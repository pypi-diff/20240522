# Comparing `tmp/odoo_addon_l10n_es_aeat_mod190-16.0.1.4.0-py3-none-any.whl.zip` & `tmp/odoo_addon_l10n_es_aeat_mod190-16.0.2.0.0-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,43 +1,43 @@
-Zip file size: 298515 bytes, number of entries: 41
--rw-r--r--  2.0 unx     4873 b- defN 24-May-08 09:23 odoo/addons/l10n_es_aeat_mod190/README.rst
--rw-r--r--  2.0 unx       21 b- defN 24-May-08 09:23 odoo/addons/l10n_es_aeat_mod190/__init__.py
--rw-r--r--  2.0 unx      995 b- defN 24-May-08 09:23 odoo/addons/l10n_es_aeat_mod190/__manifest__.py
--rw-r--r--  2.0 unx    12052 b- defN 24-May-08 09:23 odoo/addons/l10n_es_aeat_mod190/data/aeat_export_mod190_data.xml
--rw-r--r--  2.0 unx    39673 b- defN 24-May-08 09:23 odoo/addons/l10n_es_aeat_mod190/data/aeat_export_mod190_partner_data.xml
--rw-r--r--  2.0 unx    17378 b- defN 24-May-08 09:23 odoo/addons/l10n_es_aeat_mod190/data/perception_key_data.xml
--rw-r--r--  2.0 unx    54132 b- defN 24-May-08 09:23 odoo/addons/l10n_es_aeat_mod190/data/perception_subkey_data.xml
--rw-r--r--  2.0 unx     5826 b- defN 24-May-08 09:23 odoo/addons/l10n_es_aeat_mod190/data/tax_code_map_mod190_data.xml
--rw-r--r--  2.0 unx   221015 b- defN 24-May-08 09:23 odoo/addons/l10n_es_aeat_mod190/docs/DR190_2017.pdf
--rw-r--r--  2.0 unx    83130 b- defN 24-May-08 09:23 odoo/addons/l10n_es_aeat_mod190/i18n/ca.po
--rw-r--r--  2.0 unx    69108 b- defN 24-May-08 09:23 odoo/addons/l10n_es_aeat_mod190/i18n/ca_ES.po
--rw-r--r--  2.0 unx    83895 b- defN 24-May-08 09:23 odoo/addons/l10n_es_aeat_mod190/i18n/es.po
--rw-r--r--  2.0 unx    69029 b- defN 24-May-08 09:23 odoo/addons/l10n_es_aeat_mod190/i18n/l10n_es_aeat_mod190.pot
--rw-r--r--  2.0 unx     8166 b- defN 24-May-08 09:23 odoo/addons/l10n_es_aeat_mod190/migrations/16.0.1.3.0/pre-migration.py
--rw-r--r--  2.0 unx      202 b- defN 24-May-08 09:23 odoo/addons/l10n_es_aeat_mod190/models/__init__.py
--rw-r--r--  2.0 unx     2739 b- defN 24-May-08 09:23 odoo/addons/l10n_es_aeat_mod190/models/account_fiscal_position.py
--rw-r--r--  2.0 unx     3064 b- defN 24-May-08 09:23 odoo/addons/l10n_es_aeat_mod190/models/account_move.py
--rw-r--r--  2.0 unx     3372 b- defN 24-May-08 09:23 odoo/addons/l10n_es_aeat_mod190/models/account_move_line.py
--rw-r--r--  2.0 unx    25170 b- defN 24-May-08 09:23 odoo/addons/l10n_es_aeat_mod190/models/l10n_es_aeat_mod190_report.py
--rw-r--r--  2.0 unx     1252 b- defN 24-May-08 09:23 odoo/addons/l10n_es_aeat_mod190/models/l10n_es_aeat_perception.py
--rw-r--r--  2.0 unx    11074 b- defN 24-May-08 09:23 odoo/addons/l10n_es_aeat_mod190/models/res_partner.py
--rw-r--r--  2.0 unx      281 b- defN 24-May-08 09:23 odoo/addons/l10n_es_aeat_mod190/readme/CONTRIBUTORS.rst
--rw-r--r--  2.0 unx      198 b- defN 24-May-08 09:23 odoo/addons/l10n_es_aeat_mod190/readme/DESCRIPTION.rst
--rw-r--r--  2.0 unx     1637 b- defN 24-May-08 09:23 odoo/addons/l10n_es_aeat_mod190/readme/USAGE.rst
--rw-r--r--  2.0 unx     1074 b- defN 24-May-08 09:23 odoo/addons/l10n_es_aeat_mod190/security/ir.model.access.csv
--rw-r--r--  2.0 unx      427 b- defN 24-May-08 09:23 odoo/addons/l10n_es_aeat_mod190/security/l10n_es_aeat_mod190_security.xml
--rw-r--r--  2.0 unx     6146 b- defN 24-May-08 09:23 odoo/addons/l10n_es_aeat_mod190/static/description/icon.png
--rw-r--r--  2.0 unx     3754 b- defN 24-May-08 09:23 odoo/addons/l10n_es_aeat_mod190/static/description/icon_source.svg
--rw-r--r--  2.0 unx    14829 b- defN 24-May-08 09:23 odoo/addons/l10n_es_aeat_mod190/static/description/index.html
--rw-r--r--  2.0 unx       26 b- defN 24-May-08 09:23 odoo/addons/l10n_es_aeat_mod190/tests/__init__.py
--rw-r--r--  2.0 unx     6483 b- defN 24-May-08 09:23 odoo/addons/l10n_es_aeat_mod190/tests/test_mod190.py
--rw-r--r--  2.0 unx     1223 b- defN 24-May-08 09:23 odoo/addons/l10n_es_aeat_mod190/views/account_fiscal_position.xml
--rw-r--r--  2.0 unx     1118 b- defN 24-May-08 09:23 odoo/addons/l10n_es_aeat_mod190/views/account_invoice_view.xml
--rw-r--r--  2.0 unx      951 b- defN 24-May-08 09:23 odoo/addons/l10n_es_aeat_mod190/views/account_move_view.xml
--rw-r--r--  2.0 unx    12755 b- defN 24-May-08 09:23 odoo/addons/l10n_es_aeat_mod190/views/mod190_line_view.xml
--rw-r--r--  2.0 unx     4999 b- defN 24-May-08 09:23 odoo/addons/l10n_es_aeat_mod190/views/mod190_view.xml
--rw-r--r--  2.0 unx     6169 b- defN 24-May-08 09:23 odoo/addons/l10n_es_aeat_mod190/views/partner_view.xml
--rw-r--r--  2.0 unx     5489 b- defN 24-May-08 09:23 odoo_addon_l10n_es_aeat_mod190-16.0.1.4.0.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 24-May-08 09:23 odoo_addon_l10n_es_aeat_mod190-16.0.1.4.0.dist-info/WHEEL
--rw-r--r--  2.0 unx        5 b- defN 24-May-08 09:23 odoo_addon_l10n_es_aeat_mod190-16.0.1.4.0.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     4630 b- defN 24-May-08 09:23 odoo_addon_l10n_es_aeat_mod190-16.0.1.4.0.dist-info/RECORD
-41 files, 788452 bytes uncompressed, 290681 bytes compressed:  63.1%
+Zip file size: 298711 bytes, number of entries: 41
+-rw-r--r--  2.0 unx     4941 b- defN 24-May-21 18:00 odoo/addons/l10n_es_aeat_mod190/README.rst
+-rw-r--r--  2.0 unx       21 b- defN 24-May-21 18:00 odoo/addons/l10n_es_aeat_mod190/__init__.py
+-rw-r--r--  2.0 unx      995 b- defN 24-May-21 18:00 odoo/addons/l10n_es_aeat_mod190/__manifest__.py
+-rw-r--r--  2.0 unx    12052 b- defN 24-May-21 18:00 odoo/addons/l10n_es_aeat_mod190/data/aeat_export_mod190_data.xml
+-rw-r--r--  2.0 unx    39673 b- defN 24-May-21 18:00 odoo/addons/l10n_es_aeat_mod190/data/aeat_export_mod190_partner_data.xml
+-rw-r--r--  2.0 unx    17378 b- defN 24-May-21 18:00 odoo/addons/l10n_es_aeat_mod190/data/perception_key_data.xml
+-rw-r--r--  2.0 unx    54132 b- defN 24-May-21 18:00 odoo/addons/l10n_es_aeat_mod190/data/perception_subkey_data.xml
+-rw-r--r--  2.0 unx     5826 b- defN 24-May-21 18:00 odoo/addons/l10n_es_aeat_mod190/data/tax_code_map_mod190_data.xml
+-rw-r--r--  2.0 unx   221015 b- defN 24-May-21 18:00 odoo/addons/l10n_es_aeat_mod190/docs/DR190_2017.pdf
+-rw-r--r--  2.0 unx    83130 b- defN 24-May-21 18:00 odoo/addons/l10n_es_aeat_mod190/i18n/ca.po
+-rw-r--r--  2.0 unx    69108 b- defN 24-May-21 18:00 odoo/addons/l10n_es_aeat_mod190/i18n/ca_ES.po
+-rw-r--r--  2.0 unx    83895 b- defN 24-May-21 18:00 odoo/addons/l10n_es_aeat_mod190/i18n/es.po
+-rw-r--r--  2.0 unx    69498 b- defN 24-May-21 18:00 odoo/addons/l10n_es_aeat_mod190/i18n/l10n_es_aeat_mod190.pot
+-rw-r--r--  2.0 unx     8166 b- defN 24-May-21 18:00 odoo/addons/l10n_es_aeat_mod190/migrations/16.0.1.3.0/pre-migration.py
+-rw-r--r--  2.0 unx      202 b- defN 24-May-21 18:00 odoo/addons/l10n_es_aeat_mod190/models/__init__.py
+-rw-r--r--  2.0 unx     2739 b- defN 24-May-21 18:00 odoo/addons/l10n_es_aeat_mod190/models/account_fiscal_position.py
+-rw-r--r--  2.0 unx     3261 b- defN 24-May-21 18:00 odoo/addons/l10n_es_aeat_mod190/models/account_move.py
+-rw-r--r--  2.0 unx     3372 b- defN 24-May-21 18:00 odoo/addons/l10n_es_aeat_mod190/models/account_move_line.py
+-rw-r--r--  2.0 unx    28612 b- defN 24-May-21 18:00 odoo/addons/l10n_es_aeat_mod190/models/l10n_es_aeat_mod190_report.py
+-rw-r--r--  2.0 unx     1317 b- defN 24-May-21 18:00 odoo/addons/l10n_es_aeat_mod190/models/l10n_es_aeat_perception.py
+-rw-r--r--  2.0 unx    11074 b- defN 24-May-21 18:00 odoo/addons/l10n_es_aeat_mod190/models/res_partner.py
+-rw-r--r--  2.0 unx      349 b- defN 24-May-21 18:00 odoo/addons/l10n_es_aeat_mod190/readme/CONTRIBUTORS.rst
+-rw-r--r--  2.0 unx      198 b- defN 24-May-21 18:00 odoo/addons/l10n_es_aeat_mod190/readme/DESCRIPTION.rst
+-rw-r--r--  2.0 unx     1637 b- defN 24-May-21 18:00 odoo/addons/l10n_es_aeat_mod190/readme/USAGE.rst
+-rw-r--r--  2.0 unx     1074 b- defN 24-May-21 18:00 odoo/addons/l10n_es_aeat_mod190/security/ir.model.access.csv
+-rw-r--r--  2.0 unx      427 b- defN 24-May-21 18:00 odoo/addons/l10n_es_aeat_mod190/security/l10n_es_aeat_mod190_security.xml
+-rw-r--r--  2.0 unx     6146 b- defN 24-May-21 18:00 odoo/addons/l10n_es_aeat_mod190/static/description/icon.png
+-rw-r--r--  2.0 unx     3754 b- defN 24-May-21 18:00 odoo/addons/l10n_es_aeat_mod190/static/description/icon_source.svg
+-rw-r--r--  2.0 unx    14954 b- defN 24-May-21 18:00 odoo/addons/l10n_es_aeat_mod190/static/description/index.html
+-rw-r--r--  2.0 unx       26 b- defN 24-May-21 18:00 odoo/addons/l10n_es_aeat_mod190/tests/__init__.py
+-rw-r--r--  2.0 unx     6698 b- defN 24-May-21 18:00 odoo/addons/l10n_es_aeat_mod190/tests/test_mod190.py
+-rw-r--r--  2.0 unx     1223 b- defN 24-May-21 18:00 odoo/addons/l10n_es_aeat_mod190/views/account_fiscal_position.xml
+-rw-r--r--  2.0 unx     1118 b- defN 24-May-21 18:00 odoo/addons/l10n_es_aeat_mod190/views/account_invoice_view.xml
+-rw-r--r--  2.0 unx      951 b- defN 24-May-21 18:00 odoo/addons/l10n_es_aeat_mod190/views/account_move_view.xml
+-rw-r--r--  2.0 unx    12755 b- defN 24-May-21 18:00 odoo/addons/l10n_es_aeat_mod190/views/mod190_line_view.xml
+-rw-r--r--  2.0 unx     5274 b- defN 24-May-21 18:00 odoo/addons/l10n_es_aeat_mod190/views/mod190_view.xml
+-rw-r--r--  2.0 unx     6169 b- defN 24-May-21 18:00 odoo/addons/l10n_es_aeat_mod190/views/partner_view.xml
+-rw-r--r--  2.0 unx     5557 b- defN 24-May-21 18:00 odoo_addon_l10n_es_aeat_mod190-16.0.2.0.0.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 24-May-21 18:00 odoo_addon_l10n_es_aeat_mod190-16.0.2.0.0.dist-info/WHEEL
+-rw-r--r--  2.0 unx        5 b- defN 24-May-21 18:00 odoo_addon_l10n_es_aeat_mod190-16.0.2.0.0.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     4630 b- defN 24-May-21 18:00 odoo_addon_l10n_es_aeat_mod190-16.0.2.0.0.dist-info/RECORD
+41 files, 793444 bytes uncompressed, 290877 bytes compressed:  63.3%
```

## zipnote {}

```diff
@@ -105,20 +105,20 @@
 
 Filename: odoo/addons/l10n_es_aeat_mod190/views/mod190_view.xml
 Comment: 
 
 Filename: odoo/addons/l10n_es_aeat_mod190/views/partner_view.xml
 Comment: 
 
-Filename: odoo_addon_l10n_es_aeat_mod190-16.0.1.4.0.dist-info/METADATA
+Filename: odoo_addon_l10n_es_aeat_mod190-16.0.2.0.0.dist-info/METADATA
 Comment: 
 
-Filename: odoo_addon_l10n_es_aeat_mod190-16.0.1.4.0.dist-info/WHEEL
+Filename: odoo_addon_l10n_es_aeat_mod190-16.0.2.0.0.dist-info/WHEEL
 Comment: 
 
-Filename: odoo_addon_l10n_es_aeat_mod190-16.0.1.4.0.dist-info/top_level.txt
+Filename: odoo_addon_l10n_es_aeat_mod190-16.0.2.0.0.dist-info/top_level.txt
 Comment: 
 
-Filename: odoo_addon_l10n_es_aeat_mod190-16.0.1.4.0.dist-info/RECORD
+Filename: odoo_addon_l10n_es_aeat_mod190-16.0.2.0.0.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## odoo/addons/l10n_es_aeat_mod190/README.rst

```diff
@@ -3,15 +3,15 @@
 ===============
 
 .. 
    !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
    !! This file is generated by oca-gen-addon-readme !!
    !! changes will be overwritten.                   !!
    !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
-   !! source digest: sha256:0c21fb601ca36bae76d5e4404175a1faaef421604f3287a33ebd5c1a73f7b351
+   !! source digest: sha256:a76c53bbe3835e100a3d3aab2969d41c3d7e726ad721601bceabe9b240fc3429
    !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
 
 .. |badge1| image:: https://img.shields.io/badge/maturity-Beta-yellow.png
     :target: https://odoo-community.org/page/development-status
     :alt: Beta
 .. |badge2| image:: https://img.shields.io/badge/licence-AGPL--3-blue.png
     :target: http://www.gnu.org/licenses/agpl-3.0-standalone.html
@@ -102,14 +102,18 @@
 * Juan Vicente Pascual (http://www.puntsistemes.com)
 * Pedro Ortega (http://www.puntsistemes.com)
 * Enric Tobella <etobella@creublanca.es>
 * Nestor Torres (https://www.vunkers.com)
 * Marc Sánchez Fauste (https://www.vunkers.com)
 * Manuel Regidor González (https://www.sygel.es)
 
+* `Tecnativa <https://www.tecnativa.com>`_:
+
+  * Víctor Martínez
+
 Maintainers
 ~~~~~~~~~~~
 
 This module is maintained by the OCA.
 
 .. image:: https://odoo-community.org/logo.png
    :alt: Odoo Community Association
```

## odoo/addons/l10n_es_aeat_mod190/__manifest__.py

```diff
@@ -1,12 +1,12 @@
 # Copyright 2018 Juan Vicente Pascual <jvpascual@puntsistemes.es>
 
 {
     "name": "AEAT modelo 190",
-    "version": "16.0.1.4.0",
+    "version": "16.0.2.0.0",
     "category": "Localization/Accounting",
     "author": "Punt Sistemes SLU,"
     "Odoo Community Association (OCA),"
     "Vunkers IT Experts, SLU",
     "website": "https://github.com/OCA/l10n-spain",
     "license": "AGPL-3",
     "depends": ["l10n_es", "l10n_es_aeat"],
```

## odoo/addons/l10n_es_aeat_mod190/i18n/l10n_es_aeat_mod190.pot

```diff
@@ -201,14 +201,15 @@
 #. module: l10n_es_aeat_mod190
 #: model:ir.model.fields,field_description:l10n_es_aeat_mod190.field_l10n_es_aeat_mod190_report__message_needaction
 msgid "Action Needed"
 msgstr ""
 
 #. module: l10n_es_aeat_mod190
 #: model:ir.model.fields,field_description:l10n_es_aeat_mod190.field_l10n_es_aeat_report_perception_key__active
+#: model:ir.model.fields,field_description:l10n_es_aeat_mod190.field_l10n_es_aeat_report_perception_mixin__active
 #: model:ir.model.fields,field_description:l10n_es_aeat_mod190.field_l10n_es_aeat_report_perception_subkey__active
 msgid "Active"
 msgstr ""
 
 #. module: l10n_es_aeat_mod190
 #: model:ir.model.fields,field_description:l10n_es_aeat_mod190.field_l10n_es_aeat_mod190_report__activity_ids
 msgid "Activities"
@@ -232,14 +233,15 @@
 #. module: l10n_es_aeat_mod190
 #: model:ir.model.fields,field_description:l10n_es_aeat_mod190.field_l10n_es_aeat_mod190_report_line__ad_required
 msgid "Ad Required"
 msgstr ""
 
 #. module: l10n_es_aeat_mod190
 #: model:ir.model.fields,field_description:l10n_es_aeat_mod190.field_l10n_es_aeat_report_perception_key__ad_required
+#: model:ir.model.fields,field_description:l10n_es_aeat_mod190.field_l10n_es_aeat_report_perception_mixin__ad_required
 #: model:ir.model.fields,field_description:l10n_es_aeat_mod190.field_l10n_es_aeat_report_perception_subkey__ad_required
 #: model:ir.model.fields,field_description:l10n_es_aeat_mod190.field_res_partner__ad_required
 #: model:ir.model.fields,field_description:l10n_es_aeat_mod190.field_res_users__ad_required
 msgid "Aditional data required"
 msgstr ""
 
 #. module: l10n_es_aeat_mod190
@@ -383,19 +385,14 @@
 #. module: l10n_es_aeat_mod190
 #: model_terms:ir.ui.view,arch_db:l10n_es_aeat_mod190.view_l10n_es_aeat_mod190_report_line_form
 #: model_terms:ir.ui.view,arch_db:l10n_es_aeat_mod190.view_partner_form_inherit_l10n_es_aeat_mod190
 msgid "Bigger than 75 years"
 msgstr ""
 
 #. module: l10n_es_aeat_mod190
-#: model:ir.model.fields,field_description:l10n_es_aeat_mod190.field_l10n_es_aeat_mod190_report__calculado
-msgid "Calculated"
-msgstr ""
-
-#. module: l10n_es_aeat_mod190
 #: model:ir.model.fields,field_description:l10n_es_aeat_mod190.field_l10n_es_aeat_mod190_report__calculation_date
 msgid "Calculation Date"
 msgstr ""
 
 #. module: l10n_es_aeat_mod190
 #: model:ir.model.fields,field_description:l10n_es_aeat_mod190.field_res_partner__ceuta_melilla
 #: model:ir.model.fields,field_description:l10n_es_aeat_mod190.field_res_users__ceuta_melilla
@@ -420,14 +417,19 @@
 
 #. module: l10n_es_aeat_mod190
 #: model:ir.model,name:l10n_es_aeat_mod190.model_l10n_es_aeat_report_perception_key
 msgid "Clave percepcion"
 msgstr ""
 
 #. module: l10n_es_aeat_mod190
+#: model:ir.model,name:l10n_es_aeat_mod190.model_l10n_es_aeat_report_perception_mixin
+msgid "Clave percepcion (mixin)"
+msgstr ""
+
+#. module: l10n_es_aeat_mod190
 #: model:ir.model.fields,field_description:l10n_es_aeat_mod190.field_account_bank_statement_line__aeat_perception_key_id
 #: model:ir.model.fields,field_description:l10n_es_aeat_mod190.field_account_fiscal_position__aeat_perception_key_id
 #: model:ir.model.fields,field_description:l10n_es_aeat_mod190.field_account_move__aeat_perception_key_id
 #: model:ir.model.fields,field_description:l10n_es_aeat_mod190.field_account_move_line__aeat_perception_key_id
 #: model:ir.model.fields,field_description:l10n_es_aeat_mod190.field_account_payment__aeat_perception_key_id
 #: model:ir.model.fields,field_description:l10n_es_aeat_mod190.field_res_partner__aeat_perception_key_id
 #: model:ir.model.fields,field_description:l10n_es_aeat_mod190.field_res_users__aeat_perception_key_id
@@ -595,14 +597,15 @@
 #. module: l10n_es_aeat_mod190
 #: model:ir.model.fields,field_description:l10n_es_aeat_mod190.field_l10n_es_aeat_mod190_report_line__hijos_y_desc_discapacidad_entero_mr
 msgid "Descendientes con discapacidad, computado de forma entera"
 msgstr ""
 
 #. module: l10n_es_aeat_mod190
 #: model:ir.model.fields,field_description:l10n_es_aeat_mod190.field_l10n_es_aeat_report_perception_key__description
+#: model:ir.model.fields,field_description:l10n_es_aeat_mod190.field_l10n_es_aeat_report_perception_mixin__description
 #: model:ir.model.fields,field_description:l10n_es_aeat_mod190.field_l10n_es_aeat_report_perception_subkey__description
 msgid "Description"
 msgstr ""
 
 #. module: l10n_es_aeat_mod190
 #: model:ir.model.fields,field_description:l10n_es_aeat_mod190.field_l10n_es_aeat_mod190_report_line__discapacidad
 #: model:ir.model.fields,field_description:l10n_es_aeat_mod190.field_res_partner__discapacidad
@@ -927,14 +930,15 @@
 #: model:ir.model.fields,field_description:l10n_es_aeat_mod190.field_l10n_es_aeat_mod190_report__message_ids
 msgid "Messages"
 msgstr ""
 
 #. module: l10n_es_aeat_mod190
 #: model:ir.model.fields,field_description:l10n_es_aeat_mod190.field_l10n_es_aeat_mod190_report__number
 #: model:ir.model.fields,field_description:l10n_es_aeat_mod190.field_l10n_es_aeat_report_perception_key__aeat_number
+#: model:ir.model.fields,field_description:l10n_es_aeat_mod190.field_l10n_es_aeat_report_perception_mixin__aeat_number
 #: model:ir.model.fields,field_description:l10n_es_aeat_mod190.field_l10n_es_aeat_report_perception_subkey__aeat_number
 msgid "Model number"
 msgstr ""
 
 #. module: l10n_es_aeat_mod190
 #: model_terms:ir.ui.view,arch_db:l10n_es_aeat_mod190.view_partner_form_inherit_l10n_es_aeat_mod190
 msgid "Modelo 190"
@@ -1005,14 +1009,15 @@
 #: model:ir.model.fields.selection,name:l10n_es_aeat_mod190.selection__l10n_es_aeat_mod190_report_line__movilidad_geografica__0
 #: model:ir.model.fields.selection,name:l10n_es_aeat_mod190.selection__res_partner__movilidad_geografica__0
 msgid "NO"
 msgstr ""
 
 #. module: l10n_es_aeat_mod190
 #: model:ir.model.fields,field_description:l10n_es_aeat_mod190.field_l10n_es_aeat_report_perception_key__name
+#: model:ir.model.fields,field_description:l10n_es_aeat_mod190.field_l10n_es_aeat_report_perception_mixin__name
 #: model:ir.model.fields,field_description:l10n_es_aeat_mod190.field_l10n_es_aeat_report_perception_subkey__name
 msgid "Name"
 msgstr ""
 
 #. module: l10n_es_aeat_mod190
 #: model:ir.model.fields,field_description:l10n_es_aeat_mod190.field_l10n_es_aeat_mod190_report__activity_date_deadline
 msgid "Next Activity Deadline"
@@ -1229,14 +1234,15 @@
 #. module: l10n_es_aeat_mod190
 #: model:ir.model.fields.selection,name:l10n_es_aeat_mod190.selection__l10n_es_aeat_mod190_report_line__movilidad_geografica__1
 #: model:ir.model.fields.selection,name:l10n_es_aeat_mod190.selection__res_partner__movilidad_geografica__1
 msgid "SI"
 msgstr ""
 
 #. module: l10n_es_aeat_mod190
+#: model:ir.model.fields,help:l10n_es_aeat_mod190.field_l10n_es_aeat_mod190_report_line__ceuta_melilla
 #: model:ir.model.fields,help:l10n_es_aeat_mod190.field_res_partner__ceuta_melilla
 #: model:ir.model.fields,help:l10n_es_aeat_mod190.field_res_users__ceuta_melilla
 msgid ""
 "Se consignará el número 1 en los supuestos en que, por\n"
 "            tratarse de rentas obtenidas en Ceuta o Melilla con\n"
 "            derecho a la deducción establecida en el artículo 68.4 de\n"
 "            la Ley del Impuesto, el pagador hubiera determinado el\n"
@@ -1538,21 +1544,14 @@
 
 #. module: l10n_es_aeat_mod190
 #: model:ir.model.fields,field_description:l10n_es_aeat_mod190.field_l10n_es_aeat_mod190_report_line__a_nacimiento
 msgid "Year of birth"
 msgstr ""
 
 #. module: l10n_es_aeat_mod190
-#. odoo-python
-#: code:addons/l10n_es_aeat_mod190/models/l10n_es_aeat_mod190_report.py:0
-#, python-format
-msgid "You have to recalculate the report before confirm it."
-msgstr ""
-
-#. module: l10n_es_aeat_mod190
 #: model:ir.model.fields,field_description:l10n_es_aeat_mod190.field_l10n_es_aeat_mod190_report__casilla_01
 msgid "[01] Recipients"
 msgstr ""
 
 #. module: l10n_es_aeat_mod190
 #: model:ir.model.fields,field_description:l10n_es_aeat_mod190.field_l10n_es_aeat_mod190_report__casilla_02
 msgid "[02] Amount of perceptions"
```

## odoo/addons/l10n_es_aeat_mod190/models/account_move.py

```diff
@@ -1,8 +1,9 @@
 # Copyright 2020 Creu Blanca
+# Copyright 2024 Tecnativa - Víctor Martínez
 # License AGPL-3.0 or later (https://www.gnu.org/licenses/agpl).
 
 from odoo import api, fields, models
 
 
 class AccountMove(models.Model):
     _inherit = "account.move"
@@ -11,15 +12,15 @@
         comodel_name="l10n.es.aeat.report.perception.key",
         string="Clave percepción",
         help="Se consignará la clave alfabética que corresponda a las "
         "percepciones de que se trate.",
         readonly=False,
         states={"draft": [("readonly", False)]},
         store=True,
-        compute="_compute_aeat_perception_keys",
+        compute="_compute_aeat_perception_key_id",
     )
     aeat_perception_subkey_id = fields.Many2one(
         comodel_name="l10n.es.aeat.report.perception.subkey",
         string="Subclave",
         help="""Tratándose de percepciones correspondientes a las claves
                 B, E, F, G, H, I, K y L, deberá consignarse, además, la
                 subclave numérica de dos dígitos que corresponda a las
@@ -35,36 +36,40 @@
                 registros de percepción como sea necesario, de forma que
                 cada uno de ellos refleje exclusivamente los datos de
                 percepciones correspondientes a una misma clave y, en
                 su caso, subclave.""",
         readonly=False,
         states={"draft": [("readonly", False)]},
         store=True,
-        compute="_compute_aeat_perception_keys",
+        compute="_compute_aeat_perception_subkey_id",
         domain="[('aeat_perception_key_id', '=', aeat_perception_key_id)]",
     )
     is_aeat_perception_subkey_visible = fields.Boolean(
         compute="_compute_is_aeat_perception_subkey_visible"
     )
 
+    @api.depends("fiscal_position_id")
+    def _compute_aeat_perception_key_id(self):
+        for item in self.filtered(lambda x: x.fiscal_position_id):
+            item.aeat_perception_key_id = item.fiscal_position_id.aeat_perception_key_id
+
+    @api.depends("fiscal_position_id")
+    def _compute_aeat_perception_subkey_id(self):
+        for item in self.filtered(lambda x: x.fiscal_position_id):
+            item.aeat_perception_subkey_id = (
+                item.fiscal_position_id.aeat_perception_subkey_id
+            )
+
     @api.depends("aeat_perception_key_id")
     def _compute_is_aeat_perception_subkey_visible(self):
         for record in self:
             record.is_aeat_perception_subkey_visible = bool(
                 record.env["l10n.es.aeat.report.perception.subkey"].search(
                     [
                         (
                             "aeat_perception_key_id",
                             "=",
                             record.aeat_perception_key_id.id,
                         ),
                     ]
                 )
             )
-
-    @api.depends("fiscal_position_id")
-    def _compute_aeat_perception_keys(self):
-        for invoice in self:
-            if invoice.fiscal_position_id.aeat_perception_key_id:
-                fp = invoice.fiscal_position_id
-                invoice.aeat_perception_key_id = fp.aeat_perception_key_id
-                invoice.aeat_perception_subkey_id = fp.aeat_perception_subkey_id
```

## odoo/addons/l10n_es_aeat_mod190/models/l10n_es_aeat_mod190_report.py

```diff
@@ -1,364 +1,275 @@
+# Copyright 2019 Creu Blanca
+# Copyright 2024 Tecnativa - Víctor Martínez
+# License AGPL-3.0 or later (http://www.gnu.org/licenses/agpl).
+
 from odoo import _, api, exceptions, fields, models
-from odoo.tools import float_compare
 
 from odoo.addons.l10n_es_aeat.models.spanish_states_mapping import SPANISH_STATES
 
 
 class L10nEsAeatMod190Report(models.Model):
-
     _description = "AEAT 190 report"
     _inherit = "l10n.es.aeat.report.tax.mapping"
     _name = "l10n.es.aeat.mod190.report"
     _aeat_number = "190"
     _period_quarterly = False
     _period_monthly = False
     _period_yearly = True
 
-    casilla_01 = fields.Integer(string="[01] Recipients", readonly=True)
-    casilla_02 = fields.Float(string="[02] Amount of perceptions")
-    casilla_03 = fields.Float(string="[03] Amount of retentions")
+    casilla_01 = fields.Integer(
+        string="[01] Recipients",
+        compute="_compute_casilla_01",
+        readonly=False,
+        store=True,
+    )
+    casilla_02 = fields.Float(
+        string="[02] Amount of perceptions",
+        compute="_compute_casilla_02",
+        readonly=False,
+        store=True,
+    )
+    casilla_03 = fields.Float(
+        string="[03] Amount of retentions",
+        compute="_compute_casilla_03",
+        readonly=False,
+        store=True,
+    )
     partner_record_ids = fields.One2many(
         comodel_name="l10n.es.aeat.mod190.report.line",
         inverse_name="report_id",
         string="Partner records",
     )
-    registro_manual = fields.Boolean(string="Manual records", default=False)
-    calculado = fields.Boolean(string="Calculated", default=False)
+    registro_manual = fields.Boolean(
+        string="Manual records",
+        default=False,
+    )
 
-    def _check_report_lines(self):
-        """Checks if all the fields of all the report lines
-        (partner records) are filled"""
+    @api.depends("partner_record_ids")
+    def _compute_casilla_01(self):
         for item in self:
-            for partner_record in item.partner_record_ids:
-                if not partner_record.partner_record_ok:
-                    raise exceptions.UserError(
-                        _(
-                            "All partner records fields (country, VAT number) "
-                            "must be filled."
-                        )
-                    )
+            item.casilla_01 = len(item.partner_record_ids)
 
-    def button_confirm(self):
-        for report in self:
-            valid = True
-            if self.casilla_01 != len(report.partner_record_ids):
-                valid = False
-
-            percepciones = 0.0
-            retenciones = 0.0
-            for line in report.partner_record_ids:
-                percepciones += (
-                    line.percepciones_dinerarias
-                    + line.percepciones_en_especie
-                    + line.percepciones_dinerarias_incap
-                    + line.percepciones_en_especie_incap
+    @api.depends(
+        "registro_manual",
+        "partner_record_ids",
+        "partner_record_ids.percepciones_dinerarias",
+        "partner_record_ids.percepciones_en_especie",
+        "partner_record_ids.percepciones_dinerarias_incap",
+        "partner_record_ids.percepciones_en_especie_incap",
+        "tax_line_ids",
+    )
+    def _compute_casilla_02(self):
+        for item in self:
+            value = 0
+            if item.registro_manual:
+                value += sum(item.mapped("partner_record_ids.percepciones_dinerarias"))
+                value += sum(item.mapped("partner_record_ids.percepciones_en_especie"))
+                value += sum(
+                    item.mapped("partner_record_ids.percepciones_dinerarias_incap")
                 )
-
-                retenciones += (
-                    line.retenciones_dinerarias + line.retenciones_dinerarias_incap
+                value += sum(
+                    item.mapped("partner_record_ids.percepciones_en_especie_incap")
                 )
+            else:
+                tax_lines = item.tax_line_ids.search(
+                    [
+                        ("field_number", "in", (11, 13, 15)),
+                        ("model", "=", item._name),
+                        ("res_id", "=", item.id),
+                    ]
+                )
+                for move_line in tax_lines.move_line_ids:
+                    value += move_line.debit - move_line.credit
+            item.casilla_02 = value
 
-            if float_compare(self.casilla_02, percepciones, 2) != 0:
-                valid = False
+    @api.depends(
+        "registro_manual",
+        "partner_record_ids",
+        "partner_record_ids.retenciones_dinerarias",
+        "partner_record_ids.retenciones_dinerarias_incap",
+        "tax_line_ids",
+    )
+    def _compute_casilla_03(self):
+        for item in self:
+            value = 0
+            if item.registro_manual:
+                value += sum(item.mapped("partner_record_ids.retenciones_dinerarias"))
+                value += sum(
+                    item.mapped("partner_record_ids.retenciones_dinerarias_incap")
+                )
+            else:
+                tax_lines = self.tax_line_ids.search(
+                    [
+                        ("field_number", "in", (12, 14, 16)),
+                        ("model", "=", item._name),
+                        ("res_id", "=", item.id),
+                    ]
+                )
+                for move_line in tax_lines.move_line_ids:
+                    value += move_line.credit - move_line.debit
+            item.casilla_03 = value
 
-            if float_compare(self.casilla_03, retenciones, 2) != 0:
-                valid = False
+    def _check_report_lines(self):
+        """Checks if all the fields of all the report lines
+        (partner records) are filled"""
+        if any(not item.partner_record_ok for item in self.partner_record_ids):
+            raise exceptions.UserError(
+                _("All partner records fields (country, VAT number) " "must be filled.")
+            )
 
-            if not valid:
-                raise exceptions.UserError(
-                    _("You have to recalculate the report before confirm it.")
-                )
+    def button_confirm(self):
         self._check_report_lines()
         return super().button_confirm()
 
-    # flake8: noqa: C901
     def calculate(self):
         res = super().calculate()
-        for report in self:
-            if not report.registro_manual:
-                report.partner_record_ids.unlink()
+        manual_records = self.filtered(lambda x: x.registro_manual)
+        manual_records.partner_record_ids.unlink()
+        for report in self - manual_records:
             tax_lines = report.tax_line_ids.filtered(
                 lambda x: x.field_number in (11, 12, 13, 14, 15, 16)
                 and x.res_id == report.id
             )
             tax_line_vals = {}
-            for tax_line in tax_lines:
-                for line in tax_line.move_line_ids:
-                    rp = line.partner_id
-                    if line.aeat_perception_key_id:
-                        key_id = line.aeat_perception_key_id
-                        subkey_id = line.aeat_perception_subkey_id
-                    else:
-                        key_id = rp.aeat_perception_key_id
-                        subkey_id = rp.aeat_perception_subkey_id
-                    if rp.id not in tax_line_vals:
-                        tax_line_vals[rp.id] = {}
-                    if key_id.id not in tax_line_vals[rp.id]:
-                        tax_line_vals[rp.id][key_id.id] = {}
-                    if subkey_id.id not in tax_line_vals[rp.id][key_id.id]:
-                        tax_line_vals[rp.id][key_id.id][subkey_id.id] = {}
-                        partner_record_id = False
-                        for rpr_id in report.partner_record_ids:
-                            if (
-                                rpr_id.partner_id == rp
-                                and key_id == rpr_id.aeat_perception_key_id
-                                and subkey_id == rpr_id.aeat_perception_subkey_id
-                            ):
-                                partner_record_id = rpr_id.id
-                                break
-                        if not partner_record_id:
-                            if not rp.aeat_perception_key_id:
-                                raise exceptions.UserError(
-                                    _(
-                                        "The perception key of the partner, %(partner)s. "
-                                        "Must be filled."
-                                    )
-                                    % ({"partner": rp.name})
-                                )
-                            tax_line_vals[rp.id][key_id.id][
-                                subkey_id.id
-                            ] = report._get_line_mod190_vals(rp, key_id, subkey_id)
-                        else:
-                            tax_line_vals[rp.id][key_id.id][subkey_id.id] = False
-                    if report.registro_manual:
-                        continue
-                    if tax_line_vals[rp.id][key_id.id][subkey_id.id]:
-                        values = tax_line_vals[rp.id][key_id.id][subkey_id.id]
-                        pd = 0.0
-                        if (
-                            tax_line.field_number in (11, 15)
-                            and tax_line.res_id == report.id
-                        ):
-                            pd += line.debit - line.credit
-                        rd = 0.0
-                        if (
-                            tax_line.field_number in (12, 16)
-                            and tax_line.res_id == report.id
-                        ):
-                            rd += line.credit - line.debit
-                        pde = 0.0
-                        if tax_line.field_number == 13 and tax_line.res_id == report.id:
-                            pde += line.debit - line.credit
-                        rde = 0.0
-                        if tax_line.field_number == 13 and tax_line.res_id == report.id:
-                            rde += line.credit - line.debit
-                        if not rp.discapacidad or rp.discapacidad == "0":
-                            values["percepciones_dinerarias"] += pd
-                            values["retenciones_dinerarias"] += rd
-                            values["percepciones_en_especie"] += pde - rde
-                            values["ingresos_a_cuenta_efectuados"] += pde
-                            values["ingresos_a_cuenta_repercutidos"] += rde
-                        else:
-                            values["percepciones_dinerarias_incap"] += pd
-                            values["retenciones_dinerarias_incap"] += rd
-                            values["percepciones_en_especie_incap"] += pde - rde
-                            values["ingresos_a_cuenta_efectuados_incap"] += pde
-                            values["ingresos_a_cuenta_repercutidos_incap"] += rde
-
-            line_obj = self.env["l10n.es.aeat.mod190.report.line"]
-            registros = 0
-            for partner_id in tax_line_vals:
-                for key_id in tax_line_vals[partner_id]:
-                    for subkey_id in tax_line_vals[partner_id][key_id]:
-                        values = tax_line_vals[partner_id][key_id][subkey_id]
-                        registros += 1
-                        if values:
-                            line_obj.create(values)
-            report._calculate_amount(registros)
-            report.calculado = True
-        return res
-
-    def _calculate_amount(self, registros):
-        percepciones = 0.0
-        retenciones = 0.0
-        if self.registro_manual:
-            registros = 0
-            for line in self.partner_record_ids:
-                registros += 1
-                percepciones += (
-                    line.percepciones_dinerarias
-                    + line.percepciones_en_especie
-                    + line.percepciones_dinerarias_incap
-                    + line.percepciones_en_especie_incap
-                )
-                retenciones += (
-                    line.retenciones_dinerarias + line.retenciones_dinerarias_incap
+            partner_vals = []
+            for line in tax_lines.move_line_ids:
+                rp = line.partner_id
+                key_id = line.aeat_perception_key_id or rp.aeat_perception_key_id
+                subkey_id = (
+                    line.aeat_perception_subkey_id or rp.aeat_perception_subkey_id
                 )
-        else:
-            percepciones = 0.0
-            retenciones = 0.0
-            tax_lines = self.tax_line_ids.search(
-                [
-                    ("field_number", "in", (11, 13, 15)),
-                    ("model", "=", "l10n.es.aeat.mod190.report"),
-                    ("res_id", "=", self.id),
-                ]
-            )
-            for t in tax_lines:
-                for m in t.move_line_ids:
-                    percepciones += m.debit - m.credit
-
-            tax_lines = self.tax_line_ids.search(
-                [
-                    ("field_number", "in", (12, 14, 16)),
-                    ("model", "=", "l10n.es.aeat.mod190.report"),
-                    ("res_id", "=", self.id),
-                ]
-            )
-            for t in tax_lines:
-                for m in t.move_line_ids:
-                    retenciones += m.credit - m.debit
-        self.casilla_01 = registros
-        self.casilla_02 = percepciones
-        self.casilla_03 = retenciones
+                if rp.id not in tax_line_vals:
+                    tax_line_vals[rp.id] = {}
+                if key_id.id not in tax_line_vals[rp.id]:
+                    tax_line_vals[rp.id][key_id.id] = {}
+                if subkey_id.id not in tax_line_vals[rp.id][key_id.id]:
+                    tax_line_vals[rp.id][key_id.id][subkey_id.id] = {}
+                    if not rp.aeat_perception_key_id:
+                        raise exceptions.UserError(
+                            _(
+                                "The perception key of the partner, %(partner)s. "
+                                "Must be filled."
+                            )
+                            % ({"partner": rp.name})
+                        )
+                    values = report._get_line_mod190_vals(rp, key_id, subkey_id)
+                    partner_vals.append(values)
+                    tax_line_vals[rp.id][key_id.id][subkey_id.id] = values
+            # Set partner_record_ids
+            report.partner_record_ids = [(5, 0)] + [(0, 0, x) for x in partner_vals]
+        return res
 
     def _get_line_mod190_vals(self, rp, key_id, subkey_id):
         codigo_provincia = SPANISH_STATES.get(rp.state_id.code)
         if not codigo_provincia:
-            exceptions.UserError(
+            raise exceptions.UserError(
                 _("The state is not defined in the partner, %s") % rp.name
             )
-        vals = {
-            "report_id": self.id,
+        return {
             "partner_id": rp.id,
-            "partner_vat": rp._parse_aeat_vat_info()[2],
             "aeat_perception_key_id": key_id.id,
             "aeat_perception_subkey_id": subkey_id.id,
-            "codigo_provincia": codigo_provincia,
-            "ceuta_melilla": rp.ceuta_melilla,
-            "partner_record_ok": True,
-            "percepciones_dinerarias": 0,
-            "retenciones_dinerarias": 0,
-            "percepciones_en_especie": 0,
-            "ingresos_a_cuenta_efectuados": 0,
-            "ingresos_a_cuenta_repercutidos": 0,
-            "percepciones_dinerarias_incap": 0,
-            "retenciones_dinerarias_incap": 0,
-            "percepciones_en_especie_incap": 0,
-            "ingresos_a_cuenta_efectuados_incap": 0,
-            "ingresos_a_cuenta_repercutidos_incap": 0,
         }
-        if key_id.ad_required + subkey_id.ad_required >= 2:
-            vals.update(
-                {
-                    "a_nacimiento": rp.a_nacimiento,
-                    "discapacidad": rp.discapacidad,
-                    "movilidad_geografica": rp.movilidad_geografica,
-                    "representante_legal_vat": rp.representante_legal_vat,
-                    "situacion_familiar": rp.situacion_familiar,
-                    "nif_conyuge": rp.nif_conyuge,
-                    "contrato_o_relacion": rp.contrato_o_relacion,
-                    "hijos_y_descendientes_m": rp.hijos_y_descendientes_m,
-                    "hijos_y_descendientes_m_entero": rp.hijos_y_descendientes_m_entero,
-                    "hijos_y_descendientes": rp.hijos_y_descendientes_m,
-                    "hijos_y_descendientes_entero": rp.hijos_y_descendientes_entero,
-                    "computo_primeros_hijos_1": rp.computo_primeros_hijos_1,
-                    "computo_primeros_hijos_2": rp.computo_primeros_hijos_2,
-                    "computo_primeros_hijos_3": rp.computo_primeros_hijos_3,
-                    "hijos_y_desc_discapacidad_33": rp.hijos_y_desc_discapacidad_33,
-                    "hijos_y_desc_discapacidad_entero_33": rp.hijos_y_desc_discapacidad_entero_33,
-                    "hijos_y_desc_discapacidad_mr": rp.hijos_y_desc_discapacidad_mr,
-                    "hijos_y_desc_discapacidad_entero_mr": rp.hijos_y_desc_discapacidad_entero_mr,
-                    "hijos_y_desc_discapacidad_66": rp.hijos_y_desc_discapacidad_66,
-                    "hijos_y_desc_discapacidad_entero_66": rp.hijos_y_desc_discapacidad_entero_66,
-                    "ascendientes": rp.ascendientes,
-                    "ascendientes_entero": rp.ascendientes_entero,
-                    "ascendientes_m75": rp.ascendientes_m75,
-                    "ascendientes_entero_m75": rp.ascendientes_entero_m75,
-                    "ascendientes_discapacidad_33": rp.ascendientes_discapacidad_33,
-                    "ascendientes_discapacidad_entero_33": rp.ascendientes_discapacidad_entero_33,
-                    "ascendientes_discapacidad_mr": rp.ascendientes_discapacidad_mr,
-                    "ascendientes_discapacidad_entero_mr": rp.ascendientes_discapacidad_entero_mr,
-                    "ascendientes_discapacidad_66": rp.ascendientes_discapacidad_66,
-                    "ascendientes_discapacidad_entero_66": rp.ascendientes_discapacidad_entero_66,
-                }
-            )
-        return vals
 
 
 class L10nEsAeatMod190ReportLine(models.Model):
     _name = "l10n.es.aeat.mod190.report.line"
     _description = "Line for AEAT report Mod 190"
 
-    @api.depends(
-        "partner_vat",
-        "a_nacimiento",
-        "codigo_provincia",
-        "aeat_perception_key_id",
-        "partner_id",
-    )
-    def _compute_partner_record_ok(self):
-        """Comprobamos que los campos estén introducidos dependiendo de las
-        claves y las subclaves."""
-
-        for record in self:
-            record.partner_record_ok = bool(
-                record.partner_vat
-                and record.codigo_provincia
-                and record.aeat_perception_key_id
-                and record
-            )
-
     report_id = fields.Many2one(
         comodel_name="l10n.es.aeat.mod190.report",
         string="AEAT 190 Report ID",
         ondelete="cascade",
     )
     partner_record_ok = fields.Boolean(
         compute="_compute_partner_record_ok",
+        store=True,
         string="Partner Record OK",
         help="Checked if partner record is OK",
     )
     partner_id = fields.Many2one(
         comodel_name="res.partner", string="Partner", required=True
     )
-    partner_vat = fields.Char(string="NIF")
-    representante_legal_vat = fields.Char(string="L. R. VAT")
+    partner_vat = fields.Char(string="NIF", compute="_compute_partner_vat", store=True)
+    representante_legal_vat = fields.Char(
+        string="L. R. VAT", compute="_compute_representante_legal_vat", store=True
+    )
     aeat_perception_key_id = fields.Many2one(
         comodel_name="l10n.es.aeat.report.perception.key",
         string="Perception key",
         required=True,
     )
     aeat_perception_subkey_id = fields.Many2one(
         comodel_name="l10n.es.aeat.report.perception.subkey",
         string="Perception subkey",
     )
     ejercicio_devengo = fields.Char(string="year")
-    ceuta_melilla = fields.Char(string="Ceuta or Melilla")
-
+    ceuta_melilla = fields.Char(
+        string="Ceuta or Melilla", related="partner_id.ceuta_melilla"
+    )
     # Percepciones y Retenciones
-
-    percepciones_dinerarias = fields.Float(string="Monetary perceptions")
-    retenciones_dinerarias = fields.Float(string="Money withholdings")
-    percepciones_en_especie = fields.Float(string="Valuation")
-    ingresos_a_cuenta_efectuados = fields.Float(string="Income paid on account")
-    ingresos_a_cuenta_repercutidos = fields.Float(string="Income paid into account")
+    percepciones_dinerarias = fields.Float(
+        string="Monetary perceptions",
+        compute="_compute_percepciones_dinerarias",
+        store=True,
+    )
+    retenciones_dinerarias = fields.Float(
+        string="Money withholdings",
+        compute="_compute_retenciones_dinerarias",
+        store=True,
+    )
+    percepciones_en_especie = fields.Float(
+        string="Valuation", compute="_compute_percepciones_en_especie", store=True
+    )
+    ingresos_a_cuenta_efectuados = fields.Float(
+        string="Income paid on account",
+        compute="_compute_ingresos_a_cuenta_efectuados",
+        store=True,
+    )
+    ingresos_a_cuenta_repercutidos = fields.Float(
+        string="Income paid into account",
+        compute="_compute_ingresos_a_cuenta_repercutidos",
+        store=True,
+    )
     percepciones_dinerarias_incap = fields.Float(
-        string="Monetary perceptions derived from incapacity for work"
+        string="Monetary perceptions derived from incapacity for work",
+        compute="_compute_percepciones_dinerarias_incap",
+        store=True,
     )
     retenciones_dinerarias_incap = fields.Float(
-        string="Monetary withholdings derived from incapacity for work"
+        string="Monetary withholdings derived from incapacity for work",
+        compute="_compute_retenciones_dinerarias_incap",
+        store=True,
     )
     percepciones_en_especie_incap = fields.Float(
-        string="Perceptions in kind arising from incapacity for work"
+        string="Perceptions in kind arising from incapacity for work",
+        compute="_compute_percepciones_en_especie_incap",
+        store=True,
     )
     ingresos_a_cuenta_efectuados_incap = fields.Float(
-        string="Income on account in kind made as a result of incapacity " "for work"
+        string="Income on account in kind made as a result of incapacity " "for work",
+        compute="_compute_ingresos_a_cuenta_efectuados_incap",
+        store=True,
     )
     ingresos_a_cuenta_repercutidos_incap = fields.Float(
         string="Income to account in kind, repercussions derived from "
-        "incapacity for work"
+        "incapacity for work",
+        compute="_compute_ingresos_a_cuenta_repercutidos_incap",
+        store=True,
+    )
+    codigo_provincia = fields.Char(
+        string="State ISO code",
+        compute="_compute_codigo_provincia",
+        store=True,
     )
-
-    codigo_provincia = fields.Char(string="State ISO code", help="""""")
-
     # DATOS ADICIONALES (solo en las claves A, B.01, B.03, C, E.01 y E.02).
-
-    a_nacimiento = fields.Char(string="Year of birth")
+    a_nacimiento = fields.Char(
+        string="Year of birth", compute="_compute_partner_id_ad_required", store=True
+    )
     situacion_familiar = fields.Selection(
         selection=[
             (
                 "1",
                 "1 - Single, widowed, divorced or separated with children "
                 "under 18 or incapacitated",
             ),
@@ -366,16 +277,22 @@
                 "2",
                 "2 - Married and not legally separated and your spouse has "
                 "no annual income above the amount referred to",
             ),
             ("3", "3 - Other."),
         ],
         string="Family situation",
+        compute="_compute_partner_id_ad_required",
+        store=True,
+    )
+    nif_conyuge = fields.Char(
+        string="VAT of the spouse",
+        compute="_compute_partner_id_ad_required",
+        store=True,
     )
-    nif_conyuge = fields.Char(string="VAT of the spouse")
     discapacidad = fields.Selection(
         [
             ("0", "0 - No disability or degree of disability less than 33 percent."),
             (
                 "1",
                 "1 - Degree of disability greater than 33 percent and less than "
                 "66 percent.",
@@ -384,31 +301,37 @@
                 "2",
                 "2 - Degree of disability greater than 33 percent and less than "
                 "66 percent, and reduced mobility.",
             ),
             ("3", "3 - Degree of disability equal to or greater than 65%."),
         ],
         string="Disability",
+        compute="_compute_partner_id_ad_required",
+        store=True,
     )
-
     contrato_o_relacion = fields.Selection(
-        [
+        selection=[
             ("1", "1 - Contract or relationship of a general nature"),
             ("2", "2 - Contract or ratio less than a year"),
             (
                 "3",
                 "3 - Contract or special employment relationship of a dependent "
                 "nature",
             ),
             ("4", "4 - Sporadic relationship of manual workers"),
         ],
         string="Contract or relationship",
+        compute="_compute_partner_id_ad_required",
+        store=True,
     )
     movilidad_geografica = fields.Selection(
-        [("0", "NO"), ("1", "SI")], string="Geographical mobility"
+        selection=[("0", "NO"), ("1", "SI")],
+        string="Geographical mobility",
+        compute="_compute_partner_id_ad_required",
+        store=True,
     )
     reduccion_aplicable = fields.Float(string="Applicable reduction")
     gastos_deducibles = fields.Float(string="Deductible expenses")
     pensiones_compensatorias = fields.Float(string="Compensatory pensions")
     anualidades_por_alimentos = fields.Float(string="Annuities for food")
     prestamos_vh = fields.Selection(
         selection=[
@@ -421,145 +344,345 @@
                 "1",
                 "1 - Si en algún momento del ejercicio ha resultado de "
                 "aplicación la reducción del tipo de retención.",
             ),
         ],
         string="Comunicación préstamos vivienda habitual",
     )
-
-    hijos_y_descendientes_m = fields.Integer(string="Under 3 years")
+    hijos_y_descendientes_m = fields.Integer(
+        string="Under 3 years", compute="_compute_partner_id_ad_required", store=True
+    )
     hijos_y_descendientes_m_entero = fields.Integer(
-        string="Under 3 years, computed entirely"
+        string="Under 3 years, computed entirely",
+        compute="_compute_partner_id_ad_required",
+        store=True,
+    )
+    hijos_y_descendientes = fields.Integer(
+        string="Rest", compute="_compute_partner_id_ad_required", store=True
+    )
+    hijos_y_descendientes_entero = fields.Integer(
+        string="Rest, computed entirely",
+        compute="_compute_partner_id_ad_required",
+        store=True,
     )
-    hijos_y_descendientes = fields.Integer(string="Rest")
-    hijos_y_descendientes_entero = fields.Integer(string="Rest, computed entirely")
-
     hijos_y_desc_discapacidad_mr = fields.Integer(
-        string="Descendientes con discapacidad"
+        string="Descendientes con discapacidad",
+        compute="_compute_partner_id_ad_required",
+        store=True,
     )
     hijos_y_desc_discapacidad_entero_mr = fields.Integer(
-        string="Descendientes con discapacidad, computado de forma entera"
+        string="Descendientes con discapacidad, computado de forma entera",
+        compute="_compute_partner_id_ad_required",
+        store=True,
     )
     hijos_y_desc_discapacidad_33 = fields.Integer(
-        string="Hijos y descendientes con discapacidad del 33%"
+        string="Hijos y descendientes con discapacidad del 33%",
+        compute="_compute_partner_id_ad_required",
+        store=True,
     )
     hijos_y_desc_discapacidad_entero_33 = fields.Integer(
         string="Hijos y descendientes con discapacidad del 33%"
-        ", computados por entero"
+        ", computados por entero",
+        compute="_compute_partner_id_ad_required",
+        store=True,
     )
     hijos_y_desc_discapacidad_66 = fields.Integer(
-        string="Hijos y descendientes con discapacidad del 66%"
+        string="Hijos y descendientes con discapacidad del 66%",
+        compute="_compute_partner_id_ad_required",
+        store=True,
     )
     hijos_y_desc_discapacidad_entero_66 = fields.Integer(
         string="Hijos y descendientes con discapacidad del 66%"
-        ", computados por entero"
+        ", computados por entero",
+        compute="_compute_partner_id_ad_required",
+        store=True,
+    )
+    ascendientes = fields.Integer(
+        string="Ascendientes menores de 75 años",
+        compute="_compute_partner_id_ad_required",
+        store=True,
     )
-    ascendientes = fields.Integer(string="Ascendientes menores de 75 años")
     ascendientes_entero = fields.Integer(
-        string="Ascendientes menores de 75 años, computados por entero"
+        string="Ascendientes menores de 75 años, computados por entero",
+        compute="_compute_partner_id_ad_required",
+        store=True,
+    )
+    ascendientes_m75 = fields.Integer(
+        string="Ascendientes mayores de 75 años",
+        compute="_compute_partner_id_ad_required",
+        store=True,
     )
-    ascendientes_m75 = fields.Integer(string="Ascendientes mayores de 75 años")
     ascendientes_entero_m75 = fields.Integer(
-        string="Ascendientes mayores de 75 años, computados por entero"
+        string="Ascendientes mayores de 75 años, computados por entero",
+        compute="_compute_partner_id_ad_required",
+        store=True,
     )
-
     ascendientes_discapacidad_33 = fields.Integer(
-        string="Ascendientes con discapacidad"
+        string="Ascendientes con discapacidad",
+        compute="_compute_partner_id_ad_required",
+        store=True,
     )
     ascendientes_discapacidad_entero_33 = fields.Integer(
-        string="Ascendientes con discapacidad, computados por entero"
+        string="Ascendientes con discapacidad, computados por entero",
+        compute="_compute_partner_id_ad_required",
+        store=True,
     )
     ascendientes_discapacidad_mr = fields.Integer(
-        string="Ascendientes con discapacidad de más del 33%"
+        string="Ascendientes con discapacidad de más del 33%",
+        compute="_compute_partner_id_ad_required",
+        store=True,
     )
     ascendientes_discapacidad_entero_mr = fields.Integer(
-        string="Ascendientes con discapacidad de más del 33%" ", computados por entero"
+        string="Ascendientes con discapacidad de más del 33%" ", computados por entero",
+        compute="_compute_partner_id_ad_required",
+        store=True,
     )
     ascendientes_discapacidad_66 = fields.Integer(
-        string="Ascendientes con discapacidad de más del 66%"
+        string="Ascendientes con discapacidad de más del 66%",
+        compute="_compute_partner_id_ad_required",
+        store=True,
     )
     ascendientes_discapacidad_entero_66 = fields.Integer(
-        string="Ascendientes con discapacidad de más del 66%" ", computados por entero"
+        string="Ascendientes con discapacidad de más del 66%" ", computados por entero",
+        compute="_compute_partner_id_ad_required",
+        store=True,
+    )
+    computo_primeros_hijos_1 = fields.Integer(
+        string="1", compute="_compute_partner_id_ad_required", store=True
+    )
+    computo_primeros_hijos_2 = fields.Integer(
+        string="2", compute="_compute_partner_id_ad_required", store=True
+    )
+    computo_primeros_hijos_3 = fields.Integer(
+        string="3", compute="_compute_partner_id_ad_required", store=True
+    )
+    ad_required = fields.Integer(compute="_compute_ad_required", store=True)
+
+    @api.depends(
+        "partner_vat",
+        "a_nacimiento",
+        "codigo_provincia",
+        "aeat_perception_key_id",
+        "partner_id",
     )
-    computo_primeros_hijos_1 = fields.Integer(string="1")
-    computo_primeros_hijos_2 = fields.Integer(string="2")
-    computo_primeros_hijos_3 = fields.Integer(string="3")
-    ad_required = fields.Integer(compute="_compute_ad_required")
+    def _compute_partner_record_ok(self):
+        """Comprobamos que los campos estén introducidos dependiendo de las
+        claves y las subclaves."""
+        for record in self:
+            record.partner_record_ok = bool(
+                record.partner_vat
+                and record.codigo_provincia
+                and record.aeat_perception_key_id
+                and record
+            )
+
+    @api.depends("partner_id")
+    def _compute_partner_vat(self):
+        for item in self.filtered(lambda x: x.partner_id):
+            item.partner_vat = item.partner_id._parse_aeat_vat_info()[2]
+
+    @api.depends("partner_id")
+    def _compute_codigo_provincia(self):
+        for item in self:
+            code = SPANISH_STATES.get(item.partner_id.state_id.code)
+            item.codigo_provincia = code if code else "98"
 
     @api.depends("aeat_perception_key_id", "aeat_perception_subkey_id")
     def _compute_ad_required(self):
         for record in self:
             ad_required = record.aeat_perception_key_id.ad_required
             if record.aeat_perception_subkey_id:
                 ad_required += record.aeat_perception_subkey_id.ad_required
             record.ad_required = ad_required
 
-    @api.onchange("partner_id")
-    def onchange_partner_id(self):
-        if self.partner_id:
-            partner = self.partner_id
-            if not partner.state_id:
-                exceptions.UserError(_("Provincia no definida en el cliente"))
-
-            self.codigo_provincia = SPANISH_STATES.get(partner.state_id.code)
-            if not self.codigo_provincia:
-                self.codigo_provincia = "98"
-
-            self.partner_vat = partner._parse_aeat_vat_info()[2]
-            # Cargamos valores establecidos en el tercero.
-            self.aeat_perception_key_id = partner.aeat_perception_key_id
-            self.aeat_perception_subkey_id = partner.aeat_perception_subkey_id
-            self.a_nacimiento = partner.a_nacimiento
-            self.discapacidad = partner.discapacidad
-            self.ceuta_melilla = partner.ceuta_melilla
-            self.movilidad_geografica = partner.movilidad_geografica
-            self.representante_legal_vat = partner.representante_legal_vat
-            self.situacion_familiar = partner.situacion_familiar
-            self.nif_conyuge = partner.nif_conyuge
-            self.contrato_o_relacion = partner.contrato_o_relacion
-            self.hijos_y_descendientes_m = partner.hijos_y_descendientes_m
-            self.hijos_y_descendientes_m_entero = partner.hijos_y_descendientes_m_entero
-            self.hijos_y_descendientes = partner.hijos_y_descendientes
-            self.hijos_y_descendientes_entero = partner.hijos_y_descendientes_entero
-            self.computo_primeros_hijos_1 = partner.computo_primeros_hijos_1
-            self.computo_primeros_hijos_2 = partner.computo_primeros_hijos_2
-            self.computo_primeros_hijos_3 = partner.computo_primeros_hijos_3
-            self.hijos_y_desc_discapacidad_33 = partner.hijos_y_desc_discapacidad_33
-            self.hijos_y_desc_discapacidad_entero_33 = (
+    @api.depends("partner_id", "ad_required")
+    def _compute_partner_id_ad_required(self):
+        """Utilizamos el mismo compute para reducir código al tener la misma lógica."""
+        for item in self.filtered(lambda x: x.ad_required >= 2):
+            partner = item.partner_id
+            item.a_nacimiento = partner.a_nacimiento
+            item.discapacidad = partner.discapacidad
+            item.movilidad_geografica = partner.movilidad_geografica
+            item.representante_legal_vat = partner.representante_legal_vat
+            item.situacion_familiar = partner.situacion_familiar
+            item.nif_conyuge = partner.nif_conyuge
+            item.contrato_o_relacion = partner.contrato_o_relacion
+            item.hijos_y_descendientes_m = partner.hijos_y_descendientes_m
+            item.hijos_y_descendientes_m_entero = partner.hijos_y_descendientes_m_entero
+            item.hijos_y_descendientes = partner.hijos_y_descendientes
+            item.hijos_y_descendientes_entero = partner.hijos_y_descendientes_entero
+            item.computo_primeros_hijos_1 = partner.computo_primeros_hijos_1
+            item.computo_primeros_hijos_2 = partner.computo_primeros_hijos_2
+            item.computo_primeros_hijos_3 = partner.computo_primeros_hijos_3
+            item.hijos_y_desc_discapacidad_33 = partner.hijos_y_desc_discapacidad_33
+            item.hijos_y_desc_discapacidad_entero_33 = (
                 partner.hijos_y_desc_discapacidad_entero_33
             )
-            self.hijos_y_desc_discapacidad_mr = partner.hijos_y_desc_discapacidad_mr
-            self.hijos_y_desc_discapacidad_entero_mr = (
+            item.hijos_y_desc_discapacidad_mr = partner.hijos_y_desc_discapacidad_mr
+            item.hijos_y_desc_discapacidad_entero_mr = (
                 partner.hijos_y_desc_discapacidad_entero_mr
             )
-            self.hijos_y_desc_discapacidad_66 = partner.hijos_y_desc_discapacidad_66
-            self.hijos_y_desc_discapacidad_entero_66 = (
+            item.hijos_y_desc_discapacidad_66 = partner.hijos_y_desc_discapacidad_66
+            item.hijos_y_desc_discapacidad_entero_66 = (
                 partner.hijos_y_desc_discapacidad_entero_66
             )
-            self.ascendientes = partner.ascendientes
-            self.ascendientes_entero = partner.ascendientes_entero
-            self.ascendientes_m75 = partner.ascendientes_m75
-            self.ascendientes_entero_m75 = partner.ascendientes_entero_m75
-
-            self.ascendientes_discapacidad_33 = partner.ascendientes_discapacidad_33
-            self.ascendientes_discapacidad_entero_33 = (
+            item.ascendientes = partner.ascendientes
+            item.ascendientes_entero = partner.ascendientes_entero
+            item.ascendientes_m75 = partner.ascendientes_m75
+            item.ascendientes_entero_m75 = partner.ascendientes_entero_m75
+            item.ascendientes_discapacidad_33 = partner.ascendientes_discapacidad_33
+            item.ascendientes_discapacidad_entero_33 = (
                 partner.ascendientes_discapacidad_entero_33
             )
-            self.ascendientes_discapacidad_mr = partner.ascendientes_discapacidad_mr
-            self.ascendientes_discapacidad_entero_mr = (
+            item.ascendientes_discapacidad_mr = partner.ascendientes_discapacidad_mr
+            item.ascendientes_discapacidad_entero_mr = (
                 partner.ascendientes_discapacidad_entero_mr
             )
-            self.ascendientes_discapacidad_66 = partner.ascendientes_discapacidad_66
-            self.ascendientes_discapacidad_entero_66 = (
+            item.ascendientes_discapacidad_66 = partner.ascendientes_discapacidad_66
+            item.ascendientes_discapacidad_entero_66 = (
                 partner.ascendientes_discapacidad_entero_66
             )
 
+    # Calculo campos SIN incapacidad
+    @api.depends("report_id", "report_id.tax_line_ids", "discapacidad")
+    def _compute_percepciones_dinerarias(self):
+        for item in self.filtered(
+            lambda x: not x.discapacidad or x.discapacidad == "0"
+        ):
+            tax_lines = item.report_id.tax_line_ids.filtered(
+                lambda x: x.field_number in (11, 15) and x.res_id == item.report_id.id
+            )
+            value = 0.0
+            for move_line in tax_lines.move_line_ids:
+                value += move_line.debit - move_line.credit
+            item.percepciones_dinerarias = value
+
+    @api.depends("report_id", "report_id.tax_line_ids", "discapacidad")
+    def _compute_retenciones_dinerarias(self):
+        for item in self.filtered(
+            lambda x: not x.discapacidad or x.discapacidad == "0"
+        ):
+            tax_lines = item.report_id.tax_line_ids.filtered(
+                lambda x: x.field_number in (12, 16) and x.res_id == item.report_id.id
+            )
+            value = 0.0
+            for move_line in tax_lines.move_line_ids:
+                value += move_line.credit - move_line.debit
+            item.retenciones_dinerarias = value
+
+    @api.depends("report_id", "report_id.tax_line_ids", "discapacidad")
+    def _compute_percepciones_en_especie(self):
+        for item in self.filtered(
+            lambda x: not x.discapacidad or x.discapacidad == "0"
+        ):
+            tax_lines = item.report_id.tax_line_ids.filtered(
+                lambda x: x.field_number == 13 and x.res_id == item.report_id.id
+            )
+            pde = rde = 0.0
+            for move_line in tax_lines.move_line_ids:
+                pde += move_line.debit - move_line.credit
+                rde += move_line.credit - move_line.debit
+            item.percepciones_en_especie = pde - rde
+
+    @api.depends("report_id", "report_id.tax_line_ids", "discapacidad")
+    def _compute_ingresos_a_cuenta_efectuados(self):
+        for item in self.filtered(
+            lambda x: not x.discapacidad or x.discapacidad == "0"
+        ):
+            tax_lines = item.report_id.tax_line_ids.filtered(
+                lambda x: x.field_number == 13 and x.res_id == item.report_id.id
+            )
+            value = 0.0
+            for move_line in tax_lines.move_line_ids:
+                value += move_line.debit - move_line.credit
+            item.ingresos_a_cuenta_efectuados = value
+
+    @api.depends("report_id", "report_id.tax_line_ids", "discapacidad")
+    def _compute_ingresos_a_cuenta_repercutidos(self):
+        for item in self.filtered(
+            lambda x: not x.discapacidad or x.discapacidad == "0"
+        ):
+            tax_lines = item.report_id.tax_line_ids.filtered(
+                lambda x: x.field_number == 13 and x.res_id == item.report_id.id
+            )
+            value = 0.0
+            for move_line in tax_lines.move_line_ids:
+                value += move_line.credit - move_line.debit
+            item.ingresos_a_cuenta_repercutidos = value
+
+    # Calculo campos CON incapacidad
+    @api.depends("report_id", "report_id.tax_line_ids", "discapacidad")
+    def _compute_percepciones_dinerarias_incap(self):
+        """La misma lógica que para percepciones_dinerarias."""
+        for item in self.filtered(lambda x: x.discapacidad or x.discapacidad != "0"):
+            tax_lines = item.report_id.tax_line_ids.filtered(
+                lambda x: x.field_number in (11, 15) and x.res_id == item.report_id.id
+            )
+            value = 0.0
+            for move_line in tax_lines.move_line_ids:
+                value += move_line.debit - move_line.credit
+            item.percepciones_dinerarias_incap = value
+
+    @api.depends("report_id", "report_id.tax_line_ids", "discapacidad")
+    def _compute_retenciones_dinerarias_incap(self):
+        """La misma lógica que para retenciones_dinerarias."""
+        for item in self.filtered(lambda x: x.discapacidad or x.discapacidad != "0"):
+            tax_lines = item.report_id.tax_line_ids.filtered(
+                lambda x: x.field_number in (12, 16) and x.res_id == item.report_id.id
+            )
+            value = 0.0
+            for move_line in tax_lines.move_line_ids:
+                value += move_line.credit - move_line.debit
+            item.retenciones_dinerarias_incap = value
+
+    @api.depends("report_id", "report_id.tax_line_ids", "discapacidad")
+    def _compute_percepciones_en_especie_incap(self):
+        """La misma lógica que para percepciones_en_especie."""
+        for item in self.filtered(lambda x: x.discapacidad or x.discapacidad != "0"):
+            tax_lines = item.report_id.tax_line_ids.filtered(
+                lambda x: x.field_number == 13 and x.res_id == item.report_id.id
+            )
+            pde = rde = 0.0
+            for move_line in tax_lines.move_line_ids:
+                pde += move_line.debit - move_line.credit
+                rde += move_line.credit - move_line.debit
+            item.percepciones_en_especie_incap = pde - rde
+
+    @api.depends("report_id", "report_id.tax_line_ids", "discapacidad")
+    def _compute_ingresos_a_cuenta_efectuados_incap(self):
+        """La misma lógica que para ingresos_a_cuenta_efectuados."""
+        for item in self.filtered(lambda x: x.discapacidad or x.discapacidad != "0"):
+            tax_lines = item.report_id.tax_line_ids.filtered(
+                lambda x: x.field_number == 13 and x.res_id == item.report_id.id
+            )
+            value = 0.0
+            for move_line in tax_lines.move_line_ids:
+                value += move_line.debit - move_line.credit
+            item.ingresos_a_cuenta_efectuados_incap = value
+
+    @api.depends("report_id", "report_id.tax_line_ids", "discapacidad")
+    def _compute_ingresos_a_cuenta_repercutidos_incap(self):
+        """La misma lógica que para ingresos_a_cuenta_repercutidos."""
+        for item in self.filtered(lambda x: x.discapacidad or x.discapacidad != "0"):
+            tax_lines = item.report_id.tax_line_ids.filtered(
+                lambda x: x.field_number == 13 and x.res_id == item.report_id.id
+            )
+            value = 0.0
+            for move_line in tax_lines.move_line_ids:
+                value += move_line.credit - move_line.debit
+            item.ingresos_a_cuenta_repercutidos_incap = value
+
+    @api.onchange("partner_id")
+    def onchange_partner_id(self):
+        if self.partner_id:
+            if not self.partner_id.state_id:
+                raise exceptions.UserError(_("Provincia no definida en el cliente"))
+            # Cargamos valores establecidos en el tercero.
+            self.aeat_perception_key_id = self.partner_id.aeat_perception_key_id
+            self.aeat_perception_subkey_id = self.partner_id.aeat_perception_subkey_id
             if self.aeat_perception_key_id:
                 self.aeat_perception_subkey_id = False
-        else:
-            self.partner_vat = False
-            self.codigo_provincia = False
 
     @api.onchange("aeat_perception_key_id")
     def onchange_aeat_perception_key_id(self):
         if self.aeat_perception_key_id:
             self.aeat_perception_subkey_id = False
```

## odoo/addons/l10n_es_aeat_mod190/models/l10n_es_aeat_perception.py

```diff
@@ -1,35 +1,39 @@
 # Copyright 2020 Creu Blanca
+# Copyright 2024 Tecnativa - Víctor Martínez
 from odoo import fields, models
 
 
-class L10nEsAeatReportPerceptionKey(models.Model):
-    _name = "l10n.es.aeat.report.perception.key"
-    _description = "Clave percepcion"
+class L10nEsAeatReportPerceptionMixin(models.AbstractModel):
+    _name = "l10n.es.aeat.report.perception.mixin"
+    _description = "Clave percepcion (mixin)"
 
     name = fields.Char(required=True)
-    code = fields.Char(required=True)
     aeat_number = fields.Char(string="Model number", required=True)
     description = fields.Text()
     active = fields.Boolean(default=True)
+    ad_required = fields.Integer("Aditional data required", default=0)
+
+
+class L10nEsAeatReportPerceptionKey(models.Model):
+    _name = "l10n.es.aeat.report.perception.key"
+    _description = "Clave percepcion"
+    _inherit = "l10n.es.aeat.report.perception.mixin"
+
+    code = fields.Char(required=True)
     aeat_perception_subkey_ids = fields.One2many(
         comodel_name="l10n.es.aeat.report.perception.subkey",
         inverse_name="aeat_perception_key_id",
         string="Subkeys",
     )
-    ad_required = fields.Integer("Aditional data required", default=0)
 
 
 class L10nEsAeatReportPerceptionSubkey(models.Model):
     _name = "l10n.es.aeat.report.perception.subkey"
     _description = "Perception Subkey"
+    _inherit = "l10n.es.aeat.report.perception.mixin"
 
     aeat_perception_key_id = fields.Many2one(
         comodel_name="l10n.es.aeat.report.perception.key",
         string="Perception ID",
         ondelete="cascade",
     )
-    name = fields.Char(required=True)
-    aeat_number = fields.Char(string="Model number", required=True)
-    description = fields.Text()
-    active = fields.Boolean(default=True)
-    ad_required = fields.Integer("Aditional data required", default=0)
```

### encoding

```diff
@@ -1 +1 @@
-us-ascii
+utf-8
```

## odoo/addons/l10n_es_aeat_mod190/readme/CONTRIBUTORS.rst

```diff
@@ -1,7 +1,11 @@
 
 * Juan Vicente Pascual (http://www.puntsistemes.com)
 * Pedro Ortega (http://www.puntsistemes.com)
 * Enric Tobella <etobella@creublanca.es>
 * Nestor Torres (https://www.vunkers.com)
 * Marc Sánchez Fauste (https://www.vunkers.com)
 * Manuel Regidor González (https://www.sygel.es)
+
+* `Tecnativa <https://www.tecnativa.com>`_:
+
+  * Víctor Martínez
```

## odoo/addons/l10n_es_aeat_mod190/static/description/index.html

```diff
@@ -362,15 +362,15 @@
 <div class="document" id="aeat-modelo-190">
 <h1 class="title">AEAT modelo 190</h1>
 
 <!-- !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
 !! This file is generated by oca-gen-addon-readme !!
 !! changes will be overwritten.                   !!
 !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
-!! source digest: sha256:0c21fb601ca36bae76d5e4404175a1faaef421604f3287a33ebd5c1a73f7b351
+!! source digest: sha256:a76c53bbe3835e100a3d3aab2969d41c3d7e726ad721601bceabe9b240fc3429
 !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! -->
 <p><a class="reference external image-reference" href="https://odoo-community.org/page/development-status"><img alt="Beta" src="https://img.shields.io/badge/maturity-Beta-yellow.png" /></a> <a class="reference external image-reference" href="http://www.gnu.org/licenses/agpl-3.0-standalone.html"><img alt="License: AGPL-3" src="https://img.shields.io/badge/licence-AGPL--3-blue.png" /></a> <a class="reference external image-reference" href="https://github.com/OCA/l10n-spain/tree/16.0/l10n_es_aeat_mod190"><img alt="OCA/l10n-spain" src="https://img.shields.io/badge/github-OCA%2Fl10n--spain-lightgray.png?logo=github" /></a> <a class="reference external image-reference" href="https://translation.odoo-community.org/projects/l10n-spain-16-0/l10n-spain-16-0-l10n_es_aeat_mod190"><img alt="Translate me on Weblate" src="https://img.shields.io/badge/weblate-Translate%20me-F47D42.png" /></a> <a class="reference external image-reference" href="https://runboat.odoo-community.org/builds?repo=OCA/l10n-spain&amp;target_branch=16.0"><img alt="Try me on Runboat" src="https://img.shields.io/badge/runboat-Try%20me-875A7B.png" /></a></p>
 <p>Modelo 190 de la AEAT. Retenciones e ingresos a cuenta. Rendimientos del
 trabajo y de actividades económicas, premios y determinadas ganancias
 patrimoniales e imputaciones de Renta. Resumen anual.</p>
 <p><strong>Table of contents</strong></p>
 <div class="contents local topic" id="contents">
@@ -440,14 +440,18 @@
 <ul class="simple">
 <li>Juan Vicente Pascual (<a class="reference external" href="http://www.puntsistemes.com">http://www.puntsistemes.com</a>)</li>
 <li>Pedro Ortega (<a class="reference external" href="http://www.puntsistemes.com">http://www.puntsistemes.com</a>)</li>
 <li>Enric Tobella &lt;<a class="reference external" href="mailto:etobella&#64;creublanca.es">etobella&#64;creublanca.es</a>&gt;</li>
 <li>Nestor Torres (<a class="reference external" href="https://www.vunkers.com">https://www.vunkers.com</a>)</li>
 <li>Marc Sánchez Fauste (<a class="reference external" href="https://www.vunkers.com">https://www.vunkers.com</a>)</li>
 <li>Manuel Regidor González (<a class="reference external" href="https://www.sygel.es">https://www.sygel.es</a>)</li>
+<li><a class="reference external" href="https://www.tecnativa.com">Tecnativa</a>:<ul>
+<li>Víctor Martínez</li>
+</ul>
+</li>
 </ul>
 </div>
 <div class="section" id="maintainers">
 <h2><a class="toc-backref" href="#toc-entry-6">Maintainers</a></h2>
 <p>This module is maintained by the OCA.</p>
 <a class="reference external image-reference" href="https://odoo-community.org"><img alt="Odoo Community Association" src="https://odoo-community.org/logo.png" /></a>
 <p>OCA, or the Odoo Community Association, is a nonprofit organization whose
```

### html2text {}

```diff
@@ -53,14 +53,16 @@
 ********** _CC_oo_nn_tt_rr_ii_bb_uu_tt_oo_rr_ss **********
     * Juan Vicente Pascual (_h_t_t_p_:_/_/_w_w_w_._p_u_n_t_s_i_s_t_e_m_e_s_._c_o_m)
     * Pedro Ortega (_h_t_t_p_:_/_/_w_w_w_._p_u_n_t_s_i_s_t_e_m_e_s_._c_o_m)
     * Enric Tobella <_e_t_o_b_e_l_l_a_@_c_r_e_u_b_l_a_n_c_a_._e_s>
     * Nestor Torres (_h_t_t_p_s_:_/_/_w_w_w_._v_u_n_k_e_r_s_._c_o_m)
     * Marc Sánchez Fauste (_h_t_t_p_s_:_/_/_w_w_w_._v_u_n_k_e_r_s_._c_o_m)
     * Manuel Regidor González (_h_t_t_p_s_:_/_/_w_w_w_._s_y_g_e_l_._e_s)
+    * _T_e_c_n_a_t_i_v_a:
+          o Víctor Martínez
 ********** _MM_aa_ii_nn_tt_aa_ii_nn_ee_rr_ss **********
 This module is maintained by the OCA.
 _[_O_d_o_o_ _C_o_m_m_u_n_i_t_y_ _A_s_s_o_c_i_a_t_i_o_n_]
 OCA, or the Odoo Community Association, is a nonprofit organization whose
 mission is to support the collaborative development of Odoo features and
 promote its widespread use.
 This module is part of the _O_C_A_/_l_1_0_n_-_s_p_a_i_n project on GitHub.
```

## odoo/addons/l10n_es_aeat_mod190/tests/test_mod190.py

```diff
@@ -1,13 +1,15 @@
 # Copyright 2019 Creu Blanca
+# Copyright 2024 Tecnativa - Víctor Martínez
 # License AGPL-3.0 or later (http://www.gnu.org/licenses/agpl).
 
 import logging
 
 from odoo.exceptions import UserError
+from odoo.tests.common import Form
 
 from odoo.addons.l10n_es_aeat.tests.test_l10n_es_aeat_mod_base import (
     TestL10nEsAeatModBase,
 )
 
 _logger = logging.getLogger("aeat.190")
 
@@ -19,14 +21,24 @@
         "P_IRPF19": (100, -19),
         "P_IRPF20": (1000, -200),
     }
 
     @classmethod
     def setUpClass(cls):
         super().setUpClass()
+        cls.env = cls.env(
+            context=dict(
+                cls.env.context,
+                mail_create_nolog=True,
+                mail_create_nosubscribe=True,
+                mail_notrack=True,
+                no_reset_password=True,
+                tracking_disable=True,
+            )
+        )
         cls.supplier.write(
             {
                 "incluir_190": True,
                 "aeat_perception_key_id": cls.env.ref(
                     "l10n_es_aeat_mod190.aeat_m190_perception_key_01"
                 ).id,
                 "a_nacimiento": "2000",
@@ -68,60 +80,53 @@
                 "year": 2017,
                 "date_start": "2017-01-01",
                 "date_end": "2017-12-31",
             }
         )
         self.assertEqual(model190.company_id.id, self.company.id)
         _logger.debug("Calculate AEAT 190 2017")
+        with self.assertRaises(UserError):
+            model190.button_calculate()
+        self.supplier.write(
+            {
+                "vat": "ESC2259530J",
+                "country_id": self.browse_ref("base.es").id,
+                "state_id": self.browse_ref("base.state_es_bi").id,
+            }
+        )
         model190.button_calculate()
+        self.assertEqual(model190.state, "calculated")
         # Fill manual fields
         if self.debug:
             self._print_tax_lines(model190.tax_line_ids)
         self.assertTrue(model190.partner_record_ids)
         supplier_record = model190.partner_record_ids.filtered(
             lambda r: r.partner_id == self.supplier
         )
-        self.assertTrue(supplier_record)
         self.assertEqual(supplier_record.percepciones_dinerarias, 2200)
         self.assertEqual(supplier_record.retenciones_dinerarias, 438)
         self.assertEqual(2, supplier_record.ad_required)
         self.assertEqual(2, self.supplier.ad_required)
-        with self.assertRaises(UserError):
-            model190.button_confirm()
-        self.supplier.write(
-            {
-                "vat": "ESC2259530J",
-                "country_id": self.browse_ref("base.es").id,
-                "state_id": self.browse_ref("base.state_es_bi").id,
-            }
-        )
         self.customer.write(
             {
                 "vat": "ESC2259530J",
                 "country_id": self.browse_ref("base.es").id,
                 "state_id": self.browse_ref("base.state_es_bi").id,
             }
         )
-        model190.button_recalculate()
-        self.assertFalse(
-            model190.partner_record_ids.filtered(
-                lambda r: r.partner_id == self.customer
-            )
-        )
-        record_new = self.env["l10n.es.aeat.mod190.report.line"].new(
-            {"report_id": model190.id}
+        self.assertNotIn(
+            self.customer, model190.mapped("partner_record_ids.partner_id")
         )
-        record_new.partner_id = self.customer
-        record_new.onchange_partner_id()
+        records = model190.partner_record_ids
+        model190_form = Form(model190)
+        with model190_form.partner_record_ids.new() as record:
+            record.partner_id = self.customer
+        model190_form.save()
+        record_new = model190.partner_record_ids - records
         self.assertEqual(record_new.partner_vat, "C2259530J")
-        self.env["l10n.es.aeat.mod190.report.line"].create(
-            record_new._convert_to_write(record_new._cache)
-        )
-        with self.assertRaises(UserError):
-            model190.button_confirm()
         model190.write({"registro_manual": True})
         model190.button_recalculate()
         model190.button_confirm()
         self.assertEqual(model190.state, "done")
 
     def test_mod190_multikeys(self):
         self._invoice_purchase_create("2017-01-01")
@@ -130,14 +135,16 @@
                 "vat": "ESC2259530J",
                 "country_id": self.browse_ref("base.es").id,
                 "state_id": self.browse_ref("base.state_es_bi").id,
                 "property_account_position_id": self.fiscal_position.id,
             }
         )
         second_invoice = self._invoice_purchase_create("2017-01-02")
+        # Definimos la posición fiscal (se hará con _onchange_partner_id por UX)
+        second_invoice.fiscal_position_id = self.fiscal_position
         self.assertTrue(second_invoice.aeat_perception_key_id)
         model190 = self.env["l10n.es.aeat.mod190.report"].create(
             {
                 "company_id": self.company.id,
                 "company_vat": "1234567890",
                 "contact_name": "Test owner",
                 "contact_phone": "911234455",
@@ -151,19 +158,16 @@
         model190.button_calculate()
         # Fill manual fields
         if self.debug:
             self._print_tax_lines(model190.tax_line_ids)
         supplier_record = model190.partner_record_ids.filtered(
             lambda r: r.partner_id == self.supplier
         )
-        self.assertTrue(supplier_record)
         self.assertEqual(2, len(supplier_record))
         self.assertEqual(1, len(supplier_record.mapped("partner_id")))
         self.assertEqual(2, len(supplier_record.mapped("aeat_perception_key_id")))
         record_with_ad = supplier_record.filtered(lambda r: r.ad_required >= 2)
-        self.assertTrue(record_with_ad)
         self.assertEqual(record_with_ad.a_nacimiento, "2000")
         record_without_ad = supplier_record.filtered(lambda r: r.ad_required < 2)
-        self.assertTrue(record_without_ad)
         self.assertFalse(record_without_ad.a_nacimiento)
         model190.button_confirm()
         self.assertEqual(model190.state, "done")
```

### encoding

```diff
@@ -1 +1 @@
-us-ascii
+utf-8
```

## odoo/addons/l10n_es_aeat_mod190/views/mod190_view.xml

### odoo/addons/l10n_es_aeat_mod190/views/mod190_view.xml

```diff
@@ -17,34 +17,33 @@
   </record>
   <record id="view_l10n_es_aeat_mod190_report_form" model="ir.ui.view">
     <field name="name">l10n_es.aeat.mod190.report.form</field>
     <field name="model">l10n.es.aeat.mod190.report</field>
     <field name="inherit_id" ref="l10n_es_aeat.view_l10n_es_aeat_report_form"/>
     <field name="arch" type="xml">
       <field name="statement_type" position="after">
-        <field name="calculado" invisible="1"/>
-        <field name="registro_manual" attrs="{'invisible': [('calculado', '=', False)]}"/>
+        <field name="registro_manual" attrs="{'readonly': [('state', '=', 'done')]}"/>
       </field>
       <group name="group_declaration" position="after">
         <notebook>
           <page name="result" string="Result">
             <group name="group_result" attrs="{'invisible': [('state', '=', 'draft')]}" colspan="4">
               <group string="Totals">
                 <group>
-                  <field name="casilla_01" string="Number of perceptions:"/>
+                  <field name="casilla_01" attrs="{'readonly': [('state', '=', 'done')]}" string="Number of perceptions:"/>
                 </group>
                 <group>
-                  <field name="casilla_02" widget="monetary" options="{'currency_field': 'currency_id'}"/>
-                  <field name="casilla_03" widget="monetary" options="{'currency_field': 'currency_id'}"/>
+                  <field name="casilla_02" attrs="{'readonly': [('state', '=', 'done')]}" widget="monetary" options="{'currency_field': 'currency_id'}"/>
+                  <field name="casilla_03" attrs="{'readonly': [('state', '=', 'done')]}" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                 </group>
               </group>
             </group>
           </page>
           <page name="recipients" string="Recipients">
-            <field name="partner_record_ids" string="Recipients" editable="bottom" nolabel="1"/>
+            <field name="partner_record_ids" attrs="{'readonly': [('state', '=', 'done')]}" string="Recipients" editable="bottom" nolabel="1"/>
           </page>
         </notebook>
       </group>
       <form position="inside">
         <div class="oe_chatter">
           <field name="message_follower_ids" widget="mail_followers" groups="base.group_user"/>
           <field name="activity_ids" widget="mail_activity"/>
```

## Comparing `odoo_addon_l10n_es_aeat_mod190-16.0.1.4.0.dist-info/METADATA` & `odoo_addon_l10n_es_aeat_mod190-16.0.2.0.0.dist-info/METADATA`

 * *Files 7% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: odoo-addon-l10n-es-aeat-mod190
-Version: 16.0.1.4.0
+Version: 16.0.2.0.0
 Summary: AEAT modelo 190
 Home-page: https://github.com/OCA/l10n-spain
 Author: Punt Sistemes SLU,Odoo Community Association (OCA),Vunkers IT Experts, SLU
 Author-email: support@odoo-community.org
 License: AGPL-3
 Platform: UNKNOWN
 Classifier: Programming Language :: Python
@@ -20,15 +20,15 @@
 ===============
 
 .. 
    !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
    !! This file is generated by oca-gen-addon-readme !!
    !! changes will be overwritten.                   !!
    !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
-   !! source digest: sha256:0c21fb601ca36bae76d5e4404175a1faaef421604f3287a33ebd5c1a73f7b351
+   !! source digest: sha256:a76c53bbe3835e100a3d3aab2969d41c3d7e726ad721601bceabe9b240fc3429
    !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
 
 .. |badge1| image:: https://img.shields.io/badge/maturity-Beta-yellow.png
     :target: https://odoo-community.org/page/development-status
     :alt: Beta
 .. |badge2| image:: https://img.shields.io/badge/licence-AGPL--3-blue.png
     :target: http://www.gnu.org/licenses/agpl-3.0-standalone.html
@@ -119,14 +119,18 @@
 * Juan Vicente Pascual (http://www.puntsistemes.com)
 * Pedro Ortega (http://www.puntsistemes.com)
 * Enric Tobella <etobella@creublanca.es>
 * Nestor Torres (https://www.vunkers.com)
 * Marc Sánchez Fauste (https://www.vunkers.com)
 * Manuel Regidor González (https://www.sygel.es)
 
+* `Tecnativa <https://www.tecnativa.com>`_:
+
+  * Víctor Martínez
+
 Maintainers
 ~~~~~~~~~~~
 
 This module is maintained by the OCA.
 
 .. image:: https://odoo-community.org/logo.png
    :alt: Odoo Community Association
```

## Comparing `odoo_addon_l10n_es_aeat_mod190-16.0.1.4.0.dist-info/RECORD` & `odoo_addon_l10n_es_aeat_mod190-16.0.2.0.0.dist-info/RECORD`

 * *Files 4% similar despite different names*

```diff
@@ -1,41 +1,41 @@
-odoo/addons/l10n_es_aeat_mod190/README.rst,sha256=7FBLbpo2YTvIVXVuvYbbfKnXyYvpzKO5HTQ5GLCuWXA,4873
+odoo/addons/l10n_es_aeat_mod190/README.rst,sha256=nluRSl4AcLvCRZ6urQw4mm9f2AGilnaYKO0vumtddTE,4941
 odoo/addons/l10n_es_aeat_mod190/__init__.py,sha256=X9EJGOE2GtZbS0G82PtSXmWSZ_R8jEM0rlJTDliQjp4,21
-odoo/addons/l10n_es_aeat_mod190/__manifest__.py,sha256=ThqCc6_DTwe4pnNPA9wIgLXM-JVvkVIt9b-ugNJXb_8,995
+odoo/addons/l10n_es_aeat_mod190/__manifest__.py,sha256=TmU7Mu06_BLRJNpquKyFksf7Hiate1LN86RV3TCR8Lc,995
 odoo/addons/l10n_es_aeat_mod190/data/aeat_export_mod190_data.xml,sha256=kDk1iIpKUjwgFohqyTVxItqhE5ktusLL0se2S6yjBis,12052
 odoo/addons/l10n_es_aeat_mod190/data/aeat_export_mod190_partner_data.xml,sha256=4qafZt8e4JIce-Tv3QR5MqqdDnAEjBs9dUCHCyMh5m8,39673
 odoo/addons/l10n_es_aeat_mod190/data/perception_key_data.xml,sha256=NCkf0L6j7-qnAl2hhkR8eoYoVNM0fjlFQAfSPRyu-8Q,17378
 odoo/addons/l10n_es_aeat_mod190/data/perception_subkey_data.xml,sha256=d01cQ9ErnECngx_-jUAv3puCjR4FktJmgzctD2mXSWo,54132
 odoo/addons/l10n_es_aeat_mod190/data/tax_code_map_mod190_data.xml,sha256=BhFreijM3KYeh5XWWWTDcDON8S8sTGvi7qtgDXFNgwU,5826
 odoo/addons/l10n_es_aeat_mod190/docs/DR190_2017.pdf,sha256=t3LPPuV8qEYWb_ATLdDqnZHQXZ6EkJzAd3XR0i0KV2M,221015
 odoo/addons/l10n_es_aeat_mod190/i18n/ca.po,sha256=0koPBHQh2tyLT44_7ouQRzMo9Ix8BGaeCJ2K_3HENQ8,83130
 odoo/addons/l10n_es_aeat_mod190/i18n/ca_ES.po,sha256=WlCKnHiCO8sehC8VyTMkd8JKGg1cXavbwrzByHTHFvQ,69108
 odoo/addons/l10n_es_aeat_mod190/i18n/es.po,sha256=4C-AUN2zzqZXcHZ7x1BDMnfb9Yesmh08k5LQCxGJTKI,83895
-odoo/addons/l10n_es_aeat_mod190/i18n/l10n_es_aeat_mod190.pot,sha256=-teU5QegX2RHxbrcyZu5MieWUGRZFnI_Klrkv9DkBHg,69029
+odoo/addons/l10n_es_aeat_mod190/i18n/l10n_es_aeat_mod190.pot,sha256=PJGejADRYfu29yFC400HPZRwQo7mp3mWtdLES8i6AxU,69498
 odoo/addons/l10n_es_aeat_mod190/migrations/16.0.1.3.0/pre-migration.py,sha256=Z8OgRs64o3T2KFr83XUxMJV744zE1KpeFc0gh7e4BQY,8166
 odoo/addons/l10n_es_aeat_mod190/models/__init__.py,sha256=P39EjgFDx0pqnpjljuKx_18eDCpD-A50f6kc8S7ZX1w,202
 odoo/addons/l10n_es_aeat_mod190/models/account_fiscal_position.py,sha256=wKWbEdHqlha3U3inaJcLV3AQ5s05mMBYRQPAnh72YJQ,2739
-odoo/addons/l10n_es_aeat_mod190/models/account_move.py,sha256=LDzMMKEDvCSBQ0-IUp2Sf5qyec7unu4-GEAMpMYrQa0,3064
+odoo/addons/l10n_es_aeat_mod190/models/account_move.py,sha256=mHna7cQZsJyIjHIqJrXW_6wDBD--VLPD5vGysaR5DD4,3261
 odoo/addons/l10n_es_aeat_mod190/models/account_move_line.py,sha256=HPzYro5inFFHEf4cQJxXMmBa2a1jklLGKRzCPc5mLGo,3372
-odoo/addons/l10n_es_aeat_mod190/models/l10n_es_aeat_mod190_report.py,sha256=5CV4iYFLeaPpO_-ALfJAKEj_fd2UKCCGqaUpNDPJdYQ,25170
-odoo/addons/l10n_es_aeat_mod190/models/l10n_es_aeat_perception.py,sha256=XE3rBXFK8dg2vdYR6p44_TBQD2gMLeLXwsyJxfGg9hE,1252
+odoo/addons/l10n_es_aeat_mod190/models/l10n_es_aeat_mod190_report.py,sha256=1zIyIe1czEWqatG2273CSRGYF_Vm9jm2QcDkXxQmoag,28612
+odoo/addons/l10n_es_aeat_mod190/models/l10n_es_aeat_perception.py,sha256=1c2WusW5fvEPAFPlxbkgmGL2obdYJ-l0QyOnsRyUdwg,1317
 odoo/addons/l10n_es_aeat_mod190/models/res_partner.py,sha256=WnDdpg76_sazcvZNGQSTusJVpO67hHVMiWXRrGEvfpQ,11074
-odoo/addons/l10n_es_aeat_mod190/readme/CONTRIBUTORS.rst,sha256=93jew_GPxE9TeJnNQivp9nro6D3DEdYIO_YTssrt89g,281
+odoo/addons/l10n_es_aeat_mod190/readme/CONTRIBUTORS.rst,sha256=-7dXv5I7Xm4qtKhk5qBXGO9LvMzWimRX-tAepKpiR5w,349
 odoo/addons/l10n_es_aeat_mod190/readme/DESCRIPTION.rst,sha256=bTKy2padRApfdW3EpfzHnbdeECr6V1yLb65N5MUEJaU,198
 odoo/addons/l10n_es_aeat_mod190/readme/USAGE.rst,sha256=VVkSnYjP-Wa3faaE2U8URbu58fril-Wr-j06cCdR-kk,1637
 odoo/addons/l10n_es_aeat_mod190/security/ir.model.access.csv,sha256=5_9MHL-j6EVOf_3_KQRWNogThNwCBgrxjtQIEKq-SSw,1074
 odoo/addons/l10n_es_aeat_mod190/security/l10n_es_aeat_mod190_security.xml,sha256=UhznbDz5cE8uJ4WhAPeY-BNbI2_awFAnAM9RnCn8y2Y,427
 odoo/addons/l10n_es_aeat_mod190/static/description/icon.png,sha256=Uq6HwgYzH-fHKwhV_UW7usC7Fcx4euJdmSFoPQbHH9w,6146
 odoo/addons/l10n_es_aeat_mod190/static/description/icon_source.svg,sha256=rRH0IF3dTD1vbS-jrOZ8zFb0A7mvHTbk4XOcRPkGX9s,3754
-odoo/addons/l10n_es_aeat_mod190/static/description/index.html,sha256=Ez_IRtfgXCxZG4H9Mh7PLeV8JkVwQZq6Je-P24vdAJw,14829
+odoo/addons/l10n_es_aeat_mod190/static/description/index.html,sha256=qfC_gZAGb1csv25V9HUDqZhhPnH6SLgd2njmorzllzo,14954
 odoo/addons/l10n_es_aeat_mod190/tests/__init__.py,sha256=blCkTjq0Znl8zzZ5jzO8guxyanZCBC77kC239CwHCKA,26
-odoo/addons/l10n_es_aeat_mod190/tests/test_mod190.py,sha256=F2EDHCVxl17JRMZ5Uof4eZgZTSczBlmzSX68R6vXFbU,6483
+odoo/addons/l10n_es_aeat_mod190/tests/test_mod190.py,sha256=6H1I0ZdvGsaXBF4BuNgK-eZ7bhaWjodNF-NEeDeFJ2M,6698
 odoo/addons/l10n_es_aeat_mod190/views/account_fiscal_position.xml,sha256=bLpq8D8JZ50stlYXMzdGVBmAkYOmrf3i-69QUPAe7kM,1223
 odoo/addons/l10n_es_aeat_mod190/views/account_invoice_view.xml,sha256=vIhU2NhPOr5KOPDddghoTH6I9fpjXPtKiluTex2tfys,1118
 odoo/addons/l10n_es_aeat_mod190/views/account_move_view.xml,sha256=5XMaNyVBP1Ds_FWwQ_T_QGYrIGVQ8T12GU7HXjSHvJo,951
 odoo/addons/l10n_es_aeat_mod190/views/mod190_line_view.xml,sha256=Cw7i6nOvT1rIIufEK0HWzZah_iRqzEsXdd4DN17G2P0,12755
-odoo/addons/l10n_es_aeat_mod190/views/mod190_view.xml,sha256=6O33MfOcGQ3c8JOqe5Io2nDBUDnIYngVRrZRgDLPjHs,4999
+odoo/addons/l10n_es_aeat_mod190/views/mod190_view.xml,sha256=vZmvyg_wkr_jIf0UDPU4fPeiRvTHfLYtQ1veK5QV3eQ,5274
 odoo/addons/l10n_es_aeat_mod190/views/partner_view.xml,sha256=v-Yyow_NvrYFNBPNIq9q84uUkZnt0_sk-l2am6LobSM,6169
-odoo_addon_l10n_es_aeat_mod190-16.0.1.4.0.dist-info/METADATA,sha256=9CrDjJ0f81v40JhPm1tTByq2WwCGz5dT5C9o2DV6_sc,5489
-odoo_addon_l10n_es_aeat_mod190-16.0.1.4.0.dist-info/WHEEL,sha256=GJ7t_kWBFywbagK5eo9IoUwLW6oyOeTKmQ-9iHFVNxQ,92
-odoo_addon_l10n_es_aeat_mod190-16.0.1.4.0.dist-info/top_level.txt,sha256=qBj40grFkGOfDZ2WDSw3y1RnDlgG0u8rP8pvGNdbz4w,5
-odoo_addon_l10n_es_aeat_mod190-16.0.1.4.0.dist-info/RECORD,,
+odoo_addon_l10n_es_aeat_mod190-16.0.2.0.0.dist-info/METADATA,sha256=UzYGvW2DQ-0A33G5e5A3p41hpM4Za8DGrSoeR7D7pj4,5557
+odoo_addon_l10n_es_aeat_mod190-16.0.2.0.0.dist-info/WHEEL,sha256=GJ7t_kWBFywbagK5eo9IoUwLW6oyOeTKmQ-9iHFVNxQ,92
+odoo_addon_l10n_es_aeat_mod190-16.0.2.0.0.dist-info/top_level.txt,sha256=qBj40grFkGOfDZ2WDSw3y1RnDlgG0u8rP8pvGNdbz4w,5
+odoo_addon_l10n_es_aeat_mod190-16.0.2.0.0.dist-info/RECORD,,
```

