# Comparing `tmp/runningz-0.16.1-py39-none-any.whl.zip` & `tmp/runningz-0.16.2-py39-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,172 +1,172 @@
-Zip file size: 485514 bytes, number of entries: 170
--rw-r--r--  2.0 unx      196 b- defN 24-May-09 16:27 runningz/.gitignore
--rw-r--r--  2.0 unx     1299 b- defN 24-May-09 16:27 runningz/__init__.pyc
--rw-r--r--  2.0 unx      186 b- defN 24-May-09 16:27 runningz/api.pyc
--rw-r--r--  2.0 unx    18311 b- defN 24-May-09 16:27 runningz/core/DataMaster.pyc
--rw-r--r--  2.0 unx      151 b- defN 24-May-09 16:27 runningz/core/__init__.pyc
--rw-r--r--  2.0 unx     3856 b- defN 24-May-09 16:27 runningz/core/api.pyc
--rw-r--r--  2.0 unx      154 b- defN 24-May-09 16:27 runningz/core/er/__init__.pyc
--rw-r--r--  2.0 unx      572 b- defN 24-May-09 16:27 runningz/core/er/hasher.pyc
--rw-r--r--  2.0 unx      651 b- defN 24-May-09 16:27 runningz/core/er/idxer.pyc
--rw-r--r--  2.0 unx      573 b- defN 24-May-09 16:27 runningz/core/er/masker.pyc
--rw-r--r--  2.0 unx     9357 b- defN 24-May-09 16:27 runningz/core/er/namer.pyc
--rw-r--r--  2.0 unx      550 b- defN 24-May-09 16:27 runningz/core/er/scaler.pyc
--rw-r--r--  2.0 unx     7484 b- defN 24-May-09 16:27 runningz/core/op/OPMaster.pyc
--rw-r--r--  2.0 unx    15662 b- defN 24-May-09 16:27 runningz/core/op/OPMaster_py.pyc
--rw-r--r--  2.0 unx     6671 b- defN 24-May-09 16:27 runningz/core/op/__init__.pyc
--rw-r--r--  2.0 unx     7346 b- defN 24-May-09 16:27 runningz/core/op/__init___py.pyc
--rw-r--r--  2.0 unx    11402 b- defN 24-May-09 16:27 runningz/core/op/_numba.pyc
--rw-r--r--  2.0 unx    24115 b- defN 24-May-09 16:27 runningz/core/op/_numba_1.pyc
--rw-r--r--  2.0 unx    27784 b- defN 24-May-09 16:27 runningz/core/op/_numba_2.pyc
--rw-r--r--  2.0 unx    17533 b- defN 24-May-09 16:27 runningz/core/op/_numba_2_2.pyc
--rw-r--r--  2.0 unx     6742 b- defN 24-May-09 16:27 runningz/core/op/_numba_merge_roll.pyc
--rw-r--r--  2.0 unx     9392 b- defN 24-May-09 16:27 runningz/core/op/op_1.pyc
--rw-r--r--  2.0 unx    13877 b- defN 24-May-09 16:27 runningz/core/op/op_1_numba.pyc
--rw-r--r--  2.0 unx     2558 b- defN 24-May-09 16:27 runningz/core/op/op_1_numba_old.pyc
--rw-r--r--  2.0 unx    26907 b- defN 24-May-09 16:27 runningz/core/op/op_2.pyc
--rw-r--r--  2.0 unx    34643 b- defN 24-May-09 16:27 runningz/core/op/op_2_numba.pyc
--rw-r--r--  2.0 unx     5608 b- defN 24-May-09 16:27 runningz/core/op/op_3.pyc
--rw-r--r--  2.0 unx     7119 b- defN 24-May-09 16:27 runningz/core/op/op_3_numba.pyc
--rw-r--r--  2.0 unx     3788 b- defN 24-May-09 16:27 runningz/core/op/op_groupby.pyc
--rw-r--r--  2.0 unx     3575 b- defN 24-May-09 16:27 runningz/core/op/op_m.pyc
--rw-r--r--  2.0 unx     5128 b- defN 24-May-09 16:27 runningz/core/op/op_m_numba.pyc
--rw-r--r--  2.0 unx     8705 b- defN 24-May-09 16:27 runningz/core/op/op_other.pyc
--rw-r--r--  2.0 unx       15 b- defN 24-May-09 16:27 runningz/fe/.gitignore
--rw-r--r--  2.0 unx    14548 b- defN 24-May-09 16:27 runningz/fe/FEMaster.pyc
--rw-r--r--  2.0 unx    23960 b- defN 24-May-09 16:27 runningz/fe/FEMaster_py.pyc
--rw-r--r--  2.0 unx      178 b- defN 24-May-09 16:27 runningz/fe/__init__.pyc
--rw-r--r--  2.0 unx     2487 b- defN 24-May-09 16:27 runningz/fe/fe_dump.pyc
--rw-r--r--  2.0 unx     3708 b- defN 24-May-09 16:27 runningz/fe/fe_dump_py.pyc
--rw-r--r--  2.0 unx     4370 b- defN 24-May-09 16:27 runningz/fe/fe_eval.pyc
--rw-r--r--  2.0 unx     7171 b- defN 24-May-09 16:27 runningz/fe/fe_eval_py.pyc
--rw-r--r--  2.0 unx     4850 b- defN 24-May-09 16:27 runningz/fe/fe_main.pyc
--rw-r--r--  2.0 unx     8473 b- defN 24-May-09 16:27 runningz/fe/fe_main_py.pyc
--rw-r--r--  2.0 unx      156 b- defN 24-May-09 16:27 runningz/fe/config/__init__.pyc
--rw-r--r--  2.0 unx    11438 b- defN 24-May-09 16:27 runningz/fe/config/cols_dict.pyc
--rw-r--r--  2.0 unx    74158 b- defN 24-May-09 16:27 runningz/fe/config/cols_fea.pyc
--rw-r--r--  2.0 unx     1274 b- defN 24-May-09 16:27 runningz/fe/config/fm_config.pyc
--rw-r--r--  2.0 unx     1919 b- defN 24-May-09 16:27 runningz/fe/config/fm_config_opt.pyc
--rw-r--r--  2.0 unx     5184 b- defN 24-May-09 16:27 runningz/fe/config/fm_config_opt_py.pyc
--rw-r--r--  2.0 unx     5988 b- defN 24-May-09 16:27 runningz/fe/config/fm_config_py.pyc
--rw-r--r--  2.0 unx     5793 b- defN 24-May-09 16:27 runningz/fe/config/fm_config_top.pyc
--rw-r--r--  2.0 unx    19957 b- defN 24-May-09 16:27 runningz/fe/config/fm_config_top_py.pyc
--rw-r--r--  2.0 unx      298 b- defN 24-May-09 16:27 runningz/fe/er/__init__.pyc
--rw-r--r--  2.0 unx     3039 b- defN 24-May-09 16:27 runningz/fe/er/pather.pyc
--rw-r--r--  2.0 unx    17161 b- defN 24-May-09 16:27 runningz/fe/er/pooler.pyc
--rw-r--r--  2.0 unx    17241 b- defN 24-May-09 16:27 runningz/fe/er/pooler_old.pyc
--rw-r--r--  2.0 unx    38247 b- defN 24-May-09 16:27 runningz/fe/er/pooler_py.pyc
--rw-r--r--  2.0 unx     8018 b- defN 24-May-09 16:27 runningz/fe/er/ranker.pyc
--rw-r--r--  2.0 unx    12370 b- defN 24-May-09 16:27 runningz/fe/er/ranker_py.pyc
--rw-r--r--  2.0 unx     5561 b- defN 24-May-09 16:27 runningz/fe/er/typer.pyc
--rw-r--r--  2.0 unx      162 b- defN 24-May-09 16:27 runningz/fe/prepare_data/__init__.pyc
--rw-r--r--  2.0 unx    13097 b- defN 24-May-09 16:27 runningz/fe/prepare_data/base_data.pyc
--rw-r--r--  2.0 unx    19981 b- defN 24-May-09 16:27 runningz/fe/prepare_data/base_data_py.pyc
--rw-r--r--  2.0 unx     1499 b- defN 24-May-09 16:27 runningz/fe/prepare_data/basic_data.pyc
--rw-r--r--  2.0 unx     2663 b- defN 24-May-09 16:27 runningz/fe/prepare_data/basic_data_py.pyc
--rw-r--r--  2.0 unx     8388 b- defN 24-May-09 16:27 runningz/fe/prepare_data/factor_data.pyc
--rw-r--r--  2.0 unx      193 b- defN 24-May-09 16:27 runningz/fe/status/__init__.pyc
--rw-r--r--  2.0 unx    10623 b- defN 24-May-09 16:27 runningz/fe/status/status.pyc
--rw-r--r--  2.0 unx    16648 b- defN 24-May-09 16:27 runningz/fe/status/status_py.pyc
--rw-r--r--  2.0 unx      154 b- defN 24-May-09 16:27 runningz/fe/util/__init__.pyc
--rw-r--r--  2.0 unx    11846 b- defN 24-May-09 16:27 runningz/fe/util/util.pyc
--rw-r--r--  2.0 unx    14775 b- defN 24-May-09 16:27 runningz/fe/util/util_py.pyc
--rw-r--r--  2.0 unx      294 b- defN 24-May-09 16:27 runningz/metric/__init__.pyc
--rw-r--r--  2.0 unx     1818 b- defN 24-May-09 16:27 runningz/metric/get_score_metric.pyc
--rw-r--r--  2.0 unx      883 b- defN 24-May-09 16:27 runningz/metric/ic.pyc
--rw-r--r--  2.0 unx     3441 b- defN 24-May-09 16:27 runningz/metric/metrics.pyc
--rw-r--r--  2.0 unx     3252 b- defN 24-May-09 16:27 runningz/metric/metrics_numba.pyc
--rw-r--r--  2.0 unx      277 b- defN 24-May-09 16:27 runningz/model/__init__.pyc
--rw-r--r--  2.0 unx      147 b- defN 24-May-09 16:27 runningz/model/api.pyc
--rw-r--r--  2.0 unx     3266 b- defN 24-May-09 16:27 runningz/model/base.pyc
--rw-r--r--  2.0 unx     1874 b- defN 24-May-09 16:27 runningz/model/lgb.pyc
--rw-r--r--  2.0 unx     1629 b- defN 24-May-09 16:27 runningz/model/test_lgb.pyc
--rw-r--r--  2.0 unx     6063 b- defN 24-May-09 16:27 runningz/model/test_model_all.pyc
--rw-r--r--  2.0 unx      444 b- defN 24-May-09 16:27 runningz/model/imp/__init__.pyc
--rw-r--r--  2.0 unx     2330 b- defN 24-May-09 16:27 runningz/model/imp/adv.pyc
--rw-r--r--  2.0 unx     1017 b- defN 24-May-09 16:27 runningz/model/imp/fit.pyc
--rw-r--r--  2.0 unx     2148 b- defN 24-May-09 16:27 runningz/model/imp/lars.pyc
--rw-r--r--  2.0 unx     1288 b- defN 24-May-09 16:27 runningz/model/imp/pfi.pyc
--rw-r--r--  2.0 unx      303 b- defN 24-May-09 16:27 runningz/model/imp/pti.pyc
--rw-r--r--  2.0 unx     1473 b- defN 24-May-09 16:27 runningz/model/imp/util.pyc
--rw-r--r--  2.0 unx      281 b- defN 24-May-09 16:27 runningz/model/linear/__init__.pyc
--rw-r--r--  2.0 unx     3135 b- defN 24-May-09 16:27 runningz/model/linear/model_l2.pyc
--rw-r--r--  2.0 unx     3931 b- defN 24-May-09 16:27 runningz/model/linear/model_lr.pyc
--rw-r--r--  2.0 unx     3245 b- defN 24-May-09 16:27 runningz/model/linear/model_sgd.pyc
--rw-r--r--  2.0 unx      197 b- defN 24-May-09 16:27 runningz/model/nn/__init__.pyc
--rw-r--r--  2.0 unx      156 b- defN 24-May-09 16:27 runningz/model/nn/model_cnn.pyc
--rw-r--r--  2.0 unx      162 b- defN 24-May-09 16:27 runningz/model/nn/model_deep_wide.pyc
--rw-r--r--  2.0 unx      157 b- defN 24-May-09 16:27 runningz/model/nn/model_lstm.pyc
--rw-r--r--  2.0 unx     6022 b- defN 24-May-09 16:27 runningz/model/nn/model_mlp.pyc
--rw-r--r--  2.0 unx    11745 b- defN 24-May-09 16:27 runningz/model/nn/model_mlp_py.pyc
--rw-r--r--  2.0 unx      156 b- defN 24-May-09 16:27 runningz/model/nn/model_moe.pyc
--rw-r--r--  2.0 unx     4888 b- defN 24-May-09 16:27 runningz/model/nn/model_rxnet.pyc
--rw-r--r--  2.0 unx      159 b- defN 24-May-09 16:27 runningz/model/nn/model_tabnet.pyc
--rw-r--r--  2.0 unx    14568 b- defN 24-May-09 16:27 runningz/model/nn/nn_util.pyc
--rw-r--r--  2.0 unx    16916 b- defN 24-May-09 16:27 runningz/model/nn/nn_util_py.pyc
--rw-r--r--  2.0 unx      365 b- defN 24-May-09 16:27 runningz/model/tree/__init__.pyc
--rw-r--r--  2.0 unx     4689 b- defN 24-May-09 16:27 runningz/model/tree/model_cat.pyc
--rw-r--r--  2.0 unx     8214 b- defN 24-May-09 16:27 runningz/model/tree/model_cat_py.pyc
--rw-r--r--  2.0 unx     2815 b- defN 24-May-09 16:27 runningz/model/tree/model_erf.pyc
--rw-r--r--  2.0 unx     8323 b- defN 24-May-09 16:27 runningz/model/tree/model_lgb.pyc
--rw-r--r--  2.0 unx    12185 b- defN 24-May-09 16:27 runningz/model/tree/model_lgb_py.pyc
--rw-r--r--  2.0 unx     2829 b- defN 24-May-09 16:27 runningz/model/tree/model_rf.pyc
--rw-r--r--  2.0 unx     3677 b- defN 24-May-09 16:27 runningz/model/tree/model_xgb.pyc
--rw-r--r--  2.0 unx      349 b- defN 24-May-09 16:27 runningz/opt/__init__.pyc
--rw-r--r--  2.0 unx      152 b- defN 24-May-09 16:27 runningz/opt/opt_convex.pyc
--rw-r--r--  2.0 unx    12130 b- defN 24-May-09 16:27 runningz/opt/opt_elo.pyc
--rw-r--r--  2.0 unx     2320 b- defN 24-May-09 16:27 runningz/opt/opt_optuna.pyc
--rw-r--r--  2.0 unx     6914 b- defN 24-May-09 16:27 runningz/opt/opt_random.pyc
--rw-r--r--  2.0 unx     9665 b- defN 24-May-09 16:27 runningz/opt/opt_random_py.pyc
--rw-r--r--  2.0 unx      927 b- defN 24-May-09 16:27 runningz/opt/opt_scipy.pyc
--rw-r--r--  2.0 unx     3556 b- defN 24-May-09 16:27 runningz/opt/opt_sgd.pyc
--rw-r--r--  2.0 unx      150 b- defN 24-May-09 16:27 runningz/res/__init__.pyc
--rw-r--r--  2.0 unx     1180 b- defN 24-May-09 16:27 runningz/res/res_dates.pyc
--rw-r--r--  2.0 unx     1498 b- defN 24-May-09 16:27 runningz/res/res_dates_py.pyc
--rw-r--r--  2.0 unx     1715 b- defN 24-May-09 16:27 runningz/res/res_labels.pyc
--rw-r--r--  2.0 unx     2986 b- defN 24-May-09 16:27 runningz/res/res_labels_py.pyc
--rw-r--r--  2.0 unx    11812 b- defN 24-May-09 16:27 runningz/res/res_main.pyc
--rw-r--r--  2.0 unx    21240 b- defN 24-May-09 16:27 runningz/res/res_main_py.pyc
--rw-r--r--  2.0 unx      299 b- defN 24-May-09 16:27 runningz/res/res_run.pyc
--rw-r--r--  2.0 unx     1037 b- defN 24-May-09 16:27 runningz/res/res_run_py.pyc
--rw-r--r--  2.0 unx      971 b- defN 24-May-09 16:27 runningz/res/res_seeds.pyc
--rw-r--r--  2.0 unx     1183 b- defN 24-May-09 16:27 runningz/res/res_seeds_py.pyc
--rw-r--r--  2.0 unx      157 b- defN 24-May-09 16:27 runningz/res/config/__init__.pyc
--rw-r--r--  2.0 unx     1706 b- defN 24-May-09 16:27 runningz/res/config/res_config.pyc
--rw-r--r--  2.0 unx     3872 b- defN 24-May-09 16:27 runningz/res/config/res_config_py.pyc
--rw-r--r--  2.0 unx      153 b- defN 24-May-09 16:27 runningz/res/er/__init__.pyc
--rw-r--r--  2.0 unx     9935 b- defN 24-May-09 16:27 runningz/res/er/pooler.pyc
--rw-r--r--  2.0 unx    23331 b- defN 24-May-09 16:27 runningz/res/er/pooler_py.pyc
--rw-r--r--  2.0 unx      155 b- defN 24-May-09 16:27 runningz/res/util/__init__.pyc
--rw-r--r--  2.0 unx     2094 b- defN 24-May-09 16:27 runningz/res/util/util.pyc
--rw-r--r--  2.0 unx     2564 b- defN 24-May-09 16:27 runningz/res/util/util_py.pyc
--rw-r--r--  2.0 unx      172 b- defN 24-May-09 16:27 runningz/util/__init__.pyc
--rw-r--r--  2.0 unx     1813 b- defN 24-May-09 16:27 runningz/util/api.pyc
--rw-r--r--  2.0 unx     2062 b- defN 24-May-09 16:27 runningz/util/clss.pyc
--rw-r--r--  2.0 unx    46539 b- defN 24-May-09 16:27 runningz/util/code.pyc
--rw-r--r--  2.0 unx     3426 b- defN 24-May-09 16:27 runningz/util/const.pyc
--rw-r--r--  2.0 unx     4340 b- defN 24-May-09 16:27 runningz/util/const_py.pyc
--rw-r--r--  2.0 unx     1548 b- defN 24-May-09 16:27 runningz/util/csv.pyc
--rw-r--r--  2.0 unx    12208 b- defN 24-May-09 16:27 runningz/util/db.pyc
--rw-r--r--  2.0 unx      469 b- defN 24-May-09 16:27 runningz/util/debug.pyc
--rw-r--r--  2.0 unx     2191 b- defN 24-May-09 16:27 runningz/util/dec.pyc
--rw-r--r--  2.0 unx     9190 b- defN 24-May-09 16:27 runningz/util/dist.pyc
--rw-r--r--  2.0 unx     3599 b- defN 24-May-09 16:27 runningz/util/env.pyc
--rw-r--r--  2.0 unx     2172 b- defN 24-May-09 16:27 runningz/util/login.pyc
--rw-r--r--  2.0 unx     4867 b- defN 24-May-09 16:27 runningz/util/mem.pyc
--rw-r--r--  2.0 unx    19993 b- defN 24-May-09 16:27 runningz/util/npy.pyc
--rw-r--r--  2.0 unx    68010 b- defN 24-May-09 16:27 runningz/util/npy_numba.pyc
--rw-r--r--  2.0 unx    88324 b- defN 24-May-09 16:27 runningz/util/npy_numba_py.pyc
--rw-r--r--  2.0 unx   702066 b- defN 24-May-09 16:27 runningz/util/pool.pyc
--rw-r--r--  2.0 unx     9282 b- defN 24-May-09 16:27 runningz/util/run.pyc
--rw-r--r--  2.0 unx     3974 b- defN 24-May-09 16:27 runningz/util/split.pyc
--rw-r--r--  2.0 unx     5670 b- defN 24-May-09 16:27 runningz/util/test.pyc
--rw-r--r--  2.0 unx     7503 b- defN 24-May-09 16:27 runningz/util/test_py.pyc
--rw-r--r--  2.0 unx    18691 b- defN 24-May-09 16:27 runningz/util/util.pyc
--rw-r--r--  2.0 unx      156 b- defN 24-May-09 16:27 runningz/util/temp/__init__.pyc
--rw-r--r--  2.0 unx     1211 b- defN 24-May-09 16:27 runningz/util/temp/main.pyc
--rw-r--r--  2.0 unx      510 b- defN 24-May-09 16:27 runningz-0.16.1.dist-info/METADATA
--rw-r--r--  2.0 unx       82 b- defN 24-May-09 16:27 runningz-0.16.1.dist-info/WHEEL
--rw-r--r--  2.0 unx       52 b- defN 24-May-09 16:27 runningz-0.16.1.dist-info/entry_points.txt
--rw-r--r--  2.0 unx        9 b- defN 24-May-09 16:27 runningz-0.16.1.dist-info/top_level.txt
--rw-rw-r--  2.0 unx    14477 b- defN 24-May-09 16:27 runningz-0.16.1.dist-info/RECORD
-170 files, 1978905 bytes uncompressed, 462870 bytes compressed:  76.6%
+Zip file size: 486127 bytes, number of entries: 170
+-rw-r--r--  2.0 unx      196 b- defN 24-May-22 15:43 runningz/.gitignore
+-rw-r--r--  2.0 unx     1299 b- defN 24-May-22 15:43 runningz/__init__.pyc
+-rw-r--r--  2.0 unx      186 b- defN 24-May-22 15:43 runningz/api.pyc
+-rw-r--r--  2.0 unx    18311 b- defN 24-May-22 15:43 runningz/core/DataMaster.pyc
+-rw-r--r--  2.0 unx      151 b- defN 24-May-22 15:43 runningz/core/__init__.pyc
+-rw-r--r--  2.0 unx     3856 b- defN 24-May-22 15:43 runningz/core/api.pyc
+-rw-r--r--  2.0 unx      154 b- defN 24-May-22 15:43 runningz/core/er/__init__.pyc
+-rw-r--r--  2.0 unx      572 b- defN 24-May-22 15:43 runningz/core/er/hasher.pyc
+-rw-r--r--  2.0 unx      651 b- defN 24-May-22 15:43 runningz/core/er/idxer.pyc
+-rw-r--r--  2.0 unx      573 b- defN 24-May-22 15:43 runningz/core/er/masker.pyc
+-rw-r--r--  2.0 unx     9357 b- defN 24-May-22 15:43 runningz/core/er/namer.pyc
+-rw-r--r--  2.0 unx      550 b- defN 24-May-22 15:43 runningz/core/er/scaler.pyc
+-rw-r--r--  2.0 unx     7484 b- defN 24-May-22 15:43 runningz/core/op/OPMaster.pyc
+-rw-r--r--  2.0 unx    15662 b- defN 24-May-22 15:43 runningz/core/op/OPMaster_py.pyc
+-rw-r--r--  2.0 unx     6671 b- defN 24-May-22 15:43 runningz/core/op/__init__.pyc
+-rw-r--r--  2.0 unx     7346 b- defN 24-May-22 15:43 runningz/core/op/__init___py.pyc
+-rw-r--r--  2.0 unx    11402 b- defN 24-May-22 15:43 runningz/core/op/_numba.pyc
+-rw-r--r--  2.0 unx    24115 b- defN 24-May-22 15:43 runningz/core/op/_numba_1.pyc
+-rw-r--r--  2.0 unx    27784 b- defN 24-May-22 15:43 runningz/core/op/_numba_2.pyc
+-rw-r--r--  2.0 unx    17533 b- defN 24-May-22 15:43 runningz/core/op/_numba_2_2.pyc
+-rw-r--r--  2.0 unx     6742 b- defN 24-May-22 15:43 runningz/core/op/_numba_merge_roll.pyc
+-rw-r--r--  2.0 unx     9392 b- defN 24-May-22 15:43 runningz/core/op/op_1.pyc
+-rw-r--r--  2.0 unx    13877 b- defN 24-May-22 15:43 runningz/core/op/op_1_numba.pyc
+-rw-r--r--  2.0 unx     2558 b- defN 24-May-22 15:43 runningz/core/op/op_1_numba_old.pyc
+-rw-r--r--  2.0 unx    26907 b- defN 24-May-22 15:43 runningz/core/op/op_2.pyc
+-rw-r--r--  2.0 unx    34643 b- defN 24-May-22 15:43 runningz/core/op/op_2_numba.pyc
+-rw-r--r--  2.0 unx     5608 b- defN 24-May-22 15:43 runningz/core/op/op_3.pyc
+-rw-r--r--  2.0 unx     7119 b- defN 24-May-22 15:43 runningz/core/op/op_3_numba.pyc
+-rw-r--r--  2.0 unx     3788 b- defN 24-May-22 15:43 runningz/core/op/op_groupby.pyc
+-rw-r--r--  2.0 unx     3575 b- defN 24-May-22 15:43 runningz/core/op/op_m.pyc
+-rw-r--r--  2.0 unx     5128 b- defN 24-May-22 15:43 runningz/core/op/op_m_numba.pyc
+-rw-r--r--  2.0 unx     8705 b- defN 24-May-22 15:43 runningz/core/op/op_other.pyc
+-rw-r--r--  2.0 unx       15 b- defN 24-May-22 15:43 runningz/fe/.gitignore
+-rw-r--r--  2.0 unx    14548 b- defN 24-May-22 15:43 runningz/fe/FEMaster.pyc
+-rw-r--r--  2.0 unx    23960 b- defN 24-May-22 15:43 runningz/fe/FEMaster_py.pyc
+-rw-r--r--  2.0 unx      178 b- defN 24-May-22 15:43 runningz/fe/__init__.pyc
+-rw-r--r--  2.0 unx     2487 b- defN 24-May-22 15:43 runningz/fe/fe_dump.pyc
+-rw-r--r--  2.0 unx     3708 b- defN 24-May-22 15:43 runningz/fe/fe_dump_py.pyc
+-rw-r--r--  2.0 unx     4370 b- defN 24-May-22 15:43 runningz/fe/fe_eval.pyc
+-rw-r--r--  2.0 unx     7171 b- defN 24-May-22 15:43 runningz/fe/fe_eval_py.pyc
+-rw-r--r--  2.0 unx     4850 b- defN 24-May-22 15:43 runningz/fe/fe_main.pyc
+-rw-r--r--  2.0 unx     8473 b- defN 24-May-22 15:43 runningz/fe/fe_main_py.pyc
+-rw-r--r--  2.0 unx      156 b- defN 24-May-22 15:43 runningz/fe/config/__init__.pyc
+-rw-r--r--  2.0 unx    11438 b- defN 24-May-22 15:43 runningz/fe/config/cols_dict.pyc
+-rw-r--r--  2.0 unx    74158 b- defN 24-May-22 15:43 runningz/fe/config/cols_fea.pyc
+-rw-r--r--  2.0 unx     1274 b- defN 24-May-22 15:43 runningz/fe/config/fm_config.pyc
+-rw-r--r--  2.0 unx     1919 b- defN 24-May-22 15:43 runningz/fe/config/fm_config_opt.pyc
+-rw-r--r--  2.0 unx     5184 b- defN 24-May-22 15:43 runningz/fe/config/fm_config_opt_py.pyc
+-rw-r--r--  2.0 unx     5988 b- defN 24-May-22 15:43 runningz/fe/config/fm_config_py.pyc
+-rw-r--r--  2.0 unx     5793 b- defN 24-May-22 15:43 runningz/fe/config/fm_config_top.pyc
+-rw-r--r--  2.0 unx    19957 b- defN 24-May-22 15:43 runningz/fe/config/fm_config_top_py.pyc
+-rw-r--r--  2.0 unx      298 b- defN 24-May-22 15:43 runningz/fe/er/__init__.pyc
+-rw-r--r--  2.0 unx     3039 b- defN 24-May-22 15:43 runningz/fe/er/pather.pyc
+-rw-r--r--  2.0 unx    17161 b- defN 24-May-22 15:43 runningz/fe/er/pooler.pyc
+-rw-r--r--  2.0 unx    17241 b- defN 24-May-22 15:43 runningz/fe/er/pooler_old.pyc
+-rw-r--r--  2.0 unx    38247 b- defN 24-May-22 15:43 runningz/fe/er/pooler_py.pyc
+-rw-r--r--  2.0 unx     8018 b- defN 24-May-22 15:43 runningz/fe/er/ranker.pyc
+-rw-r--r--  2.0 unx    12370 b- defN 24-May-22 15:43 runningz/fe/er/ranker_py.pyc
+-rw-r--r--  2.0 unx     5561 b- defN 24-May-22 15:43 runningz/fe/er/typer.pyc
+-rw-r--r--  2.0 unx      162 b- defN 24-May-22 15:43 runningz/fe/prepare_data/__init__.pyc
+-rw-r--r--  2.0 unx    13167 b- defN 24-May-22 15:43 runningz/fe/prepare_data/base_data.pyc
+-rw-r--r--  2.0 unx    20141 b- defN 24-May-22 15:43 runningz/fe/prepare_data/base_data_py.pyc
+-rw-r--r--  2.0 unx     1543 b- defN 24-May-22 15:43 runningz/fe/prepare_data/basic_data.pyc
+-rw-r--r--  2.0 unx     2745 b- defN 24-May-22 15:43 runningz/fe/prepare_data/basic_data_py.pyc
+-rw-r--r--  2.0 unx     8426 b- defN 24-May-22 15:43 runningz/fe/prepare_data/factor_data.pyc
+-rw-r--r--  2.0 unx      193 b- defN 24-May-22 15:43 runningz/fe/status/__init__.pyc
+-rw-r--r--  2.0 unx    10623 b- defN 24-May-22 15:43 runningz/fe/status/status.pyc
+-rw-r--r--  2.0 unx    16648 b- defN 24-May-22 15:43 runningz/fe/status/status_py.pyc
+-rw-r--r--  2.0 unx      154 b- defN 24-May-22 15:43 runningz/fe/util/__init__.pyc
+-rw-r--r--  2.0 unx    11846 b- defN 24-May-22 15:43 runningz/fe/util/util.pyc
+-rw-r--r--  2.0 unx    14775 b- defN 24-May-22 15:43 runningz/fe/util/util_py.pyc
+-rw-r--r--  2.0 unx      294 b- defN 24-May-22 15:43 runningz/metric/__init__.pyc
+-rw-r--r--  2.0 unx     1818 b- defN 24-May-22 15:43 runningz/metric/get_score_metric.pyc
+-rw-r--r--  2.0 unx      883 b- defN 24-May-22 15:43 runningz/metric/ic.pyc
+-rw-r--r--  2.0 unx     3441 b- defN 24-May-22 15:43 runningz/metric/metrics.pyc
+-rw-r--r--  2.0 unx     3252 b- defN 24-May-22 15:43 runningz/metric/metrics_numba.pyc
+-rw-r--r--  2.0 unx      277 b- defN 24-May-22 15:43 runningz/model/__init__.pyc
+-rw-r--r--  2.0 unx      147 b- defN 24-May-22 15:43 runningz/model/api.pyc
+-rw-r--r--  2.0 unx     3266 b- defN 24-May-22 15:43 runningz/model/base.pyc
+-rw-r--r--  2.0 unx     1874 b- defN 24-May-22 15:43 runningz/model/lgb.pyc
+-rw-r--r--  2.0 unx     1629 b- defN 24-May-22 15:43 runningz/model/test_lgb.pyc
+-rw-r--r--  2.0 unx     6063 b- defN 24-May-22 15:43 runningz/model/test_model_all.pyc
+-rw-r--r--  2.0 unx      444 b- defN 24-May-22 15:43 runningz/model/imp/__init__.pyc
+-rw-r--r--  2.0 unx     2330 b- defN 24-May-22 15:43 runningz/model/imp/adv.pyc
+-rw-r--r--  2.0 unx     1017 b- defN 24-May-22 15:43 runningz/model/imp/fit.pyc
+-rw-r--r--  2.0 unx     2148 b- defN 24-May-22 15:43 runningz/model/imp/lars.pyc
+-rw-r--r--  2.0 unx     1288 b- defN 24-May-22 15:43 runningz/model/imp/pfi.pyc
+-rw-r--r--  2.0 unx      303 b- defN 24-May-22 15:43 runningz/model/imp/pti.pyc
+-rw-r--r--  2.0 unx     1473 b- defN 24-May-22 15:43 runningz/model/imp/util.pyc
+-rw-r--r--  2.0 unx      281 b- defN 24-May-22 15:43 runningz/model/linear/__init__.pyc
+-rw-r--r--  2.0 unx     3135 b- defN 24-May-22 15:43 runningz/model/linear/model_l2.pyc
+-rw-r--r--  2.0 unx     3931 b- defN 24-May-22 15:43 runningz/model/linear/model_lr.pyc
+-rw-r--r--  2.0 unx     3245 b- defN 24-May-22 15:43 runningz/model/linear/model_sgd.pyc
+-rw-r--r--  2.0 unx      197 b- defN 24-May-22 15:43 runningz/model/nn/__init__.pyc
+-rw-r--r--  2.0 unx      156 b- defN 24-May-22 15:43 runningz/model/nn/model_cnn.pyc
+-rw-r--r--  2.0 unx      162 b- defN 24-May-22 15:43 runningz/model/nn/model_deep_wide.pyc
+-rw-r--r--  2.0 unx      157 b- defN 24-May-22 15:43 runningz/model/nn/model_lstm.pyc
+-rw-r--r--  2.0 unx     6022 b- defN 24-May-22 15:43 runningz/model/nn/model_mlp.pyc
+-rw-r--r--  2.0 unx    11745 b- defN 24-May-22 15:43 runningz/model/nn/model_mlp_py.pyc
+-rw-r--r--  2.0 unx      156 b- defN 24-May-22 15:43 runningz/model/nn/model_moe.pyc
+-rw-r--r--  2.0 unx     4888 b- defN 24-May-22 15:43 runningz/model/nn/model_rxnet.pyc
+-rw-r--r--  2.0 unx      159 b- defN 24-May-22 15:43 runningz/model/nn/model_tabnet.pyc
+-rw-r--r--  2.0 unx    14568 b- defN 24-May-22 15:43 runningz/model/nn/nn_util.pyc
+-rw-r--r--  2.0 unx    16916 b- defN 24-May-22 15:43 runningz/model/nn/nn_util_py.pyc
+-rw-r--r--  2.0 unx      365 b- defN 24-May-22 15:43 runningz/model/tree/__init__.pyc
+-rw-r--r--  2.0 unx     4689 b- defN 24-May-22 15:43 runningz/model/tree/model_cat.pyc
+-rw-r--r--  2.0 unx     8214 b- defN 24-May-22 15:43 runningz/model/tree/model_cat_py.pyc
+-rw-r--r--  2.0 unx     2815 b- defN 24-May-22 15:43 runningz/model/tree/model_erf.pyc
+-rw-r--r--  2.0 unx     8323 b- defN 24-May-22 15:43 runningz/model/tree/model_lgb.pyc
+-rw-r--r--  2.0 unx    12185 b- defN 24-May-22 15:43 runningz/model/tree/model_lgb_py.pyc
+-rw-r--r--  2.0 unx     2829 b- defN 24-May-22 15:43 runningz/model/tree/model_rf.pyc
+-rw-r--r--  2.0 unx     3677 b- defN 24-May-22 15:43 runningz/model/tree/model_xgb.pyc
+-rw-r--r--  2.0 unx      349 b- defN 24-May-22 15:43 runningz/opt/__init__.pyc
+-rw-r--r--  2.0 unx      152 b- defN 24-May-22 15:43 runningz/opt/opt_convex.pyc
+-rw-r--r--  2.0 unx    12130 b- defN 24-May-22 15:43 runningz/opt/opt_elo.pyc
+-rw-r--r--  2.0 unx     2320 b- defN 24-May-22 15:43 runningz/opt/opt_optuna.pyc
+-rw-r--r--  2.0 unx     6914 b- defN 24-May-22 15:43 runningz/opt/opt_random.pyc
+-rw-r--r--  2.0 unx     9665 b- defN 24-May-22 15:43 runningz/opt/opt_random_py.pyc
+-rw-r--r--  2.0 unx      927 b- defN 24-May-22 15:43 runningz/opt/opt_scipy.pyc
+-rw-r--r--  2.0 unx     3556 b- defN 24-May-22 15:43 runningz/opt/opt_sgd.pyc
+-rw-r--r--  2.0 unx      150 b- defN 24-May-22 15:43 runningz/res/__init__.pyc
+-rw-r--r--  2.0 unx     1180 b- defN 24-May-22 15:43 runningz/res/res_dates.pyc
+-rw-r--r--  2.0 unx     1498 b- defN 24-May-22 15:43 runningz/res/res_dates_py.pyc
+-rw-r--r--  2.0 unx     1715 b- defN 24-May-22 15:43 runningz/res/res_labels.pyc
+-rw-r--r--  2.0 unx     2986 b- defN 24-May-22 15:43 runningz/res/res_labels_py.pyc
+-rw-r--r--  2.0 unx    11812 b- defN 24-May-22 15:43 runningz/res/res_main.pyc
+-rw-r--r--  2.0 unx    21288 b- defN 24-May-22 15:43 runningz/res/res_main_py.pyc
+-rw-r--r--  2.0 unx      301 b- defN 24-May-22 15:43 runningz/res/res_run.pyc
+-rw-r--r--  2.0 unx     1993 b- defN 24-May-22 15:43 runningz/res/res_run_py.pyc
+-rw-r--r--  2.0 unx      971 b- defN 24-May-22 15:43 runningz/res/res_seeds.pyc
+-rw-r--r--  2.0 unx     1183 b- defN 24-May-22 15:43 runningz/res/res_seeds_py.pyc
+-rw-r--r--  2.0 unx      157 b- defN 24-May-22 15:43 runningz/res/config/__init__.pyc
+-rw-r--r--  2.0 unx     1706 b- defN 24-May-22 15:43 runningz/res/config/res_config.pyc
+-rw-r--r--  2.0 unx     3872 b- defN 24-May-22 15:43 runningz/res/config/res_config_py.pyc
+-rw-r--r--  2.0 unx      153 b- defN 24-May-22 15:43 runningz/res/er/__init__.pyc
+-rw-r--r--  2.0 unx     9935 b- defN 24-May-22 15:43 runningz/res/er/pooler.pyc
+-rw-r--r--  2.0 unx    23331 b- defN 24-May-22 15:43 runningz/res/er/pooler_py.pyc
+-rw-r--r--  2.0 unx      155 b- defN 24-May-22 15:43 runningz/res/util/__init__.pyc
+-rw-r--r--  2.0 unx     2094 b- defN 24-May-22 15:43 runningz/res/util/util.pyc
+-rw-r--r--  2.0 unx     2564 b- defN 24-May-22 15:43 runningz/res/util/util_py.pyc
+-rw-r--r--  2.0 unx      172 b- defN 24-May-22 15:43 runningz/util/__init__.pyc
+-rw-r--r--  2.0 unx     1813 b- defN 24-May-22 15:43 runningz/util/api.pyc
+-rw-r--r--  2.0 unx     2062 b- defN 24-May-22 15:43 runningz/util/clss.pyc
+-rw-r--r--  2.0 unx    46539 b- defN 24-May-22 15:43 runningz/util/code.pyc
+-rw-r--r--  2.0 unx     3426 b- defN 24-May-22 15:43 runningz/util/const.pyc
+-rw-r--r--  2.0 unx     4340 b- defN 24-May-22 15:43 runningz/util/const_py.pyc
+-rw-r--r--  2.0 unx     1566 b- defN 24-May-22 15:43 runningz/util/csv.pyc
+-rw-r--r--  2.0 unx    12208 b- defN 24-May-22 15:43 runningz/util/db.pyc
+-rw-r--r--  2.0 unx      469 b- defN 24-May-22 15:43 runningz/util/debug.pyc
+-rw-r--r--  2.0 unx     2191 b- defN 24-May-22 15:43 runningz/util/dec.pyc
+-rw-r--r--  2.0 unx     9190 b- defN 24-May-22 15:43 runningz/util/dist.pyc
+-rw-r--r--  2.0 unx     3599 b- defN 24-May-22 15:43 runningz/util/env.pyc
+-rw-r--r--  2.0 unx     2172 b- defN 24-May-22 15:43 runningz/util/login.pyc
+-rw-r--r--  2.0 unx     4867 b- defN 24-May-22 15:43 runningz/util/mem.pyc
+-rw-r--r--  2.0 unx    19993 b- defN 24-May-22 15:43 runningz/util/npy.pyc
+-rw-r--r--  2.0 unx    68010 b- defN 24-May-22 15:43 runningz/util/npy_numba.pyc
+-rw-r--r--  2.0 unx    88324 b- defN 24-May-22 15:43 runningz/util/npy_numba_py.pyc
+-rw-r--r--  2.0 unx   702066 b- defN 24-May-22 15:43 runningz/util/pool.pyc
+-rw-r--r--  2.0 unx     9282 b- defN 24-May-22 15:43 runningz/util/run.pyc
+-rw-r--r--  2.0 unx     3974 b- defN 24-May-22 15:43 runningz/util/split.pyc
+-rw-r--r--  2.0 unx     5670 b- defN 24-May-22 15:43 runningz/util/test.pyc
+-rw-r--r--  2.0 unx     7503 b- defN 24-May-22 15:43 runningz/util/test_py.pyc
+-rw-r--r--  2.0 unx    18691 b- defN 24-May-22 15:43 runningz/util/util.pyc
+-rw-r--r--  2.0 unx      156 b- defN 24-May-22 15:43 runningz/util/temp/__init__.pyc
+-rw-r--r--  2.0 unx     1211 b- defN 24-May-22 15:43 runningz/util/temp/main.pyc
+-rw-r--r--  2.0 unx      510 b- defN 24-May-22 15:43 runningz-0.16.2.dist-info/METADATA
+-rw-r--r--  2.0 unx       82 b- defN 24-May-22 15:43 runningz-0.16.2.dist-info/WHEEL
+-rw-r--r--  2.0 unx       52 b- defN 24-May-22 15:43 runningz-0.16.2.dist-info/entry_points.txt
+-rw-r--r--  2.0 unx        9 b- defN 24-May-22 15:43 runningz-0.16.2.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx    14477 b- defN 24-May-22 15:43 runningz-0.16.2.dist-info/RECORD
+170 files, 1980323 bytes uncompressed, 463483 bytes compressed:  76.6%
```

## zipnote {}

```diff
@@ -489,23 +489,23 @@
 
 Filename: runningz/util/temp/__init__.pyc
 Comment: 
 
 Filename: runningz/util/temp/main.pyc
 Comment: 
 
-Filename: runningz-0.16.1.dist-info/METADATA
+Filename: runningz-0.16.2.dist-info/METADATA
 Comment: 
 
-Filename: runningz-0.16.1.dist-info/WHEEL
+Filename: runningz-0.16.2.dist-info/WHEEL
 Comment: 
 
-Filename: runningz-0.16.1.dist-info/entry_points.txt
+Filename: runningz-0.16.2.dist-info/entry_points.txt
 Comment: 
 
-Filename: runningz-0.16.1.dist-info/top_level.txt
+Filename: runningz-0.16.2.dist-info/top_level.txt
 Comment: 
 
-Filename: runningz-0.16.1.dist-info/RECORD
+Filename: runningz-0.16.2.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## runningz/__init__.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Thu May  9 16:27:28 2024 UTC, .py size: 1326 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,22 +1,22 @@
-00000000: 610d 0d0a 0000 0000 70f9 3c66 2e05 0000  a.......p.<f....
+00000000: 610d 0d0a 0000 0000 7f12 4e66 2e05 0000  a.........Nf....
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0004 0000 0040 0000 0073 b200 0000 6400  .....@...s....d.
 00000030: 5a00 6401 5a01 6402 5a02 6403 6404 6c03  Z.d.Z.d.Z.d.d.l.
 00000040: 5a03 6503 6a04 a005 6405 a101 0100 6503  Z.e.j...d.....e.
 00000050: 6a04 a005 6406 a101 0100 6503 6a04 a005  j...d.....e.j...
 00000060: 6407 a101 0100 6403 6404 6c06 5a06 6408  d.....d.d.l.Z.d.
 00000070: 6506 6a07 6409 3c00 640a 640b 6c08 6d09  e.j.d.<.d.d.l.m.
 00000080: 5a09 6d0a 5a0a 6d0b 5a0b 6d0c 5a0c 0100  Z.m.Z.m.Z.m.Z...
 00000090: 640a 640c 6c0d 5400 640a 640d 6c0e 6d0f  d.d.l.T.d.d.l.m.
 000000a0: 5a0f 0100 640a 640e 6c0e 6d10 5a10 0100  Z...d.d.l.m.Z...
 000000b0: 640a 640f 6c0e 6d11 5a11 0100 6509 6506  d.d.l.m.Z...e.e.
 000000c0: 6a07 a012 6410 a101 8301 0100 6403 6404  j...d.......d.d.
 000000d0: 6c03 5a03 6411 6412 8400 5a13 6404 5300  l.Z.d.d...Z.d.S.
-000000e0: 2913 7a06 302e 3136 2e31 da08 7275 6e6e  ).z.0.16.1..runn
+000000e0: 2913 7a06 302e 3136 2e32 da08 7275 6e6e  ).z.0.16.2..runn
 000000f0: 696e 677a 5a07 5632 4c41 4245 4ce9 0000  ingzZ.V2LABEL...
 00000100: 0000 4e7a 022e 2f7a 032e 2e2f 7a06 2e2e  ..Nz../z.../z...
 00000110: 2f2e 2e2f da03 6f66 665a 0c4b 4d50 5f57  /../..offZ.KMP_W
 00000120: 4152 4e49 4e47 53e9 0100 0000 2904 da0e  ARNINGS.....)...
 00000130: 6973 5f76 616c 6964 5f74 6f6b 656e da0a  is_valid_token..
 00000140: 4461 7461 4d61 7374 6572 da08 4f50 4d61  DataMaster..OPMa
 00000150: 7374 6572 da04 494e 464f 2901 da01 2a29  ster..INFO)...*)
```

## runningz/core/op/OPMaster_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Thu May  9 16:27:50 2024 UTC, .py size: 15403 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 86f9 3c66 2b3c 0000  a.........<f+<..
+00000000: 610d 0d0a 0000 0000 8512 4e66 2b3c 0000  a.........Nf+<..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
```

## runningz/core/op/__init___py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Thu May  9 16:27:50 2024 UTC, .py size: 7091 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 86f9 3c66 b31b 0000  a.........<f....
+00000000: 610d 0d0a 0000 0000 8512 4e66 b31b 0000  a.........Nf....
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
```

## runningz/fe/FEMaster_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Thu May  9 16:27:50 2024 UTC, .py size: 23702 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 86f9 3c66 965c 0000  a.........<f.\..
+00000000: 610d 0d0a 0000 0000 8512 4e66 965c 0000  a.........Nf.\..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
```

## runningz/fe/fe_dump_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Thu May  9 16:27:50 2024 UTC, .py size: 3463 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 86f9 3c66 870d 0000  a.........<f....
+00000000: 610d 0d0a 0000 0000 8512 4e66 870d 0000  a.........Nf....
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
```

## runningz/fe/fe_eval_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Thu May  9 16:27:50 2024 UTC, .py size: 6922 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 86f9 3c66 0a1b 0000  a.........<f....
+00000000: 610d 0d0a 0000 0000 8512 4e66 0a1b 0000  a.........Nf....
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
```

## runningz/fe/fe_main_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Thu May  9 16:27:50 2024 UTC, .py size: 8224 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 86f9 3c66 2020 0000  a.........<f  ..
+00000000: 610d 0d0a 0000 0000 8512 4e66 2020 0000  a.........Nf  ..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
```

## runningz/fe/config/fm_config_opt_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Thu May  9 16:27:50 2024 UTC, .py size: 4926 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 86f9 3c66 3e13 0000  a.........<f>...
+00000000: 610d 0d0a 0000 0000 8512 4e66 3e13 0000  a.........Nf>...
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
```

## runningz/fe/config/fm_config_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Thu May  9 16:27:50 2024 UTC, .py size: 5734 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 86f9 3c66 6616 0000  a.........<ff...
+00000000: 610d 0d0a 0000 0000 8512 4e66 6616 0000  a.........Nff...
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
```

## runningz/fe/config/fm_config_top_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Thu May  9 16:27:50 2024 UTC, .py size: 19685 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 86f9 3c66 e54c 0000  a.........<f.L..
+00000000: 610d 0d0a 0000 0000 8512 4e66 e54c 0000  a.........Nf.L..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
```

## runningz/fe/er/pooler_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Thu May  9 16:27:50 2024 UTC, .py size: 37980 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 86f9 3c66 5c94 0000  a.........<f\...
+00000000: 610d 0d0a 0000 0000 8512 4e66 5c94 0000  a.........Nf\...
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
```

## runningz/fe/er/ranker_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Thu May  9 16:27:50 2024 UTC, .py size: 12115 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 86f9 3c66 532f 0000  a.........<fS/..
+00000000: 610d 0d0a 0000 0000 8512 4e66 532f 0000  a.........NfS/..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
```

## runningz/fe/prepare_data/base_data.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Wed May  8 15:45:53 2024 UTC, .py size: 19288 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,21 +1,21 @@
-00000000: 610d 0d0a 0000 0000 319e 3b66 584b 0000  a.......1.;fXK..
+00000000: 610d 0d0a 0000 0000 f30f 4e66 f84b 0000  a.........Nf.K..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0003 0000 0040 0000 0073 ca00 0000 6400  .....@...s....d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a02 6400  d.l.Z.d.d.l.Z.d.
 00000040: 6401 6c03 5a04 6400 6401 6c05 5a06 6402  d.l.Z.d.d.l.Z.d.
 00000050: 6403 6c07 6d08 5a08 0100 6402 6404 6c09  d.l.m.Z...d.d.l.
 00000060: 6d0a 5a0a 6d0b 5a0b 6d0c 5a0c 0100 6402  m.Z.m.Z.m.Z...d.
 00000070: 6405 6c0d 6d0e 5a0e 0100 6402 6406 6c0f  d.l.m.Z...d.d.l.
 00000080: 6d10 5a10 6d11 5a11 0100 6402 6407 6c12  m.Z.m.Z...d.d.l.
 00000090: 6d13 5a13 0100 6514 5a15 6408 6409 8400  m.Z...e.Z.d.d...
 000000a0: 5a14 6402 640a 6c16 6d17 5a17 0100 6402  Z.d.d.l.m.Z...d.
 000000b0: 640b 6c09 6d18 5a14 0100 640c 640d 8400  d.l.m.Z...d.d...
-000000c0: 5a19 640e 640f 8400 5a1a 641a 6411 6412  Z.d.d...Z.d.d.d.
-000000d0: 8401 5a1b 6413 6414 8400 5a1c 641b 6416  ..Z.d.d...Z.d.d.
+000000c0: 5a19 640e 640f 8400 5a1a 641a 6412 6413  Z.d.d...Z.d.d.d.
+000000d0: 8401 5a1b 6414 6415 8400 5a1c 641b 6416  ..Z.d.d...Z.d.d.
 000000e0: 6417 8401 5a1d 4700 6418 6419 8400 6419  d...Z.G.d.d...d.
 000000f0: 8302 5a1e 6401 5300 291c e900 0000 004e  ..Z.d.S.)......N
 00000100: e903 0000 0029 01da 0a44 6174 614d 6173  .....)...DataMas
 00000110: 7465 7229 03da 066c 6f67 6765 72da 056d  ter)...logger..m
 00000120: 6572 6765 da0d 636f 6465 5f32 5f6d 6172  erge..code_2_mar
 00000130: 6b65 7429 01da 0d67 6574 5f64 665f 6964  ket)...get_df_id
 00000140: 5f61 6c6c 2902 da0c 6e70 5f73 6869 6674  _all)...np_shift
@@ -74,746 +74,750 @@
 00000490: 7320 3d20 2903 da03 6c65 6eda 0666 6f72  s = )...len..for
 000004a0: 6d61 74da 0e52 6563 7572 7369 6f6e 4572  mat..RecursionEr
 000004b0: 726f 7229 01da 0e63 6f6c 5f6c 6162 656c  ror)...col_label
 000004c0: 5f61 7267 7372 1300 0000 7213 0000 0072  _argsr....r....r
 000004d0: 1400 0000 da15 636f 6c5f 6c61 6265 6c5f  ......col_label_
 000004e0: 6172 6773 5f32 5f6e 616d 6518 0000 0073  args_2_name....s
 000004f0: 0a00 0000 0001 0c01 0a01 0c01 0a02 722e  ..............r.
-00000500: 0000 00da 0063 0600 0000 0000 0000 0000  .....c..........
-00000510: 0000 2600 0000 0900 0000 0300 0000 7322  ..&...........s"
-00000520: 0300 007c 017c 0267 0289 0087 0166 0164  ...|.|.g.....f.d
-00000530: 0164 0284 0888 0044 0083 017d 0664 0364  .d.....D...}.d.d
-00000540: 0284 007c 0644 0083 017d 0774 007c 0688  ...|.D...}.t.|..
-00000550: 0064 048d 027d 087c 08a0 0188 0188 0019  .d...}.|........
-00000560: 006a 02a0 03a1 00a1 017d 0874 04a0 057c  .j.......}.t...|
-00000570: 08a1 017d 0974 04a0 0588 0188 007c 0317  ...}.t.......|..
-00000580: 0064 0567 0117 0019 00a1 017d 0a7c 096a  .d.g.......}.|.j
-00000590: 067c 0a88 0064 0664 078d 037d 0b7c 0988  .|...d.d...}.|..
-000005a0: 0019 007d 0c74 07a0 087c 0b64 0519 00a0  ...}.t...|.d....
-000005b0: 09a1 00a0 0a7c 07a1 01a1 017d 0d7c 0444  .....|.....}.|.D
-000005c0: 0090 015d 6e7d 0e74 0b64 087c 0e9b 009d  ...]n}.t.d.|....
-000005d0: 0283 0101 0074 0c7c 0e83 0164 096b 0272  .....t.|...d.k.r
-000005e0: e67c 0e5c 037d 0f7d 107d 1174 07a0 087c  .|.\.}.}.}.t...|
-000005f0: 0b7c 0f19 00a0 09a1 00a0 0a7c 07a1 01a1  .|.........|....
-00000600: 017d 127c 127d 136e 3c7c 0e5c 047d 0f7d  .}.|.}.n<|.\.}.}
-00000610: 107d 117d 1474 07a0 087c 0b7c 0f19 00a0  .}.}.t...|.|....
-00000620: 09a1 00a0 0a7c 07a1 01a1 017d 1274 07a0  .....|.....}.t..
-00000630: 087c 0b7c 1419 00a0 09a1 00a0 0a7c 07a1  .|.|.........|..
-00000640: 01a1 017d 1374 0d7c 1083 0174 0d7c 1183  ...}.t.|...t.|..
-00000650: 0102 007d 107d 1174 0e7c 0d64 0a74 0f7c  ...}.}.t.|.d.t.|
-00000660: 107c 1183 0214 0083 027d 1564 0b7c 1574  .|.......}.d.|.t
-00000670: 07a0 107c 15a1 013c 0074 1174 127c 107c  ...|...<.t.t.|.|
-00000680: 1183 0264 0b17 0074 0f7c 107c 1183 0283  ...d...t.|.|....
-00000690: 0244 005d 2a7d 1674 0e7c 0d64 0a7c 1614  .D.]*}.t.|.d.|..
-000006a0: 0083 027d 1764 0b7c 1774 07a0 107c 17a1  ...}.d.|.t...|..
-000006b0: 013c 007c 157c 1714 007d 1590 0171 7064  .<.|.|...}...qpd
-000006c0: 0b7c 1574 07a0 107c 15a1 013c 0074 0e7c  .|.t...|...<.t.|
-000006d0: 1264 0a7c 1014 0083 027d 1874 0e7c 1364  .d.|.....}.t.|.d
-000006e0: 0a7c 1114 0083 027d 197c 157c 1914 007c  .|.....}.|.|...|
-000006f0: 181b 0064 0b18 007d 1a74 076a 137c 1a74  ...d...}.t.j.|.t
-00000700: 07a0 147c 1aa1 010f 003c 0074 157c 0e83  ...|.....<.t.|..
-00000710: 017d 1b7c 0ca0 1674 04a0 177c 1b7c 1aa0  .}.|...t...|.|..
-00000720: 18a1 00a0 0174 076a 19a1 01a1 02a1 017d  .....t.j.......}
-00000730: 0c71 9e7c 0a88 0019 007d 1c7c 1c6a 067c  .q.|.....}.|.j.|
-00000740: 0c88 0064 0664 078d 037d 1d7c 1d7d 1e74  ...d.d...}.|.}.t
-00000750: 0c7c 0583 0164 0c6b 0490 0372 067c 05a0  .|...d.k...r.|..
-00000760: 1a64 0da1 017d 1f7c 1f64 0c19 007c 1f64  .d...}.|.d...|.d
-00000770: 0b64 0085 0219 0002 007d 207d 2164 0e64  .d.......} }!d.d
-00000780: 0284 007c 2144 0083 017d 217c 2064 0f76  ...|!D...}!| d.v
-00000790: 0090 0272 847c 1e7c 2164 0c19 0019 00a0  ...r.|.|!d......
-000007a0: 09a1 007d 226e 707c 2064 1076 0090 0272  ...}"np| d.v...r
-000007b0: a47c 1e7c 2119 00a0 09a1 006a 1b64 0b64  .|.|!......j.d.d
-000007c0: 118d 017d 226e 507c 2064 1276 0090 0272  ...}"nP| d.v...r
-000007d0: e67c 1e7c 2164 0c19 0019 00a0 09a1 007d  .|.|!d.........}
-000007e0: 237c 1e7c 2164 0b19 0019 00a0 09a1 007d  #|.|!d.........}
-000007f0: 2474 07a0 1c7c 237c 2414 0064 0c6b 047c  $t...|#|$..d.k.|
-00000800: 2364 0ca1 037d 226e 0e74 1d64 137c 209b  #d...}"n.t.d.| .
-00000810: 009d 0283 0182 017c 1ea0 1674 04a0 1764  .......|...t...d
-00000820: 147c 22a1 02a1 017d 1e87 0066 0164 1564  .|"....}...f.d.d
-00000830: 0284 087c 1e6a 1e44 0083 017d 257c 1e7c  ...|.j.D...}%|.|
-00000840: 2566 0253 0029 164e 6301 0000 0000 0000  %f.S.).Nc.......
-00000850: 0000 0000 0002 0000 0006 0000 0013 0000  ................
-00000860: 0073 1e00 0000 6700 7c00 5d16 7d01 7400  .s....g.|.].}.t.
-00000870: a001 8800 7c01 1900 a002 a100 a101 9102  ....|...........
-00000880: 7104 5300 7213 0000 0029 03da 026e 70da  q.S.r....)...np.
-00000890: 0473 6f72 74da 0675 6e69 7175 65a9 0272  .sort..unique..r
-000008a0: 1100 0000 da03 636f 6c29 01da 0264 6672  ......col)...dfr
-000008b0: 1300 0000 7214 0000 00da 0a3c 6c69 7374  ....r......<list
-000008c0: 636f 6d70 3e22 0000 0072 1600 0000 7a26  comp>"...r....z&
-000008d0: 6765 745f 6466 5f6c 6162 656c 5f66 696e  get_df_label_fin
-000008e0: 616c 2e3c 6c6f 6361 6c73 3e2e 3c6c 6973  al.<locals>.<lis
-000008f0: 7463 6f6d 703e 6301 0000 0000 0000 0000  tcomp>c.........
-00000900: 0000 0002 0000 0004 0000 0053 0000 0073  ...........S...s
-00000910: 1400 0000 6700 7c00 5d0c 7d01 7400 7c01  ....g.|.].}.t.|.
-00000920: 8301 9102 7104 5300 7213 0000 0029 0172  ....q.S.r....).r
-00000930: 2a00 0000 7210 0000 0072 1300 0000 7213  *...r....r....r.
-00000940: 0000 0072 1400 0000 7236 0000 0023 0000  ...r....r6...#..
-00000950: 0072 1600 0000 a901 da07 636f 6c73 5f69  .r........cols_i
-00000960: 64da 0341 444a da04 6c65 6674 2902 da02  d..ADJ..left)...
-00000970: 6f6e da03 686f 777a 285b 2b5d 2067 6574  on..howz([+] get
-00000980: 5f64 665f 6c61 6265 6c5f 6669 6e61 6c2e  _df_label_final.
-00000990: 636f 6c5f 6c61 6265 6c5f 6172 6773 203d  col_label_args =
-000009a0: 2072 0200 0000 e9ff ffff ff72 2100 0000   r.........r!...
-000009b0: 7201 0000 00da 025f 5f63 0100 0000 0000  r......__c......
-000009c0: 0000 0000 0000 0200 0000 0500 0000 5300  ..............S.
-000009d0: 0000 7318 0000 0067 007c 005d 107d 0174  ..s....g.|.].}.t
-000009e0: 0074 017c 0183 0183 0191 0271 0453 0072  .t.|.......q.S.r
-000009f0: 1300 0000 2902 722e 0000 0072 2800 0000  ....).r....r(...
-00000a00: 7210 0000 0072 1300 0000 7213 0000 0072  r....r....r....r
-00000a10: 1400 0000 7236 0000 0050 0000 0072 1600  ....r6...P...r..
-00000a20: 0000 2901 5a03 5241 5729 015a 0341 4444  ..).Z.RAW).Z.ADD
-00000a30: a901 da04 6178 6973 2901 5a03 4d55 4c7a  ....axis).Z.MULz
-00000a40: 1b6c 6162 656c 5f66 726f 6d5f 7374 7220  .label_from_str 
-00000a50: 6572 726f 722c 206f 7020 3d20 da0e 4c41  error, op = ..LA
-00000a60: 4245 4c5f 4652 4f4d 5f53 5452 6301 0000  BEL_FROM_STRc...
-00000a70: 0000 0000 0000 0000 0002 0000 0004 0000  ................
-00000a80: 0013 0000 0073 1800 0000 6700 7c00 5d10  .....s....g.|.].
-00000a90: 7d01 7c01 8800 7601 7204 7c01 9102 7104  }.|...v.r.|...q.
-00000aa0: 5300 7213 0000 0072 1300 0000 7233 0000  S.r....r....r3..
-00000ab0: 0072 3700 0000 7213 0000 0072 1400 0000  .r7...r....r....
-00000ac0: 7236 0000 005b 0000 0072 1600 0000 291f  r6...[...r....).
-00000ad0: 7207 0000 00da 0661 7374 7970 655a 0664  r......astypeZ.d
-00000ae0: 7479 7065 735a 0774 6f5f 6469 6374 da02  typesZ.to_dict..
-00000af0: 706c 5a0b 6672 6f6d 5f70 616e 6461 7372  plZ.from_pandasr
-00000b00: 1a00 0000 7230 0000 005a 1161 7363 6f6e  ....r0...Z.ascon
-00000b10: 7469 6775 6f75 7361 7272 6179 da08 746f  tiguousarray..to
-00000b20: 5f6e 756d 7079 5a07 7265 7368 6170 65da  _numpyZ.reshape.
-00000b30: 0570 7269 6e74 722a 0000 0072 2700 0000  .printr*...r'...
-00000b40: 7208 0000 00da 036d 6178 da05 6973 6e61  r......max..isna
-00000b50: 6eda 0572 616e 6765 da03 6d69 6eda 036e  n..range..min..n
-00000b60: 616e da08 6973 6669 6e69 7465 722e 0000  an..isfiniter...
-00000b70: 005a 0c77 6974 685f 636f 6c75 6d6e 73da  .Z.with_columns.
-00000b80: 0653 6572 6965 735a 0572 6176 656c 5a07  .SeriesZ.ravelZ.
-00000b90: 666c 6f61 7433 3272 2600 0000 da04 6d65  float32r&.....me
-00000ba0: 616e da05 7768 6572 65da 134e 6f74 496d  an..where..NotIm
-00000bb0: 706c 656d 656e 7465 6445 7272 6f72 da07  plementedError..
-00000bc0: 636f 6c75 6d6e 7329 2672 3500 0000 da07  columns)&r5.....
-00000bd0: 636f 6c5f 7469 64da 0663 6f6c 5f69 64da  col_tid..col_id.
-00000be0: 0a63 6f6c 735f 7072 6963 65da 1363 6f6c  .cols_price..col
-00000bf0: 5f6c 6162 656c 5f61 7267 735f 6c69 7374  _label_args_list
-00000c00: da0e 6c61 6265 6c5f 6672 6f6d 5f73 7472  ..label_from_str
-00000c10: 5a07 6964 5f6c 6973 74da 0573 6861 7065  Z.id_list..shape
-00000c20: 5a09 6466 5f69 645f 616c 6c5a 055f 6466  Z.df_id_allZ._df
-00000c30: 5f4c 5a05 5f64 665f 525a 0664 665f 4c5f  _LZ._df_RZ.df_L_
-00000c40: 525a 065f 6466 5f4c 325a 0561 5f61 646a  RZ._df_L2Z.a_adj
-00000c50: 722d 0000 0072 3400 0000 da01 69da 016a  r-...r4.....i..j
-00000c60: da01 615a 0261 325a 0463 6f6c 325a 0361  ..aZ.a2Z.col2Z.a
-00000c70: 646a 5a02 696a 5a06 6164 6a5f 696a 5a03  djZ.ijZ.adj_ijZ.
-00000c80: 615f 695a 0361 5f6a 5a05 615f 6932 6ada  a_iZ.a_jZ.a_i2j.
-00000c90: 046e 616d 655a 065f 6466 5f52 325a 095f  .nameZ._df_R2Z._
-00000ca0: 6466 5f52 325f 4c32 da0e 6466 5f6c 6162  df_R2_L2..df_lab
-00000cb0: 656c 5f66 696e 616c da02 7373 da02 6f70  el_final..ss..op
-00000cc0: da04 636f 6c73 7212 0000 005a 0278 30da  ..colsr....Z.x0.
-00000cd0: 0278 31da 0a63 6f6c 735f 6c61 6265 6c72  .x1..cols_labelr
-00000ce0: 1300 0000 2902 7238 0000 0072 3500 0000  ....).r8...r5...
-00000cf0: 7214 0000 00da 1267 6574 5f64 665f 6c61  r......get_df_la
-00000d00: 6265 6c5f 6669 6e61 6c20 0000 0073 6800  bel_final ...sh.
-00000d10: 0000 0001 0801 1201 0e01 0c01 1402 0a01  ................
-00000d20: 1801 1002 0801 1801 0a01 0e01 0c01 0a01  ................
-00000d30: 1801 0602 0c01 1801 1801 1202 1401 0e01  ................
-00000d40: 1e01 0e01 0e01 0c01 0e02 0e01 0e01 1001  ................
-00000d50: 1201 0801 2002 0801 1001 0403 0e01 0a01  .... ...........
-00000d60: 1601 0e01 0a01 1201 0a01 1601 0a01 1001  ................
-00000d70: 1001 1801 0e01 1201 1401 7261 0000 0063  ..........ra...c
-00000d80: 0200 0000 0000 0000 0000 0000 0800 0000  ................
-00000d90: 0500 0000 4300 0000 73c0 0000 007c 0164  ....C...s....|.d
-00000da0: 0119 00a0 00a1 007d 027c 0064 0119 00a0  .......}.|.d....
-00000db0: 00a1 007d 037c 037c 037c 0264 0219 006b  ...}.|.|.|.d...k
-00000dc0: 0419 007d 037c 017c 0164 0119 007c 0264  ...}.|.|.d...|.d
-00000dd0: 0219 006b 0219 006a 0164 0364 048d 017d  ...k...j.d.d...}
-00000de0: 0474 027c 0383 0164 056b 0272 547c 0153  .t.|...d.k.rT|.S
-00000df0: 0067 007d 0574 0364 067c 039b 009d 0283  .g.}.t.d.|......
-00000e00: 0101 007c 0344 005d 1e7d 067c 04a0 04a1  ...|.D.].}.|....
-00000e10: 007d 077c 067c 0764 013c 007c 05a0 057c  .}.|.|.d.<.|...|
-00000e20: 07a1 0101 0071 6a74 066a 077c 0564 0564  .....qjt.j.|.d.d
-00000e30: 078d 026a 0164 0364 048d 017d 0774 066a  ...j.d.d...}.t.j
-00000e40: 077c 017c 0767 0264 0564 0864 098d 036a  .|.|.g.d.d.d...j
-00000e50: 0164 0364 048d 017d 017c 0153 0029 0a4e  .d.d...}.|.S.).N
-00000e60: 5a0a 7472 6164 655f 6461 7465 723d 0000  Z.trade_dater=..
-00000e70: 0054 a901 da04 6472 6f70 7201 0000 007a  .T....dropr....z
-00000e80: 115b 2b5d 2064 6174 6573 5f74 6f64 6f20  .[+] dates_todo 
-00000e90: 3d20 723f 0000 0046 2902 7240 0000 0072  = r?...F).r@...r
-00000ea0: 3100 0000 2908 7232 0000 00da 0b72 6573  1...).r2.....res
-00000eb0: 6574 5f69 6e64 6578 722a 0000 0072 4500  et_indexr*...rE.
-00000ec0: 0000 da04 636f 7079 da06 6170 7065 6e64  ....copy..append
-00000ed0: da02 7064 da06 636f 6e63 6174 2908 da04  ..pd..concat)...
-00000ee0: 6466 5f4c da04 6466 5f52 5a0a 6461 7465  df_L..df_RZ.date
-00000ef0: 735f 6861 7665 5a0a 6461 7465 735f 746f  s_haveZ.dates_to
-00000f00: 646f 5a09 6466 5f52 5f6c 6173 745a 0c64  doZ.df_R_lastZ.d
-00000f10: 665f 6e65 7874 5f6c 6973 74da 0464 6174  f_next_list..dat
-00000f20: 655a 0764 665f 6e65 7874 7213 0000 0072  eZ.df_nextr....r
-00000f30: 1300 0000 7214 0000 00da 0d64 665f 6578  ....r......df_ex
-00000f40: 7061 6e64 5f4c 5f52 5e00 0000 731c 0000  pand_L_R^...s...
-00000f50: 0000 010c 010c 0110 011c 0110 0104 010e  ................
-00000f60: 0108 0108 0108 010c 0116 011c 0172 6c00  .............rl.
-00000f70: 0000 5463 0500 0000 0000 0000 0000 0000  ..Tc............
-00000f80: 2200 0000 0d00 0000 4300 0000 73f6 0400  ".......C...s...
-00000f90: 007c 01a0 007c 027c 0367 0264 0164 0267  .|...|.|.g.d.d.g
-00000fa0: 0217 00a1 017d 0574 017c 007c 0464 038d  .....}.t.|.|.d..
-00000fb0: 027d 067c 06a0 02a1 0001 007c 027c 0367  .}.|.......|.|.g
-00000fc0: 027d 077c 057c 0719 007d 0864 047d 097c  .}.|.|...}.d.}.|
-00000fd0: 066a 0364 057c 0367 017c 0967 0117 0064  .j.d.|.g.|.g...d
-00000fe0: 068d 027d 0a7c 0a7c 0a64 0419 0064 076b  ...}.|.|.d...d.k
-00000ff0: 0419 006a 0464 0864 098d 017d 0a74 057c  ...j.d.d...}.t.|
-00001000: 087c 0a7c 0367 0183 037c 0919 00a0 06a1  .|.|.g...|......
-00001010: 007d 0b64 0a7d 097c 066a 0364 0b7c 077c  .}.d.}.|.j.d.|.|
-00001020: 0967 0117 0064 068d 027d 0a74 077c 087c  .g...d...}.t.|.|
-00001030: 0a83 027d 0a74 057c 087c 0a7c 0783 0364  ...}.t.|.|.|...d
-00001040: 0a19 00a0 06a1 00a0 0864 07a1 017d 0c64  .........d...}.d
-00001050: 0c7d 097c 066a 0364 0d7c 077c 0967 0117  .}.|.j.d.|.|.g..
-00001060: 0064 068d 027d 0a74 077c 087c 0a83 027d  .d...}.t.|.|...}
-00001070: 0a74 057c 087c 0a7c 0783 0364 0c19 00a0  .t.|.|.|...d....
-00001080: 06a1 00a0 0864 07a1 017d 0d7c 057c 0764  .....d...}.|.|.d
-00001090: 0164 0267 0217 0019 007d 0e7c 0b7c 0e64  .d.g.....}.|.|.d
-000010a0: 043c 007c 0c7c 0e64 0a3c 007c 0d7c 0e64  .<.|.|.d.<.|.|.d
-000010b0: 0c3c 007c 0e7c 0219 00a0 09a1 006a 0464  .<.|.|.......j.d
-000010c0: 0864 098d 017d 0f74 0a74 0b7c 0f74 0c6a  .d...}.t.t.|.t.j
-000010d0: 0d7c 0f64 0e64 0f8d 0283 0283 017d 107c  .|.d.d.......}.|
-000010e0: 0e64 0419 00a0 09a1 006a 0464 0864 098d  .d.......j.d.d..
-000010f0: 017d 0f74 0a74 0b7c 0f74 0c6a 0d7c 0f64  .}.t.t.|.t.j.|.d
-00001100: 0e64 0f8d 0283 0283 017d 117c 0e7c 0219  .d.......}.|.|..
-00001110: 00a0 0e7c 10a1 017c 0e64 0419 00a0 0e7c  ...|...|.d.....|
-00001120: 11a1 0118 006a 0f6a 1064 106b 057d 127c  .....j.j.d.k.}.|
-00001130: 0e64 0119 00a0 11a1 000f 007d 137c 0e64  .d.........}.|.d
-00001140: 0a19 0064 076b 017d 147c 0e64 0c19 0064  ...d.k.}.|.d...d
-00001150: 116b 017d 1564 127c 039b 0064 137c 029b  .k.}.d.|...d.|..
-00001160: 0064 149d 0564 157c 039b 0064 137c 029b  .d...d.|...d.|..
-00001170: 0064 169d 0564 177c 039b 0064 137c 029b  .d...d.|...d.|..
-00001180: 0064 189d 0564 197c 039b 0064 1a7c 029b  .d...d.|...d.|..
-00001190: 0064 149d 0564 1b7c 039b 0064 1a7c 029b  .d...d.|...d.|..
-000011a0: 0064 169d 0564 1c7c 039b 0064 1a7c 029b  .d...d.|...d.|..
-000011b0: 0064 189d 0564 1d7c 039b 0064 1e7c 029b  .d...d.|...d.|..
-000011c0: 0064 149d 0564 1f7c 039b 0064 1e7c 029b  .d...d.|...d.|..
-000011d0: 0064 169d 0564 207c 039b 0064 1e7c 029b  .d...d |...d.|..
-000011e0: 0064 189d 0567 097d 167c 016a 127c 1664  .d...g.}.|.j.|.d
-000011f0: 2164 038d 0201 007c 01a0 1364 22a1 0164  !d.....|...d"..d
-00001200: 236b 017d 177c 177c 01a0 1364 24a1 0164  #k.}.|.|...d$..d
-00001210: 236b 014d 007d 177c 177c 01a0 1364 25a1  #k.M.}.|.|...d%.
-00001220: 0164 236b 014d 007d 1774 14a0 157c 01a0  .d#k.M.}.t...|..
-00001230: 1364 26a1 017c 01a0 1364 27a1 011b 0064  .d&..|...d'....d
-00001240: 1118 00a1 0164 286b 017d 187c 1874 14a0  .....d(k.}.|.t..
-00001250: 157c 01a0 1364 29a1 017c 01a0 1364 2aa1  .|...d)..|...d*.
-00001260: 011b 0064 1118 00a1 0164 286b 014d 007d  ...d.....d(k.M.}
-00001270: 187c 1874 14a0 157c 01a0 1364 2ba1 017c  .|.t...|...d+..|
-00001280: 01a0 1364 2ca1 011b 0064 1118 00a1 0164  ...d,....d.....d
-00001290: 286b 014d 007d 1874 14a0 157c 01a0 1364  (k.M.}.t...|...d
-000012a0: 26a1 017c 01a0 1364 27a1 0118 0064 0718  &..|...d'....d..
-000012b0: 00a1 0164 2d6b 017d 197c 1974 14a0 157c  ...d-k.}.|.t...|
-000012c0: 01a0 1364 29a1 017c 01a0 1364 2aa1 0118  ...d)..|...d*...
-000012d0: 0064 0718 00a1 0164 2d6b 014d 007d 197c  .d.....d-k.M.}.|
-000012e0: 1974 14a0 157c 01a0 1364 2ba1 017c 01a0  .t...|...d+..|..
-000012f0: 1364 2ca1 0118 0064 0718 00a1 0164 2d6b  .d,....d.....d-k
-00001300: 014d 007d 197c 016a 167c 1664 2164 038d  .M.}.|.j.|.d!d..
-00001310: 0201 007c 177c 1842 007c 1942 000f 007d  ...|.|.B.|.B...}
-00001320: 1a7c 057c 0319 00a0 17a1 007d 1b74 0ca0  .|.|.......}.t..
-00001330: 187c 1ba1 01a0 1974 1aa1 0164 2e6b 017d  .|.....t...d.k.}
-00001340: 1c7c 057c 0319 00a0 0e74 0a74 0b7c 1b7c  .|.|.....t.t.|.|
-00001350: 1c83 0283 01a1 0164 086b 027d 1d7c 0490  .......d.k.}.|..
-00001360: 0372 da74 1b64 2f83 0101 007c 14a0 1c74  .r.t.d/....|...t
-00001370: 146a 1da1 017c 0e64 303c 007c 137c 1240  .j...|.d0<.|.|.@
-00001380: 007c 1440 007c 1540 00a0 1c74 146a 1da1  .|.@.|.@...t.j..
-00001390: 017c 0e64 313c 007c 0490 0472 2274 1b64  .|.d1<.|...r"t.d
-000013a0: 327c 0e64 3119 00a0 1ea1 009b 009d 0283  2|.d1...........
-000013b0: 0101 007c 0490 0472 4074 1b64 327c 0e64  ...|...r@t.d2|.d
-000013c0: 3119 00a0 1ea1 009b 0064 339d 0383 0101  1........d3.....
-000013d0: 007c 0e64 3119 007c 1d40 00a0 1c74 146a  .|.d1..|.@...t.j
-000013e0: 1da1 017c 0e64 313c 007c 0490 0472 7674  ...|.d1<.|...rvt
-000013f0: 1b64 327c 0e64 3119 00a0 1ea1 009b 0064  .d2|.d1........d
-00001400: 349d 0383 0101 007c 0e64 0219 00a0 11a1  4......|.d......
-00001410: 007d 1e7c 1464 116b 027c 0e64 0219 00a0  .}.|.d.k.|.d....
-00001420: 15a1 0064 356b 0140 007d 1f7c 1464 076b  ...d5k.@.}.|.d.k
-00001430: 027c 0e64 0219 00a0 15a1 0064 366b 0140  .|.d.......d6k.@
-00001440: 007d 207c 1f7c 2042 007c 1e42 00a0 1c74  .} |.| B.|.B...t
-00001450: 146a 1da1 017c 0e64 373c 007c 0e64 3119  .j...|.d7<.|.d1.
-00001460: 007c 0e64 3719 0040 007c 0e64 383c 0067  .|.d7..@.|.d8<.g
-00001470: 0064 39a2 017d 217c 06a0 1fa1 0001 007c  .d9..}!|.......|
-00001480: 0e7c 2166 0253 0029 3a4e da04 6f70 656e  .|!f.S.):N..open
-00001490: 5a07 7063 745f 6368 67a9 01da 0776 6572  Z.pct_chg....ver
-000014a0: 626f 7365 5a09 6c69 7374 5f64 6174 655a  boseZ.list_dateZ
-000014b0: 0c64 665f 6c69 7374 5f64 6174 6529 0172  .df_list_date).r
-000014c0: 5e00 0000 7201 0000 0054 7262 0000 005a  ^...r....Trb...Z
-000014d0: 0253 545a 0564 665f 7374 5a03 5355 535a  .STZ.df_stZ.SUSZ
-000014e0: 0664 665f 7375 737a 0625 5925 6d25 6429  .df_susz.%Y%m%d)
-000014f0: 0172 2b00 0000 e914 0000 0072 2100 0000  .r+........r!...
-00001500: 7a19 5f5f 5445 4d50 5f61 5f31 203d 2072  z.__TEMP_a_1 = r
-00001510: 6f6c 6c28 7368 6966 742c 207a 0a2c 2061  oll(shift, z., a
-00001520: 6d6f 756e 742c 207a 042c 2030 297a 195f  mount, z., 0)z._
-00001530: 5f54 454d 505f 615f 3220 3d20 726f 6c6c  _TEMP_a_2 = roll
-00001540: 2873 6869 6674 2c20 fa04 2c20 3129 7a19  (shift, .., 1)z.
-00001550: 5f5f 5445 4d50 5f61 5f33 203d 2072 6f6c  __TEMP_a_3 = rol
-00001560: 6c28 7368 6966 742c 207a 042c 2032 297a  l(shift, z., 2)z
-00001570: 195f 5f54 454d 505f 685f 3120 3d20 726f  .__TEMP_h_1 = ro
-00001580: 6c6c 2873 6869 6674 2c20 7a08 2c20 6869  ll(shift, z., hi
-00001590: 6768 2c20 7a19 5f5f 5445 4d50 5f68 5f32  gh, z.__TEMP_h_2
-000015a0: 203d 2072 6f6c 6c28 7368 6966 742c 207a   = roll(shift, z
-000015b0: 195f 5f54 454d 505f 685f 3320 3d20 726f  .__TEMP_h_3 = ro
-000015c0: 6c6c 2873 6869 6674 2c20 7a19 5f5f 5445  ll(shift, z.__TE
-000015d0: 4d50 5f6c 5f31 203d 2072 6f6c 6c28 7368  MP_l_1 = roll(sh
-000015e0: 6966 742c 207a 072c 206c 6f77 2c20 7a19  ift, z., low, z.
-000015f0: 5f5f 5445 4d50 5f6c 5f32 203d 2072 6f6c  __TEMP_l_2 = rol
-00001600: 6c28 7368 6966 742c 207a 195f 5f54 454d  l(shift, z.__TEM
-00001610: 505f 6c5f 3320 3d20 726f 6c6c 2873 6869  P_l_3 = roll(shi
-00001620: 6674 2c20 465a 0a5f 5f54 454d 505f 615f  ft, FZ.__TEMP_a_
-00001630: 3167 0000 0000 d012 5341 5a0a 5f5f 5445  1g......SAZ.__TE
-00001640: 4d50 5f61 5f32 5a0a 5f5f 5445 4d50 5f61  MP_a_2Z.__TEMP_a
-00001650: 5f33 5a0a 5f5f 5445 4d50 5f68 5f31 5a0a  _3Z.__TEMP_h_1Z.
-00001660: 5f5f 5445 4d50 5f6c 5f31 67fc a9f1 d24d  __TEMP_l_1g....M
-00001670: 6260 3f5a 0a5f 5f54 454d 505f 685f 325a  b`?Z.__TEMP_h_2Z
-00001680: 0a5f 5f54 454d 505f 6c5f 325a 0a5f 5f54  .__TEMP_l_2Z.__T
-00001690: 454d 505f 685f 335a 0a5f 5f54 454d 505f  EMP_h_3Z.__TEMP_
-000016a0: 6c5f 3367 7b14 ae47 e17a a43f 7202 0000  l_3g{..G.z.?r...
-000016b0: 007a 165b 2b5d 2053 542c 204b 4a59 2c20  .z.[+] ST, KJY, 
-000016c0: 5a44 542c 204d 4153 4bda 074d 4153 4b5f  ZDT, MASK..MASK_
-000016d0: 5354 da08 4d41 534b 5f4b 4a59 7a20 5b2b  ST..MASK_KJYz [+
-000016e0: 5d20 6466 5f6d 6173 6b5b 274d 4153 4b5f  ] df_mask['MASK_
-000016f0: 4b4a 5927 5d2e 7375 6d28 2920 3d20 7a17  KJY'].sum() = z.
-00001700: 2c20 6166 7465 7220 263d 206d 6173 6b5f  , after &= mask_
-00001710: 6b6a 795f 7476 727a 162c 2061 6674 6572  kjy_tvrz., after
-00001720: 2026 3d20 6d61 736b 5f6b 6a79 5f69 6467   &= mask_kjy_idg
-00001730: 0000 0000 0000 2340 6700 0000 0000 0013  ......#@g.......
-00001740: 40da 084d 4153 4b5f 5a44 54da 044d 4153  @..MASK_ZDT..MAS
-00001750: 4ba9 0472 7200 0000 7273 0000 0072 7400  K..rr...rs...rt.
-00001760: 0000 7275 0000 0029 20da 0f67 6574 5f63  ..ru...) ..get_c
-00001770: 6f6c 735f 7061 6e64 6173 720a 0000 00da  ols_pandasr.....
-00001780: 0763 6f6e 6e65 6374 da06 7365 6c65 6374  .connect..select
-00001790: 7264 0000 0072 0500 0000 5a09 746f 5f70  rd...r....Z.to_p
-000017a0: 616e 6461 7372 6c00 0000 5a06 6669 6c6c  andasrl...Z.fill
-000017b0: 6e61 da0f 6472 6f70 5f64 7570 6c69 6361  na..drop_duplica
-000017c0: 7465 73da 0464 6963 74da 037a 6970 7267  tes..dict..ziprg
-000017d0: 0000 005a 0b74 6f5f 6461 7465 7469 6d65  ...Z.to_datetime
-000017e0: da03 6d61 70da 0264 74da 0464 6179 735a  ..map..dt..daysZ
-000017f0: 0669 736e 756c 6cda 0566 655f 676f da0d  .isnull..fe_go..
-00001800: 6765 745f 636f 6c5f 6e75 6d70 7972 3000  get_col_numpyr0.
-00001810: 0000 da03 6162 7372 6300 0000 7232 0000  ....absrc...r2..
-00001820: 0072 4c00 0000 da05 6170 706c 7972 0600  .rL.....applyr..
-00001830: 0000 7245 0000 0072 4200 0000 da05 696e  ..rE...rB.....in
-00001840: 7433 32da 0373 756d da05 636c 6f73 6529  t32..sum..close)
-00001850: 22da 0770 6174 685f 6462 da02 646d 7251  "..path_db..dmrQ
-00001860: 0000 0072 5200 0000 726f 0000 0072 3500  ...rR...ro...r5.
-00001870: 0000 5a02 6462 da04 6b65 7973 7269 0000  ..Z.db..keysri..
-00001880: 0072 3400 0000 726a 0000 005a 0b73 5f6c  .r4...rj...Z.s_l
-00001890: 6973 745f 6461 7465 5a04 735f 7374 5a05  ist_dateZ.s_stZ.
-000018a0: 735f 7375 73da 0764 665f 6d61 736b da01  s_sus..df_mask..
-000018b0: 735a 0b64 6174 655f 6469 6374 5f31 5a0b  sZ.date_dict_1Z.
-000018c0: 6461 7465 5f64 6963 745f 325a 0669 6478  date_dict_2Z.idx
-000018d0: 5f32 305a 0769 6478 5f6e 616e 5a06 6964  _20Z.idx_nanZ.id
-000018e0: 785f 7374 5a07 6964 785f 7375 73da 096e  x_stZ.idx_sus..n
-000018f0: 616d 655f 6c69 7374 5a05 6964 785f 615a  ame_listZ.idx_aZ
-00001900: 0d69 6478 5f69 6e74 7261 5f72 6574 5a0d  .idx_intra_retZ.
-00001910: 6964 785f 696e 7472 615f 6469 665a 0c6d  idx_intra_difZ.m
-00001920: 6173 6b5f 6b6a 795f 7476 725a 0469 645f  ask_kjy_tvrZ.id_
-00001930: 6b5a 0469 645f 765a 0b6d 6173 6b5f 6b6a  kZ.id_vZ.mask_kj
-00001940: 795f 6964 5a0c 6d61 736b 5f7a 6474 5f6e  y_idZ.mask_zdt_n
-00001950: 616e 5a0b 6d61 736b 5f7a 6474 5f31 305a  anZ.mask_zdt_10Z
-00001960: 0b6d 6173 6b5f 7a64 745f 7374 da09 636f  .mask_zdt_st..co
-00001970: 6c73 5f6d 6173 6b72 1300 0000 7213 0000  ls_maskr....r...
-00001980: 0072 1400 0000 da0b 6765 745f 6466 5f6d  .r......get_df_m
-00001990: 6173 6b6e 0000 0073 8a00 0000 0001 1601  askn...s........
-000019a0: 0c01 0802 0801 0803 0401 1601 1801 1603  ................
-000019b0: 0401 1401 0a01 1a03 0401 1401 0a01 1a04  ................
-000019c0: 1001 0801 0801 0802 1401 1801 1401 1803  ................
-000019d0: 2401 0e01 0c01 0c04 1001 1001 1002 1001  $...............
-000019e0: 1001 1002 1001 1001 10f5 040d 0e01 0e01  ................
-000019f0: 1201 1202 2201 2601 2602 2201 2601 2601  ....".&.&.".&.&.
-00001a00: 0e01 0e07 0c01 1401 1c03 0e01 1002 1c01  ................
-00001a10: 1c02 1e01 1801 1e02 0c01 1801 1801 1801  ................
-00001a20: 1401 0801 0801 728e 0000 0063 0000 0000  ......r....c....
-00001a30: 0000 0000 0000 0000 0000 0000 0300 0000  ................
-00001a40: 4000 0000 731e 0000 0065 005a 0164 005a  @...s....e.Z.d.Z
-00001a50: 0264 0164 0284 005a 0364 0764 0564 0684  .d.d...Z.d.d.d..
-00001a60: 015a 0464 0353 0029 08da 0842 6173 6544  .Z.d.S.)...BaseD
-00001a70: 6174 6163 0500 0000 0000 0000 0000 0000  atac............
-00001a80: 0500 0000 0200 0000 4300 0000 730c 0000  ........C...s...
-00001a90: 0074 0064 0183 0182 0164 0053 0029 024e  .t.d.....d.S.).N
-00001aa0: 7a1e 796f 7520 6e65 6564 2074 6f20 696d  z.you need to im
-00001ab0: 706c 656d 656e 7420 6765 745f 6466 2829  plement get_df()
-00001ac0: 2901 724f 0000 0029 05da 0473 656c 66da  ).rO...)...self.
-00001ad0: 0a70 6174 685f 696e 7075 74da 0a64 6174  .path_input..dat
-00001ae0: 655f 6265 6769 6eda 0864 6174 655f 656e  e_begin..date_en
-00001af0: 64da 066e 5f6a 6f62 7372 1300 0000 7213  d..n_jobsr....r.
-00001b00: 0000 0072 1400 0000 da06 6765 745f 6466  ...r......get_df
-00001b10: d500 0000 7302 0000 0000 017a 0f42 6173  ....s......z.Bas
-00001b20: 6544 6174 612e 6765 745f 6466 4e54 6304  eData.get_dfNTc.
-00001b30: 0000 0000 0000 0000 0000 0026 0000 000b  ...........&....
-00001b40: 0000 0003 0000 0073 7a09 0000 7400 6a01  .......sz...t.j.
-00001b50: 7d04 7c01 6401 1900 7d05 7c01 6402 1900  }.|.d...}.|.d...
-00001b60: 7d06 7c01 6403 1900 7d07 7c01 6404 1900  }.|.d...}.|.d...
-00001b70: 7d08 7c07 6405 1900 8900 7c07 6406 1900  }.|.d.....|.d...
-00001b80: 7d09 7c07 6407 1900 7d0a 7c07 6408 1900  }.|.d...}.|.d...
-00001b90: 8901 7c02 6400 7500 7268 7c00 6a02 7c04  ..|.d.u.rh|.j.|.
-00001ba0: 6701 7c05 6409 1900 a201 7c06 9101 5200  g.|.d.....|...R.
-00001bb0: 8e00 7d02 640a 7403 7404 7c02 8301 8301  ..}.d.t.t.|.....
-00001bc0: 7600 727e 7c02 7d0b 6e1c 7c02 6a05 640b  v.r~|.}.n.|.j.d.
-00001bd0: 640b 640c 8d02 0100 7406 7c02 640d 640b  d.d.....t.|.d.d.
-00001be0: 640e 8d03 7d0b 7c0b 6a07 8801 6701 640d  d...}.|.j...g.d.
-00001bf0: 640f 8d02 0100 7c03 72b6 7408 6410 8301  d.....|.r.t.d...
-00001c00: 0100 6411 8800 9b00 6412 8801 9b00 6413  ..d.....d.....d.
-00001c10: 9d05 7d0c 7c0b 6a07 6414 7c0c 9b00 6415  ..}.|.j.d.|...d.
-00001c20: 9d03 6701 7c03 640f 8d02 0100 7c0b 6a09  ..g.|.d.....|.j.
-00001c30: 7c0c 6701 640d 640f 8d02 0100 6416 6417  |.g.d.d.....d.d.
-00001c40: 6418 6703 7d0d 7c0b 6a07 7c0d 640d 640f  d.g.}.|.j.|.d.d.
-00001c50: 8d02 0100 6700 7d0d 6700 6419 a201 641a  ....g.}.g.d...d.
-00001c60: 6701 1700 4400 5d56 7d0c 641b 7c0b a00a  g...D.]V}.d.|...
-00001c70: a100 6a0b 7601 9001 7252 7c0d 641c 7c0c  ..j.v...rR|.d.|.
-00001c80: 9b00 641d 8800 9b00 641e 7c0c 9b00 641e  ..d.....d.|...d.
-00001c90: 8801 9b00 6413 9d09 6701 3700 7d0d 7c0d  ....d...g.7.}.|.
-00001ca0: 7c0c 9b00 641f 7c0c 9b00 641e 7c0c 9b00  |...d.|...d.|...
-00001cb0: 6420 9d06 6701 3700 7d0d 9001 711a 7c0b  d ..g.7.}...q.|.
-00001cc0: 6a07 7c0d 640d 640f 8d02 0100 7c08 a00c  j.|.d.d.....|...
-00001cd0: 6421 6422 a102 7d0e 740d 7c0e 8301 6423  d!d"..}.t.|...d#
-00001ce0: 6b04 9001 72c6 6424 7d0f 7c0e a00e 6425  k...r.d$}.|...d%
-00001cf0: a101 6426 6400 8502 1900 7d10 740f a010  ..d&d.....}.t...
-00001d00: 6427 6428 8400 7c10 4400 8301 a101 7d11  d'd(..|.D.....}.
-00001d10: 6e38 7411 7c08 6429 1900 8301 7d0f 7c08  n8t.|.d)....}.|.
-00001d20: 6429 1900 6701 7d10 740f a010 642a 6428  d)..g.}.t...d*d(
-00001d30: 8400 7c0f a00e 642b a101 642c 642d 8502  ..|...d+..d,d-..
-00001d40: 1900 4400 8301 a101 7d11 7c10 7c08 a00c  ..D.....}.|.|...
-00001d50: 642e 6700 a102 3700 7d10 7412 7413 a014  d.g...7.}.t.t...
-00001d60: 7c10 a101 a015 a100 8301 7d10 642f 6428  |.........}.d/d(
-00001d70: 8400 7c10 4400 8301 7d10 7c10 7c08 642e  ..|.D...}.|.|.d.
-00001d80: 3c00 7c0f 7c08 6430 3c00 7c03 9002 7258  <.|.|.d0<.|...rX
-00001d90: 7408 6431 7c0e 9b00 6432 7c0f 9b00 9d04  t.d1|...d2|.....
-00001da0: 8301 0100 7c03 9002 726c 7408 6433 7c10  ....|...rlt.d3|.
-00001db0: 9b00 9d02 8301 0100 6434 6428 8400 7c10  ........d4d(..|.
-00001dc0: 4400 8301 6435 6428 8400 7c10 4400 8301  D...d5d(..|.D...
-00001dd0: 1700 7d12 7412 7413 a014 7c12 a101 a015  ..}.t.t...|.....
-00001de0: a100 8301 7d12 7c0b a016 8801 8800 6702  ....}.|.......g.
-00001df0: 7c12 1700 6436 6701 1700 a101 7d02 7417  |...d6g.....}.t.
-00001e00: 7c02 8801 8800 7c12 7c10 7c0e 8306 5c02  |.....|.|.|...\.
-00001e10: 7d13 7d14 7c14 4400 5d16 7d0c 7c0b a018  }.}.|.D.].}.|...
-00001e20: 7c0c 7c13 7c0c 1900 a102 0100 9002 71cc  |.|.|.........q.
-00001e30: 7c14 6437 6701 3700 7d14 6438 7c0b a00a  |.d7g.7.}.d8|...
-00001e40: a100 6a0b 7600 9003 7208 7c14 6438 6701  ..j.v...r.|.d8g.
-00001e50: 3700 7d14 7c14 7c01 6403 1900 6439 3c00  7.}.|.|.d...d9<.
-00001e60: 7c03 9003 7228 7408 643a 7c14 9b00 9d02  |...r(t.d:|.....
-00001e70: 8301 0100 7c08 a00c 643b 6400 a102 7d15  ....|...d;d...}.
-00001e80: 7c03 9003 724e 7408 643c 7c15 9b00 6432  |...rNt.d<|...d2
-00001e90: 7c0f 9b00 9d04 8301 0100 7c15 643d 6b02  |.........|.d=k.
-00001ea0: 9003 72b6 7c0b 6a07 643e 7c0f 9b00 6420  ..r.|.j.d>|...d 
-00001eb0: 9d03 6701 7c03 640f 8d02 0100 7c0b 6a07  ..g.|.d.....|.j.
-00001ec0: 7c09 9b00 643f 8801 9b00 641e 7c0f 9b00  |...d?....d.|...
-00001ed0: 6420 9d06 6701 7c03 640f 8d02 0100 8701  d ..g.|.d.......
-00001ee0: 6601 6440 6428 8408 7c14 4400 8301 7d0d  f.d@d(..|.D...}.
-00001ef0: 7c0b 6a07 7c0d 7c03 642c 6441 8d03 0100  |.j.|.|.d,dA....
-00001f00: 6e98 7c15 6442 6b02 9003 72f6 7c0b 6a07  n.|.dBk...r.|.j.
-00001f10: 643e 7c0f 9b00 6420 9d03 6701 7c03 640f  d>|...d ..g.|.d.
-00001f20: 8d02 0100 7c0b 6a07 7c09 9b00 6443 7c0f  ....|.j.|...dC|.
-00001f30: 9b00 6420 9d04 6701 7c03 640f 8d02 0100  ..d ..g.|.d.....
-00001f40: 6e58 7c15 6444 6b02 9004 7240 7c03 9004  nX|.dDk...r@|...
-00001f50: 720e 7408 6445 8301 0100 7c0b 6a07 643e  r.t.dE....|.j.d>
-00001f60: 7c09 9b00 6420 9d03 6701 7c03 640f 8d02  |...d ..g.|.d...
-00001f70: 0100 7c09 7c0b a00a a100 6a0b 7600 9004  ..|.|.....j.v...
-00001f80: 734e 4a00 6446 8301 8201 6e0e 7419 643c  sNJ.dF....n.t.d<
-00001f90: 7c15 9b00 9d02 8301 8201 7c03 9004 725c  |.........|...r\
-00001fa0: 7408 6447 8301 0100 741a 6a1b a01c 741a  t.dG....t.j...t.
-00001fb0: 6a1b a01d 7c04 a101 a101 9b00 6448 9d02  j...|.......dH..
-00001fc0: 7d16 7c03 9004 728a 7408 6449 7c16 9b00  }.|...r.t.dI|...
-00001fd0: 9d02 8301 0100 741a 6a1b a01e 7c16 a101  ......t.j...|...
-00001fe0: 9004 72cc 741f 7c16 7c0b 8801 8800 7c03  ..r.t.|.|.....|.
-00001ff0: 640f 8d05 5c02 7d17 7d18 7c18 4400 5d16  d...\.}.}.|.D.].
-00002000: 7d0c 7c0b a018 7c0c 7c17 7c0c 1900 a102  }.|...|.|.|.....
-00002010: 0100 9004 71b2 6e0c 6700 644a a201 0400  ....q.n.g.dJ....
-00002020: 7d18 7d18 7c18 7c01 6403 1900 644b 3c00  }.}.|.|.d...dK<.
-00002030: 7c03 9004 72f8 7408 644c 7c18 9b00 9d02  |...r.t.dL|.....
-00002040: 8301 0100 741a 6a1b a01e 7c16 a101 9005  ....t.j...|.....
-00002050: 7252 740f a020 7c0b 6a21 644d 1900 7c09  rRt.. |.j!dM..|.
-00002060: 1900 a022 a100 a101 0f00 a023 740f 6a24  ...".......#t.j$
-00002070: a101 7d19 7c19 7c0b 6a21 644d 1900 644e  ..}.|.|.j!dM..dN
-00002080: 1900 a022 a100 4d00 7d19 7c0b 6a21 644d  ..."..M.}.|.j!dM
-00002090: 1900 644f 1900 a022 a100 7d1a 6e56 740f  ..dO..."..}.nVt.
-000020a0: a020 7c0b 6a21 644d 1900 7c09 1900 a022  . |.j!dM..|...."
-000020b0: a100 a101 0f00 a023 740f 6a24 a101 7d19  .......#t.j$..}.
-000020c0: 7c19 740f a020 7c0b 6a21 644d 1900 6450  |.t.. |.j!dM..dP
-000020d0: 1900 a022 a100 a101 0f00 a023 740f 6a24  ...".......#t.j$
-000020e0: a101 4d00 7d19 7c0b a025 6451 a101 6426  ..M.}.|..%dQ..d&
-000020f0: 6b02 7d1a 7c0b a026 7c19 a023 740f 6a24  k.}.|..&|..#t.j$
-00002100: a101 6452 a102 0100 7c0b a026 7c1a a023  ..dR....|..&|..#
-00002110: 740f 6a24 a101 6453 a102 0100 640d 9006  t.j$..dS....d...
-00002120: 7284 741a 6a1b a01e 7c16 a101 9006 7284  r.t.j...|.....r.
-00002130: 7c0b a007 6454 8801 9b00 6455 9d03 6701  |...dT....dU..g.
-00002140: a101 0100 7c0b 6a16 6456 8801 9b00 9d02  ....|.j.dV......
-00002150: 6457 8d01 7d1b 7c1b 7c1b 6454 8801 9b00  dW..}.|.|.dT....
-00002160: 6455 9d03 1900 a027 a100 6458 6b04 1900  dU.....'..dXk...
-00002170: 8801 1900 6a28 7d1c 7c1c 7c1c 7c05 6409  ....j(}.|.|.|.d.
-00002180: 1900 6426 1900 6b01 1900 7d1c 7408 6459  ..d&..k...}.t.dY
-00002190: 740d 7c1c 8301 9b00 645a 641e a029 645b  t.|.....dZd..)d[
-000021a0: 645c 8400 7c1c 4400 8301 a101 9b00 645d  d\..|.D.......d]
-000021b0: 9d05 8301 0100 7c0b a02a 8801 a101 a02b  ......|..*.....+
-000021c0: 742c 7c1c 8301 a101 0f00 6a28 7d1d 6e10  t,|.......j(}.n.
-000021d0: 740f a02d 7c19 a101 a023 742e a101 7d1d  t..-|....#t...}.
-000021e0: 7c19 7c1a 4000 7d1e 7c1e 7c1d 4d00 7d1e  |.|.@.}.|.|.M.}.
-000021f0: 7c0b a026 7c1e 6451 a102 0100 7c0b a018  |..&|.dQ....|...
-00002200: 645e 7c1e a102 0100 7c03 9007 7234 7408  d^|.....|...r4t.
-00002210: 645f 7c19 a02f a100 9b00 6460 740d 7c19  d_|../....d`t.|.
-00002220: 8301 9b00 6461 7c19 a030 a100 9b00 9d06  ....da|..0......
-00002230: 8301 0100 7408 6462 7c1a a02f a100 9b00  ....t.db|../....
-00002240: 6460 740d 7c1a 8301 9b00 6461 7c1a a030  d`t.|.....da|..0
-00002250: a100 9b00 9d06 8301 0100 7408 6463 7c1e  ..........t.dc|.
-00002260: a02f a100 9b00 6460 740d 7c1e 8301 9b00  ./....d`t.|.....
-00002270: 6461 7c1e a030 a100 9b00 9d06 8301 0100  da|..0..........
-00002280: 6464 7c05 a031 a100 7601 9007 72a6 6465  dd|..1..v...r.de
-00002290: 7c05 a031 a100 7600 9007 725e 7c05 6465  |..1..v...r^|.de
-000022a0: 1900 7c05 6464 3c00 6e48 6466 7c05 a031  ..|.dd<.nHdf|..1
-000022b0: a100 7600 9007 727a 7c05 6466 1900 7c05  ..v...rz|.df..|.
-000022c0: 6464 3c00 6e2c 6409 7c05 a031 a100 7600  dd<.n,d.|..1..v.
-000022d0: 9007 7296 7c05 6409 1900 7c05 6464 3c00  ..r.|.d...|.dd<.
-000022e0: 6e10 7419 6467 7c05 9b00 6468 9d03 8301  n.t.dg|...dh....
-000022f0: 8201 7c03 9007 72c0 7408 6469 7c11 9b00  ..|...r.t.di|...
-00002300: 6432 7c0f 9b00 9d04 8301 0100 7c0b 6a21  d2|.........|.j!
-00002310: 644d 1900 8801 1900 a022 a100 7d1f 7c05  dM......."..}.|.
-00002320: a031 a100 4400 5dda 7d20 7c05 7c20 1900  .1..D.].} |.| ..
-00002330: 5c02 7d21 7d22 7c20 646a 7600 9008 721a  \.}!}"| djv...r.
-00002340: 740f a032 7c1f a101 7d23 740f a033 7c23  t..2|...}#t..3|#
-00002350: 7c23 7c22 6b01 1900 a101 6426 7c11 1700  |#|"k.....d&|...
-00002360: 0b00 1900 7d22 7c1f 7c21 6b05 7c1f 7c22  ....}"|.|!k.|.|"
-00002370: 6b01 4000 7d24 7c20 646b 6b03 9008 7242  k.@.}$| dkk...rB
-00002380: 7c24 7c1e a023 742e a101 4d00 7d24 7c0b  |$|..#t...M.}$|.
-00002390: 6a26 7c24 7c20 646c 8d02 0100 7c03 9007  j&|$| dl....|...
-000023a0: 72da 740d 7c1f 7c24 1900 8301 6423 6b04  r.t.|.|$....d#k.
-000023b0: 9008 72a0 7408 646d 7c20 646e 9b04 646f  ..r.t.dm| dn..do
-000023c0: 7c1f 7c24 1900 a034 a100 9b00 6470 7c1f  |.|$...4....dp|.
-000023d0: 7c24 1900 a010 a100 9b00 6461 7c24 a02f  |$........da|$./
-000023e0: a100 9b00 9d08 8301 0100 6e12 7408 646d  ..........n.t.dm
-000023f0: 7c20 646e 9b04 6471 9d03 8301 0100 9007  | dn..dq........
-00002400: 71da 7c03 9008 72c4 7408 6472 8301 0100  q.|...r.t.dr....
-00002410: 7c08 a00c 6473 6426 a102 8903 7c03 9008  |...dsd&....|...
-00002420: 72e4 7408 6474 8803 9b00 9d02 8301 0100  r.t.dt..........
-00002430: 8800 8801 7c09 6703 7c0a 1700 7c14 1700  ....|.g.|...|...
-00002440: 7c18 1700 7c08 a00c 6475 6400 a102 6701  |...|...dud...g.
-00002450: 1700 8902 8802 7c08 a00c 6476 6700 a102  ......|...dvg...
-00002460: 3700 8902 8802 7c08 6476 3c00 7c03 9009  7.....|.dv<.|...
-00002470: 7234 7408 6477 8802 9b00 9d02 8301 0100  r4t.dw..........
-00002480: 8702 6601 6478 6428 8408 7c0b a00a a100  ..f.dxd(..|.....
-00002490: 6a0b 4400 8301 7d25 8803 6423 6b03 9009  j.D...}%..d#k...
-000024a0: 7276 7c0b 6a07 8700 8701 8703 6603 6479  rv|.j.......f.dy
-000024b0: 6428 8408 7c25 4400 8301 7c03 640f 8d02  d(..|%D...|.d...
-000024c0: 0100 7c0b 5300 297a 4eda 0964 6174 655f  ..|.S.)zN..date_
-000024d0: 6469 6374 7294 0000 00da 0963 6f6c 735f  dictr......cols_
-000024e0: 6469 6374 da0a 6f74 6865 725f 696e 666f  dict..other_info
-000024f0: 7252 0000 00da 0963 6f6c 5f6c 6162 656c  rR.....col_label
-00002500: da08 636f 6c73 5f74 6964 7251 0000 00da  ..cols_tidrQ....
-00002510: 0361 6c6c 7203 0000 0054 2902 7263 0000  .allr....T).rc..
-00002520: 005a 0769 6e70 6c61 6365 4629 0272 6f00  .Z.inplaceF).ro.
-00002530: 0000 5a0a 6b65 6570 5f73 7061 6365 726e  ..Z.keep_spacern
-00002540: 0000 007a 255b 696e 6974 5d20 3c2d 2d2d  ...z%[init] <---
-00002550: 2d2d 2d2d 2d2d 2d20 6c61 6265 6c20 2d2d  ------- label --
-00002560: 2d2d 2d2d 2d2d 2d2d 3e20 7a0c 726f 6c6c  --------> z.roll
-00002570: 2873 6869 6674 2c20 7a0a 2c20 636c 6f73  (shift, z., clos
-00002580: 652c 2020 7271 0000 007a 0a41 444a 203d  e,  rq...z.ADJ =
-00002590: 2064 6976 287a 0c2c 2070 7265 5f63 6c6f   div(z., pre_clo
-000025a0: 7365 297a 1776 7761 7020 3d20 6469 7628  se)z.vwap = div(
-000025b0: 616d 6f75 6e74 2c20 766f 6c29 7a0e 7477  amount, vol)z.tw
-000025c0: 6170 203d 206f 2876 7761 7029 7a25 6d65  ap = o(vwap)z%me
-000025d0: 616e 203d 206d 6561 6e5f 6d28 6f70 656e  an = mean_m(open
-000025e0: 2c20 6869 6768 2c20 6c6f 772c 2063 6c6f  , high, low, clo
-000025f0: 7365 2929 045a 0474 7761 705a 0476 7761  se)).Z.twapZ.vwa
-00002600: 7072 6d00 0000 7286 0000 0072 4d00 0000  prm...r....rM...
-00002610: 7a09 7072 655f 7b63 6f6c 7d5a 0470 7265  z.pre_{col}Z.pre
-00002620: 5ffa 0f20 3d20 726f 6c6c 2873 6869 6674  _.. = roll(shift
-00002630: 2c20 fa02 2c20 7a0f 5f72 6574 203d 2072  , .., z._ret = r
-00002640: 6574 2870 7265 5ffa 0129 7255 0000 0072  et(pre_..)rU...r
-00002650: 2f00 0000 7201 0000 0072 4100 0000 723e  /...r....rA...r>
-00002660: 0000 0072 2100 0000 6301 0000 0000 0000  ...r!...c.......
-00002670: 0000 0000 0002 0000 0007 0000 0053 0000  .............S..
-00002680: 0073 2200 0000 6700 7c00 5d1a 7d01 7400  .s"...g.|.].}.t.
-00002690: a001 7402 7c01 8301 6400 6401 8502 1900  ..t.|...d.d.....
-000026a0: a101 9102 7104 5300 2902 7221 0000 0072  ....q.S.).r!...r
-000026b0: 0200 0000 2903 7230 0000 0072 4600 0000  ....).r0...rF...
-000026c0: 7228 0000 0072 1000 0000 7213 0000 0072  r(...r....r....r
-000026d0: 1300 0000 7214 0000 0072 3600 0000 0901  ....r....r6.....
-000026e0: 0000 7216 0000 007a 2142 6173 6544 6174  ..r....z!BaseDat
-000026f0: 612e 6c6f 6164 2e3c 6c6f 6361 6c73 3e2e  a.load.<locals>.
-00002700: 3c6c 6973 7463 6f6d 703e 722d 0000 0063  <listcomp>r-...c
-00002710: 0100 0000 0000 0000 0000 0000 0200 0000  ................
-00002720: 0400 0000 5300 0000 7314 0000 0067 007c  ....S...s....g.|
-00002730: 005d 0c7d 0174 007c 0183 0191 0271 0453  .].}.t.|.....q.S
-00002740: 0072 1300 0000 2901 7227 0000 0072 1000  .r....).r'...r..
-00002750: 0000 7213 0000 0072 1300 0000 7214 0000  ..r....r....r...
-00002760: 0072 3600 0000 0d01 0000 7216 0000 00da  .r6.......r.....
-00002770: 015f 7222 0000 0072 2900 0000 7254 0000  ._r"...r)...rT..
-00002780: 0063 0100 0000 0000 0000 0000 0000 0200  .c..............
-00002790: 0000 0400 0000 5300 0000 7314 0000 0067  ......S...s....g
-000027a0: 007c 005d 0c7d 0174 007c 0183 0191 0271  .|.].}.t.|.....q
-000027b0: 0453 0072 1300 0000 2901 7228 0000 0072  .S.r....).r(...r
-000027c0: 1000 0000 7213 0000 0072 1300 0000 7214  ....r....r....r.
-000027d0: 0000 0072 3600 0000 1001 0000 7216 0000  ...r6.......r...
-000027e0: 00da 0e63 6f6c 5f6c 6162 656c 5f66 726f  ...col_label_fro
-000027f0: 6d7a 155b 2b5d 206c 6162 656c 5f66 726f  mz.[+] label_fro
-00002800: 6d5f 7374 7220 3d20 7a13 2c20 636f 6c5f  m_str = z., col_
-00002810: 6c61 6265 6c5f 6672 6f6d 203d 207a 1a5b  label_from = z.[
-00002820: 2b5d 2063 6f6c 5f6c 6162 656c 5f61 7267  +] col_label_arg
-00002830: 735f 6c69 7374 203d 2063 0100 0000 0000  s_list = c......
-00002840: 0000 0000 0000 0200 0000 0400 0000 5300  ..............S.
-00002850: 0000 7314 0000 0067 007c 005d 0c7d 017c  ..s....g.|.].}.|
-00002860: 0164 0019 0091 0271 0453 0029 0172 0100  .d.....q.S.).r..
-00002870: 0000 7213 0000 0072 1000 0000 7213 0000  ..r....r....r...
-00002880: 0072 1300 0000 7214 0000 0072 3600 0000  .r....r....r6...
-00002890: 1701 0000 7216 0000 0063 0100 0000 0000  ....r....c......
-000028a0: 0000 0000 0000 0200 0000 0500 0000 5300  ..............S.
-000028b0: 0000 7324 0000 0067 007c 005d 1c7d 0174  ..s$...g.|.].}.t
-000028c0: 007c 0164 0019 0083 0174 0175 0072 047c  .|.d.....t.u.r.|
-000028d0: 0164 0019 0091 0271 0453 0029 0172 3d00  .d.....q.S.).r=.
-000028e0: 0000 2902 7223 0000 0072 0f00 0000 7210  ..).r#...r....r.
-000028f0: 0000 0072 1300 0000 7213 0000 0072 1400  ...r....r....r..
-00002900: 0000 7236 0000 0017 0100 0072 1600 0000  ..r6.......r....
-00002910: 7239 0000 00da 094c 4142 454c 5f52 4157  r9.....LABEL_RAW
-00002920: da05 6c61 6265 6c72 6000 0000 7a11 5b2b  ..labelr`...z.[+
-00002930: 5d20 636f 6c73 5f6c 6162 656c 203d 20da  ] cols_label = .
-00002940: 0b66 5f6c 6162 656c 5f70 7265 7a12 5b2b  .f_label_prez.[+
-00002950: 5d20 665f 6c61 6265 6c5f 7072 6520 3d20  ] f_label_pre = 
-00002960: 5a08 6373 7a73 636f 7265 7a0e 4c41 4245  Z.cszscorez.LABE
-00002970: 4c5f 5241 5720 3d20 6f28 7a0f 203d 2061  L_RAW = o(z. = a
-00002980: 6767 287a 7363 6f72 652c 2063 0100 0000  gg(zscore, c....
-00002990: 0000 0000 0000 0000 0200 0000 0700 0000  ................
-000029a0: 1300 0000 7326 0000 0067 007c 005d 1e7d  ....s&...g.|.].}
-000029b0: 017c 0164 0076 0172 0464 0188 009b 0064  .|.d.v.r.d.....d
-000029c0: 027c 019b 0064 039d 0591 0271 0453 0029  .|...d.....q.S.)
-000029d0: 0429 0172 a100 0000 7a0c 6167 6728 7a73  .).r....z.agg(zs
-000029e0: 636f 7265 2c20 729d 0000 0072 9e00 0000  core, r....r....
-000029f0: 7213 0000 0072 3300 0000 2901 7251 0000  r....r3...).rQ..
-00002a00: 0072 1300 0000 7214 0000 0072 3600 0000  .r....r....r6...
-00002a10: 2901 0000 7216 0000 0029 0272 6f00 0000  )...r....).ro...
-00002a20: 5a09 6b65 6570 5f6e 616d 65da 066f 7269  Z.keep_name..ori
-00002a30: 6769 6e7a 0520 3d20 6f28 5a05 6578 6973  ginz. = o(Z.exis
-00002a40: 747a 3c5b 2b5d 2072 6177 206c 6162 656c  tz<[+] raw label
-00002a50: 2066 726f 6d20 646d 2c20 2877 6869 6368   from dm, (which
-00002a60: 206d 6561 6e20 6578 6973 7420 7468 6973   mean exist this
-00002a70: 2063 6f6c 756d 6e2c 206c 6162 656c 297a   column, label)z
-00002a80: 2263 6f6c 5f6c 6162 656c 203d 207b 636f  "col_label = {co
-00002a90: 6c5f 6c61 6265 6c7d 206e 6f74 2069 6e20  l_label} not in 
-00002aa0: 646d 217a 255b 696e 6974 5d20 3c2d 2d2d  dm!z%[init] <---
-00002ab0: 2d2d 2d2d 2d2d 2d20 6d61 736b 2020 2d2d  ------- mask  --
-00002ac0: 2d2d 2d2d 2d2d 2d2d 3e20 7a06 2f72 7a2e  --------> z./rz.
-00002ad0: 6462 7a0e 5b2b 5d20 7061 7468 5f64 6220  dbz.[+] path_db 
-00002ae0: 3d20 7276 0000 0072 8d00 0000 7a10 5b2b  = rv...r....z.[+
-00002af0: 5d20 636f 6c73 5f6d 6173 6b20 3d20 5a02  ] cols_mask = Z.
-00002b00: 5430 7273 0000 0072 7400 0000 726d 0000  T0rs...rt...rm..
-00002b10: 00da 046d 6173 6b5a 036b 6a79 5a03 7a64  ...maskZ.kjyZ.zd
-00002b20: 747a 0967 7028 6d65 616e 2c20 7a0c 2c20  tz.gp(mean, z., 
-00002b30: 4c41 4245 4c5f 5241 5729 7a03 5430 2e29  LABEL_RAW)z.T0.)
-00002b40: 015a 0764 665f 6e61 6d65 67b8 1e85 eb51  .Z.df_nameg....Q
-00002b50: b89e 3f7a 105b 2b5d 2064 6174 655f 6472  ..?z.[+] date_dr
-00002b60: 6f70 203d 207a 0e0a 6461 7465 5f64 726f  op = z..date_dro
-00002b70: 7020 3d20 5b63 0100 0000 0000 0000 0000  p = [c..........
-00002b80: 0000 0200 0000 0300 0000 7300 0000 7316  ..........s...s.
-00002b90: 0000 007c 005d 0e7d 0174 007c 0183 0156  ...|.].}.t.|...V
-00002ba0: 0001 0071 0264 0053 0072 0d00 0000 720e  ...q.d.S.r....r.
-00002bb0: 0000 0072 1000 0000 7213 0000 0072 1300  ...r....r....r..
-00002bc0: 0000 7214 0000 0072 1500 0000 5801 0000  ..r....r....X...
-00002bd0: 7216 0000 007a 2042 6173 6544 6174 612e  r....z BaseData.
-00002be0: 6c6f 6164 2e3c 6c6f 6361 6c73 3e2e 3c67  load.<locals>.<g
-00002bf0: 656e 6578 7072 3efa 015d 7275 0000 007a  enexpr>..]ru...z
-00002c00: 0b5b 2b5d 206b 6a79 2020 3d20 7a03 202f  .[+] kjy  = z. /
-00002c10: 207a 0320 3d20 7a0b 5b2b 5d20 7a64 7420   z. = z.[+] zdt 
-00002c20: 203d 207a 0b5b 2b5d 206d 6173 6b20 3d20   = z.[+] mask = 
-00002c30: da04 6869 7374 da05 7472 6169 6e5a 046c  ..hist..trainZ.l
-00002c40: 6f6f 6b7a 0c64 6174 655f 6469 6374 203d  ookz.date_dict =
-00002c50: 207a 0b2c 206e 6565 6420 6869 7374 7a0e   z., need histz.
-00002c60: 5b2b 5d20 7061 6464 696e 6720 3d20 2902  [+] padding = ).
-00002c70: 72a8 0000 0072 a700 0000 da04 7465 7374  r....r......test
-00002c80: 2901 5a09 6d61 736b 5f6e 616d 657a 105b  ).Z.mask_namez.[
-00002c90: 2b5d 206d 6173 6b5f 6e61 6d65 203d 207a  +] mask_name = z
-00002ca0: 033c 3131 7a02 7c20 7a04 202d 3e20 7a09  .<11z.| z. -> z.
-00002cb0: 7c20 6c65 6e20 3d20 307a 275b 696e 6974  | len = 0z'[init
-00002cc0: 5d20 3c2d 2d2d 2d2d 2d2d 2d2d 2d20 7368  ] <---------- sh
-00002cd0: 6966 745f 6920 2d2d 2d2d 2d2d 2d2d 2d2d  ift_i ----------
-00002ce0: 3e20 da07 7368 6966 745f 697a 0e5b 2b5d  > ..shift_iz.[+]
-00002cf0: 2073 6869 6674 5f69 203d 205a 0863 6f6c   shift_i = Z.col
-00002d00: 5f64 6174 65da 1063 6f6c 735f 7368 6966  _date..cols_shif
-00002d10: 745f 315f 6e6f 747a 175b 2b5d 2063 6f6c  t_1_notz.[+] col
-00002d20: 735f 7368 6966 745f 315f 6e6f 7420 3d20  s_shift_1_not = 
-00002d30: 6301 0000 0000 0000 0000 0000 0002 0000  c...............
-00002d40: 0004 0000 0013 0000 0073 1800 0000 6700  .........s....g.
-00002d50: 7c00 5d10 7d01 7c01 8800 7601 7204 7c01  |.].}.|...v.r.|.
-00002d60: 9102 7104 5300 7213 0000 0072 1300 0000  ..q.S.r....r....
-00002d70: 7233 0000 0029 0172 ab00 0000 7213 0000  r3...).r....r...
-00002d80: 0072 1400 0000 7236 0000 0084 0100 0072  .r....r6.......r
-00002d90: 1600 0000 6301 0000 0000 0000 0000 0000  ....c...........
-00002da0: 0002 0000 000c 0000 0013 0000 0073 2e00  .............s..
-00002db0: 0000 6700 7c00 5d26 7d01 7c01 9b00 6400  ..g.|.]&}.|...d.
-00002dc0: 8800 9b00 6401 7c01 9b00 6401 8801 9b00  ....d.|...d.....
-00002dd0: 6401 8802 9b00 6402 9d0a 9102 7104 5300  d.....d.....q.S.
-00002de0: 2903 729c 0000 0072 9d00 0000 729e 0000  ).r....r....r...
-00002df0: 0072 1300 0000 7233 0000 0029 0372 5200  .r....r3...).rR.
-00002e00: 0000 7251 0000 0072 aa00 0000 7213 0000  ..rQ...r....r...
-00002e10: 0072 1400 0000 7236 0000 0085 0100 0072  .r....r6.......r
-00002e20: 1600 0000 2935 721e 0000 005a 0950 4154  ....)5r....Z.PAT
-00002e30: 485f 4441 5441 7295 0000 0072 0f00 0000  H_DATAr....r....
-00002e40: 7223 0000 0072 6400 0000 7203 0000 0072  r#...rd...r....r
-00002e50: 8000 0000 7245 0000 0072 6300 0000 da04  ....rE...rc.....
-00002e60: 6865 6164 7250 0000 0072 1700 0000 722a  headrP...r....r*
-00002e70: 0000 0072 2600 0000 7230 0000 0072 4600  ...r&...r0...rF.
-00002e80: 0000 722e 0000 0072 2400 0000 7267 0000  ..r....r$...rg..
-00002e90: 0072 4c00 0000 727a 0000 0072 7700 0000  .rL...rz...rw...
-00002ea0: 7261 0000 005a 0a73 6574 5f62 795f 636f  ra...Z.set_by_co
-00002eb0: 6c72 4f00 0000 da02 6f73 da04 7061 7468  lrO.....os..path
-00002ec0: da07 6469 726e 616d 65da 0761 6273 7061  ..dirname..abspa
-00002ed0: 7468 da06 6578 6973 7473 728e 0000 0072  th..existsr....r
-00002ee0: 4700 0000 5a07 6466 5f64 6963 7472 4400  G...Z.df_dictrD.
-00002ef0: 0000 7242 0000 0072 8400 0000 7281 0000  ..rB...r....r...
-00002f00: 005a 0873 6574 5f6d 6173 6b72 8200 0000  .Z.set_maskr....
-00002f10: da06 7661 6c75 6573 721a 0000 005a 0e67  ..valuesr....Z.g
-00002f20: 6574 5f63 6f6c 5f70 616e 6461 735a 0469  et_col_pandasZ.i
-00002f30: 7369 6eda 0373 6574 5a09 6f6e 6573 5f6c  sin..setZ.ones_l
-00002f40: 696b 65da 0462 6f6f 6c72 8500 0000 724d  ike..boolr....rM
-00002f50: 0000 0072 8900 0000 7232 0000 0072 3100  ...r....r2...r1.
-00002f60: 0000 7249 0000 0029 2672 9000 0000 5a0b  ..rI...)&r....Z.
-00002f70: 6461 7461 5f63 6f6e 6669 6772 3500 0000  data_configr5...
-00002f80: 726f 0000 0072 9100 0000 7296 0000 0072  ro...r....r....r
-00002f90: 9400 0000 7297 0000 0072 9800 0000 7299  ....r....r....r.
-00002fa0: 0000 0072 9a00 0000 7288 0000 0072 3400  ...r....r....r4.
-00002fb0: 0000 728c 0000 0072 5500 0000 72a0 0000  ..r....rU...r...
-00002fc0: 0072 5400 0000 da07 7061 6464 696e 6772  .rT.....paddingr
-00002fd0: 5300 0000 725b 0000 0072 6000 0000 72a3  S...r[...r`...r.
-00002fe0: 0000 0072 8700 0000 728a 0000 0072 8d00  ...r....r....r..
-00002ff0: 0000 5a08 6d61 736b 5f6b 6a79 5a08 6d61  ..Z.mask_kjyZ.ma
-00003000: 736b 5f7a 6474 5a05 6466 5f67 705a 0964  sk_zdtZ.df_gpZ.d
-00003010: 6174 655f 6472 6f70 5a09 6d61 736b 5f64  ate_dropZ.mask_d
-00003020: 726f 705a 096d 6173 6b5f 6d61 736b 7212  ropZ.mask_maskr.
-00003030: 0000 00da 036b 6579 7292 0000 0072 9300  .....keyr....r..
-00003040: 0000 5a08 785f 756e 6971 7565 72a5 0000  ..Z.x_uniquer...
-00003050: 005a 0c63 6f6c 735f 7368 6966 745f 3172  .Z.cols_shift_1r
-00003060: 1300 0000 2904 7252 0000 0072 5100 0000  ....).rR...rQ...
-00003070: 72ab 0000 0072 aa00 0000 7214 0000 00da  r....r....r.....
-00003080: 046c 6f61 64d8 0000 0073 0601 0000 0002  .load....s......
-00003090: 0601 0801 0802 0801 0802 0801 0801 0801  ................
-000030a0: 0803 2201 1602 0e01 0e02 1003 0c01 1201  ..".............
-000030b0: 1801 1003 0201 0201 02fd 0405 0e03 0401  ................
-000030c0: 1201 1001 2401 2001 0e03 0c01 0e01 0401  ....$. .........
-000030d0: 1201 1602 0c01 0a01 2201 1001 1201 0e01  ........".......
-000030e0: 0801 0802 1a01 1402 1c01 1201 1801 1601  ................
-000030f0: 1c01 0a01 1a01 0c01 1403 0c01 1a01 0a01  ................
-00003100: 1801 2203 1201 1201 0a01 1801 1e01 0a01  ..".............
-00003110: 0e01 1801 1a02 0e05 0e01 1a01 1401 0e01  ................
-00003120: 1601 1e02 0c01 0c01 1403 0e02 2201 1602  ............"...
-00003130: 1402 2201 2602 0e01 1401 1403 1401 1401  ..".&...........
-00003140: 1201 2201 1401 2a01 1a02 1002 0801 0801  .."...*.........
-00003150: 0c01 0c01 0601 2601 2601 2603 0e01 1c01  ......&.&.&.....
-00003160: 1c01 1c01 1001 1a01 1201 0c01 0c01 0a01  ................
-00003170: 0a01 1c02 1001 0a01 0e01 0e01 0601 4a01  ..............J.
-00003180: 1603 0e01 0c01 1401 2401 1001 0801 1401  ........$.......
-00003190: 1801 2a02 7a0d 4261 7365 4461 7461 2e6c  ..*.z.BaseData.l
-000031a0: 6f61 6429 024e 5429 05da 085f 5f6e 616d  oad).NT)...__nam
-000031b0: 655f 5fda 0a5f 5f6d 6f64 756c 655f 5fda  e__..__module__.
-000031c0: 0c5f 5f71 7561 6c6e 616d 655f 5f72 9500  .__qualname__r..
-000031d0: 0000 72b7 0000 0072 1300 0000 7213 0000  ..r....r....r...
-000031e0: 0072 1300 0000 7214 0000 0072 8f00 0000  .r....r....r....
-000031f0: d400 0000 7304 0000 0008 0108 0372 8f00  ....s........r..
-00003200: 0000 2901 722f 0000 0029 0154 291f 72ad  ..).r/...).T).r.
-00003210: 0000 00da 056e 756d 7079 7230 0000 00da  .....numpyr0....
-00003220: 0670 616e 6461 7372 6700 0000 da06 706f  .pandasrg.....po
-00003230: 6c61 7273 7243 0000 005a 0f63 6f72 652e  larsrC...Z.core.
-00003240: 4461 7461 4d61 7374 6572 7203 0000 005a  DataMasterr....Z
-00003250: 0975 7469 6c2e 7574 696c 7204 0000 0072  .util.utilr....r
-00003260: 0500 0000 7206 0000 005a 0875 7469 6c2e  ....r....Z.util.
-00003270: 6e70 7972 0700 0000 5a0e 7574 696c 2e6e  npyr....Z.util.n
-00003280: 7079 5f6e 756d 6261 7208 0000 0072 0900  py_numbar....r..
-00003290: 0000 5a07 7574 696c 2e64 6272 0a00 0000  ..Z.util.dbr....
-000032a0: 7245 0000 0072 1800 0000 5a0a 7574 696c  rE...r....Z.util
-000032b0: 2e63 6f6e 7374 721e 0000 0072 1f00 0000  .constr....r....
-000032c0: 7228 0000 0072 2e00 0000 7261 0000 0072  r(...r....ra...r
-000032d0: 6c00 0000 728e 0000 0072 8f00 0000 7213  l...r....r....r.
-000032e0: 0000 0072 1300 0000 7213 0000 0072 1400  ...r....r....r..
-000032f0: 0000 da08 3c6d 6f64 756c 653e 0100 0000  ....<module>....
-00003300: 7324 0000 0008 0108 0108 0108 010c 0114  s$..............
-00003310: 010c 0110 010c 0104 0108 020c 010c 0308  ................
-00003320: 0708 080a 3e08 100a 66                   ....>...f
+00000500: 0000 00da 0054 6307 0000 0000 0000 0000  .....Tc.........
+00000510: 0000 0027 0000 0009 0000 0003 0000 0073  ...'...........s
+00000520: 2603 0000 7c01 7c02 6702 8900 8701 6601  &...|.|.g.....f.
+00000530: 6401 6402 8408 8800 4400 8301 7d07 6403  d.d.....D...}.d.
+00000540: 6402 8400 7c07 4400 8301 7d08 7400 7c07  d...|.D...}.t.|.
+00000550: 8800 6404 8d02 7d09 7c09 a001 8801 8800  ..d...}.|.......
+00000560: 1900 6a02 a003 a100 a101 7d09 7404 a005  ..j.......}.t...
+00000570: 7c09 a101 7d0a 7404 a005 8801 8800 7c03  |...}.t.......|.
+00000580: 1700 6405 6701 1700 1900 a101 7d0b 7c0a  ..d.g.......}.|.
+00000590: 6a06 7c0b 8800 6406 6407 8d03 7d0c 7c0a  j.|...d.d...}.|.
+000005a0: 8800 1900 7d0d 7407 a008 7c0c 6405 1900  ....}.t...|.d...
+000005b0: a009 a100 a00a 7c08 a101 a101 7d0e 7c04  ......|.....}.|.
+000005c0: 4400 9001 5d72 7d0f 7c06 72b6 740b 6408  D...]r}.|.r.t.d.
+000005d0: 7c0f 9b00 9d02 8301 0100 740c 7c0f 8301  |.........t.|...
+000005e0: 6409 6b02 72ea 7c0f 5c03 7d10 7d11 7d12  d.k.r.|.\.}.}.}.
+000005f0: 7407 a008 7c0c 7c10 1900 a009 a100 a00a  t...|.|.........
+00000600: 7c08 a101 a101 7d13 7c13 7d14 6e3c 7c0f  |.....}.|.}.n<|.
+00000610: 5c04 7d10 7d11 7d12 7d15 7407 a008 7c0c  \.}.}.}.}.t...|.
+00000620: 7c10 1900 a009 a100 a00a 7c08 a101 a101  |.........|.....
+00000630: 7d13 7407 a008 7c0c 7c15 1900 a009 a100  }.t...|.|.......
+00000640: a00a 7c08 a101 a101 7d14 740d 7c11 8301  ..|.....}.t.|...
+00000650: 740d 7c12 8301 0200 7d11 7d12 740e 7c0e  t.|.....}.}.t.|.
+00000660: 640a 740f 7c11 7c12 8302 1400 8302 7d16  d.t.|.|.......}.
+00000670: 640b 7c16 7407 a010 7c16 a101 3c00 7411  d.|.t...|...<.t.
+00000680: 7412 7c11 7c12 8302 640b 1700 740f 7c11  t.|.|...d...t.|.
+00000690: 7c12 8302 8302 4400 5d2a 7d17 740e 7c0e  |.....D.]*}.t.|.
+000006a0: 640a 7c17 1400 8302 7d18 640b 7c18 7407  d.|.....}.d.|.t.
+000006b0: a010 7c18 a101 3c00 7c16 7c18 1400 7d16  ..|...<.|.|...}.
+000006c0: 9001 7174 640b 7c16 7407 a010 7c16 a101  ..qtd.|.t...|...
+000006d0: 3c00 740e 7c13 640a 7c11 1400 8302 7d19  <.t.|.d.|.....}.
+000006e0: 740e 7c14 640a 7c12 1400 8302 7d1a 7c16  t.|.d.|.....}.|.
+000006f0: 7c1a 1400 7c19 1b00 640b 1800 7d1b 7407  |...|...d...}.t.
+00000700: 6a13 7c1b 7407 a014 7c1b a101 0f00 3c00  j.|.t...|.....<.
+00000710: 7415 7c0f 8301 7d1c 7c0d a016 7404 a017  t.|...}.|...t...
+00000720: 7c1c 7c1b a018 a100 a001 7407 6a19 a101  |.|.......t.j...
+00000730: a102 a101 7d0d 719e 7c0b 8800 1900 7d1d  ....}.q.|.....}.
+00000740: 7c1d 6a06 7c0d 8800 6406 6407 8d03 7d1e  |.j.|...d.d...}.
+00000750: 7c1e 7d1f 740c 7c05 8301 640c 6b04 9003  |.}.t.|...d.k...
+00000760: 720a 7c05 a01a 640d a101 7d20 7c20 640c  r.|...d...} | d.
+00000770: 1900 7c20 640b 6400 8502 1900 0200 7d21  ..| d.d.......}!
+00000780: 7d22 640e 6402 8400 7c22 4400 8301 7d22  }"d.d...|"D...}"
+00000790: 7c21 640f 7600 9002 7288 7c1f 7c22 640c  |!d.v...r.|.|"d.
+000007a0: 1900 1900 a009 a100 7d23 6e70 7c21 6410  ........}#np|!d.
+000007b0: 7600 9002 72a8 7c1f 7c22 1900 a009 a100  v...r.|.|"......
+000007c0: 6a1b 640b 6411 8d01 7d23 6e50 7c21 6412  j.d.d...}#nP|!d.
+000007d0: 7600 9002 72ea 7c1f 7c22 640c 1900 1900  v...r.|.|"d.....
+000007e0: a009 a100 7d24 7c1f 7c22 640b 1900 1900  ....}$|.|"d.....
+000007f0: a009 a100 7d25 7407 a01c 7c24 7c25 1400  ....}%t...|$|%..
+00000800: 640c 6b04 7c24 640c a103 7d23 6e0e 741d  d.k.|$d...}#n.t.
+00000810: 6413 7c21 9b00 9d02 8301 8201 7c1f a016  d.|!........|...
+00000820: 7404 a017 6414 7c23 a102 a101 7d1f 8700  t...d.|#....}...
+00000830: 6601 6415 6402 8408 7c1f 6a1e 4400 8301  f.d.d...|.j.D...
+00000840: 7d26 7c1f 7c26 6602 5300 2916 4e63 0100  }&|.|&f.S.).Nc..
+00000850: 0000 0000 0000 0000 0000 0200 0000 0600  ................
+00000860: 0000 1300 0000 731e 0000 0067 007c 005d  ......s....g.|.]
+00000870: 167d 0174 00a0 0188 007c 0119 00a0 02a1  .}.t.....|......
+00000880: 00a1 0191 0271 0453 0072 1300 0000 2903  .....q.S.r....).
+00000890: da02 6e70 da04 736f 7274 da06 756e 6971  ..np..sort..uniq
+000008a0: 7565 a902 7211 0000 00da 0363 6f6c 2901  ue..r......col).
+000008b0: da02 6466 7213 0000 0072 1400 0000 da0a  ..dfr....r......
+000008c0: 3c6c 6973 7463 6f6d 703e 2200 0000 7216  <listcomp>"...r.
+000008d0: 0000 007a 2667 6574 5f64 665f 6c61 6265  ...z&get_df_labe
+000008e0: 6c5f 6669 6e61 6c2e 3c6c 6f63 616c 733e  l_final.<locals>
+000008f0: 2e3c 6c69 7374 636f 6d70 3e63 0100 0000  .<listcomp>c....
+00000900: 0000 0000 0000 0000 0200 0000 0400 0000  ................
+00000910: 5300 0000 7314 0000 0067 007c 005d 0c7d  S...s....g.|.].}
+00000920: 0174 007c 0183 0191 0271 0453 0072 1300  .t.|.....q.S.r..
+00000930: 0000 2901 722a 0000 0072 1000 0000 7213  ..).r*...r....r.
+00000940: 0000 0072 1300 0000 7214 0000 0072 3600  ...r....r....r6.
+00000950: 0000 2300 0000 7216 0000 00a9 01da 0763  ..#...r........c
+00000960: 6f6c 735f 6964 da03 4144 4ada 046c 6566  ols_id..ADJ..lef
+00000970: 7429 02da 026f 6eda 0368 6f77 7a28 5b2b  t)...on..howz([+
+00000980: 5d20 6765 745f 6466 5f6c 6162 656c 5f66  ] get_df_label_f
+00000990: 696e 616c 2e63 6f6c 5f6c 6162 656c 5f61  inal.col_label_a
+000009a0: 7267 7320 3d20 7202 0000 00e9 ffff ffff  rgs = r.........
+000009b0: 7221 0000 0072 0100 0000 da02 5f5f 6301  r!...r......__c.
+000009c0: 0000 0000 0000 0000 0000 0002 0000 0005  ................
+000009d0: 0000 0053 0000 0073 1800 0000 6700 7c00  ...S...s....g.|.
+000009e0: 5d10 7d01 7400 7401 7c01 8301 8301 9102  ].}.t.t.|.......
+000009f0: 7104 5300 7213 0000 0029 0272 2e00 0000  q.S.r....).r....
+00000a00: 7228 0000 0072 1000 0000 7213 0000 0072  r(...r....r....r
+00000a10: 1300 0000 7214 0000 0072 3600 0000 5000  ....r....r6...P.
+00000a20: 0000 7216 0000 0029 015a 0352 4157 2901  ..r....).Z.RAW).
+00000a30: 5a03 4144 44a9 01da 0461 7869 7329 015a  Z.ADD....axis).Z
+00000a40: 034d 554c 7a1b 6c61 6265 6c5f 6672 6f6d  .MULz.label_from
+00000a50: 5f73 7472 2065 7272 6f72 2c20 6f70 203d  _str error, op =
+00000a60: 20da 0e4c 4142 454c 5f46 524f 4d5f 5354   ..LABEL_FROM_ST
+00000a70: 5263 0100 0000 0000 0000 0000 0000 0200  Rc..............
+00000a80: 0000 0400 0000 1300 0000 7318 0000 0067  ..........s....g
+00000a90: 007c 005d 107d 017c 0188 0076 0172 047c  .|.].}.|...v.r.|
+00000aa0: 0191 0271 0453 0072 1300 0000 7213 0000  ...q.S.r....r...
+00000ab0: 0072 3300 0000 7237 0000 0072 1300 0000  .r3...r7...r....
+00000ac0: 7214 0000 0072 3600 0000 5b00 0000 7216  r....r6...[...r.
+00000ad0: 0000 0029 1f72 0700 0000 da06 6173 7479  ...).r......asty
+00000ae0: 7065 5a06 6474 7970 6573 5a07 746f 5f64  peZ.dtypesZ.to_d
+00000af0: 6963 74da 0270 6c5a 0b66 726f 6d5f 7061  ict..plZ.from_pa
+00000b00: 6e64 6173 721a 0000 0072 3000 0000 5a11  ndasr....r0...Z.
+00000b10: 6173 636f 6e74 6967 756f 7573 6172 7261  ascontiguousarra
+00000b20: 79da 0874 6f5f 6e75 6d70 795a 0772 6573  y..to_numpyZ.res
+00000b30: 6861 7065 da05 7072 696e 7472 2a00 0000  hape..printr*...
+00000b40: 7227 0000 0072 0800 0000 da03 6d61 78da  r'...r......max.
+00000b50: 0569 736e 616e da05 7261 6e67 65da 036d  .isnan..range..m
+00000b60: 696e da03 6e61 6eda 0869 7366 696e 6974  in..nan..isfinit
+00000b70: 6572 2e00 0000 5a0c 7769 7468 5f63 6f6c  er....Z.with_col
+00000b80: 756d 6e73 da06 5365 7269 6573 5a05 7261  umns..SeriesZ.ra
+00000b90: 7665 6c5a 0766 6c6f 6174 3332 7226 0000  velZ.float32r&..
+00000ba0: 00da 046d 6561 6eda 0577 6865 7265 da13  ...mean..where..
+00000bb0: 4e6f 7449 6d70 6c65 6d65 6e74 6564 4572  NotImplementedEr
+00000bc0: 726f 72da 0763 6f6c 756d 6e73 2927 7235  ror..columns)'r5
+00000bd0: 0000 00da 0763 6f6c 5f74 6964 da06 636f  .....col_tid..co
+00000be0: 6c5f 6964 da0a 636f 6c73 5f70 7269 6365  l_id..cols_price
+00000bf0: da13 636f 6c5f 6c61 6265 6c5f 6172 6773  ..col_label_args
+00000c00: 5f6c 6973 74da 0e6c 6162 656c 5f66 726f  _list..label_fro
+00000c10: 6d5f 7374 72da 0776 6572 626f 7365 5a07  m_str..verboseZ.
+00000c20: 6964 5f6c 6973 74da 0573 6861 7065 5a09  id_list..shapeZ.
+00000c30: 6466 5f69 645f 616c 6c5a 055f 6466 5f4c  df_id_allZ._df_L
+00000c40: 5a05 5f64 665f 525a 0664 665f 4c5f 525a  Z._df_RZ.df_L_RZ
+00000c50: 065f 6466 5f4c 325a 0561 5f61 646a 722d  ._df_L2Z.a_adjr-
+00000c60: 0000 0072 3400 0000 da01 69da 016a da01  ...r4.....i..j..
+00000c70: 615a 0261 325a 0463 6f6c 325a 0361 646a  aZ.a2Z.col2Z.adj
+00000c80: 5a02 696a 5a06 6164 6a5f 696a 5a03 615f  Z.ijZ.adj_ijZ.a_
+00000c90: 695a 0361 5f6a 5a05 615f 6932 6ada 046e  iZ.a_jZ.a_i2j..n
+00000ca0: 616d 655a 065f 6466 5f52 325a 095f 6466  ameZ._df_R2Z._df
+00000cb0: 5f52 325f 4c32 da0e 6466 5f6c 6162 656c  _R2_L2..df_label
+00000cc0: 5f66 696e 616c da02 7373 da02 6f70 da04  _final..ss..op..
+00000cd0: 636f 6c73 7212 0000 005a 0278 30da 0278  colsr....Z.x0..x
+00000ce0: 31da 0a63 6f6c 735f 6c61 6265 6c72 1300  1..cols_labelr..
+00000cf0: 0000 2902 7238 0000 0072 3500 0000 7214  ..).r8...r5...r.
+00000d00: 0000 00da 1267 6574 5f64 665f 6c61 6265  .....get_df_labe
+00000d10: 6c5f 6669 6e61 6c20 0000 0073 6800 0000  l_final ...sh...
+00000d20: 0001 0801 1201 0e01 0c01 1402 0a01 1801  ................
+00000d30: 1002 0801 1801 0a01 1201 0c01 0a01 1801  ................
+00000d40: 0602 0c01 1801 1801 1202 1401 0e01 1e01  ................
+00000d50: 0e01 0e01 0c01 0e02 0e01 0e01 1001 1201  ................
+00000d60: 0801 2002 0801 1001 0403 0e01 0a01 1601  .. .............
+00000d70: 0e01 0a01 1201 0a01 1601 0a01 1001 1001  ................
+00000d80: 1801 0e01 1201 1401 7262 0000 0063 0200  ........rb...c..
+00000d90: 0000 0000 0000 0000 0000 0800 0000 0500  ................
+00000da0: 0000 4300 0000 73c0 0000 007c 0164 0119  ..C...s....|.d..
+00000db0: 00a0 00a1 007d 027c 0064 0119 00a0 00a1  .....}.|.d......
+00000dc0: 007d 037c 037c 037c 0264 0219 006b 0419  .}.|.|.|.d...k..
+00000dd0: 007d 037c 017c 0164 0119 007c 0264 0219  .}.|.|.d...|.d..
+00000de0: 006b 0219 006a 0164 0364 048d 017d 0474  .k...j.d.d...}.t
+00000df0: 027c 0383 0164 056b 0272 547c 0153 0067  .|...d.k.rT|.S.g
+00000e00: 007d 0574 0364 067c 039b 009d 0283 0101  .}.t.d.|........
+00000e10: 007c 0344 005d 1e7d 067c 04a0 04a1 007d  .|.D.].}.|.....}
+00000e20: 077c 067c 0764 013c 007c 05a0 057c 07a1  .|.|.d.<.|...|..
+00000e30: 0101 0071 6a74 066a 077c 0564 0564 078d  ...qjt.j.|.d.d..
+00000e40: 026a 0164 0364 048d 017d 0774 066a 077c  .j.d.d...}.t.j.|
+00000e50: 017c 0767 0264 0564 0864 098d 036a 0164  .|.g.d.d.d...j.d
+00000e60: 0364 048d 017d 017c 0153 0029 0a4e 5a0a  .d...}.|.S.).NZ.
+00000e70: 7472 6164 655f 6461 7465 723d 0000 0054  trade_dater=...T
+00000e80: a901 da04 6472 6f70 7201 0000 007a 115b  ....dropr....z.[
+00000e90: 2b5d 2064 6174 6573 5f74 6f64 6f20 3d20  +] dates_todo = 
+00000ea0: 723f 0000 0046 2902 7240 0000 0072 3100  r?...F).r@...r1.
+00000eb0: 0000 2908 7232 0000 00da 0b72 6573 6574  ..).r2.....reset
+00000ec0: 5f69 6e64 6578 722a 0000 0072 4500 0000  _indexr*...rE...
+00000ed0: da04 636f 7079 da06 6170 7065 6e64 da02  ..copy..append..
+00000ee0: 7064 da06 636f 6e63 6174 2908 da04 6466  pd..concat)...df
+00000ef0: 5f4c da04 6466 5f52 5a0a 6461 7465 735f  _L..df_RZ.dates_
+00000f00: 6861 7665 5a0a 6461 7465 735f 746f 646f  haveZ.dates_todo
+00000f10: 5a09 6466 5f52 5f6c 6173 745a 0c64 665f  Z.df_R_lastZ.df_
+00000f20: 6e65 7874 5f6c 6973 74da 0464 6174 655a  next_list..dateZ
+00000f30: 0764 665f 6e65 7874 7213 0000 0072 1300  .df_nextr....r..
+00000f40: 0000 7214 0000 00da 0d64 665f 6578 7061  ..r......df_expa
+00000f50: 6e64 5f4c 5f52 5e00 0000 731c 0000 0000  nd_L_R^...s.....
+00000f60: 010c 010c 0110 011c 0110 0104 010e 0108  ................
+00000f70: 0108 0108 010c 0116 011c 0172 6d00 0000  ...........rm...
+00000f80: 6305 0000 0000 0000 0000 0000 0022 0000  c............"..
+00000f90: 000d 0000 0043 0000 0073 f604 0000 7c01  .....C...s....|.
+00000fa0: a000 7c02 7c03 6702 6401 6402 6702 1700  ..|.|.g.d.d.g...
+00000fb0: a101 7d05 7401 7c00 7c04 6403 8d02 7d06  ..}.t.|.|.d...}.
+00000fc0: 7c06 a002 a100 0100 7c02 7c03 6702 7d07  |.......|.|.g.}.
+00000fd0: 7c05 7c07 1900 7d08 6404 7d09 7c06 6a03  |.|...}.d.}.|.j.
+00000fe0: 6405 7c03 6701 7c09 6701 1700 6406 8d02  d.|.g.|.g...d...
+00000ff0: 7d0a 7c0a 7c0a 6404 1900 6407 6b04 1900  }.|.|.d...d.k...
+00001000: 6a04 6408 6409 8d01 7d0a 7405 7c08 7c0a  j.d.d...}.t.|.|.
+00001010: 7c03 6701 8303 7c09 1900 a006 a100 7d0b  |.g...|.......}.
+00001020: 640a 7d09 7c06 6a03 640b 7c07 7c09 6701  d.}.|.j.d.|.|.g.
+00001030: 1700 6406 8d02 7d0a 7407 7c08 7c0a 8302  ..d...}.t.|.|...
+00001040: 7d0a 7405 7c08 7c0a 7c07 8303 640a 1900  }.t.|.|.|...d...
+00001050: a006 a100 a008 6407 a101 7d0c 640c 7d09  ......d...}.d.}.
+00001060: 7c06 6a03 640d 7c07 7c09 6701 1700 6406  |.j.d.|.|.g...d.
+00001070: 8d02 7d0a 7407 7c08 7c0a 8302 7d0a 7405  ..}.t.|.|...}.t.
+00001080: 7c08 7c0a 7c07 8303 640c 1900 a006 a100  |.|.|...d.......
+00001090: a008 6407 a101 7d0d 7c05 7c07 6401 6402  ..d...}.|.|.d.d.
+000010a0: 6702 1700 1900 7d0e 7c0b 7c0e 6404 3c00  g.....}.|.|.d.<.
+000010b0: 7c0c 7c0e 640a 3c00 7c0d 7c0e 640c 3c00  |.|.d.<.|.|.d.<.
+000010c0: 7c0e 7c02 1900 a009 a100 6a04 6408 6409  |.|.......j.d.d.
+000010d0: 8d01 7d0f 740a 740b 7c0f 740c 6a0d 7c0f  ..}.t.t.|.t.j.|.
+000010e0: 640e 640f 8d02 8302 8301 7d10 7c0e 6404  d.d.......}.|.d.
+000010f0: 1900 a009 a100 6a04 6408 6409 8d01 7d0f  ......j.d.d...}.
+00001100: 740a 740b 7c0f 740c 6a0d 7c0f 640e 640f  t.t.|.t.j.|.d.d.
+00001110: 8d02 8302 8301 7d11 7c0e 7c02 1900 a00e  ......}.|.|.....
+00001120: 7c10 a101 7c0e 6404 1900 a00e 7c11 a101  |...|.d.....|...
+00001130: 1800 6a0f 6a10 6410 6b05 7d12 7c0e 6401  ..j.j.d.k.}.|.d.
+00001140: 1900 a011 a100 0f00 7d13 7c0e 640a 1900  ........}.|.d...
+00001150: 6407 6b01 7d14 7c0e 640c 1900 6411 6b01  d.k.}.|.d...d.k.
+00001160: 7d15 6412 7c03 9b00 6413 7c02 9b00 6414  }.d.|...d.|...d.
+00001170: 9d05 6415 7c03 9b00 6413 7c02 9b00 6416  ..d.|...d.|...d.
+00001180: 9d05 6417 7c03 9b00 6413 7c02 9b00 6418  ..d.|...d.|...d.
+00001190: 9d05 6419 7c03 9b00 641a 7c02 9b00 6414  ..d.|...d.|...d.
+000011a0: 9d05 641b 7c03 9b00 641a 7c02 9b00 6416  ..d.|...d.|...d.
+000011b0: 9d05 641c 7c03 9b00 641a 7c02 9b00 6418  ..d.|...d.|...d.
+000011c0: 9d05 641d 7c03 9b00 641e 7c02 9b00 6414  ..d.|...d.|...d.
+000011d0: 9d05 641f 7c03 9b00 641e 7c02 9b00 6416  ..d.|...d.|...d.
+000011e0: 9d05 6420 7c03 9b00 641e 7c02 9b00 6418  ..d |...d.|...d.
+000011f0: 9d05 6709 7d16 7c01 6a12 7c16 6421 6403  ..g.}.|.j.|.d!d.
+00001200: 8d02 0100 7c01 a013 6422 a101 6423 6b01  ....|...d"..d#k.
+00001210: 7d17 7c17 7c01 a013 6424 a101 6423 6b01  }.|.|...d$..d#k.
+00001220: 4d00 7d17 7c17 7c01 a013 6425 a101 6423  M.}.|.|...d%..d#
+00001230: 6b01 4d00 7d17 7414 a015 7c01 a013 6426  k.M.}.t...|...d&
+00001240: a101 7c01 a013 6427 a101 1b00 6411 1800  ..|...d'....d...
+00001250: a101 6428 6b01 7d18 7c18 7414 a015 7c01  ..d(k.}.|.t...|.
+00001260: a013 6429 a101 7c01 a013 642a a101 1b00  ..d)..|...d*....
+00001270: 6411 1800 a101 6428 6b01 4d00 7d18 7c18  d.....d(k.M.}.|.
+00001280: 7414 a015 7c01 a013 642b a101 7c01 a013  t...|...d+..|...
+00001290: 642c a101 1b00 6411 1800 a101 6428 6b01  d,....d.....d(k.
+000012a0: 4d00 7d18 7414 a015 7c01 a013 6426 a101  M.}.t...|...d&..
+000012b0: 7c01 a013 6427 a101 1800 6407 1800 a101  |...d'....d.....
+000012c0: 642d 6b01 7d19 7c19 7414 a015 7c01 a013  d-k.}.|.t...|...
+000012d0: 6429 a101 7c01 a013 642a a101 1800 6407  d)..|...d*....d.
+000012e0: 1800 a101 642d 6b01 4d00 7d19 7c19 7414  ....d-k.M.}.|.t.
+000012f0: a015 7c01 a013 642b a101 7c01 a013 642c  ..|...d+..|...d,
+00001300: a101 1800 6407 1800 a101 642d 6b01 4d00  ....d.....d-k.M.
+00001310: 7d19 7c01 6a16 7c16 6421 6403 8d02 0100  }.|.j.|.d!d.....
+00001320: 7c17 7c18 4200 7c19 4200 0f00 7d1a 7c05  |.|.B.|.B...}.|.
+00001330: 7c03 1900 a017 a100 7d1b 740c a018 7c1b  |.......}.t...|.
+00001340: a101 a019 741a a101 642e 6b01 7d1c 7c05  ....t...d.k.}.|.
+00001350: 7c03 1900 a00e 740a 740b 7c1b 7c1c 8302  |.....t.t.|.|...
+00001360: 8301 a101 6408 6b02 7d1d 7c04 9003 72da  ....d.k.}.|...r.
+00001370: 741b 642f 8301 0100 7c14 a01c 7414 6a1d  t.d/....|...t.j.
+00001380: a101 7c0e 6430 3c00 7c13 7c12 4000 7c14  ..|.d0<.|.|.@.|.
+00001390: 4000 7c15 4000 a01c 7414 6a1d a101 7c0e  @.|.@...t.j...|.
+000013a0: 6431 3c00 7c04 9004 7222 741b 6432 7c0e  d1<.|...r"t.d2|.
+000013b0: 6431 1900 a01e a100 9b00 9d02 8301 0100  d1..............
+000013c0: 7c04 9004 7240 741b 6432 7c0e 6431 1900  |...r@t.d2|.d1..
+000013d0: a01e a100 9b00 6433 9d03 8301 0100 7c0e  ......d3......|.
+000013e0: 6431 1900 7c1d 4000 a01c 7414 6a1d a101  d1..|.@...t.j...
+000013f0: 7c0e 6431 3c00 7c04 9004 7276 741b 6432  |.d1<.|...rvt.d2
+00001400: 7c0e 6431 1900 a01e a100 9b00 6434 9d03  |.d1........d4..
+00001410: 8301 0100 7c0e 6402 1900 a011 a100 7d1e  ....|.d.......}.
+00001420: 7c14 6411 6b02 7c0e 6402 1900 a015 a100  |.d.k.|.d.......
+00001430: 6435 6b01 4000 7d1f 7c14 6407 6b02 7c0e  d5k.@.}.|.d.k.|.
+00001440: 6402 1900 a015 a100 6436 6b01 4000 7d20  d.......d6k.@.} 
+00001450: 7c1f 7c20 4200 7c1e 4200 a01c 7414 6a1d  |.| B.|.B...t.j.
+00001460: a101 7c0e 6437 3c00 7c0e 6431 1900 7c0e  ..|.d7<.|.d1..|.
+00001470: 6437 1900 4000 7c0e 6438 3c00 6700 6439  d7..@.|.d8<.g.d9
+00001480: a201 7d21 7c06 a01f a100 0100 7c0e 7c21  ..}!|.......|.|!
+00001490: 6602 5300 293a 4eda 046f 7065 6e5a 0770  f.S.):N..openZ.p
+000014a0: 6374 5f63 6867 a901 7256 0000 005a 096c  ct_chg..rV...Z.l
+000014b0: 6973 745f 6461 7465 5a0c 6466 5f6c 6973  ist_dateZ.df_lis
+000014c0: 745f 6461 7465 2901 725f 0000 0072 0100  t_date).r_...r..
+000014d0: 0000 5472 6300 0000 5a02 5354 5a05 6466  ..Trc...Z.STZ.df
+000014e0: 5f73 745a 0353 5553 5a06 6466 5f73 7573  _stZ.SUSZ.df_sus
+000014f0: 7a06 2559 256d 2564 2901 722b 0000 00e9  z.%Y%m%d).r+....
+00001500: 1400 0000 7221 0000 007a 195f 5f54 454d  ....r!...z.__TEM
+00001510: 505f 615f 3120 3d20 726f 6c6c 2873 6869  P_a_1 = roll(shi
+00001520: 6674 2c20 7a0a 2c20 616d 6f75 6e74 2c20  ft, z., amount, 
+00001530: 7a04 2c20 3029 7a19 5f5f 5445 4d50 5f61  z., 0)z.__TEMP_a
+00001540: 5f32 203d 2072 6f6c 6c28 7368 6966 742c  _2 = roll(shift,
+00001550: 20fa 042c 2031 297a 195f 5f54 454d 505f   .., 1)z.__TEMP_
+00001560: 615f 3320 3d20 726f 6c6c 2873 6869 6674  a_3 = roll(shift
+00001570: 2c20 7a04 2c20 3229 7a19 5f5f 5445 4d50  , z., 2)z.__TEMP
+00001580: 5f68 5f31 203d 2072 6f6c 6c28 7368 6966  _h_1 = roll(shif
+00001590: 742c 207a 082c 2068 6967 682c 207a 195f  t, z., high, z._
+000015a0: 5f54 454d 505f 685f 3220 3d20 726f 6c6c  _TEMP_h_2 = roll
+000015b0: 2873 6869 6674 2c20 7a19 5f5f 5445 4d50  (shift, z.__TEMP
+000015c0: 5f68 5f33 203d 2072 6f6c 6c28 7368 6966  _h_3 = roll(shif
+000015d0: 742c 207a 195f 5f54 454d 505f 6c5f 3120  t, z.__TEMP_l_1 
+000015e0: 3d20 726f 6c6c 2873 6869 6674 2c20 7a07  = roll(shift, z.
+000015f0: 2c20 6c6f 772c 207a 195f 5f54 454d 505f  , low, z.__TEMP_
+00001600: 6c5f 3220 3d20 726f 6c6c 2873 6869 6674  l_2 = roll(shift
+00001610: 2c20 7a19 5f5f 5445 4d50 5f6c 5f33 203d  , z.__TEMP_l_3 =
+00001620: 2072 6f6c 6c28 7368 6966 742c 2046 5a0a   roll(shift, FZ.
+00001630: 5f5f 5445 4d50 5f61 5f31 6700 0000 00d0  __TEMP_a_1g.....
+00001640: 1253 415a 0a5f 5f54 454d 505f 615f 325a  .SAZ.__TEMP_a_2Z
+00001650: 0a5f 5f54 454d 505f 615f 335a 0a5f 5f54  .__TEMP_a_3Z.__T
+00001660: 454d 505f 685f 315a 0a5f 5f54 454d 505f  EMP_h_1Z.__TEMP_
+00001670: 6c5f 3167 fca9 f1d2 4d62 603f 5a0a 5f5f  l_1g....Mb`?Z.__
+00001680: 5445 4d50 5f68 5f32 5a0a 5f5f 5445 4d50  TEMP_h_2Z.__TEMP
+00001690: 5f6c 5f32 5a0a 5f5f 5445 4d50 5f68 5f33  _l_2Z.__TEMP_h_3
+000016a0: 5a0a 5f5f 5445 4d50 5f6c 5f33 677b 14ae  Z.__TEMP_l_3g{..
+000016b0: 47e1 7aa4 3f72 0200 0000 7a16 5b2b 5d20  G.z.?r....z.[+] 
+000016c0: 5354 2c20 4b4a 592c 205a 4454 2c20 4d41  ST, KJY, ZDT, MA
+000016d0: 534b da07 4d41 534b 5f53 54da 084d 4153  SK..MASK_ST..MAS
+000016e0: 4b5f 4b4a 597a 205b 2b5d 2064 665f 6d61  K_KJYz [+] df_ma
+000016f0: 736b 5b27 4d41 534b 5f4b 4a59 275d 2e73  sk['MASK_KJY'].s
+00001700: 756d 2829 203d 207a 172c 2061 6674 6572  um() = z., after
+00001710: 2026 3d20 6d61 736b 5f6b 6a79 5f74 7672   &= mask_kjy_tvr
+00001720: 7a16 2c20 6166 7465 7220 263d 206d 6173  z., after &= mas
+00001730: 6b5f 6b6a 795f 6964 6700 0000 0000 0023  k_kjy_idg......#
+00001740: 4067 0000 0000 0000 1340 da08 4d41 534b  @g.......@..MASK
+00001750: 5f5a 4454 da04 4d41 534b a904 7272 0000  _ZDT..MASK..rr..
+00001760: 0072 7300 0000 7274 0000 0072 7500 0000  .rs...rt...ru...
+00001770: 2920 da0f 6765 745f 636f 6c73 5f70 616e  ) ..get_cols_pan
+00001780: 6461 7372 0a00 0000 da07 636f 6e6e 6563  dasr......connec
+00001790: 74da 0673 656c 6563 7472 6500 0000 7205  t..selectre...r.
+000017a0: 0000 005a 0974 6f5f 7061 6e64 6173 726d  ...Z.to_pandasrm
+000017b0: 0000 005a 0666 696c 6c6e 61da 0f64 726f  ...Z.fillna..dro
+000017c0: 705f 6475 706c 6963 6174 6573 da04 6469  p_duplicates..di
+000017d0: 6374 da03 7a69 7072 6800 0000 5a0b 746f  ct..ziprh...Z.to
+000017e0: 5f64 6174 6574 696d 65da 036d 6170 da02  _datetime..map..
+000017f0: 6474 da04 6461 7973 5a06 6973 6e75 6c6c  dt..daysZ.isnull
+00001800: da05 6665 5f67 6fda 0d67 6574 5f63 6f6c  ..fe_go..get_col
+00001810: 5f6e 756d 7079 7230 0000 00da 0361 6273  _numpyr0.....abs
+00001820: 7264 0000 0072 3200 0000 724c 0000 00da  rd...r2...rL....
+00001830: 0561 7070 6c79 7206 0000 0072 4500 0000  .applyr....rE...
+00001840: 7242 0000 00da 0569 6e74 3332 da03 7375  rB.....int32..su
+00001850: 6dda 0563 6c6f 7365 2922 da07 7061 7468  m..close)"..path
+00001860: 5f64 62da 0264 6d72 5100 0000 7252 0000  _db..dmrQ...rR..
+00001870: 0072 5600 0000 7235 0000 005a 0264 62da  .rV...r5...Z.db.
+00001880: 046b 6579 7372 6a00 0000 7234 0000 0072  .keysrj...r4...r
+00001890: 6b00 0000 5a0b 735f 6c69 7374 5f64 6174  k...Z.s_list_dat
+000018a0: 655a 0473 5f73 745a 0573 5f73 7573 da07  eZ.s_stZ.s_sus..
+000018b0: 6466 5f6d 6173 6bda 0173 5a0b 6461 7465  df_mask..sZ.date
+000018c0: 5f64 6963 745f 315a 0b64 6174 655f 6469  _dict_1Z.date_di
+000018d0: 6374 5f32 5a06 6964 785f 3230 5a07 6964  ct_2Z.idx_20Z.id
+000018e0: 785f 6e61 6e5a 0669 6478 5f73 745a 0769  x_nanZ.idx_stZ.i
+000018f0: 6478 5f73 7573 da09 6e61 6d65 5f6c 6973  dx_sus..name_lis
+00001900: 745a 0569 6478 5f61 5a0d 6964 785f 696e  tZ.idx_aZ.idx_in
+00001910: 7472 615f 7265 745a 0d69 6478 5f69 6e74  tra_retZ.idx_int
+00001920: 7261 5f64 6966 5a0c 6d61 736b 5f6b 6a79  ra_difZ.mask_kjy
+00001930: 5f74 7672 5a04 6964 5f6b 5a04 6964 5f76  _tvrZ.id_kZ.id_v
+00001940: 5a0b 6d61 736b 5f6b 6a79 5f69 645a 0c6d  Z.mask_kjy_idZ.m
+00001950: 6173 6b5f 7a64 745f 6e61 6e5a 0b6d 6173  ask_zdt_nanZ.mas
+00001960: 6b5f 7a64 745f 3130 5a0b 6d61 736b 5f7a  k_zdt_10Z.mask_z
+00001970: 6474 5f73 74da 0963 6f6c 735f 6d61 736b  dt_st..cols_mask
+00001980: 7213 0000 0072 1300 0000 7214 0000 00da  r....r....r.....
+00001990: 0b67 6574 5f64 665f 6d61 736b 6e00 0000  .get_df_maskn...
+000019a0: 738a 0000 0000 0116 010c 0108 0208 0108  s...............
+000019b0: 0304 0116 0118 0116 0304 0114 010a 011a  ................
+000019c0: 0304 0114 010a 011a 0410 0108 0108 0108  ................
+000019d0: 0214 0118 0114 0118 0324 010e 010c 010c  .........$......
+000019e0: 0410 0110 0110 0210 0110 0110 0210 0110  ................
+000019f0: 0110 f504 0d0e 010e 0112 0112 0222 0126  .............".&
+00001a00: 0126 0222 0126 0126 010e 010e 070c 0114  .&.".&.&........
+00001a10: 011c 030e 0110 021c 011c 021e 0118 011e  ................
+00001a20: 020c 0118 0118 0118 0114 0108 0108 0172  ...............r
+00001a30: 8e00 0000 6300 0000 0000 0000 0000 0000  ....c...........
+00001a40: 0000 0000 0003 0000 0040 0000 0073 1e00  .........@...s..
+00001a50: 0000 6500 5a01 6400 5a02 6401 6402 8400  ..e.Z.d.Z.d.d...
+00001a60: 5a03 6407 6405 6406 8401 5a04 6403 5300  Z.d.d.d...Z.d.S.
+00001a70: 2908 da08 4261 7365 4461 7461 6305 0000  )...BaseDatac...
+00001a80: 0000 0000 0000 0000 0005 0000 0002 0000  ................
+00001a90: 0043 0000 0073 0c00 0000 7400 6401 8301  .C...s....t.d...
+00001aa0: 8201 6400 5300 2902 4e7a 1e79 6f75 206e  ..d.S.).Nz.you n
+00001ab0: 6565 6420 746f 2069 6d70 6c65 6d65 6e74  eed to implement
+00001ac0: 2067 6574 5f64 6628 2929 0172 4f00 0000   get_df()).rO...
+00001ad0: 2905 da04 7365 6c66 da0a 7061 7468 5f69  )...self..path_i
+00001ae0: 6e70 7574 da0a 6461 7465 5f62 6567 696e  nput..date_begin
+00001af0: da08 6461 7465 5f65 6e64 da06 6e5f 6a6f  ..date_end..n_jo
+00001b00: 6273 7213 0000 0072 1300 0000 7214 0000  bsr....r....r...
+00001b10: 00da 0667 6574 5f64 66d5 0000 0073 0200  ...get_df....s..
+00001b20: 0000 0001 7a0f 4261 7365 4461 7461 2e67  ....z.BaseData.g
+00001b30: 6574 5f64 664e 5463 0400 0000 0000 0000  et_dfNTc........
+00001b40: 0000 0000 2600 0000 0b00 0000 0300 0000  ....&...........
+00001b50: 73ac 0900 0074 006a 017d 047c 0164 0119  s....t.j.}.|.d..
+00001b60: 007d 057c 0164 0219 007d 067c 0164 0319  .}.|.d...}.|.d..
+00001b70: 007d 077c 0164 0419 007d 087c 0764 0519  .}.|.d...}.|.d..
+00001b80: 0089 007c 0764 0619 007d 097c 0764 0719  ...|.d...}.|.d..
+00001b90: 007d 0a7c 0764 0819 0089 017c 0264 0075  .}.|.d.....|.d.u
+00001ba0: 0072 767c 006a 027c 0467 017c 0564 0919  .rv|.j.|.g.|.d..
+00001bb0: 00a2 017c 0691 0152 0064 0a7c 08a0 0364  ...|...R.d.|...d
+00001bc0: 0a64 0ba1 0269 018e 017d 0264 0c74 0474  .d...i...}.d.t.t
+00001bd0: 057c 0283 0183 0176 0072 8c7c 027d 0b6e  .|.....v.r.|.}.n
+00001be0: 1c7c 026a 0664 0b64 0b64 0d8d 0201 0074  .|.j.d.d.d.....t
+00001bf0: 077c 0264 0e64 0b64 0f8d 037d 0b7c 0b6a  .|.d.d.d...}.|.j
+00001c00: 0888 0167 0164 0e64 108d 0201 007c 0372  ...g.d.d.....|.r
+00001c10: c474 0964 1183 0101 0064 1288 009b 0064  .t.d.....d.....d
+00001c20: 1388 019b 0064 149d 057d 0c7c 0b6a 0864  .....d...}.|.j.d
+00001c30: 157c 0c9b 0064 169d 0367 017c 0364 108d  .|...d...g.|.d..
+00001c40: 0201 007c 0b6a 0a7c 0c67 0164 0e64 108d  ...|.j.|.g.d.d..
+00001c50: 0201 0064 1764 1867 027d 0d64 197c 0ba0  ...d.d.g.}.d.|..
+00001c60: 0ba1 006a 0c76 0190 0172 207c 0d64 1a67  ...j.v...r |.d.g
+00001c70: 0137 007d 0d7c 0b6a 087c 0d64 0e64 108d  .7.}.|.j.|.d.d..
+00001c80: 0201 0067 007d 0d67 0064 1ba2 0164 1c67  ...g.}.g.d...d.g
+00001c90: 0117 0044 005d 567d 0c64 1d7c 0ba0 0ba1  ...D.]V}.d.|....
+00001ca0: 006a 0c76 0190 0172 787c 0d64 1e7c 0c9b  .j.v...rx|.d.|..
+00001cb0: 0064 1f88 009b 0064 207c 0c9b 0064 2088  .d.....d |...d .
+00001cc0: 019b 0064 149d 0967 0137 007d 0d7c 0d7c  ...d...g.7.}.|.|
+00001cd0: 0c9b 0064 217c 0c9b 0064 207c 0c9b 0064  ...d!|...d |...d
+00001ce0: 229d 0667 0137 007d 0d90 0171 407c 0b6a  "..g.7.}...q@|.j
+00001cf0: 087c 0d64 0e64 108d 0201 007c 08a0 0364  .|.d.d.....|...d
+00001d00: 2364 24a1 027d 0e74 0d7c 0e83 0164 256b  #d$..}.t.|...d%k
+00001d10: 0490 0172 ec64 267d 0f7c 0ea0 0e64 27a1  ...r.d&}.|...d'.
+00001d20: 0164 2864 0085 0219 007d 1074 0fa0 1064  .d(d.....}.t...d
+00001d30: 2964 2a84 007c 1044 0083 01a1 017d 116e  )d*..|.D.....}.n
+00001d40: 3874 117c 0864 2b19 0083 017d 0f7c 0864  8t.|.d+....}.|.d
+00001d50: 2b19 0067 017d 1074 0fa0 1064 2c64 2a84  +..g.}.t...d,d*.
+00001d60: 007c 0fa0 0e64 2da1 0164 2e64 2f85 0219  .|...d-..d.d/...
+00001d70: 0044 0083 01a1 017d 117c 107c 08a0 0364  .D.....}.|.|...d
+00001d80: 3067 00a1 0237 007d 1064 3164 2a84 007c  0g...7.}.d1d*..|
+00001d90: 1044 0083 017d 1074 1274 13a0 147c 10a1  .D...}.t.t...|..
+00001da0: 01a0 15a1 0083 017d 107c 107c 0864 303c  .......}.|.|.d0<
+00001db0: 007c 0f7c 0864 323c 007c 0390 0272 7e74  .|.|.d2<.|...r~t
+00001dc0: 0964 337c 0e9b 0064 347c 0f9b 009d 0483  .d3|...d4|......
+00001dd0: 0101 007c 0390 0272 9274 0964 357c 109b  ...|...r.t.d5|..
+00001de0: 009d 0283 0101 0064 3664 2a84 007c 1044  .......d6d*..|.D
+00001df0: 0083 0164 3764 2a84 007c 1044 0083 0117  ...d7d*..|.D....
+00001e00: 007d 1274 1274 13a0 147c 12a1 01a0 15a1  .}.t.t...|......
+00001e10: 0083 017d 127c 0ba0 1688 0188 0067 027c  ...}.|.......g.|
+00001e20: 1217 0064 3867 0117 00a1 017d 0274 177c  ...d8g.....}.t.|
+00001e30: 0288 0188 007c 127c 107c 0e7c 08a0 0364  .....|.|.|.|...d
+00001e40: 0a64 0ba1 0264 108d 075c 027d 137d 147c  .d...d...\.}.}.|
+00001e50: 1444 005d 167d 0c7c 0ba0 187c 0c7c 137c  .D.].}.|...|.|.|
+00001e60: 0c19 00a1 0201 0090 0271 fe7c 1464 3967  .........q.|.d9g
+00001e70: 0137 007d 1464 3a7c 0ba0 0ba1 006a 0c76  .7.}.d:|.....j.v
+00001e80: 0090 0372 3a7c 1464 3a67 0137 007d 147c  ...r:|.d:g.7.}.|
+00001e90: 147c 0164 0319 0064 3b3c 007c 0390 0372  .|.d...d;<.|...r
+00001ea0: 5a74 0964 3c7c 149b 009d 0283 0101 007c  Zt.d<|.........|
+00001eb0: 08a0 0364 3d64 00a1 027d 157c 0390 0372  ...d=d...}.|...r
+00001ec0: 8074 0964 3e7c 159b 0064 347c 0f9b 009d  .t.d>|...d4|....
+00001ed0: 0483 0101 007c 1564 3f6b 0290 0372 e87c  .....|.d?k...r.|
+00001ee0: 0b6a 0864 407c 0f9b 0064 229d 0367 017c  .j.d@|...d"..g.|
+00001ef0: 0364 108d 0201 007c 0b6a 087c 099b 0064  .d.....|.j.|...d
+00001f00: 4188 019b 0064 207c 0f9b 0064 229d 0667  A....d |...d"..g
+00001f10: 017c 0364 108d 0201 0087 0166 0164 4264  .|.d.......f.dBd
+00001f20: 2a84 087c 1444 0083 017d 0d7c 0b6a 087c  *..|.D...}.|.j.|
+00001f30: 0d7c 0364 2e64 438d 0301 006e 987c 1564  .|.d.dC....n.|.d
+00001f40: 446b 0290 0472 287c 0b6a 0864 407c 0f9b  Dk...r(|.j.d@|..
+00001f50: 0064 229d 0367 017c 0364 108d 0201 007c  .d"..g.|.d.....|
+00001f60: 0b6a 087c 099b 0064 457c 0f9b 0064 229d  .j.|...dE|...d".
+00001f70: 0467 017c 0364 108d 0201 006e 587c 1564  .g.|.d.....nX|.d
+00001f80: 466b 0290 0472 727c 0390 0472 4074 0964  Fk...rr|...r@t.d
+00001f90: 4783 0101 007c 0b6a 0864 407c 099b 0064  G....|.j.d@|...d
+00001fa0: 229d 0367 017c 0364 108d 0201 007c 097c  "..g.|.d.....|.|
+00001fb0: 0ba0 0ba1 006a 0c76 0090 0473 804a 0064  .....j.v...s.J.d
+00001fc0: 4883 0182 016e 0e74 1964 3e7c 159b 009d  H....n.t.d>|....
+00001fd0: 0283 0182 017c 0390 0472 8e74 0964 4983  .....|...r.t.dI.
+00001fe0: 0101 0074 1a6a 1ba0 1c74 1a6a 1ba0 1d7c  ...t.j...t.j...|
+00001ff0: 04a1 01a1 019b 0064 4a9d 027d 167c 0390  .......dJ..}.|..
+00002000: 0472 bc74 0964 4b7c 169b 009d 0283 0101  .r.t.dK|........
+00002010: 0074 1a6a 1ba0 1e7c 16a1 0190 0472 fe74  .t.j...|.....r.t
+00002020: 1f7c 167c 0b88 0188 007c 0364 108d 055c  .|.|.....|.d...\
+00002030: 027d 177d 187c 1844 005d 167d 0c7c 0ba0  .}.}.|.D.].}.|..
+00002040: 187c 0c7c 177c 0c19 00a1 0201 0090 0471  .|.|.|.........q
+00002050: e46e 0c67 0064 4ca2 0104 007d 187d 187c  .n.g.dL....}.}.|
+00002060: 187c 0164 0319 0064 4d3c 007c 0390 0572  .|.d...dM<.|...r
+00002070: 2a74 0964 4e7c 189b 009d 0283 0101 0074  *t.dN|.........t
+00002080: 1a6a 1ba0 1e7c 16a1 0190 0572 8474 0fa0  .j...|.....r.t..
+00002090: 207c 0b6a 2164 4f19 007c 0919 00a0 22a1   |.j!dO..|....".
+000020a0: 00a1 010f 00a0 2374 0f6a 24a1 017d 197c  ......#t.j$..}.|
+000020b0: 197c 0b6a 2164 4f19 0064 5019 00a0 22a1  .|.j!dO..dP...".
+000020c0: 004d 007d 197c 0b6a 2164 4f19 0064 5119  .M.}.|.j!dO..dQ.
+000020d0: 00a0 22a1 007d 1a6e 5674 0fa0 207c 0b6a  .."..}.nVt.. |.j
+000020e0: 2164 4f19 007c 0919 00a0 22a1 00a1 010f  !dO..|....".....
+000020f0: 00a0 2374 0f6a 24a1 017d 197c 1974 0fa0  ..#t.j$..}.|.t..
+00002100: 207c 0b6a 2164 4f19 0064 5219 00a0 22a1   |.j!dO..dR...".
+00002110: 00a1 010f 00a0 2374 0f6a 24a1 014d 007d  ......#t.j$..M.}
+00002120: 197c 0ba0 2564 53a1 0164 286b 027d 1a7c  .|..%dS..d(k.}.|
+00002130: 0ba0 267c 19a0 2374 0f6a 24a1 0164 54a1  ..&|..#t.j$..dT.
+00002140: 0201 007c 0ba0 267c 1aa0 2374 0f6a 24a1  ...|..&|..#t.j$.
+00002150: 0164 55a1 0201 0064 0e90 0672 b674 1a6a  .dU....d...r.t.j
+00002160: 1ba0 1e7c 16a1 0190 0672 b67c 0ba0 0864  ...|.....r.|...d
+00002170: 5688 019b 0064 579d 0367 01a1 0101 007c  V....dW..g.....|
+00002180: 0b6a 1664 5888 019b 009d 0264 598d 017d  .j.dX......dY..}
+00002190: 1b7c 1b7c 1b64 5688 019b 0064 579d 0319  .|.|.dV....dW...
+000021a0: 00a0 27a1 0064 5a6b 0419 0088 0119 006a  ..'..dZk.......j
+000021b0: 287d 1c7c 1c7c 1c7c 0564 0919 0064 2819  (}.|.|.|.d...d(.
+000021c0: 006b 0119 007d 1c74 0964 5b74 0d7c 1c83  .k...}.t.d[t.|..
+000021d0: 019b 0064 5c64 20a0 2964 5d64 5e84 007c  ...d\d .)d]d^..|
+000021e0: 1c44 0083 01a1 019b 0064 5f9d 0583 0101  .D.......d_.....
+000021f0: 007c 0ba0 2a88 01a1 01a0 2b74 2c7c 1c83  .|..*.....+t,|..
+00002200: 01a1 010f 006a 287d 1d6e 1074 0fa0 2d7c  .....j(}.n.t..-|
+00002210: 19a1 01a0 2374 2ea1 017d 1d7c 197c 1a40  ....#t...}.|.|.@
+00002220: 007d 1e7c 1e7c 1d4d 007d 1e7c 0ba0 267c  .}.|.|.M.}.|..&|
+00002230: 1e64 53a1 0201 007c 0ba0 1864 607c 1ea1  .dS....|...d`|..
+00002240: 0201 007c 0390 0772 6674 0964 617c 19a0  ...|...rft.da|..
+00002250: 2fa1 009b 0064 6274 0d7c 1983 019b 0064  /....dbt.|.....d
+00002260: 637c 19a0 30a1 009b 009d 0683 0101 0074  c|..0..........t
+00002270: 0964 647c 1aa0 2fa1 009b 0064 6274 0d7c  .dd|../....dbt.|
+00002280: 1a83 019b 0064 637c 1aa0 30a1 009b 009d  .....dc|..0.....
+00002290: 0683 0101 0074 0964 657c 1ea0 2fa1 009b  .....t.de|../...
+000022a0: 0064 6274 0d7c 1e83 019b 0064 637c 1ea0  .dbt.|.....dc|..
+000022b0: 30a1 009b 009d 0683 0101 0064 667c 05a0  0..........df|..
+000022c0: 31a1 0076 0190 0772 d864 677c 05a0 31a1  1..v...r.dg|..1.
+000022d0: 0076 0090 0772 907c 0564 6719 007c 0564  .v...r.|.dg..|.d
+000022e0: 663c 006e 4864 687c 05a0 31a1 0076 0090  f<.nHdh|..1..v..
+000022f0: 0772 ac7c 0564 6819 007c 0564 663c 006e  .r.|.dh..|.df<.n
+00002300: 2c64 097c 05a0 31a1 0076 0090 0772 c87c  ,d.|..1..v...r.|
+00002310: 0564 0919 007c 0564 663c 006e 1074 1964  .d...|.df<.n.t.d
+00002320: 697c 059b 0064 6a9d 0383 0182 017c 0390  i|...dj......|..
+00002330: 0772 f274 0964 6b7c 119b 0064 347c 0f9b  .r.t.dk|...d4|..
+00002340: 009d 0483 0101 007c 0b6a 2164 4f19 0088  .......|.j!dO...
+00002350: 0119 00a0 22a1 007d 1f7c 05a0 31a1 0044  ...."..}.|..1..D
+00002360: 005d da7d 207c 057c 2019 005c 027d 217d  .].} |.| ..\.}!}
+00002370: 227c 2064 6c76 0090 0872 4c74 0fa0 327c  "| dlv...rLt..2|
+00002380: 1fa1 017d 2374 0fa0 337c 237c 237c 226b  ...}#t..3|#|#|"k
+00002390: 0119 00a1 0164 287c 1117 000b 0019 007d  .....d(|.......}
+000023a0: 227c 1f7c 216b 057c 1f7c 226b 0140 007d  "|.|!k.|.|"k.@.}
+000023b0: 247c 2064 6d6b 0390 0872 747c 247c 1ea0  $| dmk...rt|$|..
+000023c0: 2374 2ea1 014d 007d 247c 0b6a 267c 247c  #t...M.}$|.j&|$|
+000023d0: 2064 6e8d 0201 007c 0390 0872 0c74 0d7c   dn....|...r.t.|
+000023e0: 1f7c 2419 0083 0164 256b 0490 0872 d274  .|$....d%k...r.t
+000023f0: 0964 6f7c 2064 709b 0464 717c 1f7c 2419  .do| dp..dq|.|$.
+00002400: 00a0 34a1 009b 0064 727c 1f7c 2419 00a0  ..4....dr|.|$...
+00002410: 10a1 009b 0064 637c 24a0 2fa1 009b 009d  .....dc|$./.....
+00002420: 0883 0101 006e 1274 0964 6f7c 2064 709b  .....n.t.do| dp.
+00002430: 0464 739d 0383 0101 0090 0871 0c7c 0390  .ds........q.|..
+00002440: 0872 f674 0964 7483 0101 007c 08a0 0364  .r.t.dt....|...d
+00002450: 7564 28a1 0289 037c 0390 0972 1674 0964  ud(....|...r.t.d
+00002460: 7688 039b 009d 0283 0101 0088 0088 017c  v..............|
+00002470: 0967 037c 0a17 007c 1417 007c 1817 007c  .g.|...|...|...|
+00002480: 08a0 0364 7764 00a1 0267 0117 0089 0288  ...dwd...g......
+00002490: 027c 08a0 0364 7867 00a1 0237 0089 0288  .|...dxg...7....
+000024a0: 027c 0864 783c 007c 0390 0972 6674 0964  .|.dx<.|...rft.d
+000024b0: 7988 029b 009d 0283 0101 0087 0266 0164  y............f.d
+000024c0: 7a64 2a84 087c 0ba0 0ba1 006a 0c44 0083  zd*..|.....j.D..
+000024d0: 017d 2588 0364 256b 0390 0972 a87c 0b6a  .}%..d%k...r.|.j
+000024e0: 0887 0087 0187 0366 0364 7b64 2a84 087c  .......f.d{d*..|
+000024f0: 2544 0083 017c 0364 108d 0201 007c 0b53  %D...|.d.....|.S
+00002500: 0029 7c4e da09 6461 7465 5f64 6963 7472  .)|N..date_dictr
+00002510: 9400 0000 da09 636f 6c73 5f64 6963 74da  ......cols_dict.
+00002520: 0a6f 7468 6572 5f69 6e66 6f72 5200 0000  .other_inforR...
+00002530: da09 636f 6c5f 6c61 6265 6cda 0863 6f6c  ..col_label..col
+00002540: 735f 7469 6472 5100 0000 da03 616c 6c72  s_tidrQ.....allr
+00002550: 5600 0000 5472 0300 0000 2902 7264 0000  V...Tr....).rd..
+00002560: 005a 0769 6e70 6c61 6365 4629 0272 5600  .Z.inplaceF).rV.
+00002570: 0000 5a0a 6b65 6570 5f73 7061 6365 726f  ..Z.keep_spacero
+00002580: 0000 007a 255b 696e 6974 5d20 3c2d 2d2d  ...z%[init] <---
+00002590: 2d2d 2d2d 2d2d 2d20 6c61 6265 6c20 2d2d  ------- label --
+000025a0: 2d2d 2d2d 2d2d 2d2d 3e20 7a0c 726f 6c6c  --------> z.roll
+000025b0: 2873 6869 6674 2c20 7a0a 2c20 636c 6f73  (shift, z., clos
+000025c0: 652c 2020 7271 0000 007a 0a41 444a 203d  e,  rq...z.ADJ =
+000025d0: 2064 6976 287a 0c2c 2070 7265 5f63 6c6f   div(z., pre_clo
+000025e0: 7365 297a 1776 7761 7020 3d20 6469 7628  se)z.vwap = div(
+000025f0: 616d 6f75 6e74 2c20 766f 6c29 7a25 6d65  amount, vol)z%me
+00002600: 616e 203d 206d 6561 6e5f 6d28 6f70 656e  an = mean_m(open
+00002610: 2c20 6869 6768 2c20 6c6f 772c 2063 6c6f  , high, low, clo
+00002620: 7365 29da 0474 7761 707a 0e74 7761 7020  se)..twapz.twap 
+00002630: 3d20 6f28 7677 6170 2929 0472 9c00 0000  = o(vwap)).r....
+00002640: 5a04 7677 6170 726e 0000 0072 8600 0000  Z.vwaprn...r....
+00002650: 724d 0000 007a 0970 7265 5f7b 636f 6c7d  rM...z.pre_{col}
+00002660: 5a04 7072 655f fa0f 203d 2072 6f6c 6c28  Z.pre_.. = roll(
+00002670: 7368 6966 742c 20fa 022c 207a 0f5f 7265  shift, .., z._re
+00002680: 7420 3d20 7265 7428 7072 655f fa01 2972  t = ret(pre_..)r
+00002690: 5500 0000 722f 0000 0072 0100 0000 7241  U...r/...r....rA
+000026a0: 0000 0072 3e00 0000 7221 0000 0063 0100  ...r>...r!...c..
+000026b0: 0000 0000 0000 0000 0000 0200 0000 0700  ................
+000026c0: 0000 5300 0000 7322 0000 0067 007c 005d  ..S...s"...g.|.]
+000026d0: 1a7d 0174 00a0 0174 027c 0183 0164 0064  .}.t...t.|...d.d
+000026e0: 0185 0219 00a1 0191 0271 0453 0029 0272  .........q.S.).r
+000026f0: 2100 0000 7202 0000 0029 0372 3000 0000  !...r....).r0...
+00002700: 7246 0000 0072 2800 0000 7210 0000 0072  rF...r(...r....r
+00002710: 1300 0000 7213 0000 0072 1400 0000 7236  ....r....r....r6
+00002720: 0000 0009 0100 0072 1600 0000 7a21 4261  .......r....z!Ba
+00002730: 7365 4461 7461 2e6c 6f61 642e 3c6c 6f63  seData.load.<loc
+00002740: 616c 733e 2e3c 6c69 7374 636f 6d70 3e72  als>.<listcomp>r
+00002750: 2d00 0000 6301 0000 0000 0000 0000 0000  -...c...........
+00002760: 0002 0000 0004 0000 0053 0000 0073 1400  .........S...s..
+00002770: 0000 6700 7c00 5d0c 7d01 7400 7c01 8301  ..g.|.].}.t.|...
+00002780: 9102 7104 5300 7213 0000 0029 0172 2700  ..q.S.r....).r'.
+00002790: 0000 7210 0000 0072 1300 0000 7213 0000  ..r....r....r...
+000027a0: 0072 1400 0000 7236 0000 000d 0100 0072  .r....r6.......r
+000027b0: 1600 0000 da01 5f72 2200 0000 7229 0000  ......_r"...r)..
+000027c0: 0072 5400 0000 6301 0000 0000 0000 0000  .rT...c.........
+000027d0: 0000 0002 0000 0004 0000 0053 0000 0073  ...........S...s
+000027e0: 1400 0000 6700 7c00 5d0c 7d01 7400 7c01  ....g.|.].}.t.|.
+000027f0: 8301 9102 7104 5300 7213 0000 0029 0172  ....q.S.r....).r
+00002800: 2800 0000 7210 0000 0072 1300 0000 7213  (...r....r....r.
+00002810: 0000 0072 1400 0000 7236 0000 000f 0100  ...r....r6......
+00002820: 0072 1600 0000 da0e 636f 6c5f 6c61 6265  .r......col_labe
+00002830: 6c5f 6672 6f6d 7a15 5b2b 5d20 6c61 6265  l_fromz.[+] labe
+00002840: 6c5f 6672 6f6d 5f73 7472 203d 207a 132c  l_from_str = z.,
+00002850: 2063 6f6c 5f6c 6162 656c 5f66 726f 6d20   col_label_from 
+00002860: 3d20 7a1a 5b2b 5d20 636f 6c5f 6c61 6265  = z.[+] col_labe
+00002870: 6c5f 6172 6773 5f6c 6973 7420 3d20 6301  l_args_list = c.
+00002880: 0000 0000 0000 0000 0000 0002 0000 0004  ................
+00002890: 0000 0053 0000 0073 1400 0000 6700 7c00  ...S...s....g.|.
+000028a0: 5d0c 7d01 7c01 6400 1900 9102 7104 5300  ].}.|.d.....q.S.
+000028b0: 2901 7201 0000 0072 1300 0000 7210 0000  ).r....r....r...
+000028c0: 0072 1300 0000 7213 0000 0072 1400 0000  .r....r....r....
+000028d0: 7236 0000 0017 0100 0072 1600 0000 6301  r6.......r....c.
+000028e0: 0000 0000 0000 0000 0000 0002 0000 0005  ................
+000028f0: 0000 0053 0000 0073 2400 0000 6700 7c00  ...S...s$...g.|.
+00002900: 5d1c 7d01 7400 7c01 6400 1900 8301 7401  ].}.t.|.d.....t.
+00002910: 7500 7204 7c01 6400 1900 9102 7104 5300  u.r.|.d.....q.S.
+00002920: 2901 723d 0000 0029 0272 2300 0000 720f  ).r=...).r#...r.
+00002930: 0000 0072 1000 0000 7213 0000 0072 1300  ...r....r....r..
+00002940: 0000 7214 0000 0072 3600 0000 1701 0000  ..r....r6.......
+00002950: 7216 0000 0072 3900 0000 da09 4c41 4245  r....r9.....LABE
+00002960: 4c5f 5241 57da 056c 6162 656c 7261 0000  L_RAW..labelra..
+00002970: 007a 115b 2b5d 2063 6f6c 735f 6c61 6265  .z.[+] cols_labe
+00002980: 6c20 3d20 da0b 665f 6c61 6265 6c5f 7072  l = ..f_label_pr
+00002990: 657a 125b 2b5d 2066 5f6c 6162 656c 5f70  ez.[+] f_label_p
+000029a0: 7265 203d 205a 0863 737a 7363 6f72 657a  re = Z.cszscorez
+000029b0: 0e4c 4142 454c 5f52 4157 203d 206f 287a  .LABEL_RAW = o(z
+000029c0: 0f20 3d20 6167 6728 7a73 636f 7265 2c20  . = agg(zscore, 
+000029d0: 6301 0000 0000 0000 0000 0000 0002 0000  c...............
+000029e0: 0007 0000 0013 0000 0073 2600 0000 6700  .........s&...g.
+000029f0: 7c00 5d1e 7d01 7c01 6400 7601 7204 6401  |.].}.|.d.v.r.d.
+00002a00: 8800 9b00 6402 7c01 9b00 6403 9d05 9102  ....d.|...d.....
+00002a10: 7104 5300 2904 2901 72a2 0000 007a 0c61  q.S.).).r....z.a
+00002a20: 6767 287a 7363 6f72 652c 2072 9e00 0000  gg(zscore, r....
+00002a30: 729f 0000 0072 1300 0000 7233 0000 0029  r....r....r3...)
+00002a40: 0172 5100 0000 7213 0000 0072 1400 0000  .rQ...r....r....
+00002a50: 7236 0000 0029 0100 0072 1600 0000 2902  r6...)...r....).
+00002a60: 7256 0000 005a 096b 6565 705f 6e61 6d65  rV...Z.keep_name
+00002a70: da06 6f72 6967 696e 7a05 203d 206f 285a  ..originz. = o(Z
+00002a80: 0565 7869 7374 7a3c 5b2b 5d20 7261 7720  .existz<[+] raw 
+00002a90: 6c61 6265 6c20 6672 6f6d 2064 6d2c 2028  label from dm, (
+00002aa0: 7768 6963 6820 6d65 616e 2065 7869 7374  which mean exist
+00002ab0: 2074 6869 7320 636f 6c75 6d6e 2c20 6c61   this column, la
+00002ac0: 6265 6c29 7a22 636f 6c5f 6c61 6265 6c20  bel)z"col_label 
+00002ad0: 3d20 7b63 6f6c 5f6c 6162 656c 7d20 6e6f  = {col_label} no
+00002ae0: 7420 696e 2064 6d21 7a25 5b69 6e69 745d  t in dm!z%[init]
+00002af0: 203c 2d2d 2d2d 2d2d 2d2d 2d2d 206d 6173   <---------- mas
+00002b00: 6b20 202d 2d2d 2d2d 2d2d 2d2d 2d3e 207a  k  ----------> z
+00002b10: 062f 727a 2e64 627a 0e5b 2b5d 2070 6174  ./rz.dbz.[+] pat
+00002b20: 685f 6462 203d 2072 7600 0000 728d 0000  h_db = rv...r...
+00002b30: 007a 105b 2b5d 2063 6f6c 735f 6d61 736b  .z.[+] cols_mask
+00002b40: 203d 205a 0254 3072 7300 0000 7274 0000   = Z.T0rs...rt..
+00002b50: 0072 6e00 0000 da04 6d61 736b 5a03 6b6a  .rn.....maskZ.kj
+00002b60: 795a 037a 6474 7a09 6770 286d 6561 6e2c  yZ.zdtz.gp(mean,
+00002b70: 207a 0c2c 204c 4142 454c 5f52 4157 297a   z., LABEL_RAW)z
+00002b80: 0354 302e 2901 5a07 6466 5f6e 616d 6567  .T0.).Z.df_nameg
+00002b90: b81e 85eb 51b8 9e3f 7a10 5b2b 5d20 6461  ....Q..?z.[+] da
+00002ba0: 7465 5f64 726f 7020 3d20 7a0e 0a64 6174  te_drop = z..dat
+00002bb0: 655f 6472 6f70 203d 205b 6301 0000 0000  e_drop = [c.....
+00002bc0: 0000 0000 0000 0002 0000 0003 0000 0073  ...............s
+00002bd0: 0000 0073 1600 0000 7c00 5d0e 7d01 7400  ...s....|.].}.t.
+00002be0: 7c01 8301 5600 0100 7102 6400 5300 720d  |...V...q.d.S.r.
+00002bf0: 0000 0072 0e00 0000 7210 0000 0072 1300  ...r....r....r..
+00002c00: 0000 7213 0000 0072 1400 0000 7215 0000  ..r....r....r...
+00002c10: 0058 0100 0072 1600 0000 7a20 4261 7365  .X...r....z Base
+00002c20: 4461 7461 2e6c 6f61 642e 3c6c 6f63 616c  Data.load.<local
+00002c30: 733e 2e3c 6765 6e65 7870 723e fa01 5d72  s>.<genexpr>..]r
+00002c40: 7500 0000 7a0b 5b2b 5d20 6b6a 7920 203d  u...z.[+] kjy  =
+00002c50: 207a 0320 2f20 7a03 203d 207a 0b5b 2b5d   z. / z. = z.[+]
+00002c60: 207a 6474 2020 3d20 7a0b 5b2b 5d20 6d61   zdt  = z.[+] ma
+00002c70: 736b 203d 20da 0468 6973 74da 0574 7261  sk = ..hist..tra
+00002c80: 696e 5a04 6c6f 6f6b 7a0c 6461 7465 5f64  inZ.lookz.date_d
+00002c90: 6963 7420 3d20 7a0b 2c20 6e65 6564 2068  ict = z., need h
+00002ca0: 6973 747a 0e5b 2b5d 2070 6164 6469 6e67  istz.[+] padding
+00002cb0: 203d 2029 0272 a900 0000 72a8 0000 00da   = ).r....r.....
+00002cc0: 0474 6573 7429 015a 096d 6173 6b5f 6e61  .test).Z.mask_na
+00002cd0: 6d65 7a10 5b2b 5d20 6d61 736b 5f6e 616d  mez.[+] mask_nam
+00002ce0: 6520 3d20 7a03 3c31 317a 027c 207a 0420  e = z.<11z.| z. 
+00002cf0: 2d3e 207a 097c 206c 656e 203d 2030 7a27  -> z.| len = 0z'
+00002d00: 5b69 6e69 745d 203c 2d2d 2d2d 2d2d 2d2d  [init] <--------
+00002d10: 2d2d 2073 6869 6674 5f69 202d 2d2d 2d2d  -- shift_i -----
+00002d20: 2d2d 2d2d 2d3e 20da 0773 6869 6674 5f69  -----> ..shift_i
+00002d30: 7a0e 5b2b 5d20 7368 6966 745f 6920 3d20  z.[+] shift_i = 
+00002d40: 5a08 636f 6c5f 6461 7465 da10 636f 6c73  Z.col_date..cols
+00002d50: 5f73 6869 6674 5f31 5f6e 6f74 7a17 5b2b  _shift_1_notz.[+
+00002d60: 5d20 636f 6c73 5f73 6869 6674 5f31 5f6e  ] cols_shift_1_n
+00002d70: 6f74 203d 2063 0100 0000 0000 0000 0000  ot = c..........
+00002d80: 0000 0200 0000 0400 0000 1300 0000 7318  ..............s.
+00002d90: 0000 0067 007c 005d 107d 017c 0188 0076  ...g.|.].}.|...v
+00002da0: 0172 047c 0191 0271 0453 0072 1300 0000  .r.|...q.S.r....
+00002db0: 7213 0000 0072 3300 0000 2901 72ac 0000  r....r3...).r...
+00002dc0: 0072 1300 0000 7214 0000 0072 3600 0000  .r....r....r6...
+00002dd0: 8401 0000 7216 0000 0063 0100 0000 0000  ....r....c......
+00002de0: 0000 0000 0000 0200 0000 0c00 0000 1300  ................
+00002df0: 0000 732e 0000 0067 007c 005d 267d 017c  ..s....g.|.]&}.|
+00002e00: 019b 0064 0088 009b 0064 017c 019b 0064  ...d.....d.|...d
+00002e10: 0188 019b 0064 0188 029b 0064 029d 0a91  .....d.....d....
+00002e20: 0271 0453 0029 0372 9d00 0000 729e 0000  .q.S.).r....r...
+00002e30: 0072 9f00 0000 7213 0000 0072 3300 0000  .r....r....r3...
+00002e40: 2903 7252 0000 0072 5100 0000 72ab 0000  ).rR...rQ...r...
+00002e50: 0072 1300 0000 7214 0000 0072 3600 0000  .r....r....r6...
+00002e60: 8501 0000 7216 0000 0029 3572 1e00 0000  ....r....)5r....
+00002e70: 5a09 5041 5448 5f44 4154 4172 9500 0000  Z.PATH_DATAr....
+00002e80: 7217 0000 0072 0f00 0000 7223 0000 0072  r....r....r#...r
+00002e90: 6500 0000 7203 0000 0072 8000 0000 7245  e...r....r....rE
+00002ea0: 0000 0072 6400 0000 da04 6865 6164 7250  ...rd.....headrP
+00002eb0: 0000 0072 2a00 0000 7226 0000 0072 3000  ...r*...r&...r0.
+00002ec0: 0000 7246 0000 0072 2e00 0000 7224 0000  ..rF...r....r$..
+00002ed0: 0072 6800 0000 724c 0000 0072 7a00 0000  .rh...rL...rz...
+00002ee0: 7277 0000 0072 6200 0000 5a0a 7365 745f  rw...rb...Z.set_
+00002ef0: 6279 5f63 6f6c 724f 0000 00da 026f 73da  by_colrO.....os.
+00002f00: 0470 6174 68da 0764 6972 6e61 6d65 da07  .path..dirname..
+00002f10: 6162 7370 6174 68da 0665 7869 7374 7372  abspath..existsr
+00002f20: 8e00 0000 7247 0000 005a 0764 665f 6469  ....rG...Z.df_di
+00002f30: 6374 7244 0000 0072 4200 0000 7284 0000  ctrD...rB...r...
+00002f40: 0072 8100 0000 5a08 7365 745f 6d61 736b  .r....Z.set_mask
+00002f50: 7282 0000 00da 0676 616c 7565 7372 1a00  r......valuesr..
+00002f60: 0000 5a0e 6765 745f 636f 6c5f 7061 6e64  ..Z.get_col_pand
+00002f70: 6173 5a04 6973 696e da03 7365 745a 096f  asZ.isin..setZ.o
+00002f80: 6e65 735f 6c69 6b65 da04 626f 6f6c 7285  nes_like..boolr.
+00002f90: 0000 0072 4d00 0000 7289 0000 0072 3200  ...rM...r....r2.
+00002fa0: 0000 7231 0000 0072 4900 0000 2926 7290  ..r1...rI...)&r.
+00002fb0: 0000 005a 0b64 6174 615f 636f 6e66 6967  ...Z.data_config
+00002fc0: 7235 0000 0072 5600 0000 7291 0000 0072  r5...rV...r....r
+00002fd0: 9600 0000 7294 0000 0072 9700 0000 7298  ....r....r....r.
+00002fe0: 0000 0072 9900 0000 729a 0000 0072 8800  ...r....r....r..
+00002ff0: 0000 7234 0000 0072 8c00 0000 7255 0000  ..r4...r....rU..
+00003000: 0072 a100 0000 7254 0000 00da 0770 6164  .r....rT.....pad
+00003010: 6469 6e67 7253 0000 0072 5c00 0000 7261  dingrS...r\...ra
+00003020: 0000 0072 a400 0000 7287 0000 0072 8a00  ...r....r....r..
+00003030: 0000 728d 0000 005a 086d 6173 6b5f 6b6a  ..r....Z.mask_kj
+00003040: 795a 086d 6173 6b5f 7a64 745a 0564 665f  yZ.mask_zdtZ.df_
+00003050: 6770 5a09 6461 7465 5f64 726f 705a 096d  gpZ.date_dropZ.m
+00003060: 6173 6b5f 6472 6f70 5a09 6d61 736b 5f6d  ask_dropZ.mask_m
+00003070: 6173 6b72 1200 0000 da03 6b65 7972 9200  askr......keyr..
+00003080: 0000 7293 0000 005a 0878 5f75 6e69 7175  ..r....Z.x_uniqu
+00003090: 6572 a600 0000 5a0c 636f 6c73 5f73 6869  er....Z.cols_shi
+000030a0: 6674 5f31 7213 0000 0029 0472 5200 0000  ft_1r....).rR...
+000030b0: 7251 0000 0072 ac00 0000 72ab 0000 0072  rQ...r....r....r
+000030c0: 1400 0000 da04 6c6f 6164 d800 0000 7306  ......load....s.
+000030d0: 0100 0000 0206 0108 0108 0208 0108 0208  ................
+000030e0: 0108 0108 0108 0330 0116 020e 010e 0210  .......0........
+000030f0: 030c 0112 0118 0110 0302 0102 fe04 041a  ................
+00003100: 010e 0304 0112 0110 0124 0120 010e 030c  .........$. ....
+00003110: 010e 0104 0112 0116 020c 010a 0122 0110  ............."..
+00003120: 010e 0112 0108 0108 021a 0114 021c 0112  ................
+00003130: 0118 0122 011c 010a 011a 010c 0114 030c  ..."............
+00003140: 011a 010a 0118 0122 0312 0112 010a 0118  ......."........
+00003150: 011e 010a 010e 0118 011a 020e 050e 011a  ................
+00003160: 0114 010e 0116 011e 020c 010c 0114 030e  ................
+00003170: 0222 0116 0214 0222 0126 020e 0114 0114  .".....".&......
+00003180: 0314 0114 0112 0122 0114 012a 011a 0210  ......."...*....
+00003190: 0208 0108 010c 010c 0106 0126 0126 0126  ...........&.&.&
+000031a0: 030e 011c 011c 011c 0110 011a 0112 010c  ................
+000031b0: 010c 010a 010a 011c 0210 010a 010e 010e  ................
+000031c0: 0106 014a 0116 030e 010c 0114 0124 0110  ...J.........$..
+000031d0: 0108 0114 0118 012a 027a 0d42 6173 6544  .......*.z.BaseD
+000031e0: 6174 612e 6c6f 6164 2902 4e54 2905 da08  ata.load).NT)...
+000031f0: 5f5f 6e61 6d65 5f5f da0a 5f5f 6d6f 6475  __name__..__modu
+00003200: 6c65 5f5f da0c 5f5f 7175 616c 6e61 6d65  le__..__qualname
+00003210: 5f5f 7295 0000 0072 b800 0000 7213 0000  __r....r....r...
+00003220: 0072 1300 0000 7213 0000 0072 1400 0000  .r....r....r....
+00003230: 728f 0000 00d4 0000 0073 0400 0000 0801  r........s......
+00003240: 0803 728f 0000 0029 0272 2f00 0000 5429  ..r....).r/...T)
+00003250: 0154 291f 72ae 0000 00da 056e 756d 7079  .T).r......numpy
+00003260: 7230 0000 00da 0670 616e 6461 7372 6800  r0.....pandasrh.
+00003270: 0000 da06 706f 6c61 7273 7243 0000 005a  ....polarsrC...Z
+00003280: 0f63 6f72 652e 4461 7461 4d61 7374 6572  .core.DataMaster
+00003290: 7203 0000 005a 0975 7469 6c2e 7574 696c  r....Z.util.util
+000032a0: 7204 0000 0072 0500 0000 7206 0000 005a  r....r....r....Z
+000032b0: 0875 7469 6c2e 6e70 7972 0700 0000 5a0e  .util.npyr....Z.
+000032c0: 7574 696c 2e6e 7079 5f6e 756d 6261 7208  util.npy_numbar.
+000032d0: 0000 0072 0900 0000 5a07 7574 696c 2e64  ...r....Z.util.d
+000032e0: 6272 0a00 0000 7245 0000 0072 1800 0000  br....rE...r....
+000032f0: 5a0a 7574 696c 2e63 6f6e 7374 721e 0000  Z.util.constr...
+00003300: 0072 1f00 0000 7228 0000 0072 2e00 0000  .r....r(...r....
+00003310: 7262 0000 0072 6d00 0000 728e 0000 0072  rb...rm...r....r
+00003320: 8f00 0000 7213 0000 0072 1300 0000 7213  ....r....r....r.
+00003330: 0000 0072 1400 0000 da08 3c6d 6f64 756c  ...r......<modul
+00003340: 653e 0100 0000 7324 0000 0008 0108 0108  e>....s$........
+00003350: 0108 010c 0114 010c 0110 010c 0104 0108  ................
+00003360: 020c 010c 0308 0708 080a 3e08 100a 66    ..........>...f
```

## runningz/fe/prepare_data/base_data_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Thu May  9 16:27:50 2024 UTC, .py size: 19709 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 86f9 3c66 fd4c 0000  a.........<f.L..
+00000000: 610d 0d0a 0000 0000 8512 4e66 9d4d 0000  a.........Nf.M..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
@@ -10,15 +10,15 @@
 00000090: 0000 0000 0000 0000 0004 0000 0008 0000  ................
 000000a0: 0043 0000 0073 5c00 0000 7400 6a01 a002  .C...s\...t.j...
 000000b0: 7403 a101 6401 1700 7c00 1700 7d01 6402  t...d...|...}.d.
 000000c0: 7d02 7c02 a004 6403 6404 a102 7d02 7405  }.|...d.d...}.t.
 000000d0: 7c01 6405 8302 8f1a 7d03 7c03 a006 7c02  |.d.....}.|...|.
 000000e0: a101 0100 5700 6400 0400 0400 8303 0100  ....W.d.........
 000000f0: 6e10 3100 734e 3000 0100 0100 0100 5900  n.1.sN0.......Y.
-00000100: 0100 6400 5300 2906 4efa 012f 7558 4b00  ..d.S.).N../uXK.
+00000100: 0100 6400 5300 2906 4efa 012f 75f8 4b00  ..d.S.).N../u.K.
 00000110: 0069 6d70 6f72 7420 6f73 0a69 6d70 6f72  .import os.impor
 00000120: 7420 6e75 6d70 7920 6173 206e 700a 696d  t numpy as np.im
 00000130: 706f 7274 2070 616e 6461 7320 6173 2070  port pandas as p
 00000140: 640a 696d 706f 7274 2070 6f6c 6172 7320  d.import polars 
 00000150: 6173 2070 6c0a 6672 6f6d 202e 2e2e 636f  as pl.from ...co
 00000160: 7265 2e44 6174 614d 6173 7465 7220 696d  re.DataMaster im
 00000170: 706f 7274 2044 6174 614d 6173 7465 720a  port DataMaster.
@@ -85,1165 +85,1175 @@
 00000540: 6f6c 5f6c 6162 656c 5f61 7267 737d 2729  ol_label_args}')
 00000550: 0a20 2020 0a64 6566 2067 6574 5f64 665f  .   .def get_df_
 00000560: 6c61 6265 6c5f 6669 6e61 6c28 6466 2c20  label_final(df, 
 00000570: 636f 6c5f 7469 642c 2063 6f6c 5f69 642c  col_tid, col_id,
 00000580: 2063 6f6c 735f 7072 6963 652c 2063 6f6c   cols_price, col
 00000590: 5f6c 6162 656c 5f61 7267 735f 6c69 7374  _label_args_list
 000005a0: 2c20 6c61 6265 6c5f 6672 6f6d 5f73 7472  , label_from_str
-000005b0: 203d 2027 2729 3a0a 2020 2020 636f 6c73   = ''):.    cols
-000005c0: 5f69 6420 3d20 5b63 6f6c 5f74 6964 2c20  _id = [col_tid, 
-000005d0: 636f 6c5f 6964 5d0a 2020 2020 6964 5f6c  col_id].    id_l
-000005e0: 6973 7420 3d20 5b6e 702e 736f 7274 2864  ist = [np.sort(d
-000005f0: 665b 636f 6c5d 2e75 6e69 7175 6528 2929  f[col].unique())
-00000600: 2066 6f72 2063 6f6c 2069 6e20 636f 6c73   for col in cols
-00000610: 5f69 645d 0a20 2020 2073 6861 7065 203d  _id].    shape =
-00000620: 205b 6c65 6e28 7829 2066 6f72 2078 2069   [len(x) for x i
-00000630: 6e20 6964 5f6c 6973 745d 0a20 2020 2064  n id_list].    d
-00000640: 665f 6964 5f61 6c6c 203d 2067 6574 5f64  f_id_all = get_d
-00000650: 665f 6964 5f61 6c6c 2869 645f 6c69 7374  f_id_all(id_list
-00000660: 2c20 636f 6c73 5f69 6420 3d20 636f 6c73  , cols_id = cols
-00000670: 5f69 6429 0a20 2020 2064 665f 6964 5f61  _id).    df_id_a
-00000680: 6c6c 203d 2064 665f 6964 5f61 6c6c 2e61  ll = df_id_all.a
-00000690: 7374 7970 6528 6466 5b63 6f6c 735f 6964  stype(df[cols_id
-000006a0: 5d2e 6474 7970 6573 2e74 6f5f 6469 6374  ].dtypes.to_dict
-000006b0: 2829 290a 0a20 2020 205f 6466 5f4c 203d  ())..    _df_L =
-000006c0: 2070 6c2e 6672 6f6d 5f70 616e 6461 7328   pl.from_pandas(
-000006d0: 6466 5f69 645f 616c 6c29 0a20 2020 205f  df_id_all).    _
-000006e0: 6466 5f52 203d 2070 6c2e 6672 6f6d 5f70  df_R = pl.from_p
-000006f0: 616e 6461 7328 6466 5b63 6f6c 735f 6964  andas(df[cols_id
-00000700: 202b 2063 6f6c 735f 7072 6963 6520 2b20   + cols_price + 
-00000710: 5b27 4144 4a27 5d5d 290a 2020 2020 6466  ['ADJ']]).    df
-00000720: 5f4c 5f52 203d 205f 6466 5f4c 2e6a 6f69  _L_R = _df_L.joi
-00000730: 6e28 5f64 665f 522c 206f 6e20 3d20 636f  n(_df_R, on = co
-00000740: 6c73 5f69 642c 2068 6f77 203d 2027 6c65  ls_id, how = 'le
-00000750: 6674 2729 0a0a 2020 2020 5f64 665f 4c32  ft')..    _df_L2
-00000760: 203d 205f 6466 5f4c 5b63 6f6c 735f 6964   = _df_L[cols_id
-00000770: 5d0a 2020 2020 615f 6164 6a20 3d20 6e70  ].    a_adj = np
-00000780: 2e61 7363 6f6e 7469 6775 6f75 7361 7272  .ascontiguousarr
-00000790: 6179 2864 665f 4c5f 525b 2741 444a 275d  ay(df_L_R['ADJ']
-000007a0: 2e74 6f5f 6e75 6d70 7928 292e 7265 7368  .to_numpy().resh
-000007b0: 6170 6528 7368 6170 6529 290a 2020 2020  ape(shape)).    
-000007c0: 666f 7220 636f 6c5f 6c61 6265 6c5f 6172  for col_label_ar
-000007d0: 6773 2069 6e20 636f 6c5f 6c61 6265 6c5f  gs in col_label_
-000007e0: 6172 6773 5f6c 6973 743a 0a20 2020 2020  args_list:.     
-000007f0: 2020 2070 7269 6e74 2866 275b 2b5d 2067     print(f'[+] g
-00000800: 6574 5f64 665f 6c61 6265 6c5f 6669 6e61  et_df_label_fina
-00000810: 6c2e 636f 6c5f 6c61 6265 6c5f 6172 6773  l.col_label_args
-00000820: 203d 207b 636f 6c5f 6c61 6265 6c5f 6172   = {col_label_ar
-00000830: 6773 7d27 290a 2020 2020 2020 2020 6966  gs}').        if
-00000840: 206c 656e 2863 6f6c 5f6c 6162 656c 5f61   len(col_label_a
-00000850: 7267 7329 203d 3d20 333a 0a20 2020 2020  rgs) == 3:.     
-00000860: 2020 2020 2020 2063 6f6c 2c20 692c 206a         col, i, j
-00000870: 203d 2063 6f6c 5f6c 6162 656c 5f61 7267   = col_label_arg
-00000880: 730a 2020 2020 2020 2020 2020 2020 6120  s.            a 
-00000890: 3d20 6e70 2e61 7363 6f6e 7469 6775 6f75  = np.ascontiguou
-000008a0: 7361 7272 6179 2864 665f 4c5f 525b 636f  sarray(df_L_R[co
-000008b0: 6c5d 2e74 6f5f 6e75 6d70 7928 292e 7265  l].to_numpy().re
-000008c0: 7368 6170 6528 7368 6170 6529 290a 2020  shape(shape)).  
-000008d0: 2020 2020 2020 2020 2020 6132 203d 2061            a2 = a
-000008e0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-000008f0: 2020 2020 2020 2020 2020 2063 6f6c 2c20             col, 
-00000900: 692c 206a 2c20 636f 6c32 203d 2063 6f6c  i, j, col2 = col
-00000910: 5f6c 6162 656c 5f61 7267 730a 2020 2020  _label_args.    
-00000920: 2020 2020 2020 2020 6120 3d20 6e70 2e61          a = np.a
-00000930: 7363 6f6e 7469 6775 6f75 7361 7272 6179  scontiguousarray
-00000940: 2864 665f 4c5f 525b 636f 6c5d 2e74 6f5f  (df_L_R[col].to_
-00000950: 6e75 6d70 7928 292e 7265 7368 6170 6528  numpy().reshape(
-00000960: 7368 6170 6529 290a 2020 2020 2020 2020  shape)).        
-00000970: 2020 2020 6132 203d 206e 702e 6173 636f      a2 = np.asco
-00000980: 6e74 6967 756f 7573 6172 7261 7928 6466  ntiguousarray(df
-00000990: 5f4c 5f52 5b63 6f6c 325d 2e74 6f5f 6e75  _L_R[col2].to_nu
-000009a0: 6d70 7928 292e 7265 7368 6170 6528 7368  mpy().reshape(sh
-000009b0: 6170 6529 290a 2020 2020 2020 2020 692c  ape)).        i,
-000009c0: 206a 203d 2069 6e74 2869 292c 2069 6e74   j = int(i), int
-000009d0: 286a 290a 2020 2020 2020 2020 0a20 2020  (j).        .   
-000009e0: 2020 2020 2061 646a 203d 206e 705f 7368       adj = np_sh
-000009f0: 6966 745f 7261 7728 615f 6164 6a2c 202d  ift_raw(a_adj, -
-00000a00: 3120 2a20 6d61 7828 692c 206a 2929 0a20  1 * max(i, j)). 
-00000a10: 2020 2020 2020 2061 646a 5b6e 702e 6973         adj[np.is
-00000a20: 6e61 6e28 6164 6a29 5d20 3d20 310a 2020  nan(adj)] = 1.  
-00000a30: 2020 2020 2020 666f 7220 696a 2069 6e20        for ij in 
-00000a40: 7261 6e67 6528 6d69 6e28 692c 206a 2920  range(min(i, j) 
-00000a50: 2b20 312c 206d 6178 2869 2c20 6a29 293a  + 1, max(i, j)):
-00000a60: 0a20 2020 2020 2020 2020 2020 2061 646a  .            adj
-00000a70: 5f69 6a20 3d20 6e70 5f73 6869 6674 5f72  _ij = np_shift_r
-00000a80: 6177 2861 5f61 646a 2c20 2d31 202a 2069  aw(a_adj, -1 * i
-00000a90: 6a29 2023 2076 7761 702c 302d 3e31 206f  j) # vwap,0->1 o
-00000aa0: 6e6c 7920 2a20 6164 6a5f 310a 2020 2020  nly * adj_1.    
-00000ab0: 2020 2020 2020 2020 6164 6a5f 696a 5b6e          adj_ij[n
-00000ac0: 702e 6973 6e61 6e28 6164 6a5f 696a 295d  p.isnan(adj_ij)]
-00000ad0: 203d 2031 0a20 2020 2020 2020 2020 2020   = 1.           
-00000ae0: 2061 646a 203d 2061 646a 202a 2061 646a   adj = adj * adj
-00000af0: 5f69 6a0a 2020 2020 2020 2020 6164 6a5b  _ij.        adj[
-00000b00: 6e70 2e69 736e 616e 2861 646a 295d 203d  np.isnan(adj)] =
-00000b10: 2031 0a20 2020 2020 2020 200a 2020 2020   1.        .    
-00000b20: 2020 2020 615f 6920 3d20 6e70 5f73 6869      a_i = np_shi
-00000b30: 6674 5f72 6177 2861 2c20 2d31 202a 2069  ft_raw(a, -1 * i
-00000b40: 290a 2020 2020 2020 2020 615f 6a20 3d20  ).        a_j = 
-00000b50: 6e70 5f73 6869 6674 5f72 6177 2861 322c  np_shift_raw(a2,
-00000b60: 202d 3120 2a20 6a29 0a20 2020 2020 2020   -1 * j).       
-00000b70: 2061 5f69 326a 203d 2061 646a 202a 2061   a_i2j = adj * a
-00000b80: 5f6a 202f 2061 5f69 202d 2031 0a20 2020  _j / a_i - 1.   
-00000b90: 2020 2020 2061 5f69 326a 5b7e 6e70 2e69       a_i2j[~np.i
-00000ba0: 7366 696e 6974 6528 615f 6932 6a29 5d20  sfinite(a_i2j)] 
-00000bb0: 3d20 6e70 2e6e 616e 0a20 2020 2020 2020  = np.nan.       
-00000bc0: 206e 616d 6520 3d20 636f 6c5f 6c61 6265   name = col_labe
-00000bd0: 6c5f 6172 6773 5f32 5f6e 616d 6528 636f  l_args_2_name(co
-00000be0: 6c5f 6c61 6265 6c5f 6172 6773 290a 2020  l_label_args).  
-00000bf0: 2020 2020 2020 5f64 665f 4c32 203d 205f        _df_L2 = _
-00000c00: 6466 5f4c 322e 7769 7468 5f63 6f6c 756d  df_L2.with_colum
-00000c10: 6e73 2870 6c2e 5365 7269 6573 286e 616d  ns(pl.Series(nam
-00000c20: 652c 2061 5f69 326a 2e72 6176 656c 2829  e, a_i2j.ravel()
-00000c30: 2e61 7374 7970 6528 6e70 2e66 6c6f 6174  .astype(np.float
-00000c40: 3332 2929 290a 0a20 2020 205f 6466 5f52  32)))..    _df_R
-00000c50: 3220 3d20 5f64 665f 525b 636f 6c73 5f69  2 = _df_R[cols_i
-00000c60: 645d 0a20 2020 205f 6466 5f52 325f 4c32  d].    _df_R2_L2
-00000c70: 203d 205f 6466 5f52 322e 6a6f 696e 285f   = _df_R2.join(_
-00000c80: 6466 5f4c 322c 206f 6e20 3d20 636f 6c73  df_L2, on = cols
-00000c90: 5f69 642c 2068 6f77 203d 2027 6c65 6674  _id, how = 'left
-00000ca0: 2729 0a20 2020 2064 665f 6c61 6265 6c5f  ').    df_label_
-00000cb0: 6669 6e61 6c20 3d20 5f64 665f 5232 5f4c  final = _df_R2_L
-00000cc0: 320a 2020 2020 0a20 2020 2023 202d 2d2d  2.    .    # ---
-00000cd0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00000ce0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d20 6c61 6265  ----------- labe
-00000cf0: 6c5f 6672 6f6d 5f73 7472 0a20 2020 2069  l_from_str.    i
-00000d00: 6620 6c65 6e28 6c61 6265 6c5f 6672 6f6d  f len(label_from
-00000d10: 5f73 7472 2920 3e20 303a 0a20 2020 2020  _str) > 0:.     
-00000d20: 2020 2073 7320 3d20 6c61 6265 6c5f 6672     ss = label_fr
-00000d30: 6f6d 5f73 7472 2e73 706c 6974 2827 5f5f  om_str.split('__
-00000d40: 2729 0a20 2020 2020 2020 206f 702c 2063  ').        op, c
-00000d50: 6f6c 7320 3d20 7373 5b30 5d2c 2073 735b  ols = ss[0], ss[
-00000d60: 313a 5d0a 2020 2020 2020 2020 636f 6c73  1:].        cols
-00000d70: 203d 205b 636f 6c5f 6c61 6265 6c5f 6172   = [col_label_ar
-00000d80: 6773 5f32 5f6e 616d 6528 6465 636f 6465  gs_2_name(decode
-00000d90: 5f6c 6162 656c 5f61 7267 7328 7829 2920  _label_args(x)) 
-00000da0: 666f 7220 7820 696e 2063 6f6c 735d 0a20  for x in cols]. 
-00000db0: 2020 2020 2020 2069 6620 6f70 2069 6e20         if op in 
-00000dc0: 5b27 5241 5727 5d3a 0a20 2020 2020 2020  ['RAW']:.       
-00000dd0: 2020 2020 2078 203d 2064 665f 6c61 6265       x = df_labe
-00000de0: 6c5f 6669 6e61 6c5b 636f 6c73 5b30 5d5d  l_final[cols[0]]
-00000df0: 2e74 6f5f 6e75 6d70 7928 290a 2020 2020  .to_numpy().    
-00000e00: 2020 2020 656c 6966 206f 7020 696e 205b      elif op in [
-00000e10: 2741 4444 275d 3a20 0a20 2020 2020 2020  'ADD']: .       
-00000e20: 2020 2020 2078 203d 2064 665f 6c61 6265       x = df_labe
-00000e30: 6c5f 6669 6e61 6c5b 636f 6c73 5d2e 746f  l_final[cols].to
-00000e40: 5f6e 756d 7079 2829 2e6d 6561 6e28 6178  _numpy().mean(ax
-00000e50: 6973 203d 2031 290a 2020 2020 2020 2020  is = 1).        
-00000e60: 656c 6966 206f 7020 696e 205b 274d 554c  elif op in ['MUL
-00000e70: 275d 3a20 0a20 2020 2020 2020 2020 2020  ']: .           
-00000e80: 2078 3020 3d20 6466 5f6c 6162 656c 5f66   x0 = df_label_f
-00000e90: 696e 616c 5b63 6f6c 735b 305d 5d2e 746f  inal[cols[0]].to
-00000ea0: 5f6e 756d 7079 2829 0a20 2020 2020 2020  _numpy().       
-00000eb0: 2020 2020 2078 3120 3d20 6466 5f6c 6162       x1 = df_lab
-00000ec0: 656c 5f66 696e 616c 5b63 6f6c 735b 315d  el_final[cols[1]
-00000ed0: 5d2e 746f 5f6e 756d 7079 2829 0a20 2020  ].to_numpy().   
-00000ee0: 2020 2020 2020 2020 2078 203d 206e 702e           x = np.
-00000ef0: 7768 6572 6528 7830 202a 2078 3120 3e20  where(x0 * x1 > 
-00000f00: 302c 2078 302c 2030 290a 2020 2020 2020  0, x0, 0).      
-00000f10: 2020 656c 7365 3a20 7261 6973 6520 4e6f    else: raise No
-00000f20: 7449 6d70 6c65 6d65 6e74 6564 4572 726f  tImplementedErro
-00000f30: 7228 6627 6c61 6265 6c5f 6672 6f6d 5f73  r(f'label_from_s
-00000f40: 7472 2065 7272 6f72 2c20 6f70 203d 207b  tr error, op = {
-00000f50: 6f70 7d27 290a 2020 2020 2020 2020 6466  op}').        df
-00000f60: 5f6c 6162 656c 5f66 696e 616c 203d 2064  _label_final = d
-00000f70: 665f 6c61 6265 6c5f 6669 6e61 6c2e 7769  f_label_final.wi
-00000f80: 7468 5f63 6f6c 756d 6e73 2870 6c2e 5365  th_columns(pl.Se
-00000f90: 7269 6573 2827 4c41 4245 4c5f 4652 4f4d  ries('LABEL_FROM
-00000fa0: 5f53 5452 272c 2078 2929 0a20 2020 2063  _STR', x)).    c
-00000fb0: 6f6c 735f 6c61 6265 6c20 3d20 5b63 6f6c  ols_label = [col
-00000fc0: 2066 6f72 2063 6f6c 2069 6e20 6466 5f6c   for col in df_l
-00000fd0: 6162 656c 5f66 696e 616c 2e63 6f6c 756d  abel_final.colum
-00000fe0: 6e73 2069 6620 636f 6c20 6e6f 7420 696e  ns if col not in
-00000ff0: 2063 6f6c 735f 6964 5d20 200a 2020 2020   cols_id]  .    
-00001000: 7265 7475 726e 2064 665f 6c61 6265 6c5f  return df_label_
-00001010: 6669 6e61 6c2c 2063 6f6c 735f 6c61 6265  final, cols_labe
-00001020: 6c0a 0a64 6566 2064 665f 6578 7061 6e64  l..def df_expand
-00001030: 5f4c 5f52 2864 665f 4c2c 2064 665f 5229  _L_R(df_L, df_R)
-00001040: 3a0a 2020 2020 6461 7465 735f 6861 7665  :.    dates_have
-00001050: 203d 2064 665f 525b 2774 7261 6465 5f64   = df_R['trade_d
-00001060: 6174 6527 5d2e 756e 6971 7565 2829 0a20  ate'].unique(). 
-00001070: 2020 2064 6174 6573 5f74 6f64 6f20 3d20     dates_todo = 
-00001080: 6466 5f4c 5b27 7472 6164 655f 6461 7465  df_L['trade_date
-00001090: 275d 2e75 6e69 7175 6528 290a 2020 2020  '].unique().    
-000010a0: 6461 7465 735f 746f 646f 203d 2064 6174  dates_todo = dat
-000010b0: 6573 5f74 6f64 6f5b 6461 7465 735f 746f  es_todo[dates_to
-000010c0: 646f 203e 2064 6174 6573 5f68 6176 655b  do > dates_have[
-000010d0: 2d31 5d5d 0a20 2020 2064 665f 525f 6c61  -1]].    df_R_la
-000010e0: 7374 203d 2064 665f 525b 6466 5f52 5b27  st = df_R[df_R['
-000010f0: 7472 6164 655f 6461 7465 275d 203d 3d20  trade_date'] == 
-00001100: 6461 7465 735f 6861 7665 5b2d 315d 5d2e  dates_have[-1]].
-00001110: 7265 7365 745f 696e 6465 7828 6472 6f70  reset_index(drop
-00001120: 203d 2054 7275 6529 0a20 2020 2069 6620   = True).    if 
-00001130: 6c65 6e28 6461 7465 735f 746f 646f 2920  len(dates_todo) 
-00001140: 3d3d 2030 3a20 7265 7475 726e 2064 665f  == 0: return df_
-00001150: 520a 2020 2020 6466 5f6e 6578 745f 6c69  R.    df_next_li
-00001160: 7374 203d 205b 5d20 0a20 2020 2070 7269  st = [] .    pri
-00001170: 6e74 2866 275b 2b5d 2064 6174 6573 5f74  nt(f'[+] dates_t
-00001180: 6f64 6f20 3d20 7b64 6174 6573 5f74 6f64  odo = {dates_tod
-00001190: 6f7d 2729 0a20 2020 2066 6f72 2064 6174  o}').    for dat
-000011a0: 6520 696e 2064 6174 6573 5f74 6f64 6f3a  e in dates_todo:
-000011b0: 0a20 2020 2020 2020 2064 665f 6e65 7874  .        df_next
-000011c0: 203d 2064 665f 525f 6c61 7374 2e63 6f70   = df_R_last.cop
-000011d0: 7928 290a 2020 2020 2020 2020 6466 5f6e  y().        df_n
-000011e0: 6578 745b 2774 7261 6465 5f64 6174 6527  ext['trade_date'
-000011f0: 5d20 3d20 6461 7465 0a20 2020 2020 2020  ] = date.       
-00001200: 2064 665f 6e65 7874 5f6c 6973 742e 6170   df_next_list.ap
-00001210: 7065 6e64 2864 665f 6e65 7874 290a 2020  pend(df_next).  
-00001220: 2020 6466 5f6e 6578 7420 3d20 7064 2e63    df_next = pd.c
-00001230: 6f6e 6361 7428 6466 5f6e 6578 745f 6c69  oncat(df_next_li
-00001240: 7374 2c20 6178 6973 203d 2030 292e 7265  st, axis = 0).re
-00001250: 7365 745f 696e 6465 7828 6472 6f70 203d  set_index(drop =
-00001260: 2054 7275 6529 0a20 2020 2064 665f 5220   True).    df_R 
-00001270: 3d20 7064 2e63 6f6e 6361 7428 5b64 665f  = pd.concat([df_
-00001280: 522c 2064 665f 6e65 7874 5d2c 2061 7869  R, df_next], axi
-00001290: 7320 3d20 302c 2073 6f72 7420 3d20 4661  s = 0, sort = Fa
-000012a0: 6c73 6529 2e72 6573 6574 5f69 6e64 6578  lse).reset_index
-000012b0: 2864 726f 7020 3d20 5472 7565 290a 2020  (drop = True).  
-000012c0: 2020 7265 7475 726e 2064 665f 520a 0a64    return df_R..d
-000012d0: 6566 2067 6574 5f64 665f 6d61 736b 2870  ef get_df_mask(p
-000012e0: 6174 685f 6462 2c20 646d 2c20 636f 6c5f  ath_db, dm, col_
-000012f0: 7469 642c 2063 6f6c 5f69 642c 2076 6572  tid, col_id, ver
-00001300: 626f 7365 203d 2054 7275 6529 3a0a 2020  bose = True):.  
-00001310: 2020 6466 203d 2064 6d2e 6765 745f 636f    df = dm.get_co
-00001320: 6c73 5f70 616e 6461 7328 5b63 6f6c 5f74  ls_pandas([col_t
-00001330: 6964 2c20 636f 6c5f 6964 5d20 2b20 5b27  id, col_id] + ['
-00001340: 6f70 656e 272c 2027 7063 745f 6368 6727  open', 'pct_chg'
-00001350: 5d29 0a20 2020 2064 6220 3d20 4442 4d61  ]).    db = DBMa
-00001360: 7374 6572 2870 6174 685f 6462 2c20 7665  ster(path_db, ve
-00001370: 7262 6f73 6520 3d20 7665 7262 6f73 6529  rbose = verbose)
-00001380: 0a20 2020 2064 622e 636f 6e6e 6563 7428  .    db.connect(
-00001390: 290a 0a20 2020 206b 6579 7320 3d20 5b63  )..    keys = [c
-000013a0: 6f6c 5f74 6964 2c20 636f 6c5f 6964 5d0a  ol_tid, col_id].
-000013b0: 2020 2020 6466 5f4c 203d 2064 665b 6b65      df_L = df[ke
-000013c0: 7973 5d0a 2020 2020 0a20 2020 2023 2070  ys].    .    # p
-000013d0: 7269 6e74 2827 5b2b 5d20 7265 6164 206c  rint('[+] read l
-000013e0: 6973 745f 6461 7465 2729 0a20 2020 2063  ist_date').    c
-000013f0: 6f6c 203d 2027 6c69 7374 5f64 6174 6527  ol = 'list_date'
-00001400: 0a20 2020 2064 665f 5220 3d20 6462 2e73  .    df_R = db.s
-00001410: 656c 6563 7428 2764 665f 6c69 7374 5f64  elect('df_list_d
-00001420: 6174 6527 2c20 636f 6c73 203d 205b 636f  ate', cols = [co
-00001430: 6c5f 6964 5d20 2b20 5b63 6f6c 5d29 0a20  l_id] + [col]). 
-00001440: 2020 2064 665f 5220 3d20 6466 5f52 5b64     df_R = df_R[d
-00001450: 665f 525b 276c 6973 745f 6461 7465 275d  f_R['list_date']
-00001460: 203e 2030 5d2e 7265 7365 745f 696e 6465   > 0].reset_inde
-00001470: 7828 6472 6f70 203d 2054 7275 6529 0a20  x(drop = True). 
-00001480: 2020 2073 5f6c 6973 745f 6461 7465 203d     s_list_date =
-00001490: 206d 6572 6765 2864 665f 4c2c 2064 665f   merge(df_L, df_
-000014a0: 522c 205b 636f 6c5f 6964 5d29 5b63 6f6c  R, [col_id])[col
-000014b0: 5d2e 746f 5f70 616e 6461 7328 290a 2020  ].to_pandas().  
-000014c0: 2020 0a20 2020 2023 2070 7269 6e74 2827    .    # print('
-000014d0: 5b2b 5d20 7265 6164 2073 5f73 7427 290a  [+] read s_st').
-000014e0: 2020 2020 636f 6c20 3d20 2753 5427 0a20      col = 'ST'. 
-000014f0: 2020 2064 665f 5220 3d20 6462 2e73 656c     df_R = db.sel
-00001500: 6563 7428 2764 665f 7374 272c 2063 6f6c  ect('df_st', col
-00001510: 7320 3d20 6b65 7973 202b 205b 636f 6c5d  s = keys + [col]
-00001520: 290a 2020 2020 6466 5f52 203d 2064 665f  ).    df_R = df_
-00001530: 6578 7061 6e64 5f4c 5f52 2864 665f 4c2c  expand_L_R(df_L,
-00001540: 2064 665f 5229 0a20 2020 2073 5f73 7420   df_R).    s_st 
-00001550: 3d20 6d65 7267 6528 6466 5f4c 2c20 6466  = merge(df_L, df
-00001560: 5f52 2c20 6b65 7973 295b 2753 5427 5d2e  _R, keys)['ST'].
-00001570: 746f 5f70 616e 6461 7328 292e 6669 6c6c  to_pandas().fill
-00001580: 6e61 2830 290a 2020 2020 0a20 2020 2023  na(0).    .    #
-00001590: 2070 7269 6e74 2827 5b2b 5d20 7265 6164   print('[+] read
-000015a0: 2073 5f73 7573 2729 0a20 2020 2063 6f6c   s_sus').    col
-000015b0: 203d 2027 5355 5327 0a20 2020 2064 665f   = 'SUS'.    df_
-000015c0: 5220 3d20 6462 2e73 656c 6563 7428 2764  R = db.select('d
-000015d0: 665f 7375 7327 2c20 636f 6c73 203d 206b  f_sus', cols = k
-000015e0: 6579 7320 2b20 5b63 6f6c 5d29 0a20 2020  eys + [col]).   
-000015f0: 2064 665f 5220 3d20 6466 5f65 7870 616e   df_R = df_expan
-00001600: 645f 4c5f 5228 6466 5f4c 2c20 6466 5f52  d_L_R(df_L, df_R
-00001610: 290a 2020 2020 735f 7375 7320 3d20 6d65  ).    s_sus = me
-00001620: 7267 6528 6466 5f4c 2c20 6466 5f52 2c20  rge(df_L, df_R, 
-00001630: 6b65 7973 295b 2753 5553 275d 2e74 6f5f  keys)['SUS'].to_
-00001640: 7061 6e64 6173 2829 2e66 696c 6c6e 6128  pandas().fillna(
-00001650: 3029 0a20 2020 200a 2020 2020 2320 2d2d  0).    .    # --
-00001660: 2d2d 2d2d 2d2d 2d2d 2064 665f 6d61 736b  -------- df_mask
-00001670: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
-00001680: 2320 7072 696e 7428 275b 2b5d 2064 665f  # print('[+] df_
-00001690: 6d61 736b 2729 0a20 2020 2064 665f 6d61  mask').    df_ma
-000016a0: 736b 203d 2064 665b 6b65 7973 202b 205b  sk = df[keys + [
-000016b0: 276f 7065 6e27 2c20 2770 6374 5f63 6867  'open', 'pct_chg
-000016c0: 275d 5d0a 2020 2020 6466 5f6d 6173 6b5b  ']].    df_mask[
-000016d0: 276c 6973 745f 6461 7465 275d 203d 2073  'list_date'] = s
-000016e0: 5f6c 6973 745f 6461 7465 0a20 2020 2064  _list_date.    d
-000016f0: 665f 6d61 736b 5b27 5354 275d 203d 2073  f_mask['ST'] = s
-00001700: 5f73 740a 2020 2020 6466 5f6d 6173 6b5b  _st.    df_mask[
-00001710: 2753 5553 275d 203d 2073 5f73 7573 0a0a  'SUS'] = s_sus..
-00001720: 2020 2020 7320 3d20 6466 5f6d 6173 6b5b      s = df_mask[
-00001730: 636f 6c5f 7469 645d 2e64 726f 705f 6475  col_tid].drop_du
-00001740: 706c 6963 6174 6573 2829 2e72 6573 6574  plicates().reset
-00001750: 5f69 6e64 6578 2864 726f 7020 3d20 5472  _index(drop = Tr
-00001760: 7565 290a 2020 2020 6461 7465 5f64 6963  ue).    date_dic
-00001770: 745f 3120 3d20 6469 6374 287a 6970 2873  t_1 = dict(zip(s
-00001780: 2c20 7064 2e74 6f5f 6461 7465 7469 6d65  , pd.to_datetime
-00001790: 2873 2c20 666f 726d 6174 3d27 2559 256d  (s, format='%Y%m
-000017a0: 2564 2729 2929 0a20 2020 2073 203d 2064  %d'))).    s = d
-000017b0: 665f 6d61 736b 5b27 6c69 7374 5f64 6174  f_mask['list_dat
-000017c0: 6527 5d2e 6472 6f70 5f64 7570 6c69 6361  e'].drop_duplica
-000017d0: 7465 7328 292e 7265 7365 745f 696e 6465  tes().reset_inde
-000017e0: 7828 6472 6f70 203d 2054 7275 6529 0a20  x(drop = True). 
-000017f0: 2020 2064 6174 655f 6469 6374 5f32 203d     date_dict_2 =
-00001800: 2064 6963 7428 7a69 7028 732c 2070 642e   dict(zip(s, pd.
-00001810: 746f 5f64 6174 6574 696d 6528 732c 2066  to_datetime(s, f
-00001820: 6f72 6d61 743d 2725 5925 6d25 6427 2929  ormat='%Y%m%d'))
-00001830: 290a 0a20 2020 2023 2069 6478 5f78 7878  )..    # idx_xxx
-00001840: 0a20 2020 2069 6478 5f32 3020 3d20 2864  .    idx_20 = (d
-00001850: 665f 6d61 736b 5b63 6f6c 5f74 6964 5d2e  f_mask[col_tid].
-00001860: 6d61 7028 6461 7465 5f64 6963 745f 3129  map(date_dict_1)
-00001870: 202d 2064 665f 6d61 736b 5b27 6c69 7374   - df_mask['list
-00001880: 5f64 6174 6527 5d2e 6d61 7028 6461 7465  _date'].map(date
-00001890: 5f64 6963 745f 3229 292e 6474 2e64 6179  _dict_2)).dt.day
-000018a0: 7320 3e3d 2032 300a 2020 2020 6964 785f  s >= 20.    idx_
-000018b0: 6e61 6e20 3d20 7e64 665f 6d61 736b 5b27  nan = ~df_mask['
-000018c0: 6f70 656e 275d 2e69 736e 756c 6c28 290a  open'].isnull().
-000018d0: 2020 2020 6964 785f 7374 203d 2064 665f      idx_st = df_
-000018e0: 6d61 736b 5b27 5354 275d 203c 3d20 300a  mask['ST'] <= 0.
-000018f0: 2020 2020 6964 785f 7375 7320 3d20 6466      idx_sus = df
-00001900: 5f6d 6173 6b5b 2753 5553 275d 203c 3d20  _mask['SUS'] <= 
-00001910: 310a 2020 2020 0a20 2020 2023 202d 2d2d  1.    .    # ---
-00001920: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00001930: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000005b0: 203d 2027 272c 2076 6572 626f 7365 203d   = '', verbose =
+000005c0: 2054 7275 6529 3a0a 2020 2020 636f 6c73   True):.    cols
+000005d0: 5f69 6420 3d20 5b63 6f6c 5f74 6964 2c20  _id = [col_tid, 
+000005e0: 636f 6c5f 6964 5d0a 2020 2020 6964 5f6c  col_id].    id_l
+000005f0: 6973 7420 3d20 5b6e 702e 736f 7274 2864  ist = [np.sort(d
+00000600: 665b 636f 6c5d 2e75 6e69 7175 6528 2929  f[col].unique())
+00000610: 2066 6f72 2063 6f6c 2069 6e20 636f 6c73   for col in cols
+00000620: 5f69 645d 0a20 2020 2073 6861 7065 203d  _id].    shape =
+00000630: 205b 6c65 6e28 7829 2066 6f72 2078 2069   [len(x) for x i
+00000640: 6e20 6964 5f6c 6973 745d 0a20 2020 2064  n id_list].    d
+00000650: 665f 6964 5f61 6c6c 203d 2067 6574 5f64  f_id_all = get_d
+00000660: 665f 6964 5f61 6c6c 2869 645f 6c69 7374  f_id_all(id_list
+00000670: 2c20 636f 6c73 5f69 6420 3d20 636f 6c73  , cols_id = cols
+00000680: 5f69 6429 0a20 2020 2064 665f 6964 5f61  _id).    df_id_a
+00000690: 6c6c 203d 2064 665f 6964 5f61 6c6c 2e61  ll = df_id_all.a
+000006a0: 7374 7970 6528 6466 5b63 6f6c 735f 6964  stype(df[cols_id
+000006b0: 5d2e 6474 7970 6573 2e74 6f5f 6469 6374  ].dtypes.to_dict
+000006c0: 2829 290a 0a20 2020 205f 6466 5f4c 203d  ())..    _df_L =
+000006d0: 2070 6c2e 6672 6f6d 5f70 616e 6461 7328   pl.from_pandas(
+000006e0: 6466 5f69 645f 616c 6c29 0a20 2020 205f  df_id_all).    _
+000006f0: 6466 5f52 203d 2070 6c2e 6672 6f6d 5f70  df_R = pl.from_p
+00000700: 616e 6461 7328 6466 5b63 6f6c 735f 6964  andas(df[cols_id
+00000710: 202b 2063 6f6c 735f 7072 6963 6520 2b20   + cols_price + 
+00000720: 5b27 4144 4a27 5d5d 290a 2020 2020 6466  ['ADJ']]).    df
+00000730: 5f4c 5f52 203d 205f 6466 5f4c 2e6a 6f69  _L_R = _df_L.joi
+00000740: 6e28 5f64 665f 522c 206f 6e20 3d20 636f  n(_df_R, on = co
+00000750: 6c73 5f69 642c 2068 6f77 203d 2027 6c65  ls_id, how = 'le
+00000760: 6674 2729 0a0a 2020 2020 5f64 665f 4c32  ft')..    _df_L2
+00000770: 203d 205f 6466 5f4c 5b63 6f6c 735f 6964   = _df_L[cols_id
+00000780: 5d0a 2020 2020 615f 6164 6a20 3d20 6e70  ].    a_adj = np
+00000790: 2e61 7363 6f6e 7469 6775 6f75 7361 7272  .ascontiguousarr
+000007a0: 6179 2864 665f 4c5f 525b 2741 444a 275d  ay(df_L_R['ADJ']
+000007b0: 2e74 6f5f 6e75 6d70 7928 292e 7265 7368  .to_numpy().resh
+000007c0: 6170 6528 7368 6170 6529 290a 2020 2020  ape(shape)).    
+000007d0: 666f 7220 636f 6c5f 6c61 6265 6c5f 6172  for col_label_ar
+000007e0: 6773 2069 6e20 636f 6c5f 6c61 6265 6c5f  gs in col_label_
+000007f0: 6172 6773 5f6c 6973 743a 0a20 2020 2020  args_list:.     
+00000800: 2020 2069 6620 7665 7262 6f73 653a 2070     if verbose: p
+00000810: 7269 6e74 2866 275b 2b5d 2067 6574 5f64  rint(f'[+] get_d
+00000820: 665f 6c61 6265 6c5f 6669 6e61 6c2e 636f  f_label_final.co
+00000830: 6c5f 6c61 6265 6c5f 6172 6773 203d 207b  l_label_args = {
+00000840: 636f 6c5f 6c61 6265 6c5f 6172 6773 7d27  col_label_args}'
+00000850: 290a 2020 2020 2020 2020 6966 206c 656e  ).        if len
+00000860: 2863 6f6c 5f6c 6162 656c 5f61 7267 7329  (col_label_args)
+00000870: 203d 3d20 333a 0a20 2020 2020 2020 2020   == 3:.         
+00000880: 2020 2063 6f6c 2c20 692c 206a 203d 2063     col, i, j = c
+00000890: 6f6c 5f6c 6162 656c 5f61 7267 730a 2020  ol_label_args.  
+000008a0: 2020 2020 2020 2020 2020 6120 3d20 6e70            a = np
+000008b0: 2e61 7363 6f6e 7469 6775 6f75 7361 7272  .ascontiguousarr
+000008c0: 6179 2864 665f 4c5f 525b 636f 6c5d 2e74  ay(df_L_R[col].t
+000008d0: 6f5f 6e75 6d70 7928 292e 7265 7368 6170  o_numpy().reshap
+000008e0: 6528 7368 6170 6529 290a 2020 2020 2020  e(shape)).      
+000008f0: 2020 2020 2020 6132 203d 2061 0a20 2020        a2 = a.   
+00000900: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00000910: 2020 2020 2020 2063 6f6c 2c20 692c 206a         col, i, j
+00000920: 2c20 636f 6c32 203d 2063 6f6c 5f6c 6162  , col2 = col_lab
+00000930: 656c 5f61 7267 730a 2020 2020 2020 2020  el_args.        
+00000940: 2020 2020 6120 3d20 6e70 2e61 7363 6f6e      a = np.ascon
+00000950: 7469 6775 6f75 7361 7272 6179 2864 665f  tiguousarray(df_
+00000960: 4c5f 525b 636f 6c5d 2e74 6f5f 6e75 6d70  L_R[col].to_nump
+00000970: 7928 292e 7265 7368 6170 6528 7368 6170  y().reshape(shap
+00000980: 6529 290a 2020 2020 2020 2020 2020 2020  e)).            
+00000990: 6132 203d 206e 702e 6173 636f 6e74 6967  a2 = np.ascontig
+000009a0: 756f 7573 6172 7261 7928 6466 5f4c 5f52  uousarray(df_L_R
+000009b0: 5b63 6f6c 325d 2e74 6f5f 6e75 6d70 7928  [col2].to_numpy(
+000009c0: 292e 7265 7368 6170 6528 7368 6170 6529  ).reshape(shape)
+000009d0: 290a 2020 2020 2020 2020 692c 206a 203d  ).        i, j =
+000009e0: 2069 6e74 2869 292c 2069 6e74 286a 290a   int(i), int(j).
+000009f0: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
+00000a00: 2061 646a 203d 206e 705f 7368 6966 745f   adj = np_shift_
+00000a10: 7261 7728 615f 6164 6a2c 202d 3120 2a20  raw(a_adj, -1 * 
+00000a20: 6d61 7828 692c 206a 2929 0a20 2020 2020  max(i, j)).     
+00000a30: 2020 2061 646a 5b6e 702e 6973 6e61 6e28     adj[np.isnan(
+00000a40: 6164 6a29 5d20 3d20 310a 2020 2020 2020  adj)] = 1.      
+00000a50: 2020 666f 7220 696a 2069 6e20 7261 6e67    for ij in rang
+00000a60: 6528 6d69 6e28 692c 206a 2920 2b20 312c  e(min(i, j) + 1,
+00000a70: 206d 6178 2869 2c20 6a29 293a 0a20 2020   max(i, j)):.   
+00000a80: 2020 2020 2020 2020 2061 646a 5f69 6a20           adj_ij 
+00000a90: 3d20 6e70 5f73 6869 6674 5f72 6177 2861  = np_shift_raw(a
+00000aa0: 5f61 646a 2c20 2d31 202a 2069 6a29 2023  _adj, -1 * ij) #
+00000ab0: 2076 7761 702c 302d 3e31 206f 6e6c 7920   vwap,0->1 only 
+00000ac0: 2a20 6164 6a5f 310a 2020 2020 2020 2020  * adj_1.        
+00000ad0: 2020 2020 6164 6a5f 696a 5b6e 702e 6973      adj_ij[np.is
+00000ae0: 6e61 6e28 6164 6a5f 696a 295d 203d 2031  nan(adj_ij)] = 1
+00000af0: 0a20 2020 2020 2020 2020 2020 2061 646a  .            adj
+00000b00: 203d 2061 646a 202a 2061 646a 5f69 6a0a   = adj * adj_ij.
+00000b10: 2020 2020 2020 2020 6164 6a5b 6e70 2e69          adj[np.i
+00000b20: 736e 616e 2861 646a 295d 203d 2031 0a20  snan(adj)] = 1. 
+00000b30: 2020 2020 2020 200a 2020 2020 2020 2020         .        
+00000b40: 615f 6920 3d20 6e70 5f73 6869 6674 5f72  a_i = np_shift_r
+00000b50: 6177 2861 2c20 2d31 202a 2069 290a 2020  aw(a, -1 * i).  
+00000b60: 2020 2020 2020 615f 6a20 3d20 6e70 5f73        a_j = np_s
+00000b70: 6869 6674 5f72 6177 2861 322c 202d 3120  hift_raw(a2, -1 
+00000b80: 2a20 6a29 0a20 2020 2020 2020 2061 5f69  * j).        a_i
+00000b90: 326a 203d 2061 646a 202a 2061 5f6a 202f  2j = adj * a_j /
+00000ba0: 2061 5f69 202d 2031 0a20 2020 2020 2020   a_i - 1.       
+00000bb0: 2061 5f69 326a 5b7e 6e70 2e69 7366 696e   a_i2j[~np.isfin
+00000bc0: 6974 6528 615f 6932 6a29 5d20 3d20 6e70  ite(a_i2j)] = np
+00000bd0: 2e6e 616e 0a20 2020 2020 2020 206e 616d  .nan.        nam
+00000be0: 6520 3d20 636f 6c5f 6c61 6265 6c5f 6172  e = col_label_ar
+00000bf0: 6773 5f32 5f6e 616d 6528 636f 6c5f 6c61  gs_2_name(col_la
+00000c00: 6265 6c5f 6172 6773 290a 2020 2020 2020  bel_args).      
+00000c10: 2020 5f64 665f 4c32 203d 205f 6466 5f4c    _df_L2 = _df_L
+00000c20: 322e 7769 7468 5f63 6f6c 756d 6e73 2870  2.with_columns(p
+00000c30: 6c2e 5365 7269 6573 286e 616d 652c 2061  l.Series(name, a
+00000c40: 5f69 326a 2e72 6176 656c 2829 2e61 7374  _i2j.ravel().ast
+00000c50: 7970 6528 6e70 2e66 6c6f 6174 3332 2929  ype(np.float32))
+00000c60: 290a 0a20 2020 205f 6466 5f52 3220 3d20  )..    _df_R2 = 
+00000c70: 5f64 665f 525b 636f 6c73 5f69 645d 0a20  _df_R[cols_id]. 
+00000c80: 2020 205f 6466 5f52 325f 4c32 203d 205f     _df_R2_L2 = _
+00000c90: 6466 5f52 322e 6a6f 696e 285f 6466 5f4c  df_R2.join(_df_L
+00000ca0: 322c 206f 6e20 3d20 636f 6c73 5f69 642c  2, on = cols_id,
+00000cb0: 2068 6f77 203d 2027 6c65 6674 2729 0a20   how = 'left'). 
+00000cc0: 2020 2064 665f 6c61 6265 6c5f 6669 6e61     df_label_fina
+00000cd0: 6c20 3d20 5f64 665f 5232 5f4c 320a 2020  l = _df_R2_L2.  
+00000ce0: 2020 0a20 2020 2023 202d 2d2d 2d2d 2d2d    .    # -------
+00000cf0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00000d00: 2d2d 2d2d 2d2d 2d20 6c61 6265 6c5f 6672  ------- label_fr
+00000d10: 6f6d 5f73 7472 0a20 2020 2069 6620 6c65  om_str.    if le
+00000d20: 6e28 6c61 6265 6c5f 6672 6f6d 5f73 7472  n(label_from_str
+00000d30: 2920 3e20 303a 0a20 2020 2020 2020 2073  ) > 0:.        s
+00000d40: 7320 3d20 6c61 6265 6c5f 6672 6f6d 5f73  s = label_from_s
+00000d50: 7472 2e73 706c 6974 2827 5f5f 2729 0a20  tr.split('__'). 
+00000d60: 2020 2020 2020 206f 702c 2063 6f6c 7320         op, cols 
+00000d70: 3d20 7373 5b30 5d2c 2073 735b 313a 5d0a  = ss[0], ss[1:].
+00000d80: 2020 2020 2020 2020 636f 6c73 203d 205b          cols = [
+00000d90: 636f 6c5f 6c61 6265 6c5f 6172 6773 5f32  col_label_args_2
+00000da0: 5f6e 616d 6528 6465 636f 6465 5f6c 6162  _name(decode_lab
+00000db0: 656c 5f61 7267 7328 7829 2920 666f 7220  el_args(x)) for 
+00000dc0: 7820 696e 2063 6f6c 735d 0a20 2020 2020  x in cols].     
+00000dd0: 2020 2069 6620 6f70 2069 6e20 5b27 5241     if op in ['RA
+00000de0: 5727 5d3a 0a20 2020 2020 2020 2020 2020  W']:.           
+00000df0: 2078 203d 2064 665f 6c61 6265 6c5f 6669   x = df_label_fi
+00000e00: 6e61 6c5b 636f 6c73 5b30 5d5d 2e74 6f5f  nal[cols[0]].to_
+00000e10: 6e75 6d70 7928 290a 2020 2020 2020 2020  numpy().        
+00000e20: 656c 6966 206f 7020 696e 205b 2741 4444  elif op in ['ADD
+00000e30: 275d 3a20 0a20 2020 2020 2020 2020 2020  ']: .           
+00000e40: 2078 203d 2064 665f 6c61 6265 6c5f 6669   x = df_label_fi
+00000e50: 6e61 6c5b 636f 6c73 5d2e 746f 5f6e 756d  nal[cols].to_num
+00000e60: 7079 2829 2e6d 6561 6e28 6178 6973 203d  py().mean(axis =
+00000e70: 2031 290a 2020 2020 2020 2020 656c 6966   1).        elif
+00000e80: 206f 7020 696e 205b 274d 554c 275d 3a20   op in ['MUL']: 
+00000e90: 0a20 2020 2020 2020 2020 2020 2078 3020  .            x0 
+00000ea0: 3d20 6466 5f6c 6162 656c 5f66 696e 616c  = df_label_final
+00000eb0: 5b63 6f6c 735b 305d 5d2e 746f 5f6e 756d  [cols[0]].to_num
+00000ec0: 7079 2829 0a20 2020 2020 2020 2020 2020  py().           
+00000ed0: 2078 3120 3d20 6466 5f6c 6162 656c 5f66   x1 = df_label_f
+00000ee0: 696e 616c 5b63 6f6c 735b 315d 5d2e 746f  inal[cols[1]].to
+00000ef0: 5f6e 756d 7079 2829 0a20 2020 2020 2020  _numpy().       
+00000f00: 2020 2020 2078 203d 206e 702e 7768 6572       x = np.wher
+00000f10: 6528 7830 202a 2078 3120 3e20 302c 2078  e(x0 * x1 > 0, x
+00000f20: 302c 2030 290a 2020 2020 2020 2020 656c  0, 0).        el
+00000f30: 7365 3a20 7261 6973 6520 4e6f 7449 6d70  se: raise NotImp
+00000f40: 6c65 6d65 6e74 6564 4572 726f 7228 6627  lementedError(f'
+00000f50: 6c61 6265 6c5f 6672 6f6d 5f73 7472 2065  label_from_str e
+00000f60: 7272 6f72 2c20 6f70 203d 207b 6f70 7d27  rror, op = {op}'
+00000f70: 290a 2020 2020 2020 2020 6466 5f6c 6162  ).        df_lab
+00000f80: 656c 5f66 696e 616c 203d 2064 665f 6c61  el_final = df_la
+00000f90: 6265 6c5f 6669 6e61 6c2e 7769 7468 5f63  bel_final.with_c
+00000fa0: 6f6c 756d 6e73 2870 6c2e 5365 7269 6573  olumns(pl.Series
+00000fb0: 2827 4c41 4245 4c5f 4652 4f4d 5f53 5452  ('LABEL_FROM_STR
+00000fc0: 272c 2078 2929 0a20 2020 2063 6f6c 735f  ', x)).    cols_
+00000fd0: 6c61 6265 6c20 3d20 5b63 6f6c 2066 6f72  label = [col for
+00000fe0: 2063 6f6c 2069 6e20 6466 5f6c 6162 656c   col in df_label
+00000ff0: 5f66 696e 616c 2e63 6f6c 756d 6e73 2069  _final.columns i
+00001000: 6620 636f 6c20 6e6f 7420 696e 2063 6f6c  f col not in col
+00001010: 735f 6964 5d20 200a 2020 2020 7265 7475  s_id]  .    retu
+00001020: 726e 2064 665f 6c61 6265 6c5f 6669 6e61  rn df_label_fina
+00001030: 6c2c 2063 6f6c 735f 6c61 6265 6c0a 0a64  l, cols_label..d
+00001040: 6566 2064 665f 6578 7061 6e64 5f4c 5f52  ef df_expand_L_R
+00001050: 2864 665f 4c2c 2064 665f 5229 3a0a 2020  (df_L, df_R):.  
+00001060: 2020 6461 7465 735f 6861 7665 203d 2064    dates_have = d
+00001070: 665f 525b 2774 7261 6465 5f64 6174 6527  f_R['trade_date'
+00001080: 5d2e 756e 6971 7565 2829 0a20 2020 2064  ].unique().    d
+00001090: 6174 6573 5f74 6f64 6f20 3d20 6466 5f4c  ates_todo = df_L
+000010a0: 5b27 7472 6164 655f 6461 7465 275d 2e75  ['trade_date'].u
+000010b0: 6e69 7175 6528 290a 2020 2020 6461 7465  nique().    date
+000010c0: 735f 746f 646f 203d 2064 6174 6573 5f74  s_todo = dates_t
+000010d0: 6f64 6f5b 6461 7465 735f 746f 646f 203e  odo[dates_todo >
+000010e0: 2064 6174 6573 5f68 6176 655b 2d31 5d5d   dates_have[-1]]
+000010f0: 0a20 2020 2064 665f 525f 6c61 7374 203d  .    df_R_last =
+00001100: 2064 665f 525b 6466 5f52 5b27 7472 6164   df_R[df_R['trad
+00001110: 655f 6461 7465 275d 203d 3d20 6461 7465  e_date'] == date
+00001120: 735f 6861 7665 5b2d 315d 5d2e 7265 7365  s_have[-1]].rese
+00001130: 745f 696e 6465 7828 6472 6f70 203d 2054  t_index(drop = T
+00001140: 7275 6529 0a20 2020 2069 6620 6c65 6e28  rue).    if len(
+00001150: 6461 7465 735f 746f 646f 2920 3d3d 2030  dates_todo) == 0
+00001160: 3a20 7265 7475 726e 2064 665f 520a 2020  : return df_R.  
+00001170: 2020 6466 5f6e 6578 745f 6c69 7374 203d    df_next_list =
+00001180: 205b 5d20 0a20 2020 2070 7269 6e74 2866   [] .    print(f
+00001190: 275b 2b5d 2064 6174 6573 5f74 6f64 6f20  '[+] dates_todo 
+000011a0: 3d20 7b64 6174 6573 5f74 6f64 6f7d 2729  = {dates_todo}')
+000011b0: 0a20 2020 2066 6f72 2064 6174 6520 696e  .    for date in
+000011c0: 2064 6174 6573 5f74 6f64 6f3a 0a20 2020   dates_todo:.   
+000011d0: 2020 2020 2064 665f 6e65 7874 203d 2064       df_next = d
+000011e0: 665f 525f 6c61 7374 2e63 6f70 7928 290a  f_R_last.copy().
+000011f0: 2020 2020 2020 2020 6466 5f6e 6578 745b          df_next[
+00001200: 2774 7261 6465 5f64 6174 6527 5d20 3d20  'trade_date'] = 
+00001210: 6461 7465 0a20 2020 2020 2020 2064 665f  date.        df_
+00001220: 6e65 7874 5f6c 6973 742e 6170 7065 6e64  next_list.append
+00001230: 2864 665f 6e65 7874 290a 2020 2020 6466  (df_next).    df
+00001240: 5f6e 6578 7420 3d20 7064 2e63 6f6e 6361  _next = pd.conca
+00001250: 7428 6466 5f6e 6578 745f 6c69 7374 2c20  t(df_next_list, 
+00001260: 6178 6973 203d 2030 292e 7265 7365 745f  axis = 0).reset_
+00001270: 696e 6465 7828 6472 6f70 203d 2054 7275  index(drop = Tru
+00001280: 6529 0a20 2020 2064 665f 5220 3d20 7064  e).    df_R = pd
+00001290: 2e63 6f6e 6361 7428 5b64 665f 522c 2064  .concat([df_R, d
+000012a0: 665f 6e65 7874 5d2c 2061 7869 7320 3d20  f_next], axis = 
+000012b0: 302c 2073 6f72 7420 3d20 4661 6c73 6529  0, sort = False)
+000012c0: 2e72 6573 6574 5f69 6e64 6578 2864 726f  .reset_index(dro
+000012d0: 7020 3d20 5472 7565 290a 2020 2020 7265  p = True).    re
+000012e0: 7475 726e 2064 665f 520a 0a64 6566 2067  turn df_R..def g
+000012f0: 6574 5f64 665f 6d61 736b 2870 6174 685f  et_df_mask(path_
+00001300: 6462 2c20 646d 2c20 636f 6c5f 7469 642c  db, dm, col_tid,
+00001310: 2063 6f6c 5f69 642c 2076 6572 626f 7365   col_id, verbose
+00001320: 203d 2054 7275 6529 3a0a 2020 2020 6466   = True):.    df
+00001330: 203d 2064 6d2e 6765 745f 636f 6c73 5f70   = dm.get_cols_p
+00001340: 616e 6461 7328 5b63 6f6c 5f74 6964 2c20  andas([col_tid, 
+00001350: 636f 6c5f 6964 5d20 2b20 5b27 6f70 656e  col_id] + ['open
+00001360: 272c 2027 7063 745f 6368 6727 5d29 0a20  ', 'pct_chg']). 
+00001370: 2020 2064 6220 3d20 4442 4d61 7374 6572     db = DBMaster
+00001380: 2870 6174 685f 6462 2c20 7665 7262 6f73  (path_db, verbos
+00001390: 6520 3d20 7665 7262 6f73 6529 0a20 2020  e = verbose).   
+000013a0: 2064 622e 636f 6e6e 6563 7428 290a 0a20   db.connect().. 
+000013b0: 2020 206b 6579 7320 3d20 5b63 6f6c 5f74     keys = [col_t
+000013c0: 6964 2c20 636f 6c5f 6964 5d0a 2020 2020  id, col_id].    
+000013d0: 6466 5f4c 203d 2064 665b 6b65 7973 5d0a  df_L = df[keys].
+000013e0: 2020 2020 0a20 2020 2023 2070 7269 6e74      .    # print
+000013f0: 2827 5b2b 5d20 7265 6164 206c 6973 745f  ('[+] read list_
+00001400: 6461 7465 2729 0a20 2020 2063 6f6c 203d  date').    col =
+00001410: 2027 6c69 7374 5f64 6174 6527 0a20 2020   'list_date'.   
+00001420: 2064 665f 5220 3d20 6462 2e73 656c 6563   df_R = db.selec
+00001430: 7428 2764 665f 6c69 7374 5f64 6174 6527  t('df_list_date'
+00001440: 2c20 636f 6c73 203d 205b 636f 6c5f 6964  , cols = [col_id
+00001450: 5d20 2b20 5b63 6f6c 5d29 0a20 2020 2064  ] + [col]).    d
+00001460: 665f 5220 3d20 6466 5f52 5b64 665f 525b  f_R = df_R[df_R[
+00001470: 276c 6973 745f 6461 7465 275d 203e 2030  'list_date'] > 0
+00001480: 5d2e 7265 7365 745f 696e 6465 7828 6472  ].reset_index(dr
+00001490: 6f70 203d 2054 7275 6529 0a20 2020 2073  op = True).    s
+000014a0: 5f6c 6973 745f 6461 7465 203d 206d 6572  _list_date = mer
+000014b0: 6765 2864 665f 4c2c 2064 665f 522c 205b  ge(df_L, df_R, [
+000014c0: 636f 6c5f 6964 5d29 5b63 6f6c 5d2e 746f  col_id])[col].to
+000014d0: 5f70 616e 6461 7328 290a 2020 2020 0a20  _pandas().    . 
+000014e0: 2020 2023 2070 7269 6e74 2827 5b2b 5d20     # print('[+] 
+000014f0: 7265 6164 2073 5f73 7427 290a 2020 2020  read s_st').    
+00001500: 636f 6c20 3d20 2753 5427 0a20 2020 2064  col = 'ST'.    d
+00001510: 665f 5220 3d20 6462 2e73 656c 6563 7428  f_R = db.select(
+00001520: 2764 665f 7374 272c 2063 6f6c 7320 3d20  'df_st', cols = 
+00001530: 6b65 7973 202b 205b 636f 6c5d 290a 2020  keys + [col]).  
+00001540: 2020 6466 5f52 203d 2064 665f 6578 7061    df_R = df_expa
+00001550: 6e64 5f4c 5f52 2864 665f 4c2c 2064 665f  nd_L_R(df_L, df_
+00001560: 5229 0a20 2020 2073 5f73 7420 3d20 6d65  R).    s_st = me
+00001570: 7267 6528 6466 5f4c 2c20 6466 5f52 2c20  rge(df_L, df_R, 
+00001580: 6b65 7973 295b 2753 5427 5d2e 746f 5f70  keys)['ST'].to_p
+00001590: 616e 6461 7328 292e 6669 6c6c 6e61 2830  andas().fillna(0
+000015a0: 290a 2020 2020 0a20 2020 2023 2070 7269  ).    .    # pri
+000015b0: 6e74 2827 5b2b 5d20 7265 6164 2073 5f73  nt('[+] read s_s
+000015c0: 7573 2729 0a20 2020 2063 6f6c 203d 2027  us').    col = '
+000015d0: 5355 5327 0a20 2020 2064 665f 5220 3d20  SUS'.    df_R = 
+000015e0: 6462 2e73 656c 6563 7428 2764 665f 7375  db.select('df_su
+000015f0: 7327 2c20 636f 6c73 203d 206b 6579 7320  s', cols = keys 
+00001600: 2b20 5b63 6f6c 5d29 0a20 2020 2064 665f  + [col]).    df_
+00001610: 5220 3d20 6466 5f65 7870 616e 645f 4c5f  R = df_expand_L_
+00001620: 5228 6466 5f4c 2c20 6466 5f52 290a 2020  R(df_L, df_R).  
+00001630: 2020 735f 7375 7320 3d20 6d65 7267 6528    s_sus = merge(
+00001640: 6466 5f4c 2c20 6466 5f52 2c20 6b65 7973  df_L, df_R, keys
+00001650: 295b 2753 5553 275d 2e74 6f5f 7061 6e64  )['SUS'].to_pand
+00001660: 6173 2829 2e66 696c 6c6e 6128 3029 0a20  as().fillna(0). 
+00001670: 2020 200a 2020 2020 2320 2d2d 2d2d 2d2d     .    # ------
+00001680: 2d2d 2d2d 2064 665f 6d61 736b 202d 2d2d  ---- df_mask ---
+00001690: 2d2d 2d2d 2d2d 2d0a 2020 2020 2320 7072  -------.    # pr
+000016a0: 696e 7428 275b 2b5d 2064 665f 6d61 736b  int('[+] df_mask
+000016b0: 2729 0a20 2020 2064 665f 6d61 736b 203d  ').    df_mask =
+000016c0: 2064 665b 6b65 7973 202b 205b 276f 7065   df[keys + ['ope
+000016d0: 6e27 2c20 2770 6374 5f63 6867 275d 5d0a  n', 'pct_chg']].
+000016e0: 2020 2020 6466 5f6d 6173 6b5b 276c 6973      df_mask['lis
+000016f0: 745f 6461 7465 275d 203d 2073 5f6c 6973  t_date'] = s_lis
+00001700: 745f 6461 7465 0a20 2020 2064 665f 6d61  t_date.    df_ma
+00001710: 736b 5b27 5354 275d 203d 2073 5f73 740a  sk['ST'] = s_st.
+00001720: 2020 2020 6466 5f6d 6173 6b5b 2753 5553      df_mask['SUS
+00001730: 275d 203d 2073 5f73 7573 0a0a 2020 2020  '] = s_sus..    
+00001740: 7320 3d20 6466 5f6d 6173 6b5b 636f 6c5f  s = df_mask[col_
+00001750: 7469 645d 2e64 726f 705f 6475 706c 6963  tid].drop_duplic
+00001760: 6174 6573 2829 2e72 6573 6574 5f69 6e64  ates().reset_ind
+00001770: 6578 2864 726f 7020 3d20 5472 7565 290a  ex(drop = True).
+00001780: 2020 2020 6461 7465 5f64 6963 745f 3120      date_dict_1 
+00001790: 3d20 6469 6374 287a 6970 2873 2c20 7064  = dict(zip(s, pd
+000017a0: 2e74 6f5f 6461 7465 7469 6d65 2873 2c20  .to_datetime(s, 
+000017b0: 666f 726d 6174 3d27 2559 256d 2564 2729  format='%Y%m%d')
+000017c0: 2929 0a20 2020 2073 203d 2064 665f 6d61  )).    s = df_ma
+000017d0: 736b 5b27 6c69 7374 5f64 6174 6527 5d2e  sk['list_date'].
+000017e0: 6472 6f70 5f64 7570 6c69 6361 7465 7328  drop_duplicates(
+000017f0: 292e 7265 7365 745f 696e 6465 7828 6472  ).reset_index(dr
+00001800: 6f70 203d 2054 7275 6529 0a20 2020 2064  op = True).    d
+00001810: 6174 655f 6469 6374 5f32 203d 2064 6963  ate_dict_2 = dic
+00001820: 7428 7a69 7028 732c 2070 642e 746f 5f64  t(zip(s, pd.to_d
+00001830: 6174 6574 696d 6528 732c 2066 6f72 6d61  atetime(s, forma
+00001840: 743d 2725 5925 6d25 6427 2929 290a 0a20  t='%Y%m%d'))).. 
+00001850: 2020 2023 2069 6478 5f78 7878 0a20 2020     # idx_xxx.   
+00001860: 2069 6478 5f32 3020 3d20 2864 665f 6d61   idx_20 = (df_ma
+00001870: 736b 5b63 6f6c 5f74 6964 5d2e 6d61 7028  sk[col_tid].map(
+00001880: 6461 7465 5f64 6963 745f 3129 202d 2064  date_dict_1) - d
+00001890: 665f 6d61 736b 5b27 6c69 7374 5f64 6174  f_mask['list_dat
+000018a0: 6527 5d2e 6d61 7028 6461 7465 5f64 6963  e'].map(date_dic
+000018b0: 745f 3229 292e 6474 2e64 6179 7320 3e3d  t_2)).dt.days >=
+000018c0: 2032 300a 2020 2020 6964 785f 6e61 6e20   20.    idx_nan 
+000018d0: 3d20 7e64 665f 6d61 736b 5b27 6f70 656e  = ~df_mask['open
+000018e0: 275d 2e69 736e 756c 6c28 290a 2020 2020  '].isnull().    
+000018f0: 6964 785f 7374 203d 2064 665f 6d61 736b  idx_st = df_mask
+00001900: 5b27 5354 275d 203c 3d20 300a 2020 2020  ['ST'] <= 0.    
+00001910: 6964 785f 7375 7320 3d20 6466 5f6d 6173  idx_sus = df_mas
+00001920: 6b5b 2753 5553 275d 203c 3d20 310a 2020  k['SUS'] <= 1.  
+00001930: 2020 0a20 2020 2023 202d 2d2d 2d2d 2d2d    .    # -------
 00001940: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
 00001950: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
 00001960: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
 00001970: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00001980: 2d0a 2020 2020 6e61 6d65 5f6c 6973 7420  -.    name_list 
-00001990: 3d20 5b0a 2020 2020 2020 2020 6627 5f5f  = [.        f'__
-000019a0: 5445 4d50 5f61 5f31 203d 2072 6f6c 6c28  TEMP_a_1 = roll(
-000019b0: 7368 6966 742c 207b 636f 6c5f 6964 7d2c  shift, {col_id},
-000019c0: 2061 6d6f 756e 742c 207b 636f 6c5f 7469   amount, {col_ti
-000019d0: 647d 2c20 3029 272c 0a20 2020 2020 2020  d}, 0)',.       
-000019e0: 2066 275f 5f54 454d 505f 615f 3220 3d20   f'__TEMP_a_2 = 
-000019f0: 726f 6c6c 2873 6869 6674 2c20 7b63 6f6c  roll(shift, {col
-00001a00: 5f69 647d 2c20 616d 6f75 6e74 2c20 7b63  _id}, amount, {c
-00001a10: 6f6c 5f74 6964 7d2c 2031 2927 2c0a 2020  ol_tid}, 1)',.  
-00001a20: 2020 2020 2020 6627 5f5f 5445 4d50 5f61        f'__TEMP_a
-00001a30: 5f33 203d 2072 6f6c 6c28 7368 6966 742c  _3 = roll(shift,
-00001a40: 207b 636f 6c5f 6964 7d2c 2061 6d6f 756e   {col_id}, amoun
-00001a50: 742c 207b 636f 6c5f 7469 647d 2c20 3229  t, {col_tid}, 2)
-00001a60: 272c 0a20 2020 2020 2020 200a 2020 2020  ',.        .    
-00001a70: 2020 2020 6627 5f5f 5445 4d50 5f68 5f31      f'__TEMP_h_1
-00001a80: 203d 2072 6f6c 6c28 7368 6966 742c 207b   = roll(shift, {
-00001a90: 636f 6c5f 6964 7d2c 2068 6967 682c 207b  col_id}, high, {
-00001aa0: 636f 6c5f 7469 647d 2c20 3029 272c 0a20  col_tid}, 0)',. 
-00001ab0: 2020 2020 2020 2066 275f 5f54 454d 505f         f'__TEMP_
-00001ac0: 685f 3220 3d20 726f 6c6c 2873 6869 6674  h_2 = roll(shift
-00001ad0: 2c20 7b63 6f6c 5f69 647d 2c20 6869 6768  , {col_id}, high
-00001ae0: 2c20 7b63 6f6c 5f74 6964 7d2c 2031 2927  , {col_tid}, 1)'
-00001af0: 2c0a 2020 2020 2020 2020 6627 5f5f 5445  ,.        f'__TE
-00001b00: 4d50 5f68 5f33 203d 2072 6f6c 6c28 7368  MP_h_3 = roll(sh
-00001b10: 6966 742c 207b 636f 6c5f 6964 7d2c 2068  ift, {col_id}, h
-00001b20: 6967 682c 207b 636f 6c5f 7469 647d 2c20  igh, {col_tid}, 
-00001b30: 3229 272c 0a0a 2020 2020 2020 2020 6627  2)',..        f'
-00001b40: 5f5f 5445 4d50 5f6c 5f31 203d 2072 6f6c  __TEMP_l_1 = rol
-00001b50: 6c28 7368 6966 742c 207b 636f 6c5f 6964  l(shift, {col_id
-00001b60: 7d2c 206c 6f77 2c20 7b63 6f6c 5f74 6964  }, low, {col_tid
-00001b70: 7d2c 2030 2927 2c0a 2020 2020 2020 2020  }, 0)',.        
-00001b80: 6627 5f5f 5445 4d50 5f6c 5f32 203d 2072  f'__TEMP_l_2 = r
-00001b90: 6f6c 6c28 7368 6966 742c 207b 636f 6c5f  oll(shift, {col_
-00001ba0: 6964 7d2c 206c 6f77 2c20 7b63 6f6c 5f74  id}, low, {col_t
-00001bb0: 6964 7d2c 2031 2927 2c0a 2020 2020 2020  id}, 1)',.      
-00001bc0: 2020 6627 5f5f 5445 4d50 5f6c 5f33 203d    f'__TEMP_l_3 =
-00001bd0: 2072 6f6c 6c28 7368 6966 742c 207b 636f   roll(shift, {co
-00001be0: 6c5f 6964 7d2c 206c 6f77 2c20 7b63 6f6c  l_id}, low, {col
-00001bf0: 5f74 6964 7d2c 2032 2927 2c0a 2020 2020  _tid}, 2)',.    
-00001c00: 5d0a 2020 2020 646d 2e66 655f 676f 286e  ].    dm.fe_go(n
-00001c10: 616d 655f 6c69 7374 2c20 7665 7262 6f73  ame_list, verbos
-00001c20: 6520 3d20 4661 6c73 6529 0a20 2020 2069  e = False).    i
-00001c30: 6478 5f61 2020 3d20 646d 2e67 6574 5f63  dx_a  = dm.get_c
-00001c40: 6f6c 5f6e 756d 7079 2827 5f5f 5445 4d50  ol_numpy('__TEMP
-00001c50: 5f61 5f31 2729 203c 3d20 3565 360a 2020  _a_1') <= 5e6.  
-00001c60: 2020 6964 785f 6120 263d 2064 6d2e 6765    idx_a &= dm.ge
-00001c70: 745f 636f 6c5f 6e75 6d70 7928 275f 5f54  t_col_numpy('__T
-00001c80: 454d 505f 615f 3227 2920 3c3d 2035 6536  EMP_a_2') <= 5e6
-00001c90: 0a20 2020 2069 6478 5f61 2026 3d20 646d  .    idx_a &= dm
-00001ca0: 2e67 6574 5f63 6f6c 5f6e 756d 7079 2827  .get_col_numpy('
-00001cb0: 5f5f 5445 4d50 5f61 5f33 2729 203c 3d20  __TEMP_a_3') <= 
-00001cc0: 3565 360a 0a20 2020 2069 6478 5f69 6e74  5e6..    idx_int
-00001cd0: 7261 5f72 6574 2020 3d20 6e70 2e61 6273  ra_ret  = np.abs
-00001ce0: 2864 6d2e 6765 745f 636f 6c5f 6e75 6d70  (dm.get_col_nump
-00001cf0: 7928 275f 5f54 454d 505f 685f 3127 2920  y('__TEMP_h_1') 
-00001d00: 2f20 646d 2e67 6574 5f63 6f6c 5f6e 756d  / dm.get_col_num
-00001d10: 7079 2827 5f5f 5445 4d50 5f6c 5f31 2729  py('__TEMP_l_1')
-00001d20: 202d 2031 2920 3c3d 2030 2e32 202f 2031   - 1) <= 0.2 / 1
-00001d30: 3030 0a20 2020 2069 6478 5f69 6e74 7261  00.    idx_intra
-00001d40: 5f72 6574 2026 3d20 6e70 2e61 6273 2864  _ret &= np.abs(d
-00001d50: 6d2e 6765 745f 636f 6c5f 6e75 6d70 7928  m.get_col_numpy(
-00001d60: 275f 5f54 454d 505f 685f 3227 2920 2f20  '__TEMP_h_2') / 
-00001d70: 646d 2e67 6574 5f63 6f6c 5f6e 756d 7079  dm.get_col_numpy
-00001d80: 2827 5f5f 5445 4d50 5f6c 5f32 2729 202d  ('__TEMP_l_2') -
-00001d90: 2031 2920 3c3d 2030 2e32 202f 2031 3030   1) <= 0.2 / 100
-00001da0: 0a20 2020 2069 6478 5f69 6e74 7261 5f72  .    idx_intra_r
-00001db0: 6574 2026 3d20 6e70 2e61 6273 2864 6d2e  et &= np.abs(dm.
-00001dc0: 6765 745f 636f 6c5f 6e75 6d70 7928 275f  get_col_numpy('_
-00001dd0: 5f54 454d 505f 685f 3327 2920 2f20 646d  _TEMP_h_3') / dm
-00001de0: 2e67 6574 5f63 6f6c 5f6e 756d 7079 2827  .get_col_numpy('
-00001df0: 5f5f 5445 4d50 5f6c 5f33 2729 202d 2031  __TEMP_l_3') - 1
-00001e00: 2920 3c3d 2030 2e32 202f 2031 3030 0a0a  ) <= 0.2 / 100..
-00001e10: 2020 2020 6964 785f 696e 7472 615f 6469      idx_intra_di
-00001e20: 6620 203d 206e 702e 6162 7328 646d 2e67  f  = np.abs(dm.g
-00001e30: 6574 5f63 6f6c 5f6e 756d 7079 2827 5f5f  et_col_numpy('__
-00001e40: 5445 4d50 5f68 5f31 2729 202d 2064 6d2e  TEMP_h_1') - dm.
-00001e50: 6765 745f 636f 6c5f 6e75 6d70 7928 275f  get_col_numpy('_
-00001e60: 5f54 454d 505f 6c5f 3127 2920 2d20 3029  _TEMP_l_1') - 0)
-00001e70: 203c 3d20 302e 3034 0a20 2020 2069 6478   <= 0.04.    idx
-00001e80: 5f69 6e74 7261 5f64 6966 2026 3d20 6e70  _intra_dif &= np
-00001e90: 2e61 6273 2864 6d2e 6765 745f 636f 6c5f  .abs(dm.get_col_
-00001ea0: 6e75 6d70 7928 275f 5f54 454d 505f 685f  numpy('__TEMP_h_
-00001eb0: 3227 2920 2d20 646d 2e67 6574 5f63 6f6c  2') - dm.get_col
-00001ec0: 5f6e 756d 7079 2827 5f5f 5445 4d50 5f6c  _numpy('__TEMP_l
-00001ed0: 5f32 2729 202d 2030 2920 3c3d 2030 2e30  _2') - 0) <= 0.0
-00001ee0: 340a 2020 2020 6964 785f 696e 7472 615f  4.    idx_intra_
-00001ef0: 6469 6620 263d 206e 702e 6162 7328 646d  dif &= np.abs(dm
-00001f00: 2e67 6574 5f63 6f6c 5f6e 756d 7079 2827  .get_col_numpy('
-00001f10: 5f5f 5445 4d50 5f68 5f33 2729 202d 2064  __TEMP_h_3') - d
-00001f20: 6d2e 6765 745f 636f 6c5f 6e75 6d70 7928  m.get_col_numpy(
-00001f30: 275f 5f54 454d 505f 6c5f 3327 2920 2d20  '__TEMP_l_3') - 
-00001f40: 3029 203c 3d20 302e 3034 0a20 2020 2064  0) <= 0.04.    d
-00001f50: 6d2e 6472 6f70 286e 616d 655f 6c69 7374  m.drop(name_list
-00001f60: 2c20 7665 7262 6f73 6520 3d20 4661 6c73  , verbose = Fals
-00001f70: 6529 0a20 2020 206d 6173 6b5f 6b6a 795f  e).    mask_kjy_
-00001f80: 7476 7220 3d20 7e28 6964 785f 6120 7c20  tvr = ~(idx_a | 
-00001f90: 6964 785f 696e 7472 615f 7265 7420 7c20  idx_intra_ret | 
-00001fa0: 6964 785f 696e 7472 615f 6469 6629 0a0a  idx_intra_dif)..
-00001fb0: 2020 2020 2320 3020 3d20 3630 7878 7878      # 0 = 60xxxx
-00001fc0: 2e53 480a 2020 2020 2320 3120 3d20 3030  .SH.    # 1 = 00
-00001fd0: 7878 7878 2e53 5a0a 2020 2020 2320 3220  xxxx.SZ.    # 2 
-00001fe0: 3d20 3330 7878 7878 2e53 5a0a 2020 2020  = 30xxxx.SZ.    
-00001ff0: 2320 3320 3d20 3638 7878 7878 2e53 480a  # 3 = 68xxxx.SH.
-00002000: 2020 2020 2320 3420 3d20 5b34 2c38 5d78      # 4 = [4,8]x
-00002010: 7878 7878 2e42 4a0a 2020 2020 6964 5f6b  xxxx.BJ.    id_k
-00002020: 203d 2064 665b 636f 6c5f 6964 5d2e 756e   = df[col_id].un
-00002030: 6971 7565 2829 0a20 2020 2069 645f 7620  ique().    id_v 
-00002040: 3d20 2870 642e 5365 7269 6573 2869 645f  = (pd.Series(id_
-00002050: 6b29 2e61 7070 6c79 2863 6f64 655f 325f  k).apply(code_2_
-00002060: 6d61 726b 6574 2920 3c3d 2033 290a 2020  market) <= 3).  
-00002070: 2020 6d61 736b 5f6b 6a79 5f69 6420 3d20    mask_kjy_id = 
-00002080: 6466 5b63 6f6c 5f69 645d 2e6d 6170 2864  df[col_id].map(d
-00002090: 6963 7428 7a69 7028 6964 5f6b 2c20 6964  ict(zip(id_k, id
-000020a0: 5f76 2929 2920 3d3d 2054 7275 650a 2020  _v))) == True.  
-000020b0: 2020 2320 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    # ------------
-000020c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00001980: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00001990: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
+000019a0: 2020 6e61 6d65 5f6c 6973 7420 3d20 5b0a    name_list = [.
+000019b0: 2020 2020 2020 2020 6627 5f5f 5445 4d50          f'__TEMP
+000019c0: 5f61 5f31 203d 2072 6f6c 6c28 7368 6966  _a_1 = roll(shif
+000019d0: 742c 207b 636f 6c5f 6964 7d2c 2061 6d6f  t, {col_id}, amo
+000019e0: 756e 742c 207b 636f 6c5f 7469 647d 2c20  unt, {col_tid}, 
+000019f0: 3029 272c 0a20 2020 2020 2020 2066 275f  0)',.        f'_
+00001a00: 5f54 454d 505f 615f 3220 3d20 726f 6c6c  _TEMP_a_2 = roll
+00001a10: 2873 6869 6674 2c20 7b63 6f6c 5f69 647d  (shift, {col_id}
+00001a20: 2c20 616d 6f75 6e74 2c20 7b63 6f6c 5f74  , amount, {col_t
+00001a30: 6964 7d2c 2031 2927 2c0a 2020 2020 2020  id}, 1)',.      
+00001a40: 2020 6627 5f5f 5445 4d50 5f61 5f33 203d    f'__TEMP_a_3 =
+00001a50: 2072 6f6c 6c28 7368 6966 742c 207b 636f   roll(shift, {co
+00001a60: 6c5f 6964 7d2c 2061 6d6f 756e 742c 207b  l_id}, amount, {
+00001a70: 636f 6c5f 7469 647d 2c20 3229 272c 0a20  col_tid}, 2)',. 
+00001a80: 2020 2020 2020 200a 2020 2020 2020 2020         .        
+00001a90: 6627 5f5f 5445 4d50 5f68 5f31 203d 2072  f'__TEMP_h_1 = r
+00001aa0: 6f6c 6c28 7368 6966 742c 207b 636f 6c5f  oll(shift, {col_
+00001ab0: 6964 7d2c 2068 6967 682c 207b 636f 6c5f  id}, high, {col_
+00001ac0: 7469 647d 2c20 3029 272c 0a20 2020 2020  tid}, 0)',.     
+00001ad0: 2020 2066 275f 5f54 454d 505f 685f 3220     f'__TEMP_h_2 
+00001ae0: 3d20 726f 6c6c 2873 6869 6674 2c20 7b63  = roll(shift, {c
+00001af0: 6f6c 5f69 647d 2c20 6869 6768 2c20 7b63  ol_id}, high, {c
+00001b00: 6f6c 5f74 6964 7d2c 2031 2927 2c0a 2020  ol_tid}, 1)',.  
+00001b10: 2020 2020 2020 6627 5f5f 5445 4d50 5f68        f'__TEMP_h
+00001b20: 5f33 203d 2072 6f6c 6c28 7368 6966 742c  _3 = roll(shift,
+00001b30: 207b 636f 6c5f 6964 7d2c 2068 6967 682c   {col_id}, high,
+00001b40: 207b 636f 6c5f 7469 647d 2c20 3229 272c   {col_tid}, 2)',
+00001b50: 0a0a 2020 2020 2020 2020 6627 5f5f 5445  ..        f'__TE
+00001b60: 4d50 5f6c 5f31 203d 2072 6f6c 6c28 7368  MP_l_1 = roll(sh
+00001b70: 6966 742c 207b 636f 6c5f 6964 7d2c 206c  ift, {col_id}, l
+00001b80: 6f77 2c20 7b63 6f6c 5f74 6964 7d2c 2030  ow, {col_tid}, 0
+00001b90: 2927 2c0a 2020 2020 2020 2020 6627 5f5f  )',.        f'__
+00001ba0: 5445 4d50 5f6c 5f32 203d 2072 6f6c 6c28  TEMP_l_2 = roll(
+00001bb0: 7368 6966 742c 207b 636f 6c5f 6964 7d2c  shift, {col_id},
+00001bc0: 206c 6f77 2c20 7b63 6f6c 5f74 6964 7d2c   low, {col_tid},
+00001bd0: 2031 2927 2c0a 2020 2020 2020 2020 6627   1)',.        f'
+00001be0: 5f5f 5445 4d50 5f6c 5f33 203d 2072 6f6c  __TEMP_l_3 = rol
+00001bf0: 6c28 7368 6966 742c 207b 636f 6c5f 6964  l(shift, {col_id
+00001c00: 7d2c 206c 6f77 2c20 7b63 6f6c 5f74 6964  }, low, {col_tid
+00001c10: 7d2c 2032 2927 2c0a 2020 2020 5d0a 2020  }, 2)',.    ].  
+00001c20: 2020 646d 2e66 655f 676f 286e 616d 655f    dm.fe_go(name_
+00001c30: 6c69 7374 2c20 7665 7262 6f73 6520 3d20  list, verbose = 
+00001c40: 4661 6c73 6529 0a20 2020 2069 6478 5f61  False).    idx_a
+00001c50: 2020 3d20 646d 2e67 6574 5f63 6f6c 5f6e    = dm.get_col_n
+00001c60: 756d 7079 2827 5f5f 5445 4d50 5f61 5f31  umpy('__TEMP_a_1
+00001c70: 2729 203c 3d20 3565 360a 2020 2020 6964  ') <= 5e6.    id
+00001c80: 785f 6120 263d 2064 6d2e 6765 745f 636f  x_a &= dm.get_co
+00001c90: 6c5f 6e75 6d70 7928 275f 5f54 454d 505f  l_numpy('__TEMP_
+00001ca0: 615f 3227 2920 3c3d 2035 6536 0a20 2020  a_2') <= 5e6.   
+00001cb0: 2069 6478 5f61 2026 3d20 646d 2e67 6574   idx_a &= dm.get
+00001cc0: 5f63 6f6c 5f6e 756d 7079 2827 5f5f 5445  _col_numpy('__TE
+00001cd0: 4d50 5f61 5f33 2729 203c 3d20 3565 360a  MP_a_3') <= 5e6.
+00001ce0: 0a20 2020 2069 6478 5f69 6e74 7261 5f72  .    idx_intra_r
+00001cf0: 6574 2020 3d20 6e70 2e61 6273 2864 6d2e  et  = np.abs(dm.
+00001d00: 6765 745f 636f 6c5f 6e75 6d70 7928 275f  get_col_numpy('_
+00001d10: 5f54 454d 505f 685f 3127 2920 2f20 646d  _TEMP_h_1') / dm
+00001d20: 2e67 6574 5f63 6f6c 5f6e 756d 7079 2827  .get_col_numpy('
+00001d30: 5f5f 5445 4d50 5f6c 5f31 2729 202d 2031  __TEMP_l_1') - 1
+00001d40: 2920 3c3d 2030 2e32 202f 2031 3030 0a20  ) <= 0.2 / 100. 
+00001d50: 2020 2069 6478 5f69 6e74 7261 5f72 6574     idx_intra_ret
+00001d60: 2026 3d20 6e70 2e61 6273 2864 6d2e 6765   &= np.abs(dm.ge
+00001d70: 745f 636f 6c5f 6e75 6d70 7928 275f 5f54  t_col_numpy('__T
+00001d80: 454d 505f 685f 3227 2920 2f20 646d 2e67  EMP_h_2') / dm.g
+00001d90: 6574 5f63 6f6c 5f6e 756d 7079 2827 5f5f  et_col_numpy('__
+00001da0: 5445 4d50 5f6c 5f32 2729 202d 2031 2920  TEMP_l_2') - 1) 
+00001db0: 3c3d 2030 2e32 202f 2031 3030 0a20 2020  <= 0.2 / 100.   
+00001dc0: 2069 6478 5f69 6e74 7261 5f72 6574 2026   idx_intra_ret &
+00001dd0: 3d20 6e70 2e61 6273 2864 6d2e 6765 745f  = np.abs(dm.get_
+00001de0: 636f 6c5f 6e75 6d70 7928 275f 5f54 454d  col_numpy('__TEM
+00001df0: 505f 685f 3327 2920 2f20 646d 2e67 6574  P_h_3') / dm.get
+00001e00: 5f63 6f6c 5f6e 756d 7079 2827 5f5f 5445  _col_numpy('__TE
+00001e10: 4d50 5f6c 5f33 2729 202d 2031 2920 3c3d  MP_l_3') - 1) <=
+00001e20: 2030 2e32 202f 2031 3030 0a0a 2020 2020   0.2 / 100..    
+00001e30: 6964 785f 696e 7472 615f 6469 6620 203d  idx_intra_dif  =
+00001e40: 206e 702e 6162 7328 646d 2e67 6574 5f63   np.abs(dm.get_c
+00001e50: 6f6c 5f6e 756d 7079 2827 5f5f 5445 4d50  ol_numpy('__TEMP
+00001e60: 5f68 5f31 2729 202d 2064 6d2e 6765 745f  _h_1') - dm.get_
+00001e70: 636f 6c5f 6e75 6d70 7928 275f 5f54 454d  col_numpy('__TEM
+00001e80: 505f 6c5f 3127 2920 2d20 3029 203c 3d20  P_l_1') - 0) <= 
+00001e90: 302e 3034 0a20 2020 2069 6478 5f69 6e74  0.04.    idx_int
+00001ea0: 7261 5f64 6966 2026 3d20 6e70 2e61 6273  ra_dif &= np.abs
+00001eb0: 2864 6d2e 6765 745f 636f 6c5f 6e75 6d70  (dm.get_col_nump
+00001ec0: 7928 275f 5f54 454d 505f 685f 3227 2920  y('__TEMP_h_2') 
+00001ed0: 2d20 646d 2e67 6574 5f63 6f6c 5f6e 756d  - dm.get_col_num
+00001ee0: 7079 2827 5f5f 5445 4d50 5f6c 5f32 2729  py('__TEMP_l_2')
+00001ef0: 202d 2030 2920 3c3d 2030 2e30 340a 2020   - 0) <= 0.04.  
+00001f00: 2020 6964 785f 696e 7472 615f 6469 6620    idx_intra_dif 
+00001f10: 263d 206e 702e 6162 7328 646d 2e67 6574  &= np.abs(dm.get
+00001f20: 5f63 6f6c 5f6e 756d 7079 2827 5f5f 5445  _col_numpy('__TE
+00001f30: 4d50 5f68 5f33 2729 202d 2064 6d2e 6765  MP_h_3') - dm.ge
+00001f40: 745f 636f 6c5f 6e75 6d70 7928 275f 5f54  t_col_numpy('__T
+00001f50: 454d 505f 6c5f 3327 2920 2d20 3029 203c  EMP_l_3') - 0) <
+00001f60: 3d20 302e 3034 0a20 2020 2064 6d2e 6472  = 0.04.    dm.dr
+00001f70: 6f70 286e 616d 655f 6c69 7374 2c20 7665  op(name_list, ve
+00001f80: 7262 6f73 6520 3d20 4661 6c73 6529 0a20  rbose = False). 
+00001f90: 2020 206d 6173 6b5f 6b6a 795f 7476 7220     mask_kjy_tvr 
+00001fa0: 3d20 7e28 6964 785f 6120 7c20 6964 785f  = ~(idx_a | idx_
+00001fb0: 696e 7472 615f 7265 7420 7c20 6964 785f  intra_ret | idx_
+00001fc0: 696e 7472 615f 6469 6629 0a0a 2020 2020  intra_dif)..    
+00001fd0: 2320 3020 3d20 3630 7878 7878 2e53 480a  # 0 = 60xxxx.SH.
+00001fe0: 2020 2020 2320 3120 3d20 3030 7878 7878      # 1 = 00xxxx
+00001ff0: 2e53 5a0a 2020 2020 2320 3220 3d20 3330  .SZ.    # 2 = 30
+00002000: 7878 7878 2e53 5a0a 2020 2020 2320 3320  xxxx.SZ.    # 3 
+00002010: 3d20 3638 7878 7878 2e53 480a 2020 2020  = 68xxxx.SH.    
+00002020: 2320 3420 3d20 5b34 2c38 5d78 7878 7878  # 4 = [4,8]xxxxx
+00002030: 2e42 4a0a 2020 2020 6964 5f6b 203d 2064  .BJ.    id_k = d
+00002040: 665b 636f 6c5f 6964 5d2e 756e 6971 7565  f[col_id].unique
+00002050: 2829 0a20 2020 2069 645f 7620 3d20 2870  ().    id_v = (p
+00002060: 642e 5365 7269 6573 2869 645f 6b29 2e61  d.Series(id_k).a
+00002070: 7070 6c79 2863 6f64 655f 325f 6d61 726b  pply(code_2_mark
+00002080: 6574 2920 3c3d 2033 290a 2020 2020 6d61  et) <= 3).    ma
+00002090: 736b 5f6b 6a79 5f69 6420 3d20 6466 5b63  sk_kjy_id = df[c
+000020a0: 6f6c 5f69 645d 2e6d 6170 2864 6963 7428  ol_id].map(dict(
+000020b0: 7a69 7028 6964 5f6b 2c20 6964 5f76 2929  zip(id_k, id_v))
+000020c0: 2920 3d3d 2054 7275 650a 2020 2020 2320  ) == True.    # 
 000020d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
 000020e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
 000020f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
 00002100: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002110: 2d2d 2d2d 2d2d 2d2d 0a0a 2020 2020 6966  --------..    if
-00002120: 2076 6572 626f 7365 3a20 7072 696e 7428   verbose: print(
-00002130: 275b 2b5d 2053 542c 204b 4a59 2c20 5a44  '[+] ST, KJY, ZD
-00002140: 542c 204d 4153 4b27 290a 2020 2020 6466  T, MASK').    df
-00002150: 5f6d 6173 6b5b 274d 4153 4b5f 5354 275d  _mask['MASK_ST']
-00002160: 203d 2028 6964 785f 7374 292e 6173 7479   = (idx_st).asty
-00002170: 7065 286e 702e 696e 7433 3229 0a0a 2020  pe(np.int32)..  
-00002180: 2020 6466 5f6d 6173 6b5b 274d 4153 4b5f    df_mask['MASK_
-00002190: 4b4a 5927 5d20 3d20 2869 6478 5f6e 616e  KJY'] = (idx_nan
-000021a0: 2026 2069 6478 5f32 3020 2620 6964 785f   & idx_20 & idx_
-000021b0: 7374 2026 2069 6478 5f73 7573 292e 6173  st & idx_sus).as
-000021c0: 7479 7065 286e 702e 696e 7433 3229 0a20  type(np.int32). 
-000021d0: 2020 2069 6620 7665 7262 6f73 653a 2070     if verbose: p
-000021e0: 7269 6e74 2866 225b 2b5d 2064 665f 6d61  rint(f"[+] df_ma
-000021f0: 736b 5b27 4d41 534b 5f4b 4a59 275d 2e73  sk['MASK_KJY'].s
-00002200: 756d 2829 203d 207b 6466 5f6d 6173 6b5b  um() = {df_mask[
-00002210: 274d 4153 4b5f 4b4a 5927 5d2e 7375 6d28  'MASK_KJY'].sum(
-00002220: 297d 2229 0a20 2020 2023 2064 665f 6d61  )}").    # df_ma
-00002230: 736b 5b27 4d41 534b 5f4b 4a59 275d 203d  sk['MASK_KJY'] =
-00002240: 2028 6466 5f6d 6173 6b5b 274d 4153 4b5f   (df_mask['MASK_
-00002250: 4b4a 5927 5d20 2620 6d61 736b 5f6b 6a79  KJY'] & mask_kjy
-00002260: 5f74 7672 292e 6173 7479 7065 286e 702e  _tvr).astype(np.
-00002270: 696e 7433 3229 0a20 2020 2069 6620 7665  int32).    if ve
-00002280: 7262 6f73 653a 2070 7269 6e74 2866 225b  rbose: print(f"[
-00002290: 2b5d 2064 665f 6d61 736b 5b27 4d41 534b  +] df_mask['MASK
-000022a0: 5f4b 4a59 275d 2e73 756d 2829 203d 207b  _KJY'].sum() = {
-000022b0: 6466 5f6d 6173 6b5b 274d 4153 4b5f 4b4a  df_mask['MASK_KJ
-000022c0: 5927 5d2e 7375 6d28 297d 2c20 6166 7465  Y'].sum()}, afte
-000022d0: 7220 263d 206d 6173 6b5f 6b6a 795f 7476  r &= mask_kjy_tv
-000022e0: 7222 290a 2020 2020 6466 5f6d 6173 6b5b  r").    df_mask[
-000022f0: 274d 4153 4b5f 4b4a 5927 5d20 3d20 2864  'MASK_KJY'] = (d
-00002300: 665f 6d61 736b 5b27 4d41 534b 5f4b 4a59  f_mask['MASK_KJY
-00002310: 275d 2026 206d 6173 6b5f 6b6a 795f 6964  '] & mask_kjy_id
-00002320: 292e 6173 7479 7065 286e 702e 696e 7433  ).astype(np.int3
-00002330: 3229 0a20 2020 2069 6620 7665 7262 6f73  2).    if verbos
-00002340: 653a 2070 7269 6e74 2866 225b 2b5d 2064  e: print(f"[+] d
-00002350: 665f 6d61 736b 5b27 4d41 534b 5f4b 4a59  f_mask['MASK_KJY
-00002360: 275d 2e73 756d 2829 203d 207b 6466 5f6d  '].sum() = {df_m
-00002370: 6173 6b5b 274d 4153 4b5f 4b4a 5927 5d2e  ask['MASK_KJY'].
-00002380: 7375 6d28 297d 2c20 6166 7465 7220 263d  sum()}, after &=
-00002390: 206d 6173 6b5f 6b6a 795f 6964 2229 0a20   mask_kjy_id"). 
-000023a0: 2020 200a 2020 2020 6d61 736b 5f7a 6474     .    mask_zdt
-000023b0: 5f6e 616e 203d 2064 665f 6d61 736b 5b27  _nan = df_mask['
-000023c0: 7063 745f 6368 6727 5d2e 6973 6e75 6c6c  pct_chg'].isnull
-000023d0: 2829 2023 2070 6374 5f63 6867 2069 7320  () # pct_chg is 
-000023e0: 6e61 6e2c 206e 6f74 2073 6574 2066 6f72  nan, not set for
-000023f0: 207a 6474 0a20 2020 206d 6173 6b5f 7a64   zdt.    mask_zd
-00002400: 745f 3130 203d 2028 6964 785f 7374 203d  t_10 = (idx_st =
-00002410: 3d20 3129 2026 2028 6466 5f6d 6173 6b5b  = 1) & (df_mask[
-00002420: 2770 6374 5f63 6867 275d 2e61 6273 2829  'pct_chg'].abs()
-00002430: 203c 3d20 392e 3530 290a 2020 2020 6d61   <= 9.50).    ma
-00002440: 736b 5f7a 6474 5f73 7420 3d20 2869 6478  sk_zdt_st = (idx
-00002450: 5f73 7420 3d3d 2030 2920 2620 2864 665f  _st == 0) & (df_
-00002460: 6d61 736b 5b27 7063 745f 6368 6727 5d2e  mask['pct_chg'].
-00002470: 6162 7328 2920 3c3d 2034 2e37 3529 0a20  abs() <= 4.75). 
-00002480: 2020 2064 665f 6d61 736b 5b27 4d41 534b     df_mask['MASK
-00002490: 5f5a 4454 275d 203d 2028 6d61 736b 5f7a  _ZDT'] = (mask_z
-000024a0: 6474 5f31 3020 7c20 6d61 736b 5f7a 6474  dt_10 | mask_zdt
-000024b0: 5f73 7420 7c20 6d61 736b 5f7a 6474 5f6e  _st | mask_zdt_n
-000024c0: 616e 292e 6173 7479 7065 286e 702e 696e  an).astype(np.in
-000024d0: 7433 3229 0a20 2020 2064 665f 6d61 736b  t32).    df_mask
-000024e0: 5b27 4d41 534b 275d 203d 2064 665f 6d61  ['MASK'] = df_ma
-000024f0: 736b 5b27 4d41 534b 5f4b 4a59 275d 2026  sk['MASK_KJY'] &
-00002500: 2064 665f 6d61 736b 5b27 4d41 534b 5f5a   df_mask['MASK_Z
-00002510: 4454 275d 0a20 2020 2063 6f6c 735f 6d61  DT'].    cols_ma
-00002520: 736b 203d 205b 274d 4153 4b5f 5354 272c  sk = ['MASK_ST',
-00002530: 2027 4d41 534b 5f4b 4a59 272c 2027 4d41   'MASK_KJY', 'MA
-00002540: 534b 5f5a 4454 272c 2027 4d41 534b 275d  SK_ZDT', 'MASK']
-00002550: 0a20 2020 2064 622e 636c 6f73 6528 290a  .    db.close().
-00002560: 2020 2020 7265 7475 726e 2064 665f 6d61      return df_ma
-00002570: 736b 2c20 636f 6c73 5f6d 6173 6b0a 0a63  sk, cols_mask..c
-00002580: 6c61 7373 2042 6173 6544 6174 6128 293a  lass BaseData():
-00002590: 0a20 2020 2064 6566 2067 6574 5f64 6628  .    def get_df(
-000025a0: 7365 6c66 2c20 7061 7468 5f69 6e70 7574  self, path_input
-000025b0: 2c20 6461 7465 5f62 6567 696e 2c20 6461  , date_begin, da
-000025c0: 7465 5f65 6e64 2c20 6e5f 6a6f 6273 293a  te_end, n_jobs):
-000025d0: 0a20 2020 2020 2020 2072 6169 7365 204e  .        raise N
-000025e0: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
-000025f0: 6f72 2827 796f 7520 6e65 6564 2074 6f20  or('you need to 
-00002600: 696d 706c 656d 656e 7420 6765 745f 6466  implement get_df
-00002610: 2829 2729 0a0a 2020 2020 6465 6620 6c6f  ()')..    def lo
-00002620: 6164 2873 656c 662c 2064 6174 615f 636f  ad(self, data_co
-00002630: 6e66 6967 2c20 6466 203d 204e 6f6e 652c  nfig, df = None,
-00002640: 2076 6572 626f 7365 203d 2054 7275 6529   verbose = True)
-00002650: 3a0a 2020 2020 2020 2020 2320 696e 7075  :.        # inpu
-00002660: 740a 2020 2020 2020 2020 7061 7468 5f69  t.        path_i
-00002670: 6e70 7574 203d 2043 4f4e 5354 2e50 4154  nput = CONST.PAT
-00002680: 485f 4441 5441 0a20 2020 2020 2020 2064  H_DATA.        d
-00002690: 6174 655f 6469 6374 203d 2064 6174 615f  ate_dict = data_
-000026a0: 636f 6e66 6967 5b27 6461 7465 5f64 6963  config['date_dic
-000026b0: 7427 5d0a 2020 2020 2020 2020 6e5f 6a6f  t'].        n_jo
-000026c0: 6273 203d 2064 6174 615f 636f 6e66 6967  bs = data_config
-000026d0: 5b27 6e5f 6a6f 6273 275d 0a0a 2020 2020  ['n_jobs']..    
-000026e0: 2020 2020 636f 6c73 5f64 6963 7420 3d20      cols_dict = 
-000026f0: 6461 7461 5f63 6f6e 6669 675b 2763 6f6c  data_config['col
-00002700: 735f 6469 6374 275d 0a20 2020 2020 2020  s_dict'].       
-00002710: 206f 7468 6572 5f69 6e66 6f20 3d20 6461   other_info = da
-00002720: 7461 5f63 6f6e 6669 675b 276f 7468 6572  ta_config['other
-00002730: 5f69 6e66 6f27 5d0a 0a20 2020 2020 2020  _info']..       
-00002740: 2063 6f6c 5f69 6420 3d20 636f 6c73 5f64   col_id = cols_d
-00002750: 6963 745b 2763 6f6c 5f69 6427 5d0a 2020  ict['col_id'].  
-00002760: 2020 2020 2020 636f 6c5f 6c61 6265 6c20        col_label 
-00002770: 3d20 636f 6c73 5f64 6963 745b 2763 6f6c  = cols_dict['col
-00002780: 5f6c 6162 656c 275d 0a20 2020 2020 2020  _label'].       
-00002790: 2063 6f6c 735f 7469 6420 3d20 636f 6c73   cols_tid = cols
-000027a0: 5f64 6963 745b 2763 6f6c 735f 7469 6427  _dict['cols_tid'
-000027b0: 5d0a 2020 2020 2020 2020 636f 6c5f 7469  ].        col_ti
-000027c0: 6420 3d20 636f 6c73 5f64 6963 745b 2763  d = cols_dict['c
-000027d0: 6f6c 5f74 6964 275d 0a20 2020 2020 2020  ol_tid'].       
-000027e0: 200a 2020 2020 2020 2020 2320 646d 0a20   .        # dm. 
-000027f0: 2020 2020 2020 2069 6620 6466 2069 7320         if df is 
-00002800: 4e6f 6e65 3a20 6466 203d 2073 656c 662e  None: df = self.
-00002810: 6765 745f 6466 2870 6174 685f 696e 7075  get_df(path_inpu
-00002820: 742c 202a 6461 7465 5f64 6963 745b 2761  t, *date_dict['a
-00002830: 6c6c 275d 2c20 6e5f 6a6f 6273 2920 2320  ll'], n_jobs) # 
-00002840: 6d61 736b 5f61 6c6c 0a20 2020 2020 2020  mask_all.       
-00002850: 2069 6620 2744 6174 614d 6173 7465 7227   if 'DataMaster'
-00002860: 2069 6e20 7374 7228 7479 7065 2864 6629   in str(type(df)
-00002870: 293a 2064 6d20 3d20 6466 0a20 2020 2020  ): dm = df.     
-00002880: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00002890: 2020 2020 2064 662e 7265 7365 745f 696e       df.reset_in
-000028a0: 6465 7828 6472 6f70 203d 2054 7275 652c  dex(drop = True,
-000028b0: 2069 6e70 6c61 6365 203d 2054 7275 6529   inplace = True)
-000028c0: 2023 2054 4f44 4f20 7265 7365 745f 696e   # TODO reset_in
-000028d0: 6465 780a 2020 2020 2020 2020 2020 2020  dex.            
-000028e0: 646d 203d 2044 6174 614d 6173 7465 7228  dm = DataMaster(
-000028f0: 6466 2c20 7665 7262 6f73 6520 3d20 4661  df, verbose = Fa
-00002900: 6c73 652c 206b 6565 705f 7370 6163 6520  lse, keep_space 
-00002910: 3d20 5472 7565 290a 2020 2020 2020 2020  = True).        
-00002920: 2020 2020 2320 646d 2e73 6f72 745f 7661      # dm.sort_va
-00002930: 6c75 6573 2863 6f6c 735f 7469 6420 2b20  lues(cols_tid + 
-00002940: 5b63 6f6c 5f69 645d 2920 2320 736f 7274  [col_id]) # sort
-00002950: 2c20 544f 444f 0a20 2020 2020 2020 2064  , TODO.        d
-00002960: 6d2e 6665 5f67 6f28 5b63 6f6c 5f74 6964  m.fe_go([col_tid
-00002970: 5d2c 2076 6572 626f 7365 203d 2046 616c  ], verbose = Fal
-00002980: 7365 290a 2020 2020 2020 2020 0a20 2020  se).        .   
-00002990: 2020 2020 2023 202d 2d2d 2d2d 2d2d 2d2d       # ---------
-000029a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000029b0: 2d2d 2d2d 2d20 6c61 6265 6c20 2d2d 2d2d  ----- label ----
-000029c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000029d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2054 4f44 4f0a  ---------- TODO.
-000029e0: 2020 2020 2020 2020 6966 2076 6572 626f          if verbo
-000029f0: 7365 3a20 7072 696e 7428 275b 696e 6974  se: print('[init
-00002a00: 5d20 3c2d 2d2d 2d2d 2d2d 2d2d 2d20 6c61  ] <---------- la
-00002a10: 6265 6c20 2d2d 2d2d 2d2d 2d2d 2d2d 3e20  bel ----------> 
-00002a20: 2729 0a20 2020 2020 2020 2063 6f6c 203d  ').        col =
-00002a30: 2066 2772 6f6c 6c28 7368 6966 742c 207b   f'roll(shift, {
-00002a40: 636f 6c5f 6964 7d2c 2063 6c6f 7365 2c20  col_id}, close, 
-00002a50: 207b 636f 6c5f 7469 647d 2c20 3129 270a   {col_tid}, 1)'.
-00002a60: 2020 2020 2020 2020 646d 2e66 655f 676f          dm.fe_go
-00002a70: 285b 6627 4144 4a20 3d20 6469 7628 7b63  ([f'ADJ = div({c
-00002a80: 6f6c 7d2c 2070 7265 5f63 6c6f 7365 2927  ol}, pre_close)'
-00002a90: 5d2c 2076 6572 626f 7365 203d 2076 6572  ], verbose = ver
-00002aa0: 626f 7365 290a 2020 2020 2020 2020 646d  bose).        dm
-00002ab0: 2e64 726f 7028 5b63 6f6c 5d2c 2076 6572  .drop([col], ver
-00002ac0: 626f 7365 203d 2046 616c 7365 290a 2020  bose = False).  
-00002ad0: 2020 2020 2020 2320 6261 7369 6320 636f        # basic co
-00002ae0: 6c75 6d6e 730a 2020 2020 2020 2020 6e61  lumns.        na
-00002af0: 6d65 5f6c 6973 7420 3d20 5b0a 2020 2020  me_list = [.    
-00002b00: 2020 2020 2020 2020 6627 7677 6170 203d          f'vwap =
-00002b10: 2064 6976 2861 6d6f 756e 742c 2076 6f6c   div(amount, vol
-00002b20: 2927 2c0a 2020 2020 2020 2020 2020 2020  )',.            
-00002b30: 6627 7477 6170 203d 206f 2876 7761 7029  f'twap = o(vwap)
-00002b40: 272c 0a20 2020 2020 2020 2020 2020 2066  ',.            f
-00002b50: 276d 6561 6e20 3d20 6d65 616e 5f6d 286f  'mean = mean_m(o
-00002b60: 7065 6e2c 2068 6967 682c 206c 6f77 2c20  pen, high, low, 
-00002b70: 636c 6f73 6529 272c 0a20 2020 2020 2020  close)',.       
-00002b80: 205d 0a20 2020 2020 2020 2064 6d2e 6665   ].        dm.fe
-00002b90: 5f67 6f28 6e61 6d65 5f6c 6973 742c 2076  _go(name_list, v
-00002ba0: 6572 626f 7365 203d 2046 616c 7365 290a  erbose = False).
-00002bb0: 0a20 2020 2020 2020 2023 2070 7265 5f78  .        # pre_x
-00002bc0: 7878 2c20 7878 785f 7265 740a 2020 2020  xx, xxx_ret.    
-00002bd0: 2020 2020 6e61 6d65 5f6c 6973 7420 3d20      name_list = 
-00002be0: 5b5d 0a20 2020 2020 2020 2066 6f72 2063  [].        for c
-00002bf0: 6f6c 2069 6e20 5b27 7477 6170 272c 2027  ol in ['twap', '
-00002c00: 7677 6170 272c 2027 6f70 656e 272c 2027  vwap', 'open', '
-00002c10: 636c 6f73 6527 5d20 2b20 5b27 6d65 616e  close'] + ['mean
-00002c20: 275d 3a0a 2020 2020 2020 2020 2020 2020  ']:.            
-00002c30: 6966 2027 7072 655f 7b63 6f6c 7d27 206e  if 'pre_{col}' n
-00002c40: 6f74 2069 6e20 646d 2e68 6561 6428 292e  ot in dm.head().
-00002c50: 636f 6c75 6d6e 733a 0a20 2020 2020 2020  columns:.       
-00002c60: 2020 2020 2020 2020 206e 616d 655f 6c69           name_li
-00002c70: 7374 202b 3d20 5b66 2770 7265 5f7b 636f  st += [f'pre_{co
-00002c80: 6c7d 203d 2072 6f6c 6c28 7368 6966 742c  l} = roll(shift,
-00002c90: 207b 636f 6c5f 6964 7d2c 207b 636f 6c7d   {col_id}, {col}
-00002ca0: 2c20 7b63 6f6c 5f74 6964 7d2c 2031 2927  , {col_tid}, 1)'
-00002cb0: 5d0a 2020 2020 2020 2020 2020 2020 6e61  ].            na
-00002cc0: 6d65 5f6c 6973 7420 2b3d 205b 6627 7b63  me_list += [f'{c
-00002cd0: 6f6c 7d5f 7265 7420 3d20 7265 7428 7072  ol}_ret = ret(pr
-00002ce0: 655f 7b63 6f6c 7d2c 207b 636f 6c7d 2927  e_{col}, {col})'
-00002cf0: 5d0a 2020 2020 2020 2020 646d 2e66 655f  ].        dm.fe_
-00002d00: 676f 286e 616d 655f 6c69 7374 2c20 7665  go(name_list, ve
-00002d10: 7262 6f73 6520 3d20 4661 6c73 6529 2020  rbose = False)  
-00002d20: 2020 2020 2020 0a0a 2020 2020 2020 2020        ..        
-00002d30: 2320 6466 5f6c 6162 656c 5f66 696e 616c  # df_label_final
-00002d40: 0a20 2020 2020 2020 206c 6162 656c 5f66  .        label_f
-00002d50: 726f 6d5f 7374 7220 3d20 6f74 6865 725f  rom_str = other_
-00002d60: 696e 666f 2e67 6574 2827 6c61 6265 6c5f  info.get('label_
-00002d70: 6672 6f6d 5f73 7472 272c 2027 2729 0a20  from_str', ''). 
-00002d80: 2020 2020 2020 2069 6620 6c65 6e28 6c61         if len(la
-00002d90: 6265 6c5f 6672 6f6d 5f73 7472 2920 3e20  bel_from_str) > 
-00002da0: 303a 0a20 2020 2020 2020 2020 2020 2063  0:.            c
-00002db0: 6f6c 5f6c 6162 656c 5f66 726f 6d20 3d20  ol_label_from = 
-00002dc0: 274c 4142 454c 5f46 524f 4d5f 5354 5227  'LABEL_FROM_STR'
-00002dd0: 0a20 2020 2020 2020 2020 2020 2063 6f6c  .            col
-00002de0: 5f6c 6162 656c 5f61 7267 735f 6c69 7374  _label_args_list
-00002df0: 203d 206c 6162 656c 5f66 726f 6d5f 7374   = label_from_st
-00002e00: 722e 7370 6c69 7428 275f 5f27 295b 313a  r.split('__')[1:
-00002e10: 5d0a 2020 2020 2020 2020 2020 2020 7061  ].            pa
-00002e20: 6464 696e 6720 3d20 6e70 2e6d 6178 285b  dding = np.max([
-00002e30: 6e70 2e6d 6178 2864 6563 6f64 655f 6c61  np.max(decode_la
-00002e40: 6265 6c5f 6172 6773 2878 295b 313a 335d  bel_args(x)[1:3]
-00002e50: 2920 666f 7220 7820 696e 2063 6f6c 5f6c  ) for x in col_l
-00002e60: 6162 656c 5f61 7267 735f 6c69 7374 5d29  abel_args_list])
-00002e70: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-00002e80: 2020 2020 2020 2020 2020 2063 6f6c 5f6c             col_l
-00002e90: 6162 656c 5f66 726f 6d20 3d20 636f 6c5f  abel_from = col_
-00002ea0: 6c61 6265 6c5f 6172 6773 5f32 5f6e 616d  label_args_2_nam
-00002eb0: 6528 6f74 6865 725f 696e 666f 5b27 636f  e(other_info['co
-00002ec0: 6c5f 6c61 6265 6c5f 6172 6773 275d 290a  l_label_args']).
-00002ed0: 2020 2020 2020 2020 2020 2020 636f 6c5f              col_
-00002ee0: 6c61 6265 6c5f 6172 6773 5f6c 6973 7420  label_args_list 
-00002ef0: 3d20 5b6f 7468 6572 5f69 6e66 6f5b 2763  = [other_info['c
-00002f00: 6f6c 5f6c 6162 656c 5f61 7267 7327 5d5d  ol_label_args']]
-00002f10: 0a20 2020 2020 2020 2020 2020 2070 6164  .            pad
-00002f20: 6469 6e67 203d 206e 702e 6d61 7828 5b69  ding = np.max([i
-00002f30: 6e74 2878 2920 666f 7220 7820 696e 2063  nt(x) for x in c
-00002f40: 6f6c 5f6c 6162 656c 5f66 726f 6d2e 7370  ol_label_from.sp
-00002f50: 6c69 7428 275f 2729 5b32 3a34 5d5d 2920  lit('_')[2:4]]) 
-00002f60: 2320 7061 6464 696e 6720 6b20 6461 7973  # padding k days
-00002f70: 0a20 2020 2020 2020 2063 6f6c 5f6c 6162  .        col_lab
-00002f80: 656c 5f61 7267 735f 6c69 7374 202b 3d20  el_args_list += 
-00002f90: 6f74 6865 725f 696e 666f 2e67 6574 2827  other_info.get('
-00002fa0: 636f 6c5f 6c61 6265 6c5f 6172 6773 5f6c  col_label_args_l
-00002fb0: 6973 7427 2c20 5b5d 290a 2020 2020 2020  ist', []).      
-00002fc0: 2020 636f 6c5f 6c61 6265 6c5f 6172 6773    col_label_args
-00002fd0: 5f6c 6973 7420 3d20 6c69 7374 2870 642e  _list = list(pd.
-00002fe0: 5365 7269 6573 2863 6f6c 5f6c 6162 656c  Series(col_label
-00002ff0: 5f61 7267 735f 6c69 7374 292e 6472 6f70  _args_list).drop
-00003000: 5f64 7570 6c69 6361 7465 7328 2929 0a20  _duplicates()). 
-00003010: 2020 2020 2020 2063 6f6c 5f6c 6162 656c         col_label
-00003020: 5f61 7267 735f 6c69 7374 203d 205b 6465  _args_list = [de
-00003030: 636f 6465 5f6c 6162 656c 5f61 7267 7328  code_label_args(
-00003040: 7829 2066 6f72 2078 2069 6e20 636f 6c5f  x) for x in col_
-00003050: 6c61 6265 6c5f 6172 6773 5f6c 6973 745d  label_args_list]
-00003060: 0a20 2020 2020 2020 206f 7468 6572 5f69  .        other_i
-00003070: 6e66 6f5b 2763 6f6c 5f6c 6162 656c 5f61  nfo['col_label_a
-00003080: 7267 735f 6c69 7374 275d 203d 2063 6f6c  rgs_list'] = col
-00003090: 5f6c 6162 656c 5f61 7267 735f 6c69 7374  _label_args_list
-000030a0: 0a20 2020 2020 2020 206f 7468 6572 5f69  .        other_i
-000030b0: 6e66 6f5b 2763 6f6c 5f6c 6162 656c 5f66  nfo['col_label_f
-000030c0: 726f 6d27 5d20 203d 2063 6f6c 5f6c 6162  rom']  = col_lab
-000030d0: 656c 5f66 726f 6d0a 2020 2020 2020 2020  el_from.        
-000030e0: 0a20 2020 2020 2020 2069 6620 7665 7262  .        if verb
-000030f0: 6f73 653a 2070 7269 6e74 2866 275b 2b5d  ose: print(f'[+]
-00003100: 206c 6162 656c 5f66 726f 6d5f 7374 7220   label_from_str 
-00003110: 3d20 7b6c 6162 656c 5f66 726f 6d5f 7374  = {label_from_st
-00003120: 727d 2c20 636f 6c5f 6c61 6265 6c5f 6672  r}, col_label_fr
-00003130: 6f6d 203d 207b 636f 6c5f 6c61 6265 6c5f  om = {col_label_
-00003140: 6672 6f6d 7d27 290a 2020 2020 2020 2020  from}').        
-00003150: 6966 2076 6572 626f 7365 3a20 7072 696e  if verbose: prin
-00003160: 7428 6627 5b2b 5d20 636f 6c5f 6c61 6265  t(f'[+] col_labe
-00003170: 6c5f 6172 6773 5f6c 6973 7420 3d20 7b63  l_args_list = {c
-00003180: 6f6c 5f6c 6162 656c 5f61 7267 735f 6c69  ol_label_args_li
-00003190: 7374 7d27 290a 0a20 2020 2020 2020 2063  st}')..        c
-000031a0: 6f6c 735f 7072 6963 6520 3d20 5b78 5b30  ols_price = [x[0
-000031b0: 5d20 666f 7220 7820 696e 2063 6f6c 5f6c  ] for x in col_l
-000031c0: 6162 656c 5f61 7267 735f 6c69 7374 5d20  abel_args_list] 
-000031d0: 2b20 5b78 5b2d 315d 2066 6f72 2078 2069  + [x[-1] for x i
-000031e0: 6e20 636f 6c5f 6c61 6265 6c5f 6172 6773  n col_label_args
-000031f0: 5f6c 6973 7420 6966 2074 7970 6528 785b  _list if type(x[
-00003200: 2d31 5d29 2069 7320 7374 725d 0a20 2020  -1]) is str].   
-00003210: 2020 2020 2063 6f6c 735f 7072 6963 6520       cols_price 
-00003220: 3d20 6c69 7374 2870 642e 5365 7269 6573  = list(pd.Series
-00003230: 2863 6f6c 735f 7072 6963 6529 2e64 726f  (cols_price).dro
-00003240: 705f 6475 706c 6963 6174 6573 2829 290a  p_duplicates()).
-00003250: 2020 2020 2020 2020 6466 203d 2064 6d2e          df = dm.
-00003260: 6765 745f 636f 6c73 5f70 616e 6461 7328  get_cols_pandas(
-00003270: 5b63 6f6c 5f74 6964 2c20 636f 6c5f 6964  [col_tid, col_id
-00003280: 5d20 2b20 636f 6c73 5f70 7269 6365 202b  ] + cols_price +
-00003290: 205b 2741 444a 275d 290a 2020 2020 2020   ['ADJ']).      
-000032a0: 2020 6466 5f6c 6162 656c 5f66 696e 616c    df_label_final
-000032b0: 2c20 636f 6c73 5f6c 6162 656c 203d 2067  , cols_label = g
-000032c0: 6574 5f64 665f 6c61 6265 6c5f 6669 6e61  et_df_label_fina
-000032d0: 6c28 6466 2c20 636f 6c5f 7469 642c 2063  l(df, col_tid, c
-000032e0: 6f6c 5f69 642c 2063 6f6c 735f 7072 6963  ol_id, cols_pric
-000032f0: 652c 2063 6f6c 5f6c 6162 656c 5f61 7267  e, col_label_arg
-00003300: 735f 6c69 7374 2c20 6c61 6265 6c5f 6672  s_list, label_fr
-00003310: 6f6d 5f73 7472 290a 2020 2020 2020 2020  om_str).        
-00003320: 666f 7220 636f 6c20 696e 2063 6f6c 735f  for col in cols_
-00003330: 6c61 6265 6c3a 2064 6d2e 7365 745f 6279  label: dm.set_by
-00003340: 5f63 6f6c 2863 6f6c 2c20 6466 5f6c 6162  _col(col, df_lab
-00003350: 656c 5f66 696e 616c 5b63 6f6c 5d29 0a20  el_final[col]). 
-00003360: 2020 2020 2020 2063 6f6c 735f 6c61 6265         cols_labe
-00003370: 6c20 2b3d 205b 274c 4142 454c 5f52 4157  l += ['LABEL_RAW
-00003380: 275d 0a20 2020 2020 2020 2069 6620 276c  '].        if 'l
-00003390: 6162 656c 2720 696e 2064 6d2e 6865 6164  abel' in dm.head
-000033a0: 2829 2e63 6f6c 756d 6e73 3a20 636f 6c73  ().columns: cols
-000033b0: 5f6c 6162 656c 202b 3d20 5b27 6c61 6265  _label += ['labe
-000033c0: 6c27 5d0a 2020 2020 2020 2020 6461 7461  l'].        data
-000033d0: 5f63 6f6e 6669 675b 2763 6f6c 735f 6469  _config['cols_di
-000033e0: 6374 275d 5b27 636f 6c73 5f6c 6162 656c  ct']['cols_label
-000033f0: 275d 203d 2063 6f6c 735f 6c61 6265 6c0a  '] = cols_label.
-00003400: 2020 2020 2020 2020 6966 2076 6572 626f          if verbo
-00003410: 7365 3a20 7072 696e 7428 6627 5b2b 5d20  se: print(f'[+] 
-00003420: 636f 6c73 5f6c 6162 656c 203d 207b 636f  cols_label = {co
-00003430: 6c73 5f6c 6162 656c 7d27 290a 0a20 2020  ls_label}')..   
-00003440: 2020 2020 2023 2066 5f6c 6162 656c 5f70       # f_label_p
-00003450: 7265 0a20 2020 2020 2020 2066 5f6c 6162  re.        f_lab
-00003460: 656c 5f70 7265 203d 206f 7468 6572 5f69  el_pre = other_i
-00003470: 6e66 6f2e 6765 7428 2766 5f6c 6162 656c  nfo.get('f_label
-00003480: 5f70 7265 272c 204e 6f6e 6529 0a20 2020  _pre', None).   
-00003490: 2020 2020 2069 6620 7665 7262 6f73 653a       if verbose:
-000034a0: 2070 7269 6e74 2866 275b 2b5d 2066 5f6c   print(f'[+] f_l
-000034b0: 6162 656c 5f70 7265 203d 207b 665f 6c61  abel_pre = {f_la
-000034c0: 6265 6c5f 7072 657d 2c20 636f 6c5f 6c61  bel_pre}, col_la
-000034d0: 6265 6c5f 6672 6f6d 203d 207b 636f 6c5f  bel_from = {col_
-000034e0: 6c61 6265 6c5f 6672 6f6d 7d27 290a 2020  label_from}').  
-000034f0: 2020 2020 2020 6966 2066 5f6c 6162 656c        if f_label
-00003500: 5f70 7265 203d 3d20 2763 737a 7363 6f72  _pre == 'cszscor
-00003510: 6527 3a20 2320 665f 6c61 6265 6c5f 7072  e': # f_label_pr
-00003520: 650a 2020 2020 2020 2020 2020 2020 646d  e.            dm
-00003530: 2e66 655f 676f 285b 6627 4c41 4245 4c5f  .fe_go([f'LABEL_
-00003540: 5241 5720 3d20 6f28 7b63 6f6c 5f6c 6162  RAW = o({col_lab
-00003550: 656c 5f66 726f 6d7d 2927 5d2c 2076 6572  el_from})'], ver
-00003560: 626f 7365 203d 2076 6572 626f 7365 290a  bose = verbose).
-00003570: 2020 2020 2020 2020 2020 2020 646d 2e66              dm.f
-00003580: 655f 676f 285b 6627 7b63 6f6c 5f6c 6162  e_go([f'{col_lab
-00003590: 656c 7d20 3d20 6167 6728 7a73 636f 7265  el} = agg(zscore
-000035a0: 2c20 7b63 6f6c 5f74 6964 7d2c 207b 636f  , {col_tid}, {co
-000035b0: 6c5f 6c61 6265 6c5f 6672 6f6d 7d29 275d  l_label_from})']
-000035c0: 2c20 7665 7262 6f73 6520 3d20 7665 7262  , verbose = verb
-000035d0: 6f73 6529 2023 2054 4f44 4f3f 206d 6173  ose) # TODO? mas
-000035e0: 6b20 3f20 0a20 2020 2020 2020 2020 2020  k ? .           
-000035f0: 200a 2020 2020 2020 2020 2020 2020 2320   .            # 
-00003600: 7a73 636f 7265 2066 6f72 2061 6c6c 204c  zscore for all L
-00003610: 4142 454c 0a20 2020 2020 2020 2020 2020  ABEL.           
-00003620: 206e 616d 655f 6c69 7374 203d 205b 6627   name_list = [f'
-00003630: 6167 6728 7a73 636f 7265 2c20 7b63 6f6c  agg(zscore, {col
-00003640: 5f74 6964 7d2c 207b 636f 6c7d 2927 2066  _tid}, {col})' f
-00003650: 6f72 2063 6f6c 2069 6e20 636f 6c73 5f6c  or col in cols_l
-00003660: 6162 656c 2069 6620 636f 6c20 6e6f 7420  abel if col not 
-00003670: 696e 205b 274c 4142 454c 5f52 4157 275d  in ['LABEL_RAW']
-00003680: 5d0a 2020 2020 2020 2020 2020 2020 646d  ].            dm
-00003690: 2e66 655f 676f 286e 616d 655f 6c69 7374  .fe_go(name_list
-000036a0: 2c20 7665 7262 6f73 6520 3d20 7665 7262  , verbose = verb
-000036b0: 6f73 652c 206b 6565 705f 6e61 6d65 203d  ose, keep_name =
-000036c0: 2032 290a 2020 2020 2020 2020 656c 6966   2).        elif
-000036d0: 2066 5f6c 6162 656c 5f70 7265 203d 3d20   f_label_pre == 
-000036e0: 276f 7269 6769 6e27 3a0a 2020 2020 2020  'origin':.      
-000036f0: 2020 2020 2020 646d 2e66 655f 676f 285b        dm.fe_go([
-00003700: 6627 4c41 4245 4c5f 5241 5720 3d20 6f28  f'LABEL_RAW = o(
-00003710: 7b63 6f6c 5f6c 6162 656c 5f66 726f 6d7d  {col_label_from}
-00003720: 2927 5d2c 2076 6572 626f 7365 203d 2076  )'], verbose = v
-00003730: 6572 626f 7365 290a 2020 2020 2020 2020  erbose).        
-00003740: 2020 2020 646d 2e66 655f 676f 285b 6627      dm.fe_go([f'
-00003750: 7b63 6f6c 5f6c 6162 656c 7d20 3d20 6f28  {col_label} = o(
-00003760: 7b63 6f6c 5f6c 6162 656c 5f66 726f 6d7d  {col_label_from}
-00003770: 2927 5d2c 2076 6572 626f 7365 203d 2076  )'], verbose = v
-00003780: 6572 626f 7365 290a 2020 2020 2020 2020  erbose).        
-00003790: 656c 6966 2066 5f6c 6162 656c 5f70 7265  elif f_label_pre
-000037a0: 203d 3d20 2765 7869 7374 273a 0a20 2020   == 'exist':.   
-000037b0: 2020 2020 2020 2020 2069 6620 7665 7262           if verb
-000037c0: 6f73 653a 2070 7269 6e74 2866 275b 2b5d  ose: print(f'[+]
-000037d0: 2072 6177 206c 6162 656c 2066 726f 6d20   raw label from 
-000037e0: 646d 2c20 2877 6869 6368 206d 6561 6e20  dm, (which mean 
-000037f0: 6578 6973 7420 7468 6973 2063 6f6c 756d  exist this colum
-00003800: 6e2c 206c 6162 656c 2927 290a 2020 2020  n, label)').    
-00003810: 2020 2020 2020 2020 646d 2e66 655f 676f          dm.fe_go
-00003820: 285b 6627 4c41 4245 4c5f 5241 5720 3d20  ([f'LABEL_RAW = 
-00003830: 6f28 7b63 6f6c 5f6c 6162 656c 7d29 275d  o({col_label})']
-00003840: 2c20 7665 7262 6f73 6520 3d20 7665 7262  , verbose = verb
-00003850: 6f73 6529 0a20 2020 2020 2020 2020 2020  ose).           
-00003860: 2061 7373 6572 7420 636f 6c5f 6c61 6265   assert col_labe
-00003870: 6c20 696e 2064 6d2e 6865 6164 2829 2e63  l in dm.head().c
-00003880: 6f6c 756d 6e73 2c20 2763 6f6c 5f6c 6162  olumns, 'col_lab
-00003890: 656c 203d 207b 636f 6c5f 6c61 6265 6c7d  el = {col_label}
-000038a0: 206e 6f74 2069 6e20 646d 2127 0a20 2020   not in dm!'.   
-000038b0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-000038c0: 2020 2020 2020 2072 6169 7365 204e 6f74         raise Not
-000038d0: 496d 706c 656d 656e 7465 6445 7272 6f72  ImplementedError
-000038e0: 2866 275b 2b5d 2066 5f6c 6162 656c 5f70  (f'[+] f_label_p
-000038f0: 7265 203d 207b 665f 6c61 6265 6c5f 7072  re = {f_label_pr
-00003900: 657d 2729 0a20 2020 2020 2020 2023 2064  e}').        # d
-00003910: 6d2e 7365 745f 6279 5f63 6f6c 2863 6f6c  m.set_by_col(col
-00003920: 5f6c 6162 656c 2c20 6e70 2e63 6c69 7028  _label, np.clip(
-00003930: 646d 2e67 6574 5f63 6f6c 5f6e 756d 7079  dm.get_col_numpy
-00003940: 2863 6f6c 5f6c 6162 656c 292c 202d 3130  (col_label), -10
-00003950: 2c20 3130 2929 2023 2054 4f44 4f20 636c  , 10)) # TODO cl
-00003960: 6970 0a0a 2020 2020 2020 2020 2320 2d2d  ip..        # --
-00003970: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00003980: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 206d 6173  ------------ mas
-00003990: 6b20 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  k --------------
-000039a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000039b0: 2054 4f44 4f0a 2020 2020 2020 2020 2320   TODO.        # 
-000039c0: 6466 5f6d 6173 6b0a 2020 2020 2020 2020  df_mask.        
-000039d0: 6966 2076 6572 626f 7365 3a20 7072 696e  if verbose: prin
-000039e0: 7428 275b 696e 6974 5d20 3c2d 2d2d 2d2d  t('[init] <-----
-000039f0: 2d2d 2d2d 2d20 6d61 736b 2020 2d2d 2d2d  ----- mask  ----
-00003a00: 2d2d 2d2d 2d2d 3e20 2729 0a20 2020 2020  ------> ').     
-00003a10: 2020 2070 6174 685f 6462 203d 2066 277b     path_db = f'{
-00003a20: 6f73 2e70 6174 682e 6469 726e 616d 6528  os.path.dirname(
-00003a30: 6f73 2e70 6174 682e 6162 7370 6174 6828  os.path.abspath(
-00003a40: 7061 7468 5f69 6e70 7574 2929 7d2f 727a  path_input))}/rz
-00003a50: 2e64 6227 0a20 2020 2020 2020 2069 6620  .db'.        if 
-00003a60: 7665 7262 6f73 653a 2070 7269 6e74 2866  verbose: print(f
-00003a70: 275b 2b5d 2070 6174 685f 6462 203d 207b  '[+] path_db = {
-00003a80: 7061 7468 5f64 627d 2729 0a20 2020 2020  path_db}').     
-00003a90: 2020 2069 6620 6f73 2e70 6174 682e 6578     if os.path.ex
-00003aa0: 6973 7473 2870 6174 685f 6462 293a 0a20  ists(path_db):. 
-00003ab0: 2020 2020 2020 2020 2020 2064 665f 6d61             df_ma
-00003ac0: 736b 2c20 636f 6c73 5f6d 6173 6b20 3d20  sk, cols_mask = 
-00003ad0: 6765 745f 6466 5f6d 6173 6b28 7061 7468  get_df_mask(path
-00003ae0: 5f64 622c 2064 6d2c 2063 6f6c 5f74 6964  _db, dm, col_tid
-00003af0: 2c20 636f 6c5f 6964 2c20 7665 7262 6f73  , col_id, verbos
-00003b00: 653d 7665 7262 6f73 6529 0a20 2020 2020  e=verbose).     
-00003b10: 2020 2020 2020 2066 6f72 2063 6f6c 2069         for col i
-00003b20: 6e20 636f 6c73 5f6d 6173 6b3a 2064 6d2e  n cols_mask: dm.
-00003b30: 7365 745f 6279 5f63 6f6c 2863 6f6c 2c20  set_by_col(col, 
-00003b40: 6466 5f6d 6173 6b5b 636f 6c5d 290a 2020  df_mask[col]).  
-00003b50: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00003b60: 2020 2020 2020 2020 636f 6c73 5f6d 6173          cols_mas
-00003b70: 6b20 3d20 636f 6c73 5f6d 6173 6b20 3d20  k = cols_mask = 
-00003b80: 5b27 4d41 534b 5f53 5427 2c20 274d 4153  ['MASK_ST', 'MAS
-00003b90: 4b5f 4b4a 5927 2c20 274d 4153 4b5f 5a44  K_KJY', 'MASK_ZD
-00003ba0: 5427 2c20 274d 4153 4b27 5d0a 2020 2020  T', 'MASK'].    
-00003bb0: 2020 2020 6461 7461 5f63 6f6e 6669 675b      data_config[
-00003bc0: 2763 6f6c 735f 6469 6374 275d 5b27 636f  'cols_dict']['co
-00003bd0: 6c73 5f6d 6173 6b27 5d20 3d20 636f 6c73  ls_mask'] = cols
-00003be0: 5f6d 6173 6b0a 2020 2020 2020 2020 6966  _mask.        if
-00003bf0: 2076 6572 626f 7365 3a20 7072 696e 7428   verbose: print(
-00003c00: 6627 5b2b 5d20 636f 6c73 5f6d 6173 6b20  f'[+] cols_mask 
-00003c10: 3d20 7b63 6f6c 735f 6d61 736b 7d27 290a  = {cols_mask}').
-00003c20: 0a20 2020 2020 2020 2023 206b 6a79 2026  .        # kjy &
-00003c30: 207a 6474 0a20 2020 2020 2020 2069 6620   zdt.        if 
-00003c40: 6f73 2e70 6174 682e 6578 6973 7473 2870  os.path.exists(p
-00003c50: 6174 685f 6462 293a 0a20 2020 2020 2020  ath_db):.       
-00003c60: 2020 2020 2023 206d 6173 6b20 3d20 31e7       # mask = 1.
-00003c70: 9a84 2c20 6c61 6265 6c2e 6973 6e75 6c6c  .., label.isnull
-00003c80: 2829 e79a 842c 20e4 b8bb e8a6 81e6 98af  ()..., .........
-00003c90: e59b a0e4 b8ba e590 84e7 a78d e581 9ce7  ................
-00003ca0: 898c e79a 84e6 8385 e586 b50a 2020 2020  ............    
-00003cb0: 2020 2020 2020 2020 6d61 736b 5f6b 6a79          mask_kjy
-00003cc0: 203d 2028 7e6e 702e 6973 6e61 6e28 646d   = (~np.isnan(dm
-00003cd0: 2e64 665f 6469 6374 5b27 5430 275d 5b63  .df_dict['T0'][c
-00003ce0: 6f6c 5f6c 6162 656c 5d2e 746f 5f6e 756d  ol_label].to_num
-00003cf0: 7079 2829 2929 2e61 7374 7970 6528 6e70  py())).astype(np
-00003d00: 2e69 6e74 3332 2920 2320 e4bc 9ae5 afbc  .int32) # ......
-00003d10: e887 b4e4 b88d e590 8c6c 6162 656c e4b8  .........label..
-00003d20: 8de4 b880 e6a0 b72c 20e9 bb98 e8ae a46c  ......., ......l
-00003d30: 6162 656c e983 bde7 94a8 7878 782c 302c  abel......xxx,0,
-00003d40: 31e5 90a7 0a20 2020 2020 2020 2020 2020  1....           
-00003d50: 206d 6173 6b5f 6b6a 7920 263d 2064 6d2e   mask_kjy &= dm.
-00003d60: 6466 5f64 6963 745b 2754 3027 5d5b 274d  df_dict['T0']['M
-00003d70: 4153 4b5f 4b4a 5927 5d2e 746f 5f6e 756d  ASK_KJY'].to_num
-00003d80: 7079 2829 0a20 2020 2020 2020 2020 2020  py().           
-00003d90: 2023 206d 6173 6b5f 6b6a 7920 3d20 646d   # mask_kjy = dm
-00003da0: 2e64 665f 6469 6374 5b27 5430 275d 5b27  .df_dict['T0']['
-00003db0: 4d41 534b 5f4b 4a59 275d 2e74 6f5f 6e75  MASK_KJY'].to_nu
-00003dc0: 6d70 7928 290a 2020 2020 2020 2020 2020  mpy().          
-00003dd0: 2020 6d61 736b 5f7a 6474 203d 2064 6d2e    mask_zdt = dm.
-00003de0: 6466 5f64 6963 745b 2754 3027 5d5b 274d  df_dict['T0']['M
-00003df0: 4153 4b5f 5a44 5427 5d2e 746f 5f6e 756d  ASK_ZDT'].to_num
-00003e00: 7079 2829 0a20 2020 2020 2020 2065 6c73  py().        els
-00003e10: 653a 0a20 2020 2020 2020 2020 2020 206d  e:.            m
-00003e20: 6173 6b5f 6b6a 7920 3d20 287e 6e70 2e69  ask_kjy = (~np.i
-00003e30: 736e 616e 2864 6d2e 6466 5f64 6963 745b  snan(dm.df_dict[
-00003e40: 2754 3027 5d5b 636f 6c5f 6c61 6265 6c5d  'T0'][col_label]
-00003e50: 2e74 6f5f 6e75 6d70 7928 2929 292e 6173  .to_numpy())).as
-00003e60: 7479 7065 286e 702e 696e 7433 3229 0a20  type(np.int32). 
-00003e70: 2020 2020 2020 2020 2020 206d 6173 6b5f             mask_
-00003e80: 6b6a 7920 263d 2028 7e6e 702e 6973 6e61  kjy &= (~np.isna
-00003e90: 6e28 646d 2e64 665f 6469 6374 5b27 5430  n(dm.df_dict['T0
-00003ea0: 275d 5b27 6f70 656e 275d 2e74 6f5f 6e75  ']['open'].to_nu
-00003eb0: 6d70 7928 2929 292e 6173 7479 7065 286e  mpy())).astype(n
-00003ec0: 702e 696e 7433 3229 0a20 2020 2020 2020  p.int32).       
-00003ed0: 2020 2020 2023 206d 6173 6b5f 6b6a 7920       # mask_kjy 
-00003ee0: 3d20 287e 6e70 2e69 736e 616e 2864 6d2e  = (~np.isnan(dm.
-00003ef0: 6466 5f64 6963 745b 2754 3027 5d5b 276f  df_dict['T0']['o
-00003f00: 7065 6e27 5d2e 746f 5f6e 756d 7079 2829  pen'].to_numpy()
-00003f10: 2929 2e61 7374 7970 6528 6e70 2e69 6e74  )).astype(np.int
-00003f20: 3332 290a 2020 2020 2020 2020 2020 2020  32).            
-00003f30: 6d61 736b 5f7a 6474 203d 2064 6d2e 6765  mask_zdt = dm.ge
-00003f40: 745f 636f 6c5f 6e75 6d70 7928 276d 6173  t_col_numpy('mas
-00003f50: 6b27 2920 3d3d 2031 0a20 2020 2020 2020  k') == 1.       
-00003f60: 2064 6d2e 7365 745f 6d61 736b 286d 6173   dm.set_mask(mas
-00003f70: 6b5f 6b6a 792e 6173 7479 7065 286e 702e  k_kjy.astype(np.
-00003f80: 696e 7433 3229 2c20 276b 6a79 2729 0a20  int32), 'kjy'). 
-00003f90: 2020 2020 2020 2064 6d2e 7365 745f 6d61         dm.set_ma
-00003fa0: 736b 286d 6173 6b5f 7a64 742e 6173 7479  sk(mask_zdt.asty
-00003fb0: 7065 286e 702e 696e 7433 3229 2c20 277a  pe(np.int32), 'z
-00003fc0: 6474 2729 0a0a 2020 2020 2020 2020 2320  dt')..        # 
-00003fd0: 6d61 736b 5f64 726f 700a 2020 2020 2020  mask_drop.      
-00003fe0: 2020 6966 2046 616c 7365 2061 6e64 206f    if False and o
-00003ff0: 732e 7061 7468 2e65 7869 7374 7328 7061  s.path.exists(pa
-00004000: 7468 5f64 6229 3a0a 2020 2020 2020 2020  th_db):.        
-00004010: 2020 2020 646d 2e66 655f 676f 285b 6627      dm.fe_go([f'
-00004020: 6770 286d 6561 6e2c 207b 636f 6c5f 7469  gp(mean, {col_ti
-00004030: 647d 2c20 4c41 4245 4c5f 5241 5729 275d  d}, LABEL_RAW)']
-00004040: 290a 2020 2020 2020 2020 2020 2020 6466  ).            df
-00004050: 5f67 7020 3d20 646d 2e67 6574 5f63 6f6c  _gp = dm.get_col
-00004060: 735f 7061 6e64 6173 2864 665f 6e61 6d65  s_pandas(df_name
-00004070: 203d 2066 2754 302e 7b63 6f6c 5f74 6964   = f'T0.{col_tid
-00004080: 7d27 290a 2020 2020 2020 2020 2020 2020  }').            
-00004090: 6461 7465 5f64 726f 7020 3d20 6466 5f67  date_drop = df_g
-000040a0: 705b 6466 5f67 705b 6627 6770 286d 6561  p[df_gp[f'gp(mea
-000040b0: 6e2c 207b 636f 6c5f 7469 647d 2c20 4c41  n, {col_tid}, LA
-000040c0: 4245 4c5f 5241 5729 275d 2e61 6273 2829  BEL_RAW)'].abs()
-000040d0: 203e 2030 2e30 335d 5b63 6f6c 5f74 6964   > 0.03][col_tid
-000040e0: 5d2e 7661 6c75 6573 0a20 2020 2020 2020  ].values.       
-000040f0: 2020 2020 2064 6174 655f 6472 6f70 203d       date_drop =
-00004100: 2064 6174 655f 6472 6f70 5b64 6174 655f   date_drop[date_
-00004110: 6472 6f70 203c 3d20 6461 7465 5f64 6963  drop <= date_dic
-00004120: 745b 2761 6c6c 275d 5b31 5d5d 0a20 2020  t['all'][1]].   
-00004130: 2020 2020 2020 2020 2070 7269 6e74 2866           print(f
-00004140: 275b 2b5d 2064 6174 655f 6472 6f70 203d  '[+] date_drop =
-00004150: 207b 6c65 6e28 6461 7465 5f64 726f 7029   {len(date_drop)
-00004160: 7d5c 6e64 6174 655f 6472 6f70 203d 205b  }\ndate_drop = [
-00004170: 7b22 2c20 222e 6a6f 696e 2873 7472 2878  {", ".join(str(x
-00004180: 2920 666f 7220 7820 696e 2064 6174 655f  ) for x in date_
-00004190: 6472 6f70 297d 5d27 290a 2020 2020 2020  drop)}]').      
-000041a0: 2020 2020 2020 6d61 736b 5f64 726f 7020        mask_drop 
-000041b0: 3d20 287e 646d 2e67 6574 5f63 6f6c 5f70  = (~dm.get_col_p
-000041c0: 616e 6461 7328 636f 6c5f 7469 6429 2e69  andas(col_tid).i
-000041d0: 7369 6e28 7365 7428 6461 7465 5f64 726f  sin(set(date_dro
-000041e0: 7029 2929 2e76 616c 7565 730a 2020 2020  p))).values.    
-000041f0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00004200: 2020 2020 2020 6d61 736b 5f64 726f 7020        mask_drop 
-00004210: 3d20 6e70 2e6f 6e65 735f 6c69 6b65 286d  = np.ones_like(m
-00004220: 6173 6b5f 6b6a 7929 2e61 7374 7970 6528  ask_kjy).astype(
-00004230: 626f 6f6c 290a 2020 2020 2020 2020 2320  bool).        # 
-00004240: 6d61 736b 0a20 2020 2020 2020 206d 6173  mask.        mas
-00004250: 6b5f 6d61 736b 203d 206d 6173 6b5f 6b6a  k_mask = mask_kj
-00004260: 7920 2620 6d61 736b 5f7a 6474 0a20 2020  y & mask_zdt.   
-00004270: 2020 2020 206d 6173 6b5f 6d61 736b 2026       mask_mask &
-00004280: 3d20 6d61 736b 5f64 726f 700a 2020 2020  = mask_drop.    
-00004290: 2020 2020 646d 2e73 6574 5f6d 6173 6b28      dm.set_mask(
-000042a0: 6d61 736b 5f6d 6173 6b2c 2027 6d61 736b  mask_mask, 'mask
-000042b0: 2729 0a20 2020 2020 2020 2064 6d2e 7365  ').        dm.se
-000042c0: 745f 6279 5f63 6f6c 2827 4d41 534b 272c  t_by_col('MASK',
-000042d0: 206d 6173 6b5f 6d61 736b 2920 2320 7570   mask_mask) # up
-000042e0: 6461 7465 206d 6173 6b0a 2020 2020 2020  date mask.      
-000042f0: 2020 6966 2076 6572 626f 7365 3a20 0a20    if verbose: . 
-00004300: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-00004310: 2866 275b 2b5d 206b 6a79 2020 3d20 7b6d  (f'[+] kjy  = {m
-00004320: 6173 6b5f 6b6a 792e 7375 6d28 297d 202f  ask_kjy.sum()} /
-00004330: 207b 6c65 6e28 6d61 736b 5f6b 6a79 297d   {len(mask_kjy)}
-00004340: 203d 207b 6d61 736b 5f6b 6a79 2e6d 6561   = {mask_kjy.mea
-00004350: 6e28 297d 2729 0a20 2020 2020 2020 2020  n()}').         
-00004360: 2020 2070 7269 6e74 2866 275b 2b5d 207a     print(f'[+] z
-00004370: 6474 2020 3d20 7b6d 6173 6b5f 7a64 742e  dt  = {mask_zdt.
-00004380: 7375 6d28 297d 202f 207b 6c65 6e28 6d61  sum()} / {len(ma
-00004390: 736b 5f7a 6474 297d 203d 207b 6d61 736b  sk_zdt)} = {mask
-000043a0: 5f7a 6474 2e6d 6561 6e28 297d 2729 0a20  _zdt.mean()}'). 
-000043b0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-000043c0: 2866 275b 2b5d 206d 6173 6b20 3d20 7b6d  (f'[+] mask = {m
-000043d0: 6173 6b5f 6d61 736b 2e73 756d 2829 7d20  ask_mask.sum()} 
-000043e0: 2f20 7b6c 656e 286d 6173 6b5f 6d61 736b  / {len(mask_mask
-000043f0: 297d 203d 207b 6d61 736b 5f6d 6173 6b2e  )} = {mask_mask.
-00004400: 6d65 616e 2829 7d27 290a 2020 2020 2020  mean()}').      
-00004410: 2020 0a20 2020 2020 2020 2023 2066 6f72    .        # for
-00004420: 2074 7261 696e 2076 616c 6964 2020 7465   train valid  te
-00004430: 7374 0a20 2020 2020 2020 2069 6620 2768  st.        if 'h
-00004440: 6973 7427 206e 6f74 2069 6e20 6461 7465  ist' not in date
-00004450: 5f64 6963 742e 6b65 7973 2829 3a0a 2020  _dict.keys():.  
-00004460: 2020 2020 2020 2020 2020 6966 2020 2027            if   '
-00004470: 7472 6169 6e27 2069 6e20 6461 7465 5f64  train' in date_d
-00004480: 6963 742e 6b65 7973 2829 3a20 6461 7465  ict.keys(): date
-00004490: 5f64 6963 745b 2768 6973 7427 5d20 3d20  _dict['hist'] = 
-000044a0: 6461 7465 5f64 6963 745b 2774 7261 696e  date_dict['train
-000044b0: 275d 0a20 2020 2020 2020 2020 2020 2065  '].            e
-000044c0: 6c69 6620 276c 6f6f 6b27 2069 6e20 6461  lif 'look' in da
-000044d0: 7465 5f64 6963 742e 6b65 7973 2829 3a20  te_dict.keys(): 
-000044e0: 6461 7465 5f64 6963 745b 2768 6973 7427  date_dict['hist'
-000044f0: 5d20 3d20 6461 7465 5f64 6963 745b 276c  ] = date_dict['l
-00004500: 6f6f 6b27 5d0a 2020 2020 2020 2020 2020  ook'].          
-00004510: 2020 656c 6966 2027 616c 6c27 2069 6e20    elif 'all' in 
-00004520: 6461 7465 5f64 6963 742e 6b65 7973 2829  date_dict.keys()
-00004530: 3a20 6461 7465 5f64 6963 745b 2768 6973  : date_dict['his
-00004540: 7427 5d20 3d20 6461 7465 5f64 6963 745b  t'] = date_dict[
-00004550: 2761 6c6c 275d 0a20 2020 2020 2020 2020  'all'].         
-00004560: 2020 2065 6c73 653a 2072 6169 7365 204e     else: raise N
-00004570: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
-00004580: 6f72 2866 2764 6174 655f 6469 6374 203d  or(f'date_dict =
-00004590: 207b 6461 7465 5f64 6963 747d 2c20 6e65   {date_dict}, ne
-000045a0: 6564 2068 6973 7427 290a 2020 2020 2020  ed hist').      
-000045b0: 2020 6966 2076 6572 626f 7365 3a20 7072    if verbose: pr
-000045c0: 696e 7428 6627 5b2b 5d20 7061 6464 696e  int(f'[+] paddin
-000045d0: 6720 3d20 7b70 6164 6469 6e67 7d2c 2063  g = {padding}, c
-000045e0: 6f6c 5f6c 6162 656c 5f66 726f 6d20 3d20  ol_label_from = 
-000045f0: 7b63 6f6c 5f6c 6162 656c 5f66 726f 6d7d  {col_label_from}
-00004600: 2729 0a20 2020 2020 2020 2078 203d 2064  ').        x = d
-00004610: 6d2e 6466 5f64 6963 745b 2754 3027 5d5b  m.df_dict['T0'][
-00004620: 636f 6c5f 7469 645d 2e74 6f5f 6e75 6d70  col_tid].to_nump
-00004630: 7928 290a 2020 2020 2020 2020 666f 7220  y().        for 
-00004640: 6b65 7920 696e 2064 6174 655f 6469 6374  key in date_dict
-00004650: 2e6b 6579 7328 293a 0a20 2020 2020 2020  .keys():.       
-00004660: 2020 2020 2064 6174 655f 6265 6769 6e2c       date_begin,
-00004670: 2064 6174 655f 656e 6420 3d20 6461 7465   date_end = date
-00004680: 5f64 6963 745b 6b65 795d 0a20 2020 2020  _dict[key].     
-00004690: 2020 2020 2020 2069 6620 6b65 7920 696e         if key in
-000046a0: 205b 2774 7261 696e 272c 2027 6869 7374   ['train', 'hist
-000046b0: 275d 3a20 2320 e59c a8e5 8e9f e69c 8964  ']: # .........d
-000046c0: 6174 655f 656e 64e7 9a84 e59f bae7 a180  ate_end.........
-000046d0: e4b8 8a2c 20e5 868d e58e bbe6 8e89 7061  ..., .........pa
-000046e0: 6464 696e 67e5 a4a9 0a20 2020 2020 2020  dding....       
-000046f0: 2020 2020 2020 2020 2078 5f75 6e69 7175           x_uniqu
-00004700: 6520 3d20 6e70 2e75 6e69 7175 6528 7829  e = np.unique(x)
-00004710: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00004720: 2064 6174 655f 656e 6420 3d20 6e70 2e73   date_end = np.s
-00004730: 6f72 7428 785f 756e 6971 7565 5b78 5f75  ort(x_unique[x_u
-00004740: 6e69 7175 6520 3c3d 2064 6174 655f 656e  nique <= date_en
-00004750: 645d 295b 2d28 3120 2b20 7061 6464 696e  d])[-(1 + paddin
-00004760: 6729 5d0a 2020 2020 2020 2020 2020 2020  g)].            
-00004770: 0a20 2020 2020 2020 2020 2020 206d 6173  .            mas
-00004780: 6b20 3d20 2028 7820 3e3d 2064 6174 655f  k =  (x >= date_
-00004790: 6265 6769 6e29 2026 2028 7820 3c3d 2064  begin) & (x <= d
-000047a0: 6174 655f 656e 6429 0a20 2020 2020 2020  ate_end).       
-000047b0: 2020 2020 2069 6620 6b65 7920 213d 2027       if key != '
-000047c0: 7465 7374 273a 0a20 2020 2020 2020 2020  test':.         
-000047d0: 2020 2020 2020 206d 6173 6b20 263d 206d         mask &= m
-000047e0: 6173 6b5f 6d61 736b 2e61 7374 7970 6528  ask_mask.astype(
-000047f0: 626f 6f6c 290a 2020 2020 2020 2020 2020  bool).          
-00004800: 2020 646d 2e73 6574 5f6d 6173 6b28 6d61    dm.set_mask(ma
-00004810: 736b 2c20 6d61 736b 5f6e 616d 6520 3d20  sk, mask_name = 
-00004820: 6b65 7929 0a20 2020 2020 2020 2020 2020  key).           
-00004830: 2069 6620 7665 7262 6f73 653a 0a20 2020   if verbose:.   
-00004840: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00004850: 6c65 6e28 785b 6d61 736b 5d29 203e 2030  len(x[mask]) > 0
-00004860: 3a20 7072 696e 7428 6627 5b2b 5d20 6d61  : print(f'[+] ma
-00004870: 736b 5f6e 616d 6520 3d20 7b6b 6579 3a3c  sk_name = {key:<
-00004880: 3131 7d7c 207b 785b 6d61 736b 5d2e 6d69  11}| {x[mask].mi
-00004890: 6e28 297d 202d 3e20 7b78 5b6d 6173 6b5d  n()} -> {x[mask]
-000048a0: 2e6d 6178 2829 7d20 3d20 7b6d 6173 6b2e  .max()} = {mask.
-000048b0: 7375 6d28 297d 2729 0a20 2020 2020 2020  sum()}').       
-000048c0: 2020 2020 2020 2020 2065 6c73 653a 2070           else: p
-000048d0: 7269 6e74 2866 275b 2b5d 206d 6173 6b5f  rint(f'[+] mask_
-000048e0: 6e61 6d65 203d 207b 6b65 793a 3c31 317d  name = {key:<11}
-000048f0: 7c20 6c65 6e20 3d20 3027 290a 2020 2020  | len = 0').    
-00004900: 2020 2020 0a20 2020 2020 2020 2023 2073      .        # s
-00004910: 6869 6674 5f31 0a20 2020 2020 2020 2069  hift_1.        i
-00004920: 6620 7665 7262 6f73 653a 2070 7269 6e74  f verbose: print
-00004930: 2827 5b69 6e69 745d 203c 2d2d 2d2d 2d2d  ('[init] <------
-00004940: 2d2d 2d2d 2073 6869 6674 5f69 202d 2d2d  ---- shift_i ---
-00004950: 2d2d 2d2d 2d2d 2d3e 2027 290a 2020 2020  -------> ').    
-00004960: 2020 2020 7368 6966 745f 6920 3d20 6f74      shift_i = ot
-00004970: 6865 725f 696e 666f 2e67 6574 2827 7368  her_info.get('sh
-00004980: 6966 745f 6927 2c20 3129 0a20 2020 2020  ift_i', 1).     
-00004990: 2020 2069 6620 7665 7262 6f73 653a 2070     if verbose: p
-000049a0: 7269 6e74 2866 275b 2b5d 2073 6869 6674  rint(f'[+] shift
-000049b0: 5f69 203d 207b 7368 6966 745f 697d 2729  _i = {shift_i}')
-000049c0: 0a20 2020 2020 2020 2063 6f6c 735f 7368  .        cols_sh
-000049d0: 6966 745f 315f 6e6f 7420 3d20 5b63 6f6c  ift_1_not = [col
-000049e0: 5f69 642c 2063 6f6c 5f74 6964 2c20 636f  _id, col_tid, co
-000049f0: 6c5f 6c61 6265 6c5d 202b 2063 6f6c 735f  l_label] + cols_
-00004a00: 7469 6420 2b20 636f 6c73 5f6c 6162 656c  tid + cols_label
-00004a10: 202b 2063 6f6c 735f 6d61 736b 202b 205b   + cols_mask + [
-00004a20: 6f74 6865 725f 696e 666f 2e67 6574 2827  other_info.get('
-00004a30: 636f 6c5f 6461 7465 272c 204e 6f6e 6529  col_date', None)
-00004a40: 5d0a 2020 2020 2020 2020 636f 6c73 5f73  ].        cols_s
-00004a50: 6869 6674 5f31 5f6e 6f74 202b 3d20 6f74  hift_1_not += ot
-00004a60: 6865 725f 696e 666f 2e67 6574 2827 636f  her_info.get('co
-00004a70: 6c73 5f73 6869 6674 5f31 5f6e 6f74 272c  ls_shift_1_not',
-00004a80: 205b 5d29 0a20 2020 2020 2020 206f 7468   []).        oth
-00004a90: 6572 5f69 6e66 6f5b 2763 6f6c 735f 7368  er_info['cols_sh
-00004aa0: 6966 745f 315f 6e6f 7427 5d20 3d20 636f  ift_1_not'] = co
-00004ab0: 6c73 5f73 6869 6674 5f31 5f6e 6f74 0a20  ls_shift_1_not. 
-00004ac0: 2020 2020 2020 2069 6620 7665 7262 6f73         if verbos
-00004ad0: 653a 2070 7269 6e74 2866 275b 2b5d 2063  e: print(f'[+] c
-00004ae0: 6f6c 735f 7368 6966 745f 315f 6e6f 7420  ols_shift_1_not 
-00004af0: 3d20 7b63 6f6c 735f 7368 6966 745f 315f  = {cols_shift_1_
-00004b00: 6e6f 747d 2729 0a20 2020 2020 2020 2063  not}').        c
-00004b10: 6f6c 735f 7368 6966 745f 3120 3d20 5b63  ols_shift_1 = [c
-00004b20: 6f6c 2066 6f72 2063 6f6c 2069 6e20 646d  ol for col in dm
-00004b30: 2e68 6561 6428 292e 636f 6c75 6d6e 7320  .head().columns 
-00004b40: 6966 2063 6f6c 206e 6f74 2069 6e20 636f  if col not in co
-00004b50: 6c73 5f73 6869 6674 5f31 5f6e 6f74 5d0a  ls_shift_1_not].
-00004b60: 2020 2020 2020 2020 6966 2073 6869 6674          if shift
-00004b70: 5f69 2021 3d20 303a 2064 6d2e 6665 5f67  _i != 0: dm.fe_g
-00004b80: 6f28 5b66 277b 636f 6c7d 203d 2072 6f6c  o([f'{col} = rol
-00004b90: 6c28 7368 6966 742c 207b 636f 6c5f 6964  l(shift, {col_id
-00004ba0: 7d2c 207b 636f 6c7d 2c20 7b63 6f6c 5f74  }, {col}, {col_t
-00004bb0: 6964 7d2c 207b 7368 6966 745f 697d 2927  id}, {shift_i})'
-00004bc0: 2066 6f72 2063 6f6c 2069 6e20 636f 6c73   for col in cols
-00004bd0: 5f73 6869 6674 5f31 5d2c 2076 6572 626f  _shift_1], verbo
-00004be0: 7365 3d76 6572 626f 7365 290a 2020 2020  se=verbose).    
-00004bf0: 2020 2020 2320 646d 2e66 655f 676f 285b      # dm.fe_go([
-00004c00: 6627 726f 6c6c 2873 6869 6674 2c20 7b63  f'roll(shift, {c
-00004c10: 6f6c 5f69 647d 2c20 7b63 6f6c 7d2c 207b  ol_id}, {col}, {
-00004c20: 636f 6c5f 7469 647d 2c20 3129 2720 666f  col_tid}, 1)' fo
-00004c30: 7220 636f 6c20 696e 2063 6f6c 735f 7368  r col in cols_sh
-00004c40: 6966 745f 315d 2c20 6b65 6570 5f6e 616d  ift_1], keep_nam
-00004c50: 6520 3d20 3229 0a20 2020 2020 2020 2072  e = 2).        r
-00004c60: 6574 7572 6e20 646d 0a7a 065c 275c 275c  eturn dm.z.\'\'\
-00004c70: 277a 0327 2727 da01 7729 07da 026f 73da  'z.'''..w)...os.
-00004c80: 0470 6174 68da 0764 6972 6e61 6d65 da08  .path..dirname..
-00004c90: 5f5f 6669 6c65 5f5f da07 7265 706c 6163  __file__..replac
-00004ca0: 65da 046f 7065 6eda 0577 7269 7465 2904  e..open..write).
-00004cb0: da06 6f75 7470 7574 5a0b 7061 7468 5f6f  ..outputZ.path_o
-00004cc0: 7574 7075 74da 0173 da01 66a9 0072 0e00  utput..s..f..r..
-00004cd0: 0000 fa4b 6275 696c 642f 6264 6973 742e  ...Kbuild/bdist.
-00004ce0: 6d61 636f 7378 2d31 302e 392d 7838 365f  macosx-10.9-x86_
-00004cf0: 3634 2f65 6767 2f72 756e 6e69 6e67 7a2f  64/egg/runningz/
-00004d00: 6665 2f70 7265 7061 7265 5f64 6174 612f  fe/prepare_data/
-00004d10: 6261 7365 5f64 6174 615f 7079 2e70 79da  base_data_py.py.
-00004d20: 0372 756e 0400 0000 7310 0000 0000 0114  .run....s.......
-00004d30: 0104 7f00 7f00 7f00 0b0c 010c 0172 1000  .............r..
-00004d40: 0000 da08 5f5f 6d61 696e 5f5f 7a08 2d2d  ....__main__z.--
-00004d50: 6f75 7470 7574 5429 02da 0474 7970 65da  outputT)...type.
-00004d60: 0872 6571 7569 7265 6429 0c72 0400 0000  .required).r....
-00004d70: da03 7379 7372 1000 0000 da08 5f5f 6e61  ..sysr......__na
-00004d80: 6d65 5f5f da08 6172 6770 6172 7365 da0e  me__..argparse..
-00004d90: 4172 6775 6d65 6e74 5061 7273 6572 da06  ArgumentParser..
-00004da0: 7061 7273 6572 da0c 6164 645f 6172 6775  parser..add_argu
-00004db0: 6d65 6e74 da03 7374 72da 0a70 6172 7365  ment..str..parse
-00004dc0: 5f61 7267 73da 0461 7267 7372 0b00 0000  _args..argsr....
-00004dd0: 720e 0000 0072 0e00 0000 720e 0000 0072  r....r....r....r
-00004de0: 0f00 0000 da08 3c6d 6f64 756c 653e 0200  ......<module>..
-00004df0: 0000 7316 0000 0008 0108 0108 7f00 7f00  ..s.............
-00004e00: 7f00 1108 0108 0108 0110 0108 01         .............
+00002110: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002120: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002130: 2d2d 2d2d 0a0a 2020 2020 6966 2076 6572  ----..    if ver
+00002140: 626f 7365 3a20 7072 696e 7428 275b 2b5d  bose: print('[+]
+00002150: 2053 542c 204b 4a59 2c20 5a44 542c 204d   ST, KJY, ZDT, M
+00002160: 4153 4b27 290a 2020 2020 6466 5f6d 6173  ASK').    df_mas
+00002170: 6b5b 274d 4153 4b5f 5354 275d 203d 2028  k['MASK_ST'] = (
+00002180: 6964 785f 7374 292e 6173 7479 7065 286e  idx_st).astype(n
+00002190: 702e 696e 7433 3229 0a0a 2020 2020 6466  p.int32)..    df
+000021a0: 5f6d 6173 6b5b 274d 4153 4b5f 4b4a 5927  _mask['MASK_KJY'
+000021b0: 5d20 3d20 2869 6478 5f6e 616e 2026 2069  ] = (idx_nan & i
+000021c0: 6478 5f32 3020 2620 6964 785f 7374 2026  dx_20 & idx_st &
+000021d0: 2069 6478 5f73 7573 292e 6173 7479 7065   idx_sus).astype
+000021e0: 286e 702e 696e 7433 3229 0a20 2020 2069  (np.int32).    i
+000021f0: 6620 7665 7262 6f73 653a 2070 7269 6e74  f verbose: print
+00002200: 2866 225b 2b5d 2064 665f 6d61 736b 5b27  (f"[+] df_mask['
+00002210: 4d41 534b 5f4b 4a59 275d 2e73 756d 2829  MASK_KJY'].sum()
+00002220: 203d 207b 6466 5f6d 6173 6b5b 274d 4153   = {df_mask['MAS
+00002230: 4b5f 4b4a 5927 5d2e 7375 6d28 297d 2229  K_KJY'].sum()}")
+00002240: 0a20 2020 2023 2064 665f 6d61 736b 5b27  .    # df_mask['
+00002250: 4d41 534b 5f4b 4a59 275d 203d 2028 6466  MASK_KJY'] = (df
+00002260: 5f6d 6173 6b5b 274d 4153 4b5f 4b4a 5927  _mask['MASK_KJY'
+00002270: 5d20 2620 6d61 736b 5f6b 6a79 5f74 7672  ] & mask_kjy_tvr
+00002280: 292e 6173 7479 7065 286e 702e 696e 7433  ).astype(np.int3
+00002290: 3229 0a20 2020 2069 6620 7665 7262 6f73  2).    if verbos
+000022a0: 653a 2070 7269 6e74 2866 225b 2b5d 2064  e: print(f"[+] d
+000022b0: 665f 6d61 736b 5b27 4d41 534b 5f4b 4a59  f_mask['MASK_KJY
+000022c0: 275d 2e73 756d 2829 203d 207b 6466 5f6d  '].sum() = {df_m
+000022d0: 6173 6b5b 274d 4153 4b5f 4b4a 5927 5d2e  ask['MASK_KJY'].
+000022e0: 7375 6d28 297d 2c20 6166 7465 7220 263d  sum()}, after &=
+000022f0: 206d 6173 6b5f 6b6a 795f 7476 7222 290a   mask_kjy_tvr").
+00002300: 2020 2020 6466 5f6d 6173 6b5b 274d 4153      df_mask['MAS
+00002310: 4b5f 4b4a 5927 5d20 3d20 2864 665f 6d61  K_KJY'] = (df_ma
+00002320: 736b 5b27 4d41 534b 5f4b 4a59 275d 2026  sk['MASK_KJY'] &
+00002330: 206d 6173 6b5f 6b6a 795f 6964 292e 6173   mask_kjy_id).as
+00002340: 7479 7065 286e 702e 696e 7433 3229 0a20  type(np.int32). 
+00002350: 2020 2069 6620 7665 7262 6f73 653a 2070     if verbose: p
+00002360: 7269 6e74 2866 225b 2b5d 2064 665f 6d61  rint(f"[+] df_ma
+00002370: 736b 5b27 4d41 534b 5f4b 4a59 275d 2e73  sk['MASK_KJY'].s
+00002380: 756d 2829 203d 207b 6466 5f6d 6173 6b5b  um() = {df_mask[
+00002390: 274d 4153 4b5f 4b4a 5927 5d2e 7375 6d28  'MASK_KJY'].sum(
+000023a0: 297d 2c20 6166 7465 7220 263d 206d 6173  )}, after &= mas
+000023b0: 6b5f 6b6a 795f 6964 2229 0a20 2020 200a  k_kjy_id").    .
+000023c0: 2020 2020 6d61 736b 5f7a 6474 5f6e 616e      mask_zdt_nan
+000023d0: 203d 2064 665f 6d61 736b 5b27 7063 745f   = df_mask['pct_
+000023e0: 6368 6727 5d2e 6973 6e75 6c6c 2829 2023  chg'].isnull() #
+000023f0: 2070 6374 5f63 6867 2069 7320 6e61 6e2c   pct_chg is nan,
+00002400: 206e 6f74 2073 6574 2066 6f72 207a 6474   not set for zdt
+00002410: 0a20 2020 206d 6173 6b5f 7a64 745f 3130  .    mask_zdt_10
+00002420: 203d 2028 6964 785f 7374 203d 3d20 3129   = (idx_st == 1)
+00002430: 2026 2028 6466 5f6d 6173 6b5b 2770 6374   & (df_mask['pct
+00002440: 5f63 6867 275d 2e61 6273 2829 203c 3d20  _chg'].abs() <= 
+00002450: 392e 3530 290a 2020 2020 6d61 736b 5f7a  9.50).    mask_z
+00002460: 6474 5f73 7420 3d20 2869 6478 5f73 7420  dt_st = (idx_st 
+00002470: 3d3d 2030 2920 2620 2864 665f 6d61 736b  == 0) & (df_mask
+00002480: 5b27 7063 745f 6368 6727 5d2e 6162 7328  ['pct_chg'].abs(
+00002490: 2920 3c3d 2034 2e37 3529 0a20 2020 2064  ) <= 4.75).    d
+000024a0: 665f 6d61 736b 5b27 4d41 534b 5f5a 4454  f_mask['MASK_ZDT
+000024b0: 275d 203d 2028 6d61 736b 5f7a 6474 5f31  '] = (mask_zdt_1
+000024c0: 3020 7c20 6d61 736b 5f7a 6474 5f73 7420  0 | mask_zdt_st 
+000024d0: 7c20 6d61 736b 5f7a 6474 5f6e 616e 292e  | mask_zdt_nan).
+000024e0: 6173 7479 7065 286e 702e 696e 7433 3229  astype(np.int32)
+000024f0: 0a20 2020 2064 665f 6d61 736b 5b27 4d41  .    df_mask['MA
+00002500: 534b 275d 203d 2064 665f 6d61 736b 5b27  SK'] = df_mask['
+00002510: 4d41 534b 5f4b 4a59 275d 2026 2064 665f  MASK_KJY'] & df_
+00002520: 6d61 736b 5b27 4d41 534b 5f5a 4454 275d  mask['MASK_ZDT']
+00002530: 0a20 2020 2063 6f6c 735f 6d61 736b 203d  .    cols_mask =
+00002540: 205b 274d 4153 4b5f 5354 272c 2027 4d41   ['MASK_ST', 'MA
+00002550: 534b 5f4b 4a59 272c 2027 4d41 534b 5f5a  SK_KJY', 'MASK_Z
+00002560: 4454 272c 2027 4d41 534b 275d 0a20 2020  DT', 'MASK'].   
+00002570: 2064 622e 636c 6f73 6528 290a 2020 2020   db.close().    
+00002580: 7265 7475 726e 2064 665f 6d61 736b 2c20  return df_mask, 
+00002590: 636f 6c73 5f6d 6173 6b0a 0a63 6c61 7373  cols_mask..class
+000025a0: 2042 6173 6544 6174 6128 293a 0a20 2020   BaseData():.   
+000025b0: 2064 6566 2067 6574 5f64 6628 7365 6c66   def get_df(self
+000025c0: 2c20 7061 7468 5f69 6e70 7574 2c20 6461  , path_input, da
+000025d0: 7465 5f62 6567 696e 2c20 6461 7465 5f65  te_begin, date_e
+000025e0: 6e64 2c20 6e5f 6a6f 6273 293a 0a20 2020  nd, n_jobs):.   
+000025f0: 2020 2020 2072 6169 7365 204e 6f74 496d       raise NotIm
+00002600: 706c 656d 656e 7465 6445 7272 6f72 2827  plementedError('
+00002610: 796f 7520 6e65 6564 2074 6f20 696d 706c  you need to impl
+00002620: 656d 656e 7420 6765 745f 6466 2829 2729  ement get_df()')
+00002630: 0a0a 2020 2020 6465 6620 6c6f 6164 2873  ..    def load(s
+00002640: 656c 662c 2064 6174 615f 636f 6e66 6967  elf, data_config
+00002650: 2c20 6466 203d 204e 6f6e 652c 2076 6572  , df = None, ver
+00002660: 626f 7365 203d 2054 7275 6529 3a0a 2020  bose = True):.  
+00002670: 2020 2020 2020 2320 696e 7075 740a 2020        # input.  
+00002680: 2020 2020 2020 7061 7468 5f69 6e70 7574        path_input
+00002690: 203d 2043 4f4e 5354 2e50 4154 485f 4441   = CONST.PATH_DA
+000026a0: 5441 0a20 2020 2020 2020 2064 6174 655f  TA.        date_
+000026b0: 6469 6374 203d 2064 6174 615f 636f 6e66  dict = data_conf
+000026c0: 6967 5b27 6461 7465 5f64 6963 7427 5d0a  ig['date_dict'].
+000026d0: 2020 2020 2020 2020 6e5f 6a6f 6273 203d          n_jobs =
+000026e0: 2064 6174 615f 636f 6e66 6967 5b27 6e5f   data_config['n_
+000026f0: 6a6f 6273 275d 0a0a 2020 2020 2020 2020  jobs']..        
+00002700: 636f 6c73 5f64 6963 7420 3d20 6461 7461  cols_dict = data
+00002710: 5f63 6f6e 6669 675b 2763 6f6c 735f 6469  _config['cols_di
+00002720: 6374 275d 0a20 2020 2020 2020 206f 7468  ct'].        oth
+00002730: 6572 5f69 6e66 6f20 3d20 6461 7461 5f63  er_info = data_c
+00002740: 6f6e 6669 675b 276f 7468 6572 5f69 6e66  onfig['other_inf
+00002750: 6f27 5d0a 0a20 2020 2020 2020 2063 6f6c  o']..        col
+00002760: 5f69 6420 3d20 636f 6c73 5f64 6963 745b  _id = cols_dict[
+00002770: 2763 6f6c 5f69 6427 5d0a 2020 2020 2020  'col_id'].      
+00002780: 2020 636f 6c5f 6c61 6265 6c20 3d20 636f    col_label = co
+00002790: 6c73 5f64 6963 745b 2763 6f6c 5f6c 6162  ls_dict['col_lab
+000027a0: 656c 275d 0a20 2020 2020 2020 2063 6f6c  el'].        col
+000027b0: 735f 7469 6420 3d20 636f 6c73 5f64 6963  s_tid = cols_dic
+000027c0: 745b 2763 6f6c 735f 7469 6427 5d0a 2020  t['cols_tid'].  
+000027d0: 2020 2020 2020 636f 6c5f 7469 6420 3d20        col_tid = 
+000027e0: 636f 6c73 5f64 6963 745b 2763 6f6c 5f74  cols_dict['col_t
+000027f0: 6964 275d 0a20 2020 2020 2020 200a 2020  id'].        .  
+00002800: 2020 2020 2020 2320 646d 0a20 2020 2020        # dm.     
+00002810: 2020 2069 6620 6466 2069 7320 4e6f 6e65     if df is None
+00002820: 3a20 6466 203d 2073 656c 662e 6765 745f  : df = self.get_
+00002830: 6466 2870 6174 685f 696e 7075 742c 202a  df(path_input, *
+00002840: 6461 7465 5f64 6963 745b 2761 6c6c 275d  date_dict['all']
+00002850: 2c20 6e5f 6a6f 6273 2c20 7665 7262 6f73  , n_jobs, verbos
+00002860: 6520 3d20 6f74 6865 725f 696e 666f 2e67  e = other_info.g
+00002870: 6574 2827 7665 7262 6f73 6527 2c20 5472  et('verbose', Tr
+00002880: 7565 2929 2023 206d 6173 6b5f 616c 6c0a  ue)) # mask_all.
+00002890: 2020 2020 2020 2020 6966 2027 4461 7461          if 'Data
+000028a0: 4d61 7374 6572 2720 696e 2073 7472 2874  Master' in str(t
+000028b0: 7970 6528 6466 2929 3a20 646d 203d 2064  ype(df)): dm = d
+000028c0: 660a 2020 2020 2020 2020 656c 7365 3a0a  f.        else:.
+000028d0: 2020 2020 2020 2020 2020 2020 6466 2e72              df.r
+000028e0: 6573 6574 5f69 6e64 6578 2864 726f 7020  eset_index(drop 
+000028f0: 3d20 5472 7565 2c20 696e 706c 6163 6520  = True, inplace 
+00002900: 3d20 5472 7565 2920 2320 544f 444f 2072  = True) # TODO r
+00002910: 6573 6574 5f69 6e64 6578 0a20 2020 2020  eset_index.     
+00002920: 2020 2020 2020 2064 6d20 3d20 4461 7461         dm = Data
+00002930: 4d61 7374 6572 2864 662c 2076 6572 626f  Master(df, verbo
+00002940: 7365 203d 2046 616c 7365 2c20 6b65 6570  se = False, keep
+00002950: 5f73 7061 6365 203d 2054 7275 6529 0a20  _space = True). 
+00002960: 2020 2020 2020 2020 2020 2023 2064 6d2e             # dm.
+00002970: 736f 7274 5f76 616c 7565 7328 636f 6c73  sort_values(cols
+00002980: 5f74 6964 202b 205b 636f 6c5f 6964 5d29  _tid + [col_id])
+00002990: 2023 2073 6f72 742c 2054 4f44 4f0a 2020   # sort, TODO.  
+000029a0: 2020 2020 2020 646d 2e66 655f 676f 285b        dm.fe_go([
+000029b0: 636f 6c5f 7469 645d 2c20 7665 7262 6f73  col_tid], verbos
+000029c0: 6520 3d20 4661 6c73 6529 0a20 2020 2020  e = False).     
+000029d0: 2020 200a 2020 2020 2020 2020 2320 2d2d     .        # --
+000029e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000029f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 206c 6162  ------------ lab
+00002a00: 656c 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  el -------------
+00002a10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002a20: 2d20 544f 444f 0a20 2020 2020 2020 2069  - TODO.        i
+00002a30: 6620 7665 7262 6f73 653a 2070 7269 6e74  f verbose: print
+00002a40: 2827 5b69 6e69 745d 203c 2d2d 2d2d 2d2d  ('[init] <------
+00002a50: 2d2d 2d2d 206c 6162 656c 202d 2d2d 2d2d  ---- label -----
+00002a60: 2d2d 2d2d 2d3e 2027 290a 2020 2020 2020  -----> ').      
+00002a70: 2020 636f 6c20 3d20 6627 726f 6c6c 2873    col = f'roll(s
+00002a80: 6869 6674 2c20 7b63 6f6c 5f69 647d 2c20  hift, {col_id}, 
+00002a90: 636c 6f73 652c 2020 7b63 6f6c 5f74 6964  close,  {col_tid
+00002aa0: 7d2c 2031 2927 0a20 2020 2020 2020 2064  }, 1)'.        d
+00002ab0: 6d2e 6665 5f67 6f28 5b66 2741 444a 203d  m.fe_go([f'ADJ =
+00002ac0: 2064 6976 287b 636f 6c7d 2c20 7072 655f   div({col}, pre_
+00002ad0: 636c 6f73 6529 275d 2c20 7665 7262 6f73  close)'], verbos
+00002ae0: 6520 3d20 7665 7262 6f73 6529 0a20 2020  e = verbose).   
+00002af0: 2020 2020 2064 6d2e 6472 6f70 285b 636f       dm.drop([co
+00002b00: 6c5d 2c20 7665 7262 6f73 6520 3d20 4661  l], verbose = Fa
+00002b10: 6c73 6529 0a20 2020 2020 2020 2023 2062  lse).        # b
+00002b20: 6173 6963 2063 6f6c 756d 6e73 0a20 2020  asic columns.   
+00002b30: 2020 2020 206e 616d 655f 6c69 7374 203d       name_list =
+00002b40: 205b 0a20 2020 2020 2020 2020 2020 2066   [.            f
+00002b50: 2776 7761 7020 3d20 6469 7628 616d 6f75  'vwap = div(amou
+00002b60: 6e74 2c20 766f 6c29 272c 0a20 2020 2020  nt, vol)',.     
+00002b70: 2020 2020 2020 2066 276d 6561 6e20 3d20         f'mean = 
+00002b80: 6d65 616e 5f6d 286f 7065 6e2c 2068 6967  mean_m(open, hig
+00002b90: 682c 206c 6f77 2c20 636c 6f73 6529 272c  h, low, close)',
+00002ba0: 0a20 2020 2020 2020 205d 0a20 2020 2020  .        ].     
+00002bb0: 2020 2069 6620 2774 7761 7027 206e 6f74     if 'twap' not
+00002bc0: 2069 6e20 646d 2e68 6561 6428 292e 636f   in dm.head().co
+00002bd0: 6c75 6d6e 733a 206e 616d 655f 6c69 7374  lumns: name_list
+00002be0: 202b 3d20 5b66 2774 7761 7020 3d20 6f28   += [f'twap = o(
+00002bf0: 7677 6170 2927 5d0a 2020 2020 2020 2020  vwap)'].        
+00002c00: 646d 2e66 655f 676f 286e 616d 655f 6c69  dm.fe_go(name_li
+00002c10: 7374 2c20 7665 7262 6f73 6520 3d20 4661  st, verbose = Fa
+00002c20: 6c73 6529 0a0a 2020 2020 2020 2020 2320  lse)..        # 
+00002c30: 7072 655f 7878 782c 2078 7878 5f72 6574  pre_xxx, xxx_ret
+00002c40: 0a20 2020 2020 2020 206e 616d 655f 6c69  .        name_li
+00002c50: 7374 203d 205b 5d0a 2020 2020 2020 2020  st = [].        
+00002c60: 666f 7220 636f 6c20 696e 205b 2774 7761  for col in ['twa
+00002c70: 7027 2c20 2776 7761 7027 2c20 276f 7065  p', 'vwap', 'ope
+00002c80: 6e27 2c20 2763 6c6f 7365 275d 202b 205b  n', 'close'] + [
+00002c90: 276d 6561 6e27 5d3a 0a20 2020 2020 2020  'mean']:.       
+00002ca0: 2020 2020 2069 6620 2770 7265 5f7b 636f       if 'pre_{co
+00002cb0: 6c7d 2720 6e6f 7420 696e 2064 6d2e 6865  l}' not in dm.he
+00002cc0: 6164 2829 2e63 6f6c 756d 6e73 3a0a 2020  ad().columns:.  
+00002cd0: 2020 2020 2020 2020 2020 2020 2020 6e61                na
+00002ce0: 6d65 5f6c 6973 7420 2b3d 205b 6627 7072  me_list += [f'pr
+00002cf0: 655f 7b63 6f6c 7d20 3d20 726f 6c6c 2873  e_{col} = roll(s
+00002d00: 6869 6674 2c20 7b63 6f6c 5f69 647d 2c20  hift, {col_id}, 
+00002d10: 7b63 6f6c 7d2c 207b 636f 6c5f 7469 647d  {col}, {col_tid}
+00002d20: 2c20 3129 275d 0a20 2020 2020 2020 2020  , 1)'].         
+00002d30: 2020 206e 616d 655f 6c69 7374 202b 3d20     name_list += 
+00002d40: 5b66 277b 636f 6c7d 5f72 6574 203d 2072  [f'{col}_ret = r
+00002d50: 6574 2870 7265 5f7b 636f 6c7d 2c20 7b63  et(pre_{col}, {c
+00002d60: 6f6c 7d29 275d 0a20 2020 2020 2020 2064  ol})'].        d
+00002d70: 6d2e 6665 5f67 6f28 6e61 6d65 5f6c 6973  m.fe_go(name_lis
+00002d80: 742c 2076 6572 626f 7365 203d 2046 616c  t, verbose = Fal
+00002d90: 7365 2920 2020 2020 2020 200a 0a20 2020  se)        ..   
+00002da0: 2020 2020 2023 2064 665f 6c61 6265 6c5f       # df_label_
+00002db0: 6669 6e61 6c0a 2020 2020 2020 2020 6c61  final.        la
+00002dc0: 6265 6c5f 6672 6f6d 5f73 7472 203d 206f  bel_from_str = o
+00002dd0: 7468 6572 5f69 6e66 6f2e 6765 7428 276c  ther_info.get('l
+00002de0: 6162 656c 5f66 726f 6d5f 7374 7227 2c20  abel_from_str', 
+00002df0: 2727 290a 2020 2020 2020 2020 6966 206c  '').        if l
+00002e00: 656e 286c 6162 656c 5f66 726f 6d5f 7374  en(label_from_st
+00002e10: 7229 203e 2030 3a0a 2020 2020 2020 2020  r) > 0:.        
+00002e20: 2020 2020 636f 6c5f 6c61 6265 6c5f 6672      col_label_fr
+00002e30: 6f6d 203d 2027 4c41 4245 4c5f 4652 4f4d  om = 'LABEL_FROM
+00002e40: 5f53 5452 270a 2020 2020 2020 2020 2020  _STR'.          
+00002e50: 2020 636f 6c5f 6c61 6265 6c5f 6172 6773    col_label_args
+00002e60: 5f6c 6973 7420 3d20 6c61 6265 6c5f 6672  _list = label_fr
+00002e70: 6f6d 5f73 7472 2e73 706c 6974 2827 5f5f  om_str.split('__
+00002e80: 2729 5b31 3a5d 0a20 2020 2020 2020 2020  ')[1:].         
+00002e90: 2020 2070 6164 6469 6e67 203d 206e 702e     padding = np.
+00002ea0: 6d61 7828 5b6e 702e 6d61 7828 6465 636f  max([np.max(deco
+00002eb0: 6465 5f6c 6162 656c 5f61 7267 7328 7829  de_label_args(x)
+00002ec0: 5b31 3a33 5d29 2066 6f72 2078 2069 6e20  [1:3]) for x in 
+00002ed0: 636f 6c5f 6c61 6265 6c5f 6172 6773 5f6c  col_label_args_l
+00002ee0: 6973 745d 290a 2020 2020 2020 2020 656c  ist]).        el
+00002ef0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00002f00: 636f 6c5f 6c61 6265 6c5f 6672 6f6d 203d  col_label_from =
+00002f10: 2063 6f6c 5f6c 6162 656c 5f61 7267 735f   col_label_args_
+00002f20: 325f 6e61 6d65 286f 7468 6572 5f69 6e66  2_name(other_inf
+00002f30: 6f5b 2763 6f6c 5f6c 6162 656c 5f61 7267  o['col_label_arg
+00002f40: 7327 5d29 0a20 2020 2020 2020 2020 2020  s']).           
+00002f50: 2063 6f6c 5f6c 6162 656c 5f61 7267 735f   col_label_args_
+00002f60: 6c69 7374 203d 205b 6f74 6865 725f 696e  list = [other_in
+00002f70: 666f 5b27 636f 6c5f 6c61 6265 6c5f 6172  fo['col_label_ar
+00002f80: 6773 275d 5d0a 2020 2020 2020 2020 2020  gs']].          
+00002f90: 2020 7061 6464 696e 6720 3d20 6e70 2e6d    padding = np.m
+00002fa0: 6178 285b 696e 7428 7829 2066 6f72 2078  ax([int(x) for x
+00002fb0: 2069 6e20 636f 6c5f 6c61 6265 6c5f 6672   in col_label_fr
+00002fc0: 6f6d 2e73 706c 6974 2827 5f27 295b 323a  om.split('_')[2:
+00002fd0: 345d 5d29 2023 2070 6164 6469 6e67 206b  4]]) # padding k
+00002fe0: 2064 6179 730a 2020 2020 2020 2020 636f   days.        co
+00002ff0: 6c5f 6c61 6265 6c5f 6172 6773 5f6c 6973  l_label_args_lis
+00003000: 7420 2b3d 206f 7468 6572 5f69 6e66 6f2e  t += other_info.
+00003010: 6765 7428 2763 6f6c 5f6c 6162 656c 5f61  get('col_label_a
+00003020: 7267 735f 6c69 7374 272c 205b 5d29 0a20  rgs_list', []). 
+00003030: 2020 2020 2020 2063 6f6c 5f6c 6162 656c         col_label
+00003040: 5f61 7267 735f 6c69 7374 203d 205b 6465  _args_list = [de
+00003050: 636f 6465 5f6c 6162 656c 5f61 7267 7328  code_label_args(
+00003060: 7829 2066 6f72 2078 2069 6e20 636f 6c5f  x) for x in col_
+00003070: 6c61 6265 6c5f 6172 6773 5f6c 6973 745d  label_args_list]
+00003080: 0a20 2020 2020 2020 2063 6f6c 5f6c 6162  .        col_lab
+00003090: 656c 5f61 7267 735f 6c69 7374 203d 206c  el_args_list = l
+000030a0: 6973 7428 7064 2e53 6572 6965 7328 636f  ist(pd.Series(co
+000030b0: 6c5f 6c61 6265 6c5f 6172 6773 5f6c 6973  l_label_args_lis
+000030c0: 7429 2e64 726f 705f 6475 706c 6963 6174  t).drop_duplicat
+000030d0: 6573 2829 290a 2020 2020 2020 2020 6f74  es()).        ot
+000030e0: 6865 725f 696e 666f 5b27 636f 6c5f 6c61  her_info['col_la
+000030f0: 6265 6c5f 6172 6773 5f6c 6973 7427 5d20  bel_args_list'] 
+00003100: 3d20 636f 6c5f 6c61 6265 6c5f 6172 6773  = col_label_args
+00003110: 5f6c 6973 740a 2020 2020 2020 2020 6f74  _list.        ot
+00003120: 6865 725f 696e 666f 5b27 636f 6c5f 6c61  her_info['col_la
+00003130: 6265 6c5f 6672 6f6d 275d 2020 3d20 636f  bel_from']  = co
+00003140: 6c5f 6c61 6265 6c5f 6672 6f6d 0a20 2020  l_label_from.   
+00003150: 2020 2020 200a 2020 2020 2020 2020 6966       .        if
+00003160: 2076 6572 626f 7365 3a20 7072 696e 7428   verbose: print(
+00003170: 6627 5b2b 5d20 6c61 6265 6c5f 6672 6f6d  f'[+] label_from
+00003180: 5f73 7472 203d 207b 6c61 6265 6c5f 6672  _str = {label_fr
+00003190: 6f6d 5f73 7472 7d2c 2063 6f6c 5f6c 6162  om_str}, col_lab
+000031a0: 656c 5f66 726f 6d20 3d20 7b63 6f6c 5f6c  el_from = {col_l
+000031b0: 6162 656c 5f66 726f 6d7d 2729 0a20 2020  abel_from}').   
+000031c0: 2020 2020 2069 6620 7665 7262 6f73 653a       if verbose:
+000031d0: 2070 7269 6e74 2866 275b 2b5d 2063 6f6c   print(f'[+] col
+000031e0: 5f6c 6162 656c 5f61 7267 735f 6c69 7374  _label_args_list
+000031f0: 203d 207b 636f 6c5f 6c61 6265 6c5f 6172   = {col_label_ar
+00003200: 6773 5f6c 6973 747d 2729 0a0a 2020 2020  gs_list}')..    
+00003210: 2020 2020 636f 6c73 5f70 7269 6365 203d      cols_price =
+00003220: 205b 785b 305d 2066 6f72 2078 2069 6e20   [x[0] for x in 
+00003230: 636f 6c5f 6c61 6265 6c5f 6172 6773 5f6c  col_label_args_l
+00003240: 6973 745d 202b 205b 785b 2d31 5d20 666f  ist] + [x[-1] fo
+00003250: 7220 7820 696e 2063 6f6c 5f6c 6162 656c  r x in col_label
+00003260: 5f61 7267 735f 6c69 7374 2069 6620 7479  _args_list if ty
+00003270: 7065 2878 5b2d 315d 2920 6973 2073 7472  pe(x[-1]) is str
+00003280: 5d0a 2020 2020 2020 2020 636f 6c73 5f70  ].        cols_p
+00003290: 7269 6365 203d 206c 6973 7428 7064 2e53  rice = list(pd.S
+000032a0: 6572 6965 7328 636f 6c73 5f70 7269 6365  eries(cols_price
+000032b0: 292e 6472 6f70 5f64 7570 6c69 6361 7465  ).drop_duplicate
+000032c0: 7328 2929 0a20 2020 2020 2020 2064 6620  s()).        df 
+000032d0: 3d20 646d 2e67 6574 5f63 6f6c 735f 7061  = dm.get_cols_pa
+000032e0: 6e64 6173 285b 636f 6c5f 7469 642c 2063  ndas([col_tid, c
+000032f0: 6f6c 5f69 645d 202b 2063 6f6c 735f 7072  ol_id] + cols_pr
+00003300: 6963 6520 2b20 5b27 4144 4a27 5d29 0a20  ice + ['ADJ']). 
+00003310: 2020 2020 2020 2064 665f 6c61 6265 6c5f         df_label_
+00003320: 6669 6e61 6c2c 2063 6f6c 735f 6c61 6265  final, cols_labe
+00003330: 6c20 3d20 6765 745f 6466 5f6c 6162 656c  l = get_df_label
+00003340: 5f66 696e 616c 2864 662c 2063 6f6c 5f74  _final(df, col_t
+00003350: 6964 2c20 636f 6c5f 6964 2c20 636f 6c73  id, col_id, cols
+00003360: 5f70 7269 6365 2c20 636f 6c5f 6c61 6265  _price, col_labe
+00003370: 6c5f 6172 6773 5f6c 6973 742c 206c 6162  l_args_list, lab
+00003380: 656c 5f66 726f 6d5f 7374 722c 2076 6572  el_from_str, ver
+00003390: 626f 7365 203d 206f 7468 6572 5f69 6e66  bose = other_inf
+000033a0: 6f2e 6765 7428 2776 6572 626f 7365 272c  o.get('verbose',
+000033b0: 2054 7275 6529 290a 2020 2020 2020 2020   True)).        
+000033c0: 666f 7220 636f 6c20 696e 2063 6f6c 735f  for col in cols_
+000033d0: 6c61 6265 6c3a 2064 6d2e 7365 745f 6279  label: dm.set_by
+000033e0: 5f63 6f6c 2863 6f6c 2c20 6466 5f6c 6162  _col(col, df_lab
+000033f0: 656c 5f66 696e 616c 5b63 6f6c 5d29 0a20  el_final[col]). 
+00003400: 2020 2020 2020 2063 6f6c 735f 6c61 6265         cols_labe
+00003410: 6c20 2b3d 205b 274c 4142 454c 5f52 4157  l += ['LABEL_RAW
+00003420: 275d 0a20 2020 2020 2020 2069 6620 276c  '].        if 'l
+00003430: 6162 656c 2720 696e 2064 6d2e 6865 6164  abel' in dm.head
+00003440: 2829 2e63 6f6c 756d 6e73 3a20 636f 6c73  ().columns: cols
+00003450: 5f6c 6162 656c 202b 3d20 5b27 6c61 6265  _label += ['labe
+00003460: 6c27 5d0a 2020 2020 2020 2020 6461 7461  l'].        data
+00003470: 5f63 6f6e 6669 675b 2763 6f6c 735f 6469  _config['cols_di
+00003480: 6374 275d 5b27 636f 6c73 5f6c 6162 656c  ct']['cols_label
+00003490: 275d 203d 2063 6f6c 735f 6c61 6265 6c0a  '] = cols_label.
+000034a0: 2020 2020 2020 2020 6966 2076 6572 626f          if verbo
+000034b0: 7365 3a20 7072 696e 7428 6627 5b2b 5d20  se: print(f'[+] 
+000034c0: 636f 6c73 5f6c 6162 656c 203d 207b 636f  cols_label = {co
+000034d0: 6c73 5f6c 6162 656c 7d27 290a 0a20 2020  ls_label}')..   
+000034e0: 2020 2020 2023 2066 5f6c 6162 656c 5f70       # f_label_p
+000034f0: 7265 0a20 2020 2020 2020 2066 5f6c 6162  re.        f_lab
+00003500: 656c 5f70 7265 203d 206f 7468 6572 5f69  el_pre = other_i
+00003510: 6e66 6f2e 6765 7428 2766 5f6c 6162 656c  nfo.get('f_label
+00003520: 5f70 7265 272c 204e 6f6e 6529 0a20 2020  _pre', None).   
+00003530: 2020 2020 2069 6620 7665 7262 6f73 653a       if verbose:
+00003540: 2070 7269 6e74 2866 275b 2b5d 2066 5f6c   print(f'[+] f_l
+00003550: 6162 656c 5f70 7265 203d 207b 665f 6c61  abel_pre = {f_la
+00003560: 6265 6c5f 7072 657d 2c20 636f 6c5f 6c61  bel_pre}, col_la
+00003570: 6265 6c5f 6672 6f6d 203d 207b 636f 6c5f  bel_from = {col_
+00003580: 6c61 6265 6c5f 6672 6f6d 7d27 290a 2020  label_from}').  
+00003590: 2020 2020 2020 6966 2066 5f6c 6162 656c        if f_label
+000035a0: 5f70 7265 203d 3d20 2763 737a 7363 6f72  _pre == 'cszscor
+000035b0: 6527 3a20 2320 665f 6c61 6265 6c5f 7072  e': # f_label_pr
+000035c0: 650a 2020 2020 2020 2020 2020 2020 646d  e.            dm
+000035d0: 2e66 655f 676f 285b 6627 4c41 4245 4c5f  .fe_go([f'LABEL_
+000035e0: 5241 5720 3d20 6f28 7b63 6f6c 5f6c 6162  RAW = o({col_lab
+000035f0: 656c 5f66 726f 6d7d 2927 5d2c 2076 6572  el_from})'], ver
+00003600: 626f 7365 203d 2076 6572 626f 7365 290a  bose = verbose).
+00003610: 2020 2020 2020 2020 2020 2020 646d 2e66              dm.f
+00003620: 655f 676f 285b 6627 7b63 6f6c 5f6c 6162  e_go([f'{col_lab
+00003630: 656c 7d20 3d20 6167 6728 7a73 636f 7265  el} = agg(zscore
+00003640: 2c20 7b63 6f6c 5f74 6964 7d2c 207b 636f  , {col_tid}, {co
+00003650: 6c5f 6c61 6265 6c5f 6672 6f6d 7d29 275d  l_label_from})']
+00003660: 2c20 7665 7262 6f73 6520 3d20 7665 7262  , verbose = verb
+00003670: 6f73 6529 2023 2054 4f44 4f3f 206d 6173  ose) # TODO? mas
+00003680: 6b20 3f20 0a20 2020 2020 2020 2020 2020  k ? .           
+00003690: 200a 2020 2020 2020 2020 2020 2020 2320   .            # 
+000036a0: 7a73 636f 7265 2066 6f72 2061 6c6c 204c  zscore for all L
+000036b0: 4142 454c 0a20 2020 2020 2020 2020 2020  ABEL.           
+000036c0: 206e 616d 655f 6c69 7374 203d 205b 6627   name_list = [f'
+000036d0: 6167 6728 7a73 636f 7265 2c20 7b63 6f6c  agg(zscore, {col
+000036e0: 5f74 6964 7d2c 207b 636f 6c7d 2927 2066  _tid}, {col})' f
+000036f0: 6f72 2063 6f6c 2069 6e20 636f 6c73 5f6c  or col in cols_l
+00003700: 6162 656c 2069 6620 636f 6c20 6e6f 7420  abel if col not 
+00003710: 696e 205b 274c 4142 454c 5f52 4157 275d  in ['LABEL_RAW']
+00003720: 5d0a 2020 2020 2020 2020 2020 2020 646d  ].            dm
+00003730: 2e66 655f 676f 286e 616d 655f 6c69 7374  .fe_go(name_list
+00003740: 2c20 7665 7262 6f73 6520 3d20 7665 7262  , verbose = verb
+00003750: 6f73 652c 206b 6565 705f 6e61 6d65 203d  ose, keep_name =
+00003760: 2032 290a 2020 2020 2020 2020 656c 6966   2).        elif
+00003770: 2066 5f6c 6162 656c 5f70 7265 203d 3d20   f_label_pre == 
+00003780: 276f 7269 6769 6e27 3a0a 2020 2020 2020  'origin':.      
+00003790: 2020 2020 2020 646d 2e66 655f 676f 285b        dm.fe_go([
+000037a0: 6627 4c41 4245 4c5f 5241 5720 3d20 6f28  f'LABEL_RAW = o(
+000037b0: 7b63 6f6c 5f6c 6162 656c 5f66 726f 6d7d  {col_label_from}
+000037c0: 2927 5d2c 2076 6572 626f 7365 203d 2076  )'], verbose = v
+000037d0: 6572 626f 7365 290a 2020 2020 2020 2020  erbose).        
+000037e0: 2020 2020 646d 2e66 655f 676f 285b 6627      dm.fe_go([f'
+000037f0: 7b63 6f6c 5f6c 6162 656c 7d20 3d20 6f28  {col_label} = o(
+00003800: 7b63 6f6c 5f6c 6162 656c 5f66 726f 6d7d  {col_label_from}
+00003810: 2927 5d2c 2076 6572 626f 7365 203d 2076  )'], verbose = v
+00003820: 6572 626f 7365 290a 2020 2020 2020 2020  erbose).        
+00003830: 656c 6966 2066 5f6c 6162 656c 5f70 7265  elif f_label_pre
+00003840: 203d 3d20 2765 7869 7374 273a 0a20 2020   == 'exist':.   
+00003850: 2020 2020 2020 2020 2069 6620 7665 7262           if verb
+00003860: 6f73 653a 2070 7269 6e74 2866 275b 2b5d  ose: print(f'[+]
+00003870: 2072 6177 206c 6162 656c 2066 726f 6d20   raw label from 
+00003880: 646d 2c20 2877 6869 6368 206d 6561 6e20  dm, (which mean 
+00003890: 6578 6973 7420 7468 6973 2063 6f6c 756d  exist this colum
+000038a0: 6e2c 206c 6162 656c 2927 290a 2020 2020  n, label)').    
+000038b0: 2020 2020 2020 2020 646d 2e66 655f 676f          dm.fe_go
+000038c0: 285b 6627 4c41 4245 4c5f 5241 5720 3d20  ([f'LABEL_RAW = 
+000038d0: 6f28 7b63 6f6c 5f6c 6162 656c 7d29 275d  o({col_label})']
+000038e0: 2c20 7665 7262 6f73 6520 3d20 7665 7262  , verbose = verb
+000038f0: 6f73 6529 0a20 2020 2020 2020 2020 2020  ose).           
+00003900: 2061 7373 6572 7420 636f 6c5f 6c61 6265   assert col_labe
+00003910: 6c20 696e 2064 6d2e 6865 6164 2829 2e63  l in dm.head().c
+00003920: 6f6c 756d 6e73 2c20 2763 6f6c 5f6c 6162  olumns, 'col_lab
+00003930: 656c 203d 207b 636f 6c5f 6c61 6265 6c7d  el = {col_label}
+00003940: 206e 6f74 2069 6e20 646d 2127 0a20 2020   not in dm!'.   
+00003950: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00003960: 2020 2020 2020 2072 6169 7365 204e 6f74         raise Not
+00003970: 496d 706c 656d 656e 7465 6445 7272 6f72  ImplementedError
+00003980: 2866 275b 2b5d 2066 5f6c 6162 656c 5f70  (f'[+] f_label_p
+00003990: 7265 203d 207b 665f 6c61 6265 6c5f 7072  re = {f_label_pr
+000039a0: 657d 2729 0a20 2020 2020 2020 2023 2064  e}').        # d
+000039b0: 6d2e 7365 745f 6279 5f63 6f6c 2863 6f6c  m.set_by_col(col
+000039c0: 5f6c 6162 656c 2c20 6e70 2e63 6c69 7028  _label, np.clip(
+000039d0: 646d 2e67 6574 5f63 6f6c 5f6e 756d 7079  dm.get_col_numpy
+000039e0: 2863 6f6c 5f6c 6162 656c 292c 202d 3130  (col_label), -10
+000039f0: 2c20 3130 2929 2023 2054 4f44 4f20 636c  , 10)) # TODO cl
+00003a00: 6970 0a0a 2020 2020 2020 2020 2320 2d2d  ip..        # --
+00003a10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00003a20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 206d 6173  ------------ mas
+00003a30: 6b20 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  k --------------
+00003a40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00003a50: 2054 4f44 4f0a 2020 2020 2020 2020 2320   TODO.        # 
+00003a60: 6466 5f6d 6173 6b0a 2020 2020 2020 2020  df_mask.        
+00003a70: 6966 2076 6572 626f 7365 3a20 7072 696e  if verbose: prin
+00003a80: 7428 275b 696e 6974 5d20 3c2d 2d2d 2d2d  t('[init] <-----
+00003a90: 2d2d 2d2d 2d20 6d61 736b 2020 2d2d 2d2d  ----- mask  ----
+00003aa0: 2d2d 2d2d 2d2d 3e20 2729 0a20 2020 2020  ------> ').     
+00003ab0: 2020 2070 6174 685f 6462 203d 2066 277b     path_db = f'{
+00003ac0: 6f73 2e70 6174 682e 6469 726e 616d 6528  os.path.dirname(
+00003ad0: 6f73 2e70 6174 682e 6162 7370 6174 6828  os.path.abspath(
+00003ae0: 7061 7468 5f69 6e70 7574 2929 7d2f 727a  path_input))}/rz
+00003af0: 2e64 6227 0a20 2020 2020 2020 2069 6620  .db'.        if 
+00003b00: 7665 7262 6f73 653a 2070 7269 6e74 2866  verbose: print(f
+00003b10: 275b 2b5d 2070 6174 685f 6462 203d 207b  '[+] path_db = {
+00003b20: 7061 7468 5f64 627d 2729 0a20 2020 2020  path_db}').     
+00003b30: 2020 2069 6620 6f73 2e70 6174 682e 6578     if os.path.ex
+00003b40: 6973 7473 2870 6174 685f 6462 293a 0a20  ists(path_db):. 
+00003b50: 2020 2020 2020 2020 2020 2064 665f 6d61             df_ma
+00003b60: 736b 2c20 636f 6c73 5f6d 6173 6b20 3d20  sk, cols_mask = 
+00003b70: 6765 745f 6466 5f6d 6173 6b28 7061 7468  get_df_mask(path
+00003b80: 5f64 622c 2064 6d2c 2063 6f6c 5f74 6964  _db, dm, col_tid
+00003b90: 2c20 636f 6c5f 6964 2c20 7665 7262 6f73  , col_id, verbos
+00003ba0: 653d 7665 7262 6f73 6529 0a20 2020 2020  e=verbose).     
+00003bb0: 2020 2020 2020 2066 6f72 2063 6f6c 2069         for col i
+00003bc0: 6e20 636f 6c73 5f6d 6173 6b3a 2064 6d2e  n cols_mask: dm.
+00003bd0: 7365 745f 6279 5f63 6f6c 2863 6f6c 2c20  set_by_col(col, 
+00003be0: 6466 5f6d 6173 6b5b 636f 6c5d 290a 2020  df_mask[col]).  
+00003bf0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00003c00: 2020 2020 2020 2020 636f 6c73 5f6d 6173          cols_mas
+00003c10: 6b20 3d20 636f 6c73 5f6d 6173 6b20 3d20  k = cols_mask = 
+00003c20: 5b27 4d41 534b 5f53 5427 2c20 274d 4153  ['MASK_ST', 'MAS
+00003c30: 4b5f 4b4a 5927 2c20 274d 4153 4b5f 5a44  K_KJY', 'MASK_ZD
+00003c40: 5427 2c20 274d 4153 4b27 5d0a 2020 2020  T', 'MASK'].    
+00003c50: 2020 2020 6461 7461 5f63 6f6e 6669 675b      data_config[
+00003c60: 2763 6f6c 735f 6469 6374 275d 5b27 636f  'cols_dict']['co
+00003c70: 6c73 5f6d 6173 6b27 5d20 3d20 636f 6c73  ls_mask'] = cols
+00003c80: 5f6d 6173 6b0a 2020 2020 2020 2020 6966  _mask.        if
+00003c90: 2076 6572 626f 7365 3a20 7072 696e 7428   verbose: print(
+00003ca0: 6627 5b2b 5d20 636f 6c73 5f6d 6173 6b20  f'[+] cols_mask 
+00003cb0: 3d20 7b63 6f6c 735f 6d61 736b 7d27 290a  = {cols_mask}').
+00003cc0: 0a20 2020 2020 2020 2023 206b 6a79 2026  .        # kjy &
+00003cd0: 207a 6474 0a20 2020 2020 2020 2069 6620   zdt.        if 
+00003ce0: 6f73 2e70 6174 682e 6578 6973 7473 2870  os.path.exists(p
+00003cf0: 6174 685f 6462 293a 0a20 2020 2020 2020  ath_db):.       
+00003d00: 2020 2020 2023 206d 6173 6b20 3d20 31e7       # mask = 1.
+00003d10: 9a84 2c20 6c61 6265 6c2e 6973 6e75 6c6c  .., label.isnull
+00003d20: 2829 e79a 842c 20e4 b8bb e8a6 81e6 98af  ()..., .........
+00003d30: e59b a0e4 b8ba e590 84e7 a78d e581 9ce7  ................
+00003d40: 898c e79a 84e6 8385 e586 b50a 2020 2020  ............    
+00003d50: 2020 2020 2020 2020 6d61 736b 5f6b 6a79          mask_kjy
+00003d60: 203d 2028 7e6e 702e 6973 6e61 6e28 646d   = (~np.isnan(dm
+00003d70: 2e64 665f 6469 6374 5b27 5430 275d 5b63  .df_dict['T0'][c
+00003d80: 6f6c 5f6c 6162 656c 5d2e 746f 5f6e 756d  ol_label].to_num
+00003d90: 7079 2829 2929 2e61 7374 7970 6528 6e70  py())).astype(np
+00003da0: 2e69 6e74 3332 2920 2320 e4bc 9ae5 afbc  .int32) # ......
+00003db0: e887 b4e4 b88d e590 8c6c 6162 656c e4b8  .........label..
+00003dc0: 8de4 b880 e6a0 b72c 20e9 bb98 e8ae a46c  ......., ......l
+00003dd0: 6162 656c e983 bde7 94a8 7878 782c 302c  abel......xxx,0,
+00003de0: 31e5 90a7 0a20 2020 2020 2020 2020 2020  1....           
+00003df0: 206d 6173 6b5f 6b6a 7920 263d 2064 6d2e   mask_kjy &= dm.
+00003e00: 6466 5f64 6963 745b 2754 3027 5d5b 274d  df_dict['T0']['M
+00003e10: 4153 4b5f 4b4a 5927 5d2e 746f 5f6e 756d  ASK_KJY'].to_num
+00003e20: 7079 2829 0a20 2020 2020 2020 2020 2020  py().           
+00003e30: 2023 206d 6173 6b5f 6b6a 7920 3d20 646d   # mask_kjy = dm
+00003e40: 2e64 665f 6469 6374 5b27 5430 275d 5b27  .df_dict['T0']['
+00003e50: 4d41 534b 5f4b 4a59 275d 2e74 6f5f 6e75  MASK_KJY'].to_nu
+00003e60: 6d70 7928 290a 2020 2020 2020 2020 2020  mpy().          
+00003e70: 2020 6d61 736b 5f7a 6474 203d 2064 6d2e    mask_zdt = dm.
+00003e80: 6466 5f64 6963 745b 2754 3027 5d5b 274d  df_dict['T0']['M
+00003e90: 4153 4b5f 5a44 5427 5d2e 746f 5f6e 756d  ASK_ZDT'].to_num
+00003ea0: 7079 2829 0a20 2020 2020 2020 2065 6c73  py().        els
+00003eb0: 653a 0a20 2020 2020 2020 2020 2020 206d  e:.            m
+00003ec0: 6173 6b5f 6b6a 7920 3d20 287e 6e70 2e69  ask_kjy = (~np.i
+00003ed0: 736e 616e 2864 6d2e 6466 5f64 6963 745b  snan(dm.df_dict[
+00003ee0: 2754 3027 5d5b 636f 6c5f 6c61 6265 6c5d  'T0'][col_label]
+00003ef0: 2e74 6f5f 6e75 6d70 7928 2929 292e 6173  .to_numpy())).as
+00003f00: 7479 7065 286e 702e 696e 7433 3229 0a20  type(np.int32). 
+00003f10: 2020 2020 2020 2020 2020 206d 6173 6b5f             mask_
+00003f20: 6b6a 7920 263d 2028 7e6e 702e 6973 6e61  kjy &= (~np.isna
+00003f30: 6e28 646d 2e64 665f 6469 6374 5b27 5430  n(dm.df_dict['T0
+00003f40: 275d 5b27 6f70 656e 275d 2e74 6f5f 6e75  ']['open'].to_nu
+00003f50: 6d70 7928 2929 292e 6173 7479 7065 286e  mpy())).astype(n
+00003f60: 702e 696e 7433 3229 0a20 2020 2020 2020  p.int32).       
+00003f70: 2020 2020 2023 206d 6173 6b5f 6b6a 7920       # mask_kjy 
+00003f80: 3d20 287e 6e70 2e69 736e 616e 2864 6d2e  = (~np.isnan(dm.
+00003f90: 6466 5f64 6963 745b 2754 3027 5d5b 276f  df_dict['T0']['o
+00003fa0: 7065 6e27 5d2e 746f 5f6e 756d 7079 2829  pen'].to_numpy()
+00003fb0: 2929 2e61 7374 7970 6528 6e70 2e69 6e74  )).astype(np.int
+00003fc0: 3332 290a 2020 2020 2020 2020 2020 2020  32).            
+00003fd0: 6d61 736b 5f7a 6474 203d 2064 6d2e 6765  mask_zdt = dm.ge
+00003fe0: 745f 636f 6c5f 6e75 6d70 7928 276d 6173  t_col_numpy('mas
+00003ff0: 6b27 2920 3d3d 2031 0a20 2020 2020 2020  k') == 1.       
+00004000: 2064 6d2e 7365 745f 6d61 736b 286d 6173   dm.set_mask(mas
+00004010: 6b5f 6b6a 792e 6173 7479 7065 286e 702e  k_kjy.astype(np.
+00004020: 696e 7433 3229 2c20 276b 6a79 2729 0a20  int32), 'kjy'). 
+00004030: 2020 2020 2020 2064 6d2e 7365 745f 6d61         dm.set_ma
+00004040: 736b 286d 6173 6b5f 7a64 742e 6173 7479  sk(mask_zdt.asty
+00004050: 7065 286e 702e 696e 7433 3229 2c20 277a  pe(np.int32), 'z
+00004060: 6474 2729 0a0a 2020 2020 2020 2020 2320  dt')..        # 
+00004070: 6d61 736b 5f64 726f 700a 2020 2020 2020  mask_drop.      
+00004080: 2020 6966 2046 616c 7365 2061 6e64 206f    if False and o
+00004090: 732e 7061 7468 2e65 7869 7374 7328 7061  s.path.exists(pa
+000040a0: 7468 5f64 6229 3a0a 2020 2020 2020 2020  th_db):.        
+000040b0: 2020 2020 646d 2e66 655f 676f 285b 6627      dm.fe_go([f'
+000040c0: 6770 286d 6561 6e2c 207b 636f 6c5f 7469  gp(mean, {col_ti
+000040d0: 647d 2c20 4c41 4245 4c5f 5241 5729 275d  d}, LABEL_RAW)']
+000040e0: 290a 2020 2020 2020 2020 2020 2020 6466  ).            df
+000040f0: 5f67 7020 3d20 646d 2e67 6574 5f63 6f6c  _gp = dm.get_col
+00004100: 735f 7061 6e64 6173 2864 665f 6e61 6d65  s_pandas(df_name
+00004110: 203d 2066 2754 302e 7b63 6f6c 5f74 6964   = f'T0.{col_tid
+00004120: 7d27 290a 2020 2020 2020 2020 2020 2020  }').            
+00004130: 6461 7465 5f64 726f 7020 3d20 6466 5f67  date_drop = df_g
+00004140: 705b 6466 5f67 705b 6627 6770 286d 6561  p[df_gp[f'gp(mea
+00004150: 6e2c 207b 636f 6c5f 7469 647d 2c20 4c41  n, {col_tid}, LA
+00004160: 4245 4c5f 5241 5729 275d 2e61 6273 2829  BEL_RAW)'].abs()
+00004170: 203e 2030 2e30 335d 5b63 6f6c 5f74 6964   > 0.03][col_tid
+00004180: 5d2e 7661 6c75 6573 0a20 2020 2020 2020  ].values.       
+00004190: 2020 2020 2064 6174 655f 6472 6f70 203d       date_drop =
+000041a0: 2064 6174 655f 6472 6f70 5b64 6174 655f   date_drop[date_
+000041b0: 6472 6f70 203c 3d20 6461 7465 5f64 6963  drop <= date_dic
+000041c0: 745b 2761 6c6c 275d 5b31 5d5d 0a20 2020  t['all'][1]].   
+000041d0: 2020 2020 2020 2020 2070 7269 6e74 2866           print(f
+000041e0: 275b 2b5d 2064 6174 655f 6472 6f70 203d  '[+] date_drop =
+000041f0: 207b 6c65 6e28 6461 7465 5f64 726f 7029   {len(date_drop)
+00004200: 7d5c 6e64 6174 655f 6472 6f70 203d 205b  }\ndate_drop = [
+00004210: 7b22 2c20 222e 6a6f 696e 2873 7472 2878  {", ".join(str(x
+00004220: 2920 666f 7220 7820 696e 2064 6174 655f  ) for x in date_
+00004230: 6472 6f70 297d 5d27 290a 2020 2020 2020  drop)}]').      
+00004240: 2020 2020 2020 6d61 736b 5f64 726f 7020        mask_drop 
+00004250: 3d20 287e 646d 2e67 6574 5f63 6f6c 5f70  = (~dm.get_col_p
+00004260: 616e 6461 7328 636f 6c5f 7469 6429 2e69  andas(col_tid).i
+00004270: 7369 6e28 7365 7428 6461 7465 5f64 726f  sin(set(date_dro
+00004280: 7029 2929 2e76 616c 7565 730a 2020 2020  p))).values.    
+00004290: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+000042a0: 2020 2020 2020 6d61 736b 5f64 726f 7020        mask_drop 
+000042b0: 3d20 6e70 2e6f 6e65 735f 6c69 6b65 286d  = np.ones_like(m
+000042c0: 6173 6b5f 6b6a 7929 2e61 7374 7970 6528  ask_kjy).astype(
+000042d0: 626f 6f6c 290a 2020 2020 2020 2020 2320  bool).        # 
+000042e0: 6d61 736b 0a20 2020 2020 2020 206d 6173  mask.        mas
+000042f0: 6b5f 6d61 736b 203d 206d 6173 6b5f 6b6a  k_mask = mask_kj
+00004300: 7920 2620 6d61 736b 5f7a 6474 0a20 2020  y & mask_zdt.   
+00004310: 2020 2020 206d 6173 6b5f 6d61 736b 2026       mask_mask &
+00004320: 3d20 6d61 736b 5f64 726f 700a 2020 2020  = mask_drop.    
+00004330: 2020 2020 646d 2e73 6574 5f6d 6173 6b28      dm.set_mask(
+00004340: 6d61 736b 5f6d 6173 6b2c 2027 6d61 736b  mask_mask, 'mask
+00004350: 2729 0a20 2020 2020 2020 2064 6d2e 7365  ').        dm.se
+00004360: 745f 6279 5f63 6f6c 2827 4d41 534b 272c  t_by_col('MASK',
+00004370: 206d 6173 6b5f 6d61 736b 2920 2320 7570   mask_mask) # up
+00004380: 6461 7465 206d 6173 6b0a 2020 2020 2020  date mask.      
+00004390: 2020 6966 2076 6572 626f 7365 3a20 0a20    if verbose: . 
+000043a0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+000043b0: 2866 275b 2b5d 206b 6a79 2020 3d20 7b6d  (f'[+] kjy  = {m
+000043c0: 6173 6b5f 6b6a 792e 7375 6d28 297d 202f  ask_kjy.sum()} /
+000043d0: 207b 6c65 6e28 6d61 736b 5f6b 6a79 297d   {len(mask_kjy)}
+000043e0: 203d 207b 6d61 736b 5f6b 6a79 2e6d 6561   = {mask_kjy.mea
+000043f0: 6e28 297d 2729 0a20 2020 2020 2020 2020  n()}').         
+00004400: 2020 2070 7269 6e74 2866 275b 2b5d 207a     print(f'[+] z
+00004410: 6474 2020 3d20 7b6d 6173 6b5f 7a64 742e  dt  = {mask_zdt.
+00004420: 7375 6d28 297d 202f 207b 6c65 6e28 6d61  sum()} / {len(ma
+00004430: 736b 5f7a 6474 297d 203d 207b 6d61 736b  sk_zdt)} = {mask
+00004440: 5f7a 6474 2e6d 6561 6e28 297d 2729 0a20  _zdt.mean()}'). 
+00004450: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+00004460: 2866 275b 2b5d 206d 6173 6b20 3d20 7b6d  (f'[+] mask = {m
+00004470: 6173 6b5f 6d61 736b 2e73 756d 2829 7d20  ask_mask.sum()} 
+00004480: 2f20 7b6c 656e 286d 6173 6b5f 6d61 736b  / {len(mask_mask
+00004490: 297d 203d 207b 6d61 736b 5f6d 6173 6b2e  )} = {mask_mask.
+000044a0: 6d65 616e 2829 7d27 290a 2020 2020 2020  mean()}').      
+000044b0: 2020 0a20 2020 2020 2020 2023 2066 6f72    .        # for
+000044c0: 2074 7261 696e 2076 616c 6964 2020 7465   train valid  te
+000044d0: 7374 0a20 2020 2020 2020 2069 6620 2768  st.        if 'h
+000044e0: 6973 7427 206e 6f74 2069 6e20 6461 7465  ist' not in date
+000044f0: 5f64 6963 742e 6b65 7973 2829 3a0a 2020  _dict.keys():.  
+00004500: 2020 2020 2020 2020 2020 6966 2020 2027            if   '
+00004510: 7472 6169 6e27 2069 6e20 6461 7465 5f64  train' in date_d
+00004520: 6963 742e 6b65 7973 2829 3a20 6461 7465  ict.keys(): date
+00004530: 5f64 6963 745b 2768 6973 7427 5d20 3d20  _dict['hist'] = 
+00004540: 6461 7465 5f64 6963 745b 2774 7261 696e  date_dict['train
+00004550: 275d 0a20 2020 2020 2020 2020 2020 2065  '].            e
+00004560: 6c69 6620 276c 6f6f 6b27 2069 6e20 6461  lif 'look' in da
+00004570: 7465 5f64 6963 742e 6b65 7973 2829 3a20  te_dict.keys(): 
+00004580: 6461 7465 5f64 6963 745b 2768 6973 7427  date_dict['hist'
+00004590: 5d20 3d20 6461 7465 5f64 6963 745b 276c  ] = date_dict['l
+000045a0: 6f6f 6b27 5d0a 2020 2020 2020 2020 2020  ook'].          
+000045b0: 2020 656c 6966 2027 616c 6c27 2069 6e20    elif 'all' in 
+000045c0: 6461 7465 5f64 6963 742e 6b65 7973 2829  date_dict.keys()
+000045d0: 3a20 6461 7465 5f64 6963 745b 2768 6973  : date_dict['his
+000045e0: 7427 5d20 3d20 6461 7465 5f64 6963 745b  t'] = date_dict[
+000045f0: 2761 6c6c 275d 0a20 2020 2020 2020 2020  'all'].         
+00004600: 2020 2065 6c73 653a 2072 6169 7365 204e     else: raise N
+00004610: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
+00004620: 6f72 2866 2764 6174 655f 6469 6374 203d  or(f'date_dict =
+00004630: 207b 6461 7465 5f64 6963 747d 2c20 6e65   {date_dict}, ne
+00004640: 6564 2068 6973 7427 290a 2020 2020 2020  ed hist').      
+00004650: 2020 6966 2076 6572 626f 7365 3a20 7072    if verbose: pr
+00004660: 696e 7428 6627 5b2b 5d20 7061 6464 696e  int(f'[+] paddin
+00004670: 6720 3d20 7b70 6164 6469 6e67 7d2c 2063  g = {padding}, c
+00004680: 6f6c 5f6c 6162 656c 5f66 726f 6d20 3d20  ol_label_from = 
+00004690: 7b63 6f6c 5f6c 6162 656c 5f66 726f 6d7d  {col_label_from}
+000046a0: 2729 0a20 2020 2020 2020 2078 203d 2064  ').        x = d
+000046b0: 6d2e 6466 5f64 6963 745b 2754 3027 5d5b  m.df_dict['T0'][
+000046c0: 636f 6c5f 7469 645d 2e74 6f5f 6e75 6d70  col_tid].to_nump
+000046d0: 7928 290a 2020 2020 2020 2020 666f 7220  y().        for 
+000046e0: 6b65 7920 696e 2064 6174 655f 6469 6374  key in date_dict
+000046f0: 2e6b 6579 7328 293a 0a20 2020 2020 2020  .keys():.       
+00004700: 2020 2020 2064 6174 655f 6265 6769 6e2c       date_begin,
+00004710: 2064 6174 655f 656e 6420 3d20 6461 7465   date_end = date
+00004720: 5f64 6963 745b 6b65 795d 0a20 2020 2020  _dict[key].     
+00004730: 2020 2020 2020 2069 6620 6b65 7920 696e         if key in
+00004740: 205b 2774 7261 696e 272c 2027 6869 7374   ['train', 'hist
+00004750: 275d 3a20 2320 e59c a8e5 8e9f e69c 8964  ']: # .........d
+00004760: 6174 655f 656e 64e7 9a84 e59f bae7 a180  ate_end.........
+00004770: e4b8 8a2c 20e5 868d e58e bbe6 8e89 7061  ..., .........pa
+00004780: 6464 696e 67e5 a4a9 0a20 2020 2020 2020  dding....       
+00004790: 2020 2020 2020 2020 2078 5f75 6e69 7175           x_uniqu
+000047a0: 6520 3d20 6e70 2e75 6e69 7175 6528 7829  e = np.unique(x)
+000047b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000047c0: 2064 6174 655f 656e 6420 3d20 6e70 2e73   date_end = np.s
+000047d0: 6f72 7428 785f 756e 6971 7565 5b78 5f75  ort(x_unique[x_u
+000047e0: 6e69 7175 6520 3c3d 2064 6174 655f 656e  nique <= date_en
+000047f0: 645d 295b 2d28 3120 2b20 7061 6464 696e  d])[-(1 + paddin
+00004800: 6729 5d0a 2020 2020 2020 2020 2020 2020  g)].            
+00004810: 0a20 2020 2020 2020 2020 2020 206d 6173  .            mas
+00004820: 6b20 3d20 2028 7820 3e3d 2064 6174 655f  k =  (x >= date_
+00004830: 6265 6769 6e29 2026 2028 7820 3c3d 2064  begin) & (x <= d
+00004840: 6174 655f 656e 6429 0a20 2020 2020 2020  ate_end).       
+00004850: 2020 2020 2069 6620 6b65 7920 213d 2027       if key != '
+00004860: 7465 7374 273a 0a20 2020 2020 2020 2020  test':.         
+00004870: 2020 2020 2020 206d 6173 6b20 263d 206d         mask &= m
+00004880: 6173 6b5f 6d61 736b 2e61 7374 7970 6528  ask_mask.astype(
+00004890: 626f 6f6c 290a 2020 2020 2020 2020 2020  bool).          
+000048a0: 2020 646d 2e73 6574 5f6d 6173 6b28 6d61    dm.set_mask(ma
+000048b0: 736b 2c20 6d61 736b 5f6e 616d 6520 3d20  sk, mask_name = 
+000048c0: 6b65 7929 0a20 2020 2020 2020 2020 2020  key).           
+000048d0: 2069 6620 7665 7262 6f73 653a 0a20 2020   if verbose:.   
+000048e0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+000048f0: 6c65 6e28 785b 6d61 736b 5d29 203e 2030  len(x[mask]) > 0
+00004900: 3a20 7072 696e 7428 6627 5b2b 5d20 6d61  : print(f'[+] ma
+00004910: 736b 5f6e 616d 6520 3d20 7b6b 6579 3a3c  sk_name = {key:<
+00004920: 3131 7d7c 207b 785b 6d61 736b 5d2e 6d69  11}| {x[mask].mi
+00004930: 6e28 297d 202d 3e20 7b78 5b6d 6173 6b5d  n()} -> {x[mask]
+00004940: 2e6d 6178 2829 7d20 3d20 7b6d 6173 6b2e  .max()} = {mask.
+00004950: 7375 6d28 297d 2729 0a20 2020 2020 2020  sum()}').       
+00004960: 2020 2020 2020 2020 2065 6c73 653a 2070           else: p
+00004970: 7269 6e74 2866 275b 2b5d 206d 6173 6b5f  rint(f'[+] mask_
+00004980: 6e61 6d65 203d 207b 6b65 793a 3c31 317d  name = {key:<11}
+00004990: 7c20 6c65 6e20 3d20 3027 290a 2020 2020  | len = 0').    
+000049a0: 2020 2020 0a20 2020 2020 2020 2023 2073      .        # s
+000049b0: 6869 6674 5f31 0a20 2020 2020 2020 2069  hift_1.        i
+000049c0: 6620 7665 7262 6f73 653a 2070 7269 6e74  f verbose: print
+000049d0: 2827 5b69 6e69 745d 203c 2d2d 2d2d 2d2d  ('[init] <------
+000049e0: 2d2d 2d2d 2073 6869 6674 5f69 202d 2d2d  ---- shift_i ---
+000049f0: 2d2d 2d2d 2d2d 2d3e 2027 290a 2020 2020  -------> ').    
+00004a00: 2020 2020 7368 6966 745f 6920 3d20 6f74      shift_i = ot
+00004a10: 6865 725f 696e 666f 2e67 6574 2827 7368  her_info.get('sh
+00004a20: 6966 745f 6927 2c20 3129 0a20 2020 2020  ift_i', 1).     
+00004a30: 2020 2069 6620 7665 7262 6f73 653a 2070     if verbose: p
+00004a40: 7269 6e74 2866 275b 2b5d 2073 6869 6674  rint(f'[+] shift
+00004a50: 5f69 203d 207b 7368 6966 745f 697d 2729  _i = {shift_i}')
+00004a60: 0a20 2020 2020 2020 2063 6f6c 735f 7368  .        cols_sh
+00004a70: 6966 745f 315f 6e6f 7420 3d20 5b63 6f6c  ift_1_not = [col
+00004a80: 5f69 642c 2063 6f6c 5f74 6964 2c20 636f  _id, col_tid, co
+00004a90: 6c5f 6c61 6265 6c5d 202b 2063 6f6c 735f  l_label] + cols_
+00004aa0: 7469 6420 2b20 636f 6c73 5f6c 6162 656c  tid + cols_label
+00004ab0: 202b 2063 6f6c 735f 6d61 736b 202b 205b   + cols_mask + [
+00004ac0: 6f74 6865 725f 696e 666f 2e67 6574 2827  other_info.get('
+00004ad0: 636f 6c5f 6461 7465 272c 204e 6f6e 6529  col_date', None)
+00004ae0: 5d0a 2020 2020 2020 2020 636f 6c73 5f73  ].        cols_s
+00004af0: 6869 6674 5f31 5f6e 6f74 202b 3d20 6f74  hift_1_not += ot
+00004b00: 6865 725f 696e 666f 2e67 6574 2827 636f  her_info.get('co
+00004b10: 6c73 5f73 6869 6674 5f31 5f6e 6f74 272c  ls_shift_1_not',
+00004b20: 205b 5d29 0a20 2020 2020 2020 206f 7468   []).        oth
+00004b30: 6572 5f69 6e66 6f5b 2763 6f6c 735f 7368  er_info['cols_sh
+00004b40: 6966 745f 315f 6e6f 7427 5d20 3d20 636f  ift_1_not'] = co
+00004b50: 6c73 5f73 6869 6674 5f31 5f6e 6f74 0a20  ls_shift_1_not. 
+00004b60: 2020 2020 2020 2069 6620 7665 7262 6f73         if verbos
+00004b70: 653a 2070 7269 6e74 2866 275b 2b5d 2063  e: print(f'[+] c
+00004b80: 6f6c 735f 7368 6966 745f 315f 6e6f 7420  ols_shift_1_not 
+00004b90: 3d20 7b63 6f6c 735f 7368 6966 745f 315f  = {cols_shift_1_
+00004ba0: 6e6f 747d 2729 0a20 2020 2020 2020 2063  not}').        c
+00004bb0: 6f6c 735f 7368 6966 745f 3120 3d20 5b63  ols_shift_1 = [c
+00004bc0: 6f6c 2066 6f72 2063 6f6c 2069 6e20 646d  ol for col in dm
+00004bd0: 2e68 6561 6428 292e 636f 6c75 6d6e 7320  .head().columns 
+00004be0: 6966 2063 6f6c 206e 6f74 2069 6e20 636f  if col not in co
+00004bf0: 6c73 5f73 6869 6674 5f31 5f6e 6f74 5d0a  ls_shift_1_not].
+00004c00: 2020 2020 2020 2020 6966 2073 6869 6674          if shift
+00004c10: 5f69 2021 3d20 303a 2064 6d2e 6665 5f67  _i != 0: dm.fe_g
+00004c20: 6f28 5b66 277b 636f 6c7d 203d 2072 6f6c  o([f'{col} = rol
+00004c30: 6c28 7368 6966 742c 207b 636f 6c5f 6964  l(shift, {col_id
+00004c40: 7d2c 207b 636f 6c7d 2c20 7b63 6f6c 5f74  }, {col}, {col_t
+00004c50: 6964 7d2c 207b 7368 6966 745f 697d 2927  id}, {shift_i})'
+00004c60: 2066 6f72 2063 6f6c 2069 6e20 636f 6c73   for col in cols
+00004c70: 5f73 6869 6674 5f31 5d2c 2076 6572 626f  _shift_1], verbo
+00004c80: 7365 3d76 6572 626f 7365 290a 2020 2020  se=verbose).    
+00004c90: 2020 2020 2320 646d 2e66 655f 676f 285b      # dm.fe_go([
+00004ca0: 6627 726f 6c6c 2873 6869 6674 2c20 7b63  f'roll(shift, {c
+00004cb0: 6f6c 5f69 647d 2c20 7b63 6f6c 7d2c 207b  ol_id}, {col}, {
+00004cc0: 636f 6c5f 7469 647d 2c20 3129 2720 666f  col_tid}, 1)' fo
+00004cd0: 7220 636f 6c20 696e 2063 6f6c 735f 7368  r col in cols_sh
+00004ce0: 6966 745f 315d 2c20 6b65 6570 5f6e 616d  ift_1], keep_nam
+00004cf0: 6520 3d20 3229 0a20 2020 2020 2020 2072  e = 2).        r
+00004d00: 6574 7572 6e20 646d 0a7a 065c 275c 275c  eturn dm.z.\'\'\
+00004d10: 277a 0327 2727 da01 7729 07da 026f 73da  'z.'''..w)...os.
+00004d20: 0470 6174 68da 0764 6972 6e61 6d65 da08  .path..dirname..
+00004d30: 5f5f 6669 6c65 5f5f da07 7265 706c 6163  __file__..replac
+00004d40: 65da 046f 7065 6eda 0577 7269 7465 2904  e..open..write).
+00004d50: da06 6f75 7470 7574 5a0b 7061 7468 5f6f  ..outputZ.path_o
+00004d60: 7574 7075 74da 0173 da01 66a9 0072 0e00  utput..s..f..r..
+00004d70: 0000 fa4b 6275 696c 642f 6264 6973 742e  ...Kbuild/bdist.
+00004d80: 6d61 636f 7378 2d31 302e 392d 7838 365f  macosx-10.9-x86_
+00004d90: 3634 2f65 6767 2f72 756e 6e69 6e67 7a2f  64/egg/runningz/
+00004da0: 6665 2f70 7265 7061 7265 5f64 6174 612f  fe/prepare_data/
+00004db0: 6261 7365 5f64 6174 615f 7079 2e70 79da  base_data_py.py.
+00004dc0: 0372 756e 0400 0000 7310 0000 0000 0114  .run....s.......
+00004dd0: 0104 7f00 7f00 7f00 0b0c 010c 0172 1000  .............r..
+00004de0: 0000 da08 5f5f 6d61 696e 5f5f 7a08 2d2d  ....__main__z.--
+00004df0: 6f75 7470 7574 5429 02da 0474 7970 65da  outputT)...type.
+00004e00: 0872 6571 7569 7265 6429 0c72 0400 0000  .required).r....
+00004e10: da03 7379 7372 1000 0000 da08 5f5f 6e61  ..sysr......__na
+00004e20: 6d65 5f5f da08 6172 6770 6172 7365 da0e  me__..argparse..
+00004e30: 4172 6775 6d65 6e74 5061 7273 6572 da06  ArgumentParser..
+00004e40: 7061 7273 6572 da0c 6164 645f 6172 6775  parser..add_argu
+00004e50: 6d65 6e74 da03 7374 72da 0a70 6172 7365  ment..str..parse
+00004e60: 5f61 7267 73da 0461 7267 7372 0b00 0000  _args..argsr....
+00004e70: 720e 0000 0072 0e00 0000 720e 0000 0072  r....r....r....r
+00004e80: 0f00 0000 da08 3c6d 6f64 756c 653e 0200  ......<module>..
+00004e90: 0000 7316 0000 0008 0108 0108 7f00 7f00  ..s.............
+00004ea0: 7f00 1108 0108 0108 0110 0108 01         .............
```

## runningz/fe/prepare_data/basic_data.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Sun Mar 17 15:34:29 2024 UTC, .py size: 1981 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,94 +1,97 @@
-00000000: 610d 0d0a 0000 0000 850d f765 bd07 0000  a..........e....
+00000000: 610d 0d0a 0000 0000 f239 4066 0f08 0000  a........9@f....
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0004 0000 0040 0000 0073 5a00 0000 6400  .....@...sZ...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a02 6400  d.l.Z.d.d.l.Z.d.
 00000040: 6401 6c03 5a04 6402 6403 6c05 6d06 5a06  d.l.Z.d.d.l.m.Z.
 00000050: 0100 6404 6405 6c07 6d08 5a08 0100 6402  ..d.d.l.m.Z...d.
-00000060: 6406 6c09 6d0a 5a0a 0100 640d 6409 640a  d.l.m.Z...d.d.d.
-00000070: 8401 5a0b 4700 640b 640c 8400 640c 6508  ..Z.G.d.d...d.e.
-00000080: 8303 5a0c 6401 5300 290e e900 0000 004e  ..Z.d.S.)......N
+00000060: 6406 6c09 6d0a 5a0a 0100 640e 640a 640b  d.l.m.Z...d.d.d.
+00000070: 8401 5a0b 4700 640c 640d 8400 640d 6508  ..Z.G.d.d...d.e.
+00000080: 8303 5a0c 6401 5300 290f e900 0000 004e  ..Z.d.S.)......N
 00000090: e903 0000 0029 01da 1372 6561 645f 6373  .....)...read_cs
 000000a0: 765f 6c69 7374 5f6e 6a6f 6273 e901 0000  v_list_njobs....
 000000b0: 0029 01da 0842 6173 6544 6174 6129 01da  .)...BaseData)..
 000000c0: 0543 4f4e 5354 da08 3030 3030 3030 3030  .CONST..00000000
-000000d0: da08 3939 3939 3939 3939 6304 0000 0000  ..99999999c.....
-000000e0: 0000 0000 0000 000d 0000 000c 0000 0043  ...............C
-000000f0: 0000 0073 1001 0000 7400 7c01 8301 7400  ...s....t.|...t.
-00000100: 7c02 8301 0200 7d01 7d02 7401 7402 a003  |.....}.}.t.t...
-00000110: 7c00 a101 8301 7d04 6700 7d05 6700 7d06  |.....}.g.}.g.}.
-00000120: 7c04 4400 5d74 7d07 7401 7402 a003 7c00  |.D.]t}.t.t...|.
-00000130: 9b00 6401 7c07 9b00 6401 9d04 a101 8301  ..d.|...d.......
-00000140: 7d08 7c08 4400 5d50 7d09 7c09 6400 6402  }.|.D.]P}.|.d.d.
-00000150: 8502 1900 7c01 6b05 724e 7c09 6400 6402  ....|.k.rN|.d.d.
-00000160: 8502 1900 7c02 6b01 724e 7c05 a004 7c00  ....|.k.rN|...|.
-00000170: 9b00 6401 7c07 9b00 6401 7c09 9b00 9d05  ..d.|...d.|.....
-00000180: a101 0100 7c06 a004 7c09 6400 6402 8502  ....|...|.d.d...
-00000190: 1900 a101 0100 714e 712c 6403 6404 6c05  ......qNq,d.d.l.
-000001a0: 6d06 7d0a 0100 7c0a 6405 7407 7c06 8301  m.}...|.d.t.|...
-000001b0: 9b00 9d02 8301 0100 6406 6407 6408 6408  ........d.d.d.d.
-000001c0: 6408 6408 6408 6408 6408 6408 6408 6409  d.d.d.d.d.d.d.d.
-000001d0: 9c0b 7d0b 7408 7c05 6400 7c0b 7c03 640a  ..}.t.|.d.|.|.d.
-000001e0: 8d04 7d0c 7c0c 640b 0500 1900 640c 3900  ..}.|.d.....d.9.
-000001f0: 0300 3c00 7c0c 640d 0500 1900 640e 3900  ..<.|.d.....d.9.
-00000200: 0300 3c00 7c0c 5300 290f 4efa 012f e9fc  ..<.|.S.).N../..
-00000210: ffff ff72 0200 0000 2901 da08 6d79 5f70  ...r....)...my_p
-00000220: 7269 6e74 7a0c 5b2b 5d20 6e64 6179 7320  rintz.[+] ndays 
-00000230: 3d20 da06 6f62 6a65 6374 5a05 696e 7433  = ..objectZ.int3
-00000240: 325a 0766 6c6f 6174 3332 290b 5a07 7473  2Z.float32).Z.ts
-00000250: 5f63 6f64 655a 0a74 7261 6465 5f64 6174  _codeZ.trade_dat
-00000260: 65da 046f 7065 6eda 0468 6967 68da 036c  e..open..high..l
-00000270: 6f77 da05 636c 6f73 655a 0970 7265 5f63  ow..closeZ.pre_c
-00000280: 6c6f 7365 5a06 6368 616e 6765 5a07 7063  loseZ.changeZ.pc
-00000290: 745f 6368 67da 0376 6f6c da06 616d 6f75  t_chg..vol..amou
-000002a0: 6e74 2903 5a07 7573 6563 6f6c 73da 0564  nt).Z.usecols..d
-000002b0: 7479 7065 da06 6e5f 6a6f 6273 7211 0000  type..n_jobsr...
-000002c0: 00e9 6400 0000 7212 0000 0069 e803 0000  ..d...r....i....
-000002d0: 2909 da03 7374 72da 0673 6f72 7465 64da  )...str..sorted.
-000002e0: 026f 73da 076c 6973 7464 6972 da06 6170  .os..listdir..ap
-000002f0: 7065 6e64 5a09 7574 696c 2e75 7469 6c72  pendZ.util.utilr
-00000300: 0b00 0000 da03 6c65 6e72 0300 0000 290d  ......lenr....).
-00000310: da0a 7061 7468 5f69 6e70 7574 da0a 6461  ..path_input..da
-00000320: 7465 5f62 6567 696e da08 6461 7465 5f65  te_begin..date_e
-00000330: 6e64 7214 0000 005a 0979 6561 725f 6c69  ndr....Z.year_li
-00000340: 7374 da09 7061 7468 5f6c 6973 745a 0964  st..path_listZ.d
-00000350: 6174 655f 6c69 7374 da04 7965 6172 5a09  ate_list..yearZ.
-00000360: 6669 6c65 5f6c 6973 74da 0466 696c 65da  file_list..file.
-00000370: 0570 7269 6e74 7213 0000 00da 0264 66a9  .printr......df.
-00000380: 0072 2400 0000 fa49 6275 696c 642f 6264  .r$....Ibuild/bd
-00000390: 6973 742e 6d61 636f 7378 2d31 302e 392d  ist.macosx-10.9-
-000003a0: 7838 365f 3634 2f65 6767 2f72 756e 6e69  x86_64/egg/runni
-000003b0: 6e67 7a2f 6665 2f70 7265 7061 7265 5f64  ngz/fe/prepare_d
-000003c0: 6174 612f 6261 7369 635f 6461 7461 2e70  ata/basic_data.p
-000003d0: 79da 0a72 6561 645f 6261 7369 6308 0000  y..read_basic...
-000003e0: 0073 3800 0000 0001 1201 0e01 0401 0401  .s8.............
-000003f0: 0801 1a01 0801 2001 1a01 1602 0c01 1202  ...... .........
-00000400: 0201 0201 0201 0201 0201 0201 0201 0201  ................
-00000410: 0201 0201 02f5 060d 1002 1001 1001 7226  ..............r&
-00000420: 0000 0063 0000 0000 0000 0000 0000 0000  ...c............
-00000430: 0000 0000 0200 0000 4000 0000 7314 0000  ........@...s...
-00000440: 0065 005a 0164 005a 0264 0164 0284 005a  .e.Z.d.Z.d.d...Z
-00000450: 0364 0353 0029 04da 0942 6173 6963 4461  .d.S.)...BasicDa
-00000460: 7461 6305 0000 0000 0000 0000 0000 0005  tac.............
-00000470: 0000 0005 0000 0043 0000 0073 0e00 0000  .......C...s....
-00000480: 7400 7c01 7c02 7c03 7c04 8304 5300 2901  t.|.|.|.|...S.).
-00000490: 4e29 0172 2600 0000 2905 da04 7365 6c66  N).r&...)...self
-000004a0: 721c 0000 0072 1d00 0000 721e 0000 0072  r....r....r....r
-000004b0: 1400 0000 7224 0000 0072 2400 0000 7225  ....r$...r$...r%
-000004c0: 0000 00da 0667 6574 5f64 662a 0000 0073  .....get_df*...s
-000004d0: 0200 0000 0001 7a10 4261 7369 6344 6174  ......z.BasicDat
-000004e0: 612e 6765 745f 6466 4e29 04da 085f 5f6e  a.get_dfN)...__n
-000004f0: 616d 655f 5fda 0a5f 5f6d 6f64 756c 655f  ame__..__module_
-00000500: 5fda 0c5f 5f71 7561 6c6e 616d 655f 5f72  _..__qualname__r
-00000510: 2900 0000 7224 0000 0072 2400 0000 7224  )...r$...r$...r$
-00000520: 0000 0072 2500 0000 7227 0000 0029 0000  ...r%...r'...)..
-00000530: 0073 0200 0000 0801 7227 0000 0029 0372  .s......r'...).r
-00000540: 0700 0000 7208 0000 0072 0400 0000 290d  ....r....r....).
-00000550: 7218 0000 00da 056e 756d 7079 da02 6e70  r......numpy..np
-00000560: da06 7061 6e64 6173 da02 7064 5a08 7574  ..pandas..pdZ.ut
-00000570: 696c 2e63 7376 7203 0000 005a 0962 6173  il.csvr....Z.bas
-00000580: 655f 6461 7461 7205 0000 005a 0a75 7469  e_datar....Z.uti
-00000590: 6c2e 636f 6e73 7472 0600 0000 7226 0000  l.constr....r&..
-000005a0: 0072 2700 0000 7224 0000 0072 2400 0000  .r'...r$...r$...
-000005b0: 7224 0000 0072 2500 0000 da08 3c6d 6f64  r$...r%.....<mod
-000005c0: 756c 653e 0100 0000 730e 0000 0008 0108  ule>....s.......
-000005d0: 0108 010c 010c 010c 020a 21              ..........!
+000000d0: da08 3939 3939 3939 3939 5463 0500 0000  ..99999999Tc....
+000000e0: 0000 0000 0000 0000 0e00 0000 0c00 0000  ................
+000000f0: 4300 0000 7316 0100 0074 007c 0183 0174  C...s....t.|...t
+00000100: 007c 0283 0102 007d 017d 0274 0174 02a0  .|.....}.}.t.t..
+00000110: 037c 00a1 0183 017d 0567 007d 0667 007d  .|.....}.g.}.g.}
+00000120: 077c 0544 005d 747d 0874 0174 02a0 037c  .|.D.]t}.t.t...|
+00000130: 009b 0064 017c 089b 0064 019d 04a1 0183  ...d.|...d......
+00000140: 017d 097c 0944 005d 507d 0a7c 0a64 0064  .}.|.D.]P}.|.d.d
+00000150: 0285 0219 007c 016b 0572 4e7c 0a64 0064  .....|.k.rN|.d.d
+00000160: 0285 0219 007c 026b 0172 4e7c 06a0 047c  .....|.k.rN|...|
+00000170: 009b 0064 017c 089b 0064 017c 0a9b 009d  ...d.|...d.|....
+00000180: 05a1 0101 007c 07a0 047c 0a64 0064 0285  .....|...|.d.d..
+00000190: 0219 00a1 0101 0071 4e71 2c64 0364 046c  .......qNq,d.d.l
+000001a0: 056d 067d 0b01 007c 0472 c47c 0b64 0574  .m.}...|.r.|.d.t
+000001b0: 077c 0783 019b 009d 0283 0101 0064 0664  .|...........d.d
+000001c0: 0764 0864 0864 0864 0864 0864 0864 0864  .d.d.d.d.d.d.d.d
+000001d0: 0864 0864 099c 0b7d 0c74 087c 0664 007c  .d.d...}.t.|.d.|
+000001e0: 0c7c 037c 0464 0a8d 057d 0d7c 0d64 0b05  .|.|.d...}.|.d..
+000001f0: 0019 0064 0c39 0003 003c 007c 0d64 0d05  ...d.9...<.|.d..
+00000200: 0019 0064 0e39 0003 003c 007c 0d53 0029  ...d.9...<.|.S.)
+00000210: 0f4e fa01 2fe9 fcff ffff 7202 0000 0029  .N../.....r....)
+00000220: 01da 086d 795f 7072 696e 747a 0c5b 2b5d  ...my_printz.[+]
+00000230: 206e 6461 7973 203d 20da 066f 626a 6563   ndays = ..objec
+00000240: 745a 0569 6e74 3332 5a07 666c 6f61 7433  tZ.int32Z.float3
+00000250: 3229 0b5a 0774 735f 636f 6465 5a0a 7472  2).Z.ts_codeZ.tr
+00000260: 6164 655f 6461 7465 da04 6f70 656e da04  ade_date..open..
+00000270: 6869 6768 da03 6c6f 77da 0563 6c6f 7365  high..low..close
+00000280: 5a09 7072 655f 636c 6f73 655a 0663 6861  Z.pre_closeZ.cha
+00000290: 6e67 655a 0770 6374 5f63 6867 da03 766f  ngeZ.pct_chg..vo
+000002a0: 6cda 0661 6d6f 756e 7429 045a 0775 7365  l..amount).Z.use
+000002b0: 636f 6c73 da05 6474 7970 65da 066e 5f6a  cols..dtype..n_j
+000002c0: 6f62 73da 0776 6572 626f 7365 7211 0000  obs..verboser...
+000002d0: 00e9 6400 0000 7212 0000 0069 e803 0000  ..d...r....i....
+000002e0: 2909 da03 7374 72da 0673 6f72 7465 64da  )...str..sorted.
+000002f0: 026f 73da 076c 6973 7464 6972 da06 6170  .os..listdir..ap
+00000300: 7065 6e64 5a09 7574 696c 2e75 7469 6c72  pendZ.util.utilr
+00000310: 0b00 0000 da03 6c65 6e72 0300 0000 290e  ......lenr....).
+00000320: da0a 7061 7468 5f69 6e70 7574 da0a 6461  ..path_input..da
+00000330: 7465 5f62 6567 696e da08 6461 7465 5f65  te_begin..date_e
+00000340: 6e64 7214 0000 0072 1500 0000 5a09 7965  ndr....r....Z.ye
+00000350: 6172 5f6c 6973 74da 0970 6174 685f 6c69  ar_list..path_li
+00000360: 7374 5a09 6461 7465 5f6c 6973 74da 0479  stZ.date_list..y
+00000370: 6561 725a 0966 696c 655f 6c69 7374 da04  earZ.file_list..
+00000380: 6669 6c65 da05 7072 696e 7472 1300 0000  file..printr....
+00000390: da02 6466 a900 7225 0000 00fa 4962 7569  ..df..r%....Ibui
+000003a0: 6c64 2f62 6469 7374 2e6d 6163 6f73 782d  ld/bdist.macosx-
+000003b0: 3130 2e39 2d78 3836 5f36 342f 6567 672f  10.9-x86_64/egg/
+000003c0: 7275 6e6e 696e 677a 2f66 652f 7072 6570  runningz/fe/prep
+000003d0: 6172 655f 6461 7461 2f62 6173 6963 5f64  are_data/basic_d
+000003e0: 6174 612e 7079 da0a 7265 6164 5f62 6173  ata.py..read_bas
+000003f0: 6963 0800 0000 7338 0000 0000 0112 010e  ic....s8........
+00000400: 0104 0104 0108 011a 0108 0120 011a 0116  ........... ....
+00000410: 020c 0116 0202 0102 0102 0102 0102 0102  ................
+00000420: 0102 0102 0102 0102 0102 f506 0d12 0210  ................
+00000430: 0110 0172 2700 0000 6300 0000 0000 0000  ...r'...c.......
+00000440: 0000 0000 0000 0000 0003 0000 0040 0000  .............@..
+00000450: 0073 1600 0000 6500 5a01 6400 5a02 6405  .s....e.Z.d.Z.d.
+00000460: 6402 6403 8401 5a03 6404 5300 2906 da09  d.d...Z.d.S.)...
+00000470: 4261 7369 6344 6174 6154 6306 0000 0000  BasicDataTc.....
+00000480: 0000 0000 0000 0006 0000 0007 0000 0043  ...............C
+00000490: 0000 0073 1200 0000 7400 7c01 7c02 7c03  ...s....t.|.|.|.
+000004a0: 7c04 7c05 6401 8d05 5300 2902 4e29 0172  |.|.d...S.).N).r
+000004b0: 1500 0000 2901 7227 0000 0029 06da 0473  ....).r'...)...s
+000004c0: 656c 6672 1d00 0000 721e 0000 0072 1f00  elfr....r....r..
+000004d0: 0000 7214 0000 0072 1500 0000 7225 0000  ..r....r....r%..
+000004e0: 0072 2500 0000 7226 0000 00da 0667 6574  .r%...r&.....get
+000004f0: 5f64 662a 0000 0073 0200 0000 0001 7a10  _df*...s......z.
+00000500: 4261 7369 6344 6174 612e 6765 745f 6466  BasicData.get_df
+00000510: 4e29 0154 2904 da08 5f5f 6e61 6d65 5f5f  N).T)...__name__
+00000520: da0a 5f5f 6d6f 6475 6c65 5f5f da0c 5f5f  ..__module__..__
+00000530: 7175 616c 6e61 6d65 5f5f 722a 0000 0072  qualname__r*...r
+00000540: 2500 0000 7225 0000 0072 2500 0000 7226  %...r%...r%...r&
+00000550: 0000 0072 2800 0000 2900 0000 7302 0000  ...r(...)...s...
+00000560: 0008 0172 2800 0000 2904 7207 0000 0072  ...r(...).r....r
+00000570: 0800 0000 7204 0000 0054 290d 7219 0000  ....r....T).r...
+00000580: 00da 056e 756d 7079 da02 6e70 da06 7061  ...numpy..np..pa
+00000590: 6e64 6173 da02 7064 5a08 7574 696c 2e63  ndas..pdZ.util.c
+000005a0: 7376 7203 0000 005a 0962 6173 655f 6461  svr....Z.base_da
+000005b0: 7461 7205 0000 005a 0a75 7469 6c2e 636f  tar....Z.util.co
+000005c0: 6e73 7472 0600 0000 7227 0000 0072 2800  nstr....r'...r(.
+000005d0: 0000 7225 0000 0072 2500 0000 7225 0000  ..r%...r%...r%..
+000005e0: 0072 2600 0000 da08 3c6d 6f64 756c 653e  .r&.....<module>
+000005f0: 0100 0000 730e 0000 0008 0108 0108 010c  ....s...........
+00000600: 010c 010c 020a 21                        ......!
```

## runningz/fe/prepare_data/basic_data_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Thu May  9 16:27:50 2024 UTC, .py size: 2402 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 86f9 3c66 6209 0000  a.........<fb...
+00000000: 610d 0d0a 0000 0000 8512 4e66 b409 0000  a.........Nf....
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
@@ -10,15 +10,15 @@
 00000090: 0000 0000 0000 0000 0004 0000 0008 0000  ................
 000000a0: 0043 0000 0073 5c00 0000 7400 6a01 a002  .C...s\...t.j...
 000000b0: 7403 a101 6401 1700 7c00 1700 7d01 6402  t...d...|...}.d.
 000000c0: 7d02 7c02 a004 6403 6404 a102 7d02 7405  }.|...d.d...}.t.
 000000d0: 7c01 6405 8302 8f1a 7d03 7c03 a006 7c02  |.d.....}.|...|.
 000000e0: a101 0100 5700 6400 0400 0400 8303 0100  ....W.d.........
 000000f0: 6e10 3100 734e 3000 0100 0100 0100 5900  n.1.sN0.......Y.
-00000100: 0100 6400 5300 2906 4efa 012f 61bd 0700  ..d.S.).N../a...
+00000100: 0100 6400 5300 2906 4efa 012f 610f 0800  ..d.S.).N../a...
 00000110: 0069 6d70 6f72 7420 6f73 0a69 6d70 6f72  .import os.impor
 00000120: 7420 6e75 6d70 7920 6173 206e 700a 696d  t numpy as np.im
 00000130: 706f 7274 2070 616e 6461 7320 6173 2070  port pandas as p
 00000140: 640a 6672 6f6d 202e 2e2e 7574 696c 2e63  d.from ...util.c
 00000150: 7376 2069 6d70 6f72 7420 7265 6164 5f63  sv import read_c
 00000160: 7376 5f6c 6973 745f 6e6a 6f62 730a 6672  sv_list_njobs.fr
 00000170: 6f6d 202e 6261 7365 5f64 6174 6120 696d  om .base_data im
@@ -26,142 +26,147 @@
 00000190: 6f6d 202e 2e2e 7574 696c 2e63 6f6e 7374  om ...util.const
 000001a0: 2069 6d70 6f72 7420 434f 4e53 540a 0a64   import CONST..d
 000001b0: 6566 2072 6561 645f 6261 7369 6328 7061  ef read_basic(pa
 000001c0: 7468 5f69 6e70 7574 2c20 6461 7465 5f62  th_input, date_b
 000001d0: 6567 696e 203d 2027 3030 3030 3030 3030  egin = '00000000
 000001e0: 272c 2064 6174 655f 656e 6420 3d20 2739  ', date_end = '9
 000001f0: 3939 3939 3939 3927 2c20 6e5f 6a6f 6273  9999999', n_jobs
-00000200: 203d 2031 293a 0a20 2020 2064 6174 655f   = 1):.    date_
-00000210: 6265 6769 6e2c 2064 6174 655f 656e 6420  begin, date_end 
-00000220: 3d20 7374 7228 6461 7465 5f62 6567 696e  = str(date_begin
-00000230: 292c 2073 7472 2864 6174 655f 656e 6429  ), str(date_end)
-00000240: 0a20 2020 2079 6561 725f 6c69 7374 203d  .    year_list =
-00000250: 2073 6f72 7465 6428 6f73 2e6c 6973 7464   sorted(os.listd
-00000260: 6972 2870 6174 685f 696e 7075 7429 290a  ir(path_input)).
-00000270: 2020 2020 7061 7468 5f6c 6973 7420 3d20      path_list = 
-00000280: 5b5d 0a20 2020 2064 6174 655f 6c69 7374  [].    date_list
-00000290: 203d 205b 5d0a 2020 2020 666f 7220 7965   = [].    for ye
-000002a0: 6172 2069 6e20 7965 6172 5f6c 6973 743a  ar in year_list:
-000002b0: 0a20 2020 2020 2020 2066 696c 655f 6c69  .        file_li
-000002c0: 7374 203d 2073 6f72 7465 6428 6f73 2e6c  st = sorted(os.l
-000002d0: 6973 7464 6972 2866 277b 7061 7468 5f69  istdir(f'{path_i
-000002e0: 6e70 7574 7d2f 7b79 6561 727d 2f27 2929  nput}/{year}/'))
-000002f0: 0a20 2020 2020 2020 2066 6f72 2066 696c  .        for fil
-00000300: 6520 696e 2066 696c 655f 6c69 7374 3a0a  e in file_list:.
-00000310: 2020 2020 2020 2020 2020 2020 6966 2066              if f
-00000320: 696c 655b 3a2d 345d 203e 3d20 6461 7465  ile[:-4] >= date
-00000330: 5f62 6567 696e 2061 6e64 2066 696c 655b  _begin and file[
-00000340: 3a2d 345d 203c 3d20 6461 7465 5f65 6e64  :-4] <= date_end
-00000350: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00000360: 2020 7061 7468 5f6c 6973 742e 6170 7065    path_list.appe
-00000370: 6e64 2866 277b 7061 7468 5f69 6e70 7574  nd(f'{path_input
-00000380: 7d2f 7b79 6561 727d 2f7b 6669 6c65 7d27  }/{year}/{file}'
-00000390: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-000003a0: 2020 6461 7465 5f6c 6973 742e 6170 7065    date_list.appe
-000003b0: 6e64 2866 696c 655b 3a2d 345d 290a 2020  nd(file[:-4]).  
-000003c0: 2020 0a20 2020 2066 726f 6d20 2e2e 2e75    .    from ...u
-000003d0: 7469 6c2e 7574 696c 2069 6d70 6f72 7420  til.util import 
-000003e0: 6d79 5f70 7269 6e74 2061 7320 7072 696e  my_print as prin
-000003f0: 740a 2020 2020 7072 696e 7428 6627 5b2b  t.    print(f'[+
-00000400: 5d20 6e64 6179 7320 3d20 7b6c 656e 2864  ] ndays = {len(d
-00000410: 6174 655f 6c69 7374 297d 2729 0a20 2020  ate_list)}').   
-00000420: 2064 7479 7065 203d 207b 0a20 2020 2020   dtype = {.     
-00000430: 2020 2027 7473 5f63 6f64 6527 3a20 276f     'ts_code': 'o
-00000440: 626a 6563 7427 2c0a 2020 2020 2020 2020  bject',.        
-00000450: 2774 7261 6465 5f64 6174 6527 3a20 2769  'trade_date': 'i
-00000460: 6e74 3332 272c 0a20 2020 2020 2020 2027  nt32',.        '
-00000470: 6f70 656e 273a 2027 666c 6f61 7433 3227  open': 'float32'
-00000480: 2c0a 2020 2020 2020 2020 2768 6967 6827  ,.        'high'
-00000490: 3a20 2766 6c6f 6174 3332 272c 0a20 2020  : 'float32',.   
-000004a0: 2020 2020 2027 6c6f 7727 3a20 2766 6c6f       'low': 'flo
-000004b0: 6174 3332 272c 0a20 2020 2020 2020 2027  at32',.        '
-000004c0: 636c 6f73 6527 3a20 2766 6c6f 6174 3332  close': 'float32
-000004d0: 272c 0a20 2020 2020 2020 2027 7072 655f  ',.        'pre_
-000004e0: 636c 6f73 6527 3a20 2766 6c6f 6174 3332  close': 'float32
-000004f0: 272c 0a20 2020 2020 2020 2027 6368 616e  ',.        'chan
-00000500: 6765 273a 2027 666c 6f61 7433 3227 2c0a  ge': 'float32',.
-00000510: 2020 2020 2020 2020 2770 6374 5f63 6867          'pct_chg
-00000520: 273a 2027 666c 6f61 7433 3227 2c0a 2020  ': 'float32',.  
-00000530: 2020 2020 2020 2776 6f6c 273a 2027 666c        'vol': 'fl
-00000540: 6f61 7433 3227 2c0a 2020 2020 2020 2020  oat32',.        
-00000550: 2761 6d6f 756e 7427 3a20 2766 6c6f 6174  'amount': 'float
-00000560: 3332 270a 2020 2020 7d0a 2020 2020 6466  32'.    }.    df
-00000570: 203d 2072 6561 645f 6373 765f 6c69 7374   = read_csv_list
-00000580: 5f6e 6a6f 6273 2870 6174 685f 6c69 7374  _njobs(path_list
-00000590: 2c20 7573 6563 6f6c 7320 3d20 4e6f 6e65  , usecols = None
-000005a0: 2c20 6474 7970 6520 3d20 6474 7970 652c  , dtype = dtype,
-000005b0: 206e 5f6a 6f62 7320 3d20 6e5f 6a6f 6273   n_jobs = n_jobs
-000005c0: 290a 2020 2020 2320 6466 2e72 6573 6574  ).    # df.reset
-000005d0: 5f69 6e64 6578 2864 726f 7020 3d20 5472  _index(drop = Tr
-000005e0: 7565 2c20 696e 706c 6163 6520 3d20 5472  ue, inplace = Tr
-000005f0: 7565 290a 2020 2020 6466 5b27 766f 6c27  ue).    df['vol'
-00000600: 5d20 2a3d 2031 3030 0a20 2020 2064 665b  ] *= 100.    df[
-00000610: 2761 6d6f 756e 7427 5d20 2a3d 2031 3030  'amount'] *= 100
-00000620: 300a 2020 2020 7265 7475 726e 2064 660a  0.    return df.
-00000630: 0a63 6c61 7373 2042 6173 6963 4461 7461  .class BasicData
-00000640: 2842 6173 6544 6174 6129 3a0a 2020 2020  (BaseData):.    
-00000650: 6465 6620 6765 745f 6466 2873 656c 662c  def get_df(self,
-00000660: 2070 6174 685f 696e 7075 742c 2064 6174   path_input, dat
-00000670: 655f 6265 6769 6e2c 2064 6174 655f 656e  e_begin, date_en
-00000680: 642c 206e 5f6a 6f62 7329 3a0a 2020 2020  d, n_jobs):.    
-00000690: 2020 2020 7265 7475 726e 2072 6561 645f      return read_
-000006a0: 6261 7369 6328 7061 7468 5f69 6e70 7574  basic(path_input
-000006b0: 2c20 6461 7465 5f62 6567 696e 2c20 6461  , date_begin, da
-000006c0: 7465 5f65 6e64 2c20 6e5f 6a6f 6273 290a  te_end, n_jobs).
-000006d0: 2020 2020 2020 2020 2320 6466 203d 2070          # df = p
-000006e0: 642e 7265 6164 5f70 6963 6b6c 6528 2764  d.read_pickle('d
-000006f0: 662e 7069 636b 6c65 2729 0a20 2020 2020  f.pickle').     
-00000700: 2020 2023 2064 6620 3d20 6466 5b28 6461     # df = df[(da
-00000710: 7465 5f62 6567 696e 203c 3d20 6466 5b27  te_begin <= df['
-00000720: 7472 6164 655f 6461 7465 275d 2920 2620  trade_date']) & 
-00000730: 2864 665b 2774 7261 6465 5f64 6174 6527  (df['trade_date'
-00000740: 5d20 3c3d 2064 6174 655f 656e 6429 5d2e  ] <= date_end)].
-00000750: 7265 7365 745f 696e 6465 7828 6472 6f70  reset_index(drop
-00000760: 203d 2054 7275 6529 0a20 2020 2020 2020   = True).       
-00000770: 2023 2072 6574 7572 6e20 6466 0a20 2020   # return df.   
-00000780: 2020 2020 2023 2069 6d70 6f72 7420 7061       # import pa
-00000790: 6e64 6173 2061 7320 7064 0a20 2020 2020  ndas as pd.     
-000007a0: 2020 2023 2064 6620 3d20 7064 2e72 6561     # df = pd.rea
-000007b0: 645f 6665 6174 6865 7228 6627 2f55 7365  d_feather(f'/Use
-000007c0: 7273 2f72 756e 6e69 6e67 7a2f 6461 7461  rs/runningz/data
-000007d0: 2f64 6174 615f 6665 612f 6274 6375 7364  /data_fea/btcusd
-000007e0: 742e 6665 6127 290a 2020 2020 2020 2020  t.fea').        
-000007f0: 2320 7320 3d20 6466 5b27 4441 5445 275d  # s = df['DATE']
-00000800: 2e64 726f 705f 6475 706c 6963 6174 6573  .drop_duplicates
-00000810: 2829 2e72 6573 6574 5f69 6e64 6578 2864  ().reset_index(d
-00000820: 726f 7020 3d20 5472 7565 290a 2020 2020  rop = True).    
-00000830: 2020 2020 2320 6b76 203d 2064 6963 7428      # kv = dict(
-00000840: 7a69 7028 732c 2073 2e61 7070 6c79 286c  zip(s, s.apply(l
-00000850: 616d 6264 6120 783a 2069 6e74 2878 2e72  ambda x: int(x.r
-00000860: 6570 6c61 6365 2827 2d27 2c20 2727 2929  eplace('-', ''))
-00000870: 2929 290a 2020 2020 2020 2020 2320 6466  ))).        # df
-00000880: 5b27 4441 5445 275d 203d 2064 665b 2744  ['DATE'] = df['D
-00000890: 4154 4527 5d2e 6d61 7028 6b76 290a 2020  ATE'].map(kv).  
-000008a0: 2020 2020 2020 2320 6465 6c20 6466 5b27        # del df['
-000008b0: 5f5f 4e41 4d45 5f5f 275d 0a20 2020 2020  __NAME__'].     
-000008c0: 2020 2023 2072 6574 7572 6e20 6466 7a06     # return dfz.
-000008d0: 5c27 5c27 5c27 7a03 2727 27da 0177 2907  \'\'\'z.'''..w).
-000008e0: da02 6f73 da04 7061 7468 da07 6469 726e  ..os..path..dirn
-000008f0: 616d 65da 085f 5f66 696c 655f 5fda 0772  ame..__file__..r
-00000900: 6570 6c61 6365 da04 6f70 656e da05 7772  eplace..open..wr
-00000910: 6974 6529 04da 066f 7574 7075 745a 0b70  ite)...outputZ.p
-00000920: 6174 685f 6f75 7470 7574 da01 73da 0166  ath_output..s..f
-00000930: a900 720e 0000 00fa 4c62 7569 6c64 2f62  ..r.....Lbuild/b
-00000940: 6469 7374 2e6d 6163 6f73 782d 3130 2e39  dist.macosx-10.9
-00000950: 2d78 3836 5f36 342f 6567 672f 7275 6e6e  -x86_64/egg/runn
-00000960: 696e 677a 2f66 652f 7072 6570 6172 655f  ingz/fe/prepare_
-00000970: 6461 7461 2f62 6173 6963 5f64 6174 615f  data/basic_data_
-00000980: 7079 2e70 79da 0372 756e 0400 0000 730a  py.py..run....s.
-00000990: 0000 0000 0114 0104 350c 010c 0172 1000  ........5....r..
-000009a0: 0000 da08 5f5f 6d61 696e 5f5f 7a08 2d2d  ....__main__z.--
-000009b0: 6f75 7470 7574 5429 02da 0474 7970 65da  outputT)...type.
-000009c0: 0872 6571 7569 7265 6429 0c72 0400 0000  .required).r....
-000009d0: da03 7379 7372 1000 0000 da08 5f5f 6e61  ..sysr......__na
-000009e0: 6d65 5f5f da08 6172 6770 6172 7365 da0e  me__..argparse..
-000009f0: 4172 6775 6d65 6e74 5061 7273 6572 da06  ArgumentParser..
-00000a00: 7061 7273 6572 da0c 6164 645f 6172 6775  parser..add_argu
-00000a10: 6d65 6e74 da03 7374 72da 0a70 6172 7365  ment..str..parse
-00000a20: 5f61 7267 73da 0461 7267 7372 0b00 0000  _args..argsr....
-00000a30: 720e 0000 0072 0e00 0000 720e 0000 0072  r....r....r....r
-00000a40: 0f00 0000 da08 3c6d 6f64 756c 653e 0200  ......<module>..
-00000a50: 0000 7310 0000 0008 0108 0108 3b08 0108  ..s.........;...
-00000a60: 0108 0110 0108 01                        .......
+00000200: 203d 2031 2c20 7665 7262 6f73 6520 3d20   = 1, verbose = 
+00000210: 5472 7565 293a 0a20 2020 2064 6174 655f  True):.    date_
+00000220: 6265 6769 6e2c 2064 6174 655f 656e 6420  begin, date_end 
+00000230: 3d20 7374 7228 6461 7465 5f62 6567 696e  = str(date_begin
+00000240: 292c 2073 7472 2864 6174 655f 656e 6429  ), str(date_end)
+00000250: 0a20 2020 2079 6561 725f 6c69 7374 203d  .    year_list =
+00000260: 2073 6f72 7465 6428 6f73 2e6c 6973 7464   sorted(os.listd
+00000270: 6972 2870 6174 685f 696e 7075 7429 290a  ir(path_input)).
+00000280: 2020 2020 7061 7468 5f6c 6973 7420 3d20      path_list = 
+00000290: 5b5d 0a20 2020 2064 6174 655f 6c69 7374  [].    date_list
+000002a0: 203d 205b 5d0a 2020 2020 666f 7220 7965   = [].    for ye
+000002b0: 6172 2069 6e20 7965 6172 5f6c 6973 743a  ar in year_list:
+000002c0: 0a20 2020 2020 2020 2066 696c 655f 6c69  .        file_li
+000002d0: 7374 203d 2073 6f72 7465 6428 6f73 2e6c  st = sorted(os.l
+000002e0: 6973 7464 6972 2866 277b 7061 7468 5f69  istdir(f'{path_i
+000002f0: 6e70 7574 7d2f 7b79 6561 727d 2f27 2929  nput}/{year}/'))
+00000300: 0a20 2020 2020 2020 2066 6f72 2066 696c  .        for fil
+00000310: 6520 696e 2066 696c 655f 6c69 7374 3a0a  e in file_list:.
+00000320: 2020 2020 2020 2020 2020 2020 6966 2066              if f
+00000330: 696c 655b 3a2d 345d 203e 3d20 6461 7465  ile[:-4] >= date
+00000340: 5f62 6567 696e 2061 6e64 2066 696c 655b  _begin and file[
+00000350: 3a2d 345d 203c 3d20 6461 7465 5f65 6e64  :-4] <= date_end
+00000360: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00000370: 2020 7061 7468 5f6c 6973 742e 6170 7065    path_list.appe
+00000380: 6e64 2866 277b 7061 7468 5f69 6e70 7574  nd(f'{path_input
+00000390: 7d2f 7b79 6561 727d 2f7b 6669 6c65 7d27  }/{year}/{file}'
+000003a0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+000003b0: 2020 6461 7465 5f6c 6973 742e 6170 7065    date_list.appe
+000003c0: 6e64 2866 696c 655b 3a2d 345d 290a 2020  nd(file[:-4]).  
+000003d0: 2020 0a20 2020 2066 726f 6d20 2e2e 2e75    .    from ...u
+000003e0: 7469 6c2e 7574 696c 2069 6d70 6f72 7420  til.util import 
+000003f0: 6d79 5f70 7269 6e74 2061 7320 7072 696e  my_print as prin
+00000400: 740a 2020 2020 6966 2076 6572 626f 7365  t.    if verbose
+00000410: 3a20 7072 696e 7428 6627 5b2b 5d20 6e64  : print(f'[+] nd
+00000420: 6179 7320 3d20 7b6c 656e 2864 6174 655f  ays = {len(date_
+00000430: 6c69 7374 297d 2729 0a20 2020 2064 7479  list)}').    dty
+00000440: 7065 203d 207b 0a20 2020 2020 2020 2027  pe = {.        '
+00000450: 7473 5f63 6f64 6527 3a20 276f 626a 6563  ts_code': 'objec
+00000460: 7427 2c0a 2020 2020 2020 2020 2774 7261  t',.        'tra
+00000470: 6465 5f64 6174 6527 3a20 2769 6e74 3332  de_date': 'int32
+00000480: 272c 0a20 2020 2020 2020 2027 6f70 656e  ',.        'open
+00000490: 273a 2027 666c 6f61 7433 3227 2c0a 2020  ': 'float32',.  
+000004a0: 2020 2020 2020 2768 6967 6827 3a20 2766        'high': 'f
+000004b0: 6c6f 6174 3332 272c 0a20 2020 2020 2020  loat32',.       
+000004c0: 2027 6c6f 7727 3a20 2766 6c6f 6174 3332   'low': 'float32
+000004d0: 272c 0a20 2020 2020 2020 2027 636c 6f73  ',.        'clos
+000004e0: 6527 3a20 2766 6c6f 6174 3332 272c 0a20  e': 'float32',. 
+000004f0: 2020 2020 2020 2027 7072 655f 636c 6f73         'pre_clos
+00000500: 6527 3a20 2766 6c6f 6174 3332 272c 0a20  e': 'float32',. 
+00000510: 2020 2020 2020 2027 6368 616e 6765 273a         'change':
+00000520: 2027 666c 6f61 7433 3227 2c0a 2020 2020   'float32',.    
+00000530: 2020 2020 2770 6374 5f63 6867 273a 2027      'pct_chg': '
+00000540: 666c 6f61 7433 3227 2c0a 2020 2020 2020  float32',.      
+00000550: 2020 2776 6f6c 273a 2027 666c 6f61 7433    'vol': 'float3
+00000560: 3227 2c0a 2020 2020 2020 2020 2761 6d6f  2',.        'amo
+00000570: 756e 7427 3a20 2766 6c6f 6174 3332 270a  unt': 'float32'.
+00000580: 2020 2020 7d0a 2020 2020 6466 203d 2072      }.    df = r
+00000590: 6561 645f 6373 765f 6c69 7374 5f6e 6a6f  ead_csv_list_njo
+000005a0: 6273 2870 6174 685f 6c69 7374 2c20 7573  bs(path_list, us
+000005b0: 6563 6f6c 7320 3d20 4e6f 6e65 2c20 6474  ecols = None, dt
+000005c0: 7970 6520 3d20 6474 7970 652c 206e 5f6a  ype = dtype, n_j
+000005d0: 6f62 7320 3d20 6e5f 6a6f 6273 2c20 7665  obs = n_jobs, ve
+000005e0: 7262 6f73 6520 3d20 7665 7262 6f73 6529  rbose = verbose)
+000005f0: 0a20 2020 2023 2064 662e 7265 7365 745f  .    # df.reset_
+00000600: 696e 6465 7828 6472 6f70 203d 2054 7275  index(drop = Tru
+00000610: 652c 2069 6e70 6c61 6365 203d 2054 7275  e, inplace = Tru
+00000620: 6529 0a20 2020 2064 665b 2776 6f6c 275d  e).    df['vol']
+00000630: 202a 3d20 3130 300a 2020 2020 6466 5b27   *= 100.    df['
+00000640: 616d 6f75 6e74 275d 202a 3d20 3130 3030  amount'] *= 1000
+00000650: 0a20 2020 2072 6574 7572 6e20 6466 0a0a  .    return df..
+00000660: 636c 6173 7320 4261 7369 6344 6174 6128  class BasicData(
+00000670: 4261 7365 4461 7461 293a 0a20 2020 2064  BaseData):.    d
+00000680: 6566 2067 6574 5f64 6628 7365 6c66 2c20  ef get_df(self, 
+00000690: 7061 7468 5f69 6e70 7574 2c20 6461 7465  path_input, date
+000006a0: 5f62 6567 696e 2c20 6461 7465 5f65 6e64  _begin, date_end
+000006b0: 2c20 6e5f 6a6f 6273 2c20 7665 7262 6f73  , n_jobs, verbos
+000006c0: 6520 3d20 5472 7565 293a 0a20 2020 2020  e = True):.     
+000006d0: 2020 2072 6574 7572 6e20 7265 6164 5f62     return read_b
+000006e0: 6173 6963 2870 6174 685f 696e 7075 742c  asic(path_input,
+000006f0: 2064 6174 655f 6265 6769 6e2c 2064 6174   date_begin, dat
+00000700: 655f 656e 642c 206e 5f6a 6f62 732c 2076  e_end, n_jobs, v
+00000710: 6572 626f 7365 203d 2076 6572 626f 7365  erbose = verbose
+00000720: 290a 2020 2020 2020 2020 2320 6466 203d  ).        # df =
+00000730: 2070 642e 7265 6164 5f70 6963 6b6c 6528   pd.read_pickle(
+00000740: 2764 662e 7069 636b 6c65 2729 0a20 2020  'df.pickle').   
+00000750: 2020 2020 2023 2064 6620 3d20 6466 5b28       # df = df[(
+00000760: 6461 7465 5f62 6567 696e 203c 3d20 6466  date_begin <= df
+00000770: 5b27 7472 6164 655f 6461 7465 275d 2920  ['trade_date']) 
+00000780: 2620 2864 665b 2774 7261 6465 5f64 6174  & (df['trade_dat
+00000790: 6527 5d20 3c3d 2064 6174 655f 656e 6429  e'] <= date_end)
+000007a0: 5d2e 7265 7365 745f 696e 6465 7828 6472  ].reset_index(dr
+000007b0: 6f70 203d 2054 7275 6529 0a20 2020 2020  op = True).     
+000007c0: 2020 2023 2072 6574 7572 6e20 6466 0a20     # return df. 
+000007d0: 2020 2020 2020 2023 2069 6d70 6f72 7420         # import 
+000007e0: 7061 6e64 6173 2061 7320 7064 0a20 2020  pandas as pd.   
+000007f0: 2020 2020 2023 2064 6620 3d20 7064 2e72       # df = pd.r
+00000800: 6561 645f 6665 6174 6865 7228 6627 2f55  ead_feather(f'/U
+00000810: 7365 7273 2f72 756e 6e69 6e67 7a2f 6461  sers/runningz/da
+00000820: 7461 2f64 6174 615f 6665 612f 6274 6375  ta/data_fea/btcu
+00000830: 7364 742e 6665 6127 290a 2020 2020 2020  sdt.fea').      
+00000840: 2020 2320 7320 3d20 6466 5b27 4441 5445    # s = df['DATE
+00000850: 275d 2e64 726f 705f 6475 706c 6963 6174  '].drop_duplicat
+00000860: 6573 2829 2e72 6573 6574 5f69 6e64 6578  es().reset_index
+00000870: 2864 726f 7020 3d20 5472 7565 290a 2020  (drop = True).  
+00000880: 2020 2020 2020 2320 6b76 203d 2064 6963        # kv = dic
+00000890: 7428 7a69 7028 732c 2073 2e61 7070 6c79  t(zip(s, s.apply
+000008a0: 286c 616d 6264 6120 783a 2069 6e74 2878  (lambda x: int(x
+000008b0: 2e72 6570 6c61 6365 2827 2d27 2c20 2727  .replace('-', ''
+000008c0: 2929 2929 290a 2020 2020 2020 2020 2320  ))))).        # 
+000008d0: 6466 5b27 4441 5445 275d 203d 2064 665b  df['DATE'] = df[
+000008e0: 2744 4154 4527 5d2e 6d61 7028 6b76 290a  'DATE'].map(kv).
+000008f0: 2020 2020 2020 2020 2320 6465 6c20 6466          # del df
+00000900: 5b27 5f5f 4e41 4d45 5f5f 275d 0a20 2020  ['__NAME__'].   
+00000910: 2020 2020 2023 2072 6574 7572 6e20 6466       # return df
+00000920: 7a06 5c27 5c27 5c27 7a03 2727 27da 0177  z.\'\'\'z.'''..w
+00000930: 2907 da02 6f73 da04 7061 7468 da07 6469  )...os..path..di
+00000940: 726e 616d 65da 085f 5f66 696c 655f 5fda  rname..__file__.
+00000950: 0772 6570 6c61 6365 da04 6f70 656e da05  .replace..open..
+00000960: 7772 6974 6529 04da 066f 7574 7075 745a  write)...outputZ
+00000970: 0b70 6174 685f 6f75 7470 7574 da01 73da  .path_output..s.
+00000980: 0166 a900 720e 0000 00fa 4c62 7569 6c64  .f..r.....Lbuild
+00000990: 2f62 6469 7374 2e6d 6163 6f73 782d 3130  /bdist.macosx-10
+000009a0: 2e39 2d78 3836 5f36 342f 6567 672f 7275  .9-x86_64/egg/ru
+000009b0: 6e6e 696e 677a 2f66 652f 7072 6570 6172  nningz/fe/prepar
+000009c0: 655f 6461 7461 2f62 6173 6963 5f64 6174  e_data/basic_dat
+000009d0: 615f 7079 2e70 79da 0372 756e 0400 0000  a_py.py..run....
+000009e0: 730a 0000 0000 0114 0104 350c 010c 0172  s.........5....r
+000009f0: 1000 0000 da08 5f5f 6d61 696e 5f5f 7a08  ......__main__z.
+00000a00: 2d2d 6f75 7470 7574 5429 02da 0474 7970  --outputT)...typ
+00000a10: 65da 0872 6571 7569 7265 6429 0c72 0400  e..required).r..
+00000a20: 0000 da03 7379 7372 1000 0000 da08 5f5f  ....sysr......__
+00000a30: 6e61 6d65 5f5f da08 6172 6770 6172 7365  name__..argparse
+00000a40: da0e 4172 6775 6d65 6e74 5061 7273 6572  ..ArgumentParser
+00000a50: da06 7061 7273 6572 da0c 6164 645f 6172  ..parser..add_ar
+00000a60: 6775 6d65 6e74 da03 7374 72da 0a70 6172  gument..str..par
+00000a70: 7365 5f61 7267 73da 0461 7267 7372 0b00  se_args..argsr..
+00000a80: 0000 720e 0000 0072 0e00 0000 720e 0000  ..r....r....r...
+00000a90: 0072 0f00 0000 da08 3c6d 6f64 756c 653e  .r......<module>
+00000aa0: 0200 0000 7310 0000 0008 0108 0108 3b08  ....s.........;.
+00000ab0: 0108 0108 0110 0108 01                   .........
```

## runningz/fe/prepare_data/factor_data.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Fri Apr 19 12:16:02 2024 UTC, .py size: 8591 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,525 +1,527 @@
-00000000: 610d 0d0a 0000 0000 8260 2266 8f21 0000  a........`"f.!..
+00000000: 610d 0d0a 0000 0000 f83a 4066 ed21 0000  a........:@f.!..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
-00000020: 0004 0000 0040 0000 0073 dc00 0000 6400  .....@...s....d.
+00000020: 0004 0000 0040 0000 0073 de00 0000 6400  .....@...s....d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a02 6400  d.l.Z.d.d.l.Z.d.
 00000040: 6401 6c03 5a04 6400 6401 6c05 5a06 6400  d.l.Z.d.d.l.Z.d.
 00000050: 6401 6c07 5a08 6402 6403 6c09 6d0a 5a0a  d.l.Z.d.d.l.m.Z.
 00000060: 0100 6402 6404 6c0b 6d0c 5a0c 6d0d 5a0d  ..d.d.l.m.Z.m.Z.
 00000070: 6d0e 5a0e 0100 6402 6405 6c0f 6d10 5a10  m.Z...d.d.l.m.Z.
 00000080: 0100 6402 6406 6c11 6d12 5a12 6d13 5a13  ..d.d.l.m.Z.m.Z.
 00000090: 0100 6402 6407 6c14 6d15 5a15 0100 6516  ..d.d.l.m.Z...e.
 000000a0: 5a17 6408 6409 8400 5a16 6402 640a 6c18  Z.d.d...Z.d.d.l.
 000000b0: 6d19 5a19 0100 6402 640b 6c0b 6d1a 5a16  m.Z...d.d.l.m.Z.
 000000c0: 0100 6402 640c 6c1b 6d1c 5a1c 0100 4700  ..d.d.l.m.Z...G.
 000000d0: 640d 640e 8400 640e 8302 5a1d 640f 6700  d.d...d...Z.d.g.
-000000e0: 640f 6603 6410 6411 8401 5a1e 6417 6413  d.f.d.d...Z.d.d.
-000000f0: 6414 8401 5a1f 4700 6415 6416 8400 6416  d...Z.G.d.d...d.
-00000100: 651d 8303 5a20 6401 5300 2918 e900 0000  e...Z d.S.).....
-00000110: 004e e903 0000 0029 01da 0a44 6174 614d  .N.....)...DataM
-00000120: 6173 7465 7229 03da 066c 6f67 6765 72da  aster)...logger.
-00000130: 056d 6572 6765 da0d 636f 6465 5f32 5f6d  .merge..code_2_m
-00000140: 6172 6b65 7429 01da 0d67 6574 5f64 665f  arket)...get_df_
-00000150: 6964 5f61 6c6c 2902 da0c 6e70 5f73 6869  id_all)...np_shi
-00000160: 6674 5f72 6177 da08 6e70 5f73 6869 6674  ft_raw..np_shift
-00000170: 2901 da08 4442 4d61 7374 6572 6300 0000  )...DBMasterc...
-00000180: 0000 0000 0000 0000 0002 0000 0006 0000  ................
-00000190: 004f 0000 0073 2e00 0000 7c01 a000 6401  .O...s....|...d.
-000001a0: 6402 a102 6402 6b03 7214 7401 5300 7402  d...d.k.r.t.S.t.
-000001b0: a003 6403 a004 6404 6405 8400 7c00 4400  ..d...d.d...|.D.
-000001c0: 8301 a101 a101 5300 2906 4eda 0466 696c  ......S.).N..fil
-000001d0: 657a 0a73 7973 2e73 7464 6f75 74fa 0120  ez.sys.stdout.. 
-000001e0: 6301 0000 0000 0000 0000 0000 0002 0000  c...............
-000001f0: 0003 0000 0073 0000 0073 1600 0000 7c00  .....s...s....|.
-00000200: 5d0e 7d01 7400 7c01 8301 5600 0100 7102  ].}.t.|...V...q.
-00000210: 6400 5300 a901 4e29 01da 0373 7472 a902  d.S...N)...str..
-00000220: da02 2e30 da01 78a9 0072 1200 0000 fa4a  ...0..x..r.....J
-00000230: 6275 696c 642f 6264 6973 742e 6d61 636f  build/bdist.maco
-00000240: 7378 2d31 302e 392d 7838 365f 3634 2f65  sx-10.9-x86_64/e
-00000250: 6767 2f72 756e 6e69 6e67 7a2f 6665 2f70  gg/runningz/fe/p
-00000260: 7265 7061 7265 5f64 6174 612f 6661 6374  repare_data/fact
-00000270: 6f72 5f64 6174 612e 7079 da09 3c67 656e  or_data.py..<gen
-00000280: 6578 7072 3e0d 0000 00f3 0000 0000 7a1b  expr>.........z.
-00000290: 3c6c 616d 6264 613e 2e3c 6c6f 6361 6c73  <lambda>.<locals
-000002a0: 3e2e 3c67 656e 6578 7072 3e29 05da 0367  >.<genexpr>)...g
-000002b0: 6574 da06 5f70 7269 6e74 7204 0000 00da  et.._printr.....
-000002c0: 0469 6e66 6fda 046a 6f69 6e29 02da 0461  .info..join)...a
-000002d0: 7267 73da 066b 7761 7267 7372 1200 0000  rgs..kwargsr....
-000002e0: 7212 0000 0072 1300 0000 da08 3c6c 616d  r....r......<lam
-000002f0: 6264 613e 0c00 0000 7302 0000 0014 0172  bda>....s......r
-00000300: 1c00 0000 2901 da05 434f 4e53 5429 01da  ....)...CONST)..
-00000310: 086d 795f 7072 696e 7429 01da 1372 6561  .my_print)...rea
-00000320: 645f 6373 765f 6c69 7374 5f6e 6a6f 6273  d_csv_list_njobs
-00000330: 6300 0000 0000 0000 0000 0000 0000 0000  c...............
-00000340: 0003 0000 0040 0000 0073 2000 0000 6500  .....@...s ...e.
-00000350: 5a01 6400 5a02 6408 6402 6403 8401 5a03  Z.d.Z.d.d.d...Z.
-00000360: 6409 6406 6407 8401 5a04 6404 5300 290a  d.d.d...Z.d.S.).
-00000370: da0a 4661 6374 6f72 4461 7461 e901 0000  ..FactorData....
-00000380: 0063 0600 0000 0000 0000 0000 0000 0600  .c..............
-00000390: 0000 0200 0000 4300 0000 730c 0000 0074  ......C...s....t
-000003a0: 0064 0183 0182 0164 0053 0029 024e 7a1e  .d.....d.S.).Nz.
-000003b0: 796f 7520 6e65 6564 2074 6f20 696d 706c  you need to impl
-000003c0: 656d 656e 7420 6765 745f 6466 2829 2901  ement get_df()).
-000003d0: da13 4e6f 7449 6d70 6c65 6d65 6e74 6564  ..NotImplemented
-000003e0: 4572 726f 7229 06da 0473 656c 66da 0a70  Error)...self..p
-000003f0: 6174 685f 696e 7075 74da 0a64 6174 655f  ath_input..date_
-00000400: 6265 6769 6eda 0864 6174 655f 656e 64da  begin..date_end.
-00000410: 066e 5f6a 6f62 73da 0773 6869 6674 5f69  .n_jobs..shift_i
-00000420: 7212 0000 0072 1200 0000 7213 0000 00da  r....r....r.....
-00000430: 0667 6574 5f64 6614 0000 0073 0200 0000  .get_df....s....
-00000440: 0001 7a11 4661 6374 6f72 4461 7461 2e67  ..z.FactorData.g
-00000450: 6574 5f64 664e 5463 0400 0000 0000 0000  et_dfNTc........
-00000460: 0000 0000 1900 0000 0700 0000 0300 0000  ................
-00000470: 73e4 0200 0074 006a 017d 047c 0164 0119  s....t.j.}.|.d..
-00000480: 007d 057c 0164 0219 007d 067c 0164 0319  .}.|.d...}.|.d..
-00000490: 007d 077c 0164 0419 007d 087c 0764 0519  .}.|.d...}.|.d..
-000004a0: 0089 007c 0764 0619 007d 097c 0764 0719  ...|.d...}.|.d..
-000004b0: 007d 0a7c 0764 0819 0089 0188 0188 0067  .}.|.d.........g
-000004c0: 027d 0b7c 0264 0075 0072 707c 006a 027c  .}.|.d.u.rp|.j.|
-000004d0: 0467 017c 0564 0919 00a2 017c 0691 0152  .g.|.d.....|...R
-000004e0: 008e 007d 0264 0a74 0374 047c 0283 0183  ...}.d.t.t.|....
-000004f0: 0176 0072 867c 027d 0c6e 1c7c 026a 0564  .v.r.|.}.n.|.j.d
-00000500: 0b64 0b64 0c8d 0201 0074 067c 0264 0d64  .d.d.....t.|.d.d
-00000510: 0b64 0e8d 037d 0c7c 0c6a 0788 0167 0164  .d...}.|.j...g.d
-00000520: 0d64 0f8d 0201 007c 0ca0 0864 1074 096a  .d.....|...d.t.j
-00000530: 0a74 0b7c 0c83 0174 096a 0c64 118d 02a1  .t.|...t.j.d....
-00000540: 0201 0064 1264 1367 027d 0d7c 0ca0 0d7c  ...d.d.g.}.|...|
-00000550: 0ba1 0189 0387 0366 0164 1464 1584 087c  .......f.d.d...|
-00000560: 0b44 0083 017d 0e64 1664 1584 007c 0e44  .D...}.d.d...|.D
-00000570: 0083 017d 0f74 0e7c 0e7c 0b64 178d 02a0  ...}.t.|.|.d....
-00000580: 0f88 037c 0b19 006a 10a0 11a1 00a1 017d  ...|...j.......}
-00000590: 1074 126a 137c 107c 0ca0 0d7c 0b7c 0d17  .t.j.|.|...|.|..
-000005a0: 00a1 017c 0b64 188d 03a0 14a1 007d 117c  ...|.d.......}.|
-000005b0: 1164 1219 007c 1164 1319 0014 0064 1914  .d...|.d.....d..
-000005c0: 007c 1164 1a3c 0074 09a0 1574 09a0 167c  .|.d.<.t...t...|
-000005d0: 1164 1a19 0064 1b17 00a1 0164 1c64 1da1  .d...d.....d.d..
-000005e0: 037c 1164 1e3c 0074 12a0 067c 11a1 017d  .|.d.<.t...|...}
-000005f0: 127c 126a 0764 1f88 019b 0064 209d 0367  .|.j.d.....d ..g
-00000600: 0164 0d64 0f8d 0201 007c 126a 0764 2188  .d.d.....|.j.d!.
-00000610: 019b 0064 229d 0367 0164 0d64 0f8d 0201  ...d"..g.d.d....
-00000620: 007c 12a0 1764 1ea1 017c 1164 233c 0064  .|...d...|.d#<.d
-00000630: 2367 017d 1374 126a 1388 037c 117c 0b7c  #g.}.t.j...|.|.|
-00000640: 1317 0019 007c 0b64 188d 03a0 14a1 007d  .....|.d.......}
-00000650: 147c 1344 005d 167d 157c 0ca0 087c 157c  .|.D.].}.|...|.|
-00000660: 147c 1519 00a1 0201 0090 0171 e064 2464  .|.........q.d$d
-00000670: 1584 007c 0ca0 18a1 006a 1944 0083 017d  ...|.....j.D...}
-00000680: 1664 2564 1584 007c 0ca0 18a1 006a 1944  .d%d...|.....j.D
-00000690: 0083 017d 177c 0390 0272 2e74 1a64 2683  ...}.|...r.t.d&.
-000006a0: 0101 007c 08a0 1b64 2764 1ba1 0289 047c  ...|...d'd.....|
-000006b0: 0390 0272 4e74 1a64 2888 049b 009d 0283  ...rNt.d(.......
-000006c0: 0101 0088 0088 017c 0967 037c 0a17 007c  .......|.g.|...|
-000006d0: 1617 007c 1717 007c 08a0 1b64 2964 00a1  ...|...|...d)d..
-000006e0: 0267 0117 0089 0288 027c 08a0 1b64 2a67  .g.......|...d*g
-000006f0: 00a1 0237 0089 0288 027c 0864 2a3c 007c  ...7.....|.d*<.|
-00000700: 0390 0272 9e74 1a64 2b88 029b 009d 0283  ...r.t.d+.......
-00000710: 0101 0087 0266 0164 2c64 1584 087c 0ca0  .....f.d,d...|..
-00000720: 18a1 006a 1944 0083 017d 1888 0464 2d6b  ...j.D...}...d-k
-00000730: 0390 0272 e07c 0c6a 0787 0087 0187 0466  ...r.|.j.......f
-00000740: 0364 2e64 1584 087c 1844 0083 017c 0364  .d.d...|.D...|.d
-00000750: 0f8d 0201 007c 0c53 0029 2f4e da09 6461  .....|.S.)/N..da
-00000760: 7465 5f64 6963 7472 2700 0000 da09 636f  te_dictr'.....co
-00000770: 6c73 5f64 6963 74da 0a6f 7468 6572 5f69  ls_dict..other_i
-00000780: 6e66 6fda 0663 6f6c 5f69 64da 0963 6f6c  nfo..col_id..col
-00000790: 5f6c 6162 656c da08 636f 6c73 5f74 6964  _label..cols_tid
-000007a0: da07 636f 6c5f 7469 64da 0361 6c6c 7203  ..col_tid..allr.
-000007b0: 0000 0054 2902 da04 6472 6f70 5a07 696e  ...T)...dropZ.in
-000007c0: 706c 6163 6546 2902 da07 7665 7262 6f73  placeF)...verbos
-000007d0: 655a 0a6b 6565 705f 7370 6163 6529 0172  eZ.keep_space).r
-000007e0: 3300 0000 5a03 4f4e 4529 01da 0564 7479  3...Z.ONE)...dty
-000007f0: 7065 da05 636c 6f73 65da 0b74 6f74 616c  pe..close..total
-00000800: 5f73 6861 7265 6301 0000 0000 0000 0000  _sharec.........
-00000810: 0000 0002 0000 0006 0000 0013 0000 0073  ...............s
-00000820: 1e00 0000 6700 7c00 5d16 7d01 7400 a001  ....g.|.].}.t...
-00000830: 8800 7c01 1900 a002 a100 a101 9102 7104  ..|...........q.
-00000840: 5300 7212 0000 0029 03da 026e 70da 0473  S.r....)...np..s
-00000850: 6f72 74da 0675 6e69 7175 65a9 0272 1000  ort..unique..r..
-00000860: 0000 da03 636f 6c29 01da 0564 665f 6964  ....col)...df_id
-00000870: 7212 0000 0072 1300 0000 da0a 3c6c 6973  r....r......<lis
-00000880: 7463 6f6d 703e 3300 0000 7215 0000 007a  tcomp>3...r....z
-00000890: 2346 6163 746f 7244 6174 612e 6c6f 6164  #FactorData.load
-000008a0: 2e3c 6c6f 6361 6c73 3e2e 3c6c 6973 7463  .<locals>.<listc
-000008b0: 6f6d 703e 6301 0000 0000 0000 0000 0000  omp>c...........
-000008c0: 0002 0000 0004 0000 0053 0000 0073 1400  .........S...s..
-000008d0: 0000 6700 7c00 5d0c 7d01 7400 7c01 8301  ..g.|.].}.t.|...
-000008e0: 9102 7104 5300 7212 0000 0029 01da 036c  ..q.S.r....)...l
-000008f0: 656e 720f 0000 0072 1200 0000 7212 0000  enr....r....r...
-00000900: 0072 1300 0000 723d 0000 0034 0000 0072  .r....r=...4...r
-00000910: 1500 0000 2901 da07 636f 6c73 5f69 6429  ....)...cols_id)
-00000920: 01da 046b 6579 7367 0000 0000 84d7 9741  ...keysg.......A
-00000930: 5a04 5349 5a45 7221 0000 00e9 0800 0000  Z.SIZEr!........
-00000940: e90b 0000 005a 0853 495a 455f 6c6f 677a  .....Z.SIZE_logz
-00000950: 1753 495a 455f 6c6f 6720 3d20 6167 6728  .SIZE_log = agg(
-00000960: 7a73 636f 7265 2c20 7a0b 2c20 5349 5a45  zscore, z., SIZE
-00000970: 5f6c 6f67 297a 2653 495a 455f 6c6f 6720  _log)z&SIZE_log 
-00000980: 3d20 6164 6428 6469 6628 5349 5a45 5f6c  = add(dif(SIZE_l
-00000990: 6f67 2c20 6167 6728 6d61 782c 207a 102c  og, agg(max, z.,
-000009a0: 2053 495a 455f 6c6f 6729 292c 2031 29da   SIZE_log)), 1).
-000009b0: 0473 697a 6563 0100 0000 0000 0000 0000  .sizec..........
-000009c0: 0000 0200 0000 0400 0000 5300 0000 7320  ..........S...s 
-000009d0: 0000 0067 007c 005d 187d 0164 007c 0176  ...g.|.].}.d.|.v
-000009e0: 0073 1864 017c 0176 0072 047c 0191 0271  .s.d.|.v.r.|...q
-000009f0: 0453 0029 025a 054c 4142 454c da05 6c61  .S.).Z.LABEL..la
-00000a00: 6265 6c72 1200 0000 723a 0000 0072 1200  belr....r:...r..
-00000a10: 0000 7212 0000 0072 1300 0000 723d 0000  ..r....r....r=..
-00000a20: 0044 0000 0072 1500 0000 6301 0000 0000  .D...r....c.....
-00000a30: 0000 0000 0000 0002 0000 0004 0000 0053  ...............S
-00000a40: 0000 0073 1800 0000 6700 7c00 5d10 7d01  ...s....g.|.].}.
-00000a50: 6400 7c01 7600 7204 7c01 9102 7104 5300  d.|.v.r.|...q.S.
-00000a60: 2901 da04 4d41 534b 7212 0000 0072 3a00  )...MASKr....r:.
-00000a70: 0000 7212 0000 0072 1200 0000 7213 0000  ..r....r....r...
-00000a80: 0072 3d00 0000 4500 0000 7215 0000 007a  .r=...E...r....z
-00000a90: 275b 696e 6974 5d20 3c2d 2d2d 2d2d 2d2d  '[init] <-------
-00000aa0: 2d2d 2d20 7368 6966 745f 6920 2d2d 2d2d  --- shift_i ----
-00000ab0: 2d2d 2d2d 2d2d 3e20 7228 0000 007a 0e5b  ------> r(...z.[
-00000ac0: 2b5d 2073 6869 6674 5f69 203d 20da 0863  +] shift_i = ..c
-00000ad0: 6f6c 5f64 6174 65da 1063 6f6c 735f 7368  ol_date..cols_sh
-00000ae0: 6966 745f 315f 6e6f 747a 175b 2b5d 2063  ift_1_notz.[+] c
-00000af0: 6f6c 735f 7368 6966 745f 315f 6e6f 7420  ols_shift_1_not 
-00000b00: 3d20 6301 0000 0000 0000 0000 0000 0002  = c.............
-00000b10: 0000 0004 0000 0013 0000 0073 1800 0000  ...........s....
-00000b20: 6700 7c00 5d10 7d01 7c01 8800 7601 7204  g.|.].}.|...v.r.
-00000b30: 7c01 9102 7104 5300 7212 0000 0072 1200  |...q.S.r....r..
-00000b40: 0000 723a 0000 0029 0172 4700 0000 7212  ..r:...).rG...r.
-00000b50: 0000 0072 1300 0000 723d 0000 004e 0000  ...r....r=...N..
-00000b60: 0072 1500 0000 7201 0000 0063 0100 0000  .r....r....c....
-00000b70: 0000 0000 0000 0000 0200 0000 0c00 0000  ................
-00000b80: 1300 0000 732e 0000 0067 007c 005d 267d  ....s....g.|.]&}
-00000b90: 017c 019b 0064 0088 009b 0064 017c 019b  .|...d.....d.|..
-00000ba0: 0064 0188 019b 0064 0188 029b 0064 029d  .d.....d.....d..
-00000bb0: 0a91 0271 0453 0029 037a 0f20 3d20 726f  ...q.S.).z. = ro
-00000bc0: 6c6c 2873 6869 6674 2c20 7a02 2c20 fa01  ll(shift, z., ..
-00000bd0: 2972 1200 0000 723a 0000 0029 0372 2d00  )r....r:...).r-.
-00000be0: 0000 7230 0000 0072 2800 0000 7212 0000  ..r0...r(...r...
-00000bf0: 0072 1300 0000 723d 0000 004f 0000 0072  .r....r=...O...r
-00000c00: 1500 0000 291c 721d 0000 005a 0950 4154  ....).r....Z.PAT
-00000c10: 485f 4441 5441 7229 0000 0072 0e00 0000  H_DATAr)...r....
-00000c20: da04 7479 7065 da0b 7265 7365 745f 696e  ..type..reset_in
-00000c30: 6465 7872 0300 0000 5a05 6665 5f67 6f5a  dexr....Z.fe_goZ
-00000c40: 0a73 6574 5f62 795f 636f 6c72 3700 0000  .set_by_colr7...
-00000c50: 5a04 6f6e 6573 723e 0000 00da 0766 6c6f  Z.onesr>.....flo
-00000c60: 6174 3332 5a0f 6765 745f 636f 6c73 5f70  at32Z.get_cols_p
-00000c70: 616e 6461 7372 0700 0000 5a06 6173 7479  andasr....Z.asty
-00000c80: 7065 5a06 6474 7970 6573 5a07 746f 5f64  peZ.dtypesZ.to_d
-00000c90: 6963 74da 0272 7a72 0500 0000 5a09 746f  ict..rzr....Z.to
-00000ca0: 5f70 616e 6461 735a 0463 6c69 70da 056c  _pandasZ.clip..l
-00000cb0: 6f67 3130 5a0d 6765 745f 636f 6c5f 6e75  og10Z.get_col_nu
-00000cc0: 6d70 79da 0468 6561 64da 0763 6f6c 756d  mpy..head..colum
-00000cd0: 6e73 da05 7072 696e 7472 1600 0000 2919  ns..printr....).
-00000ce0: 7223 0000 005a 0b64 6174 615f 636f 6e66  r#...Z.data_conf
-00000cf0: 6967 da02 6466 7233 0000 0072 2400 0000  ig..dfr3...r$...
-00000d00: 722a 0000 0072 2700 0000 722b 0000 0072  r*...r'...r+...r
-00000d10: 2c00 0000 722e 0000 0072 2f00 0000 723f  ,...r....r/...r?
-00000d20: 0000 00da 0264 6d5a 0863 6f6c 735f 7365  .....dmZ.cols_se
-00000d30: 6c5a 0769 645f 6c69 7374 da05 7368 6170  lZ.id_list..shap
-00000d40: 655a 0864 665f 6964 5f32 645a 0c64 665f  eZ.df_id_2dZ.df_
-00000d50: 6661 6374 6f72 5f32 645a 0464 6d5f 695a  factor_2dZ.dm_iZ
-00000d60: 0b63 6f6c 735f 6661 6374 6f72 5a09 6466  .cols_factorZ.df
-00000d70: 5f66 6163 746f 7272 3b00 0000 5a0a 636f  _factorr;...Z.co
-00000d80: 6c73 5f6c 6162 656c 5a09 636f 6c73 5f6d  ls_labelZ.cols_m
-00000d90: 6173 6b5a 0c63 6f6c 735f 7368 6966 745f  askZ.cols_shift_
-00000da0: 3172 1200 0000 2905 722d 0000 0072 3000  1r....).r-...r0.
-00000db0: 0000 7247 0000 0072 3c00 0000 7228 0000  ..rG...r<...r(..
-00000dc0: 0072 1300 0000 da04 6c6f 6164 1700 0000  .r......load....
-00000dd0: 7356 0000 0000 0206 0108 0108 0208 0108  sV..............
-00000de0: 0208 0108 0108 0108 0108 0322 0116 020e  ..........."....
-00000df0: 010e 0110 011c 0408 010a 0112 010e 011c  ................
-00000e00: 011e 0218 0120 010a 0118 0118 010e 0306  ..... ..........
-00000e10: 011c 011c 0214 0114 020e 010c 0114 0124  ...............$
-00000e20: 0110 0108 0114 0118 012a 017a 0f46 6163  .........*.z.Fac
-00000e30: 746f 7244 6174 612e 6c6f 6164 2901 7221  torData.load).r!
-00000e40: 0000 0029 024e 5429 05da 085f 5f6e 616d  ...).NT)...__nam
-00000e50: 655f 5fda 0a5f 5f6d 6f64 756c 655f 5fda  e__..__module__.
-00000e60: 0c5f 5f71 7561 6c6e 616d 655f 5f72 2900  .__qualname__r).
-00000e70: 0000 7254 0000 0072 1200 0000 7212 0000  ..rT...r....r...
-00000e80: 0072 1200 0000 7213 0000 0072 2000 0000  .r....r....r ...
-00000e90: 1300 0000 7304 0000 0008 010a 0372 2000  ....s........r .
-00000ea0: 0000 7221 0000 0063 0600 0000 0000 0000  ..r!...c........
-00000eb0: 0000 0000 1200 0000 1800 0000 0300 0000  ................
-00000ec0: 731e 0200 0074 007c 0183 0174 007c 0283  s....t.|...t.|..
-00000ed0: 0102 007d 017d 0274 0174 02a0 037c 00a1  ...}.}.t.t...|..
-00000ee0: 0183 017d 0667 007d 0767 007d 087c 0644  ...}.g.}.g.}.|.D
-00000ef0: 005d 747d 0974 0174 02a0 037c 009b 0064  .]t}.t.t...|...d
-00000f00: 017c 099b 0064 019d 04a1 0183 017d 0a7c  .|...d.......}.|
-00000f10: 0a44 005d 507d 0b7c 0b64 0064 0285 0219  .D.]P}.|.d.d....
-00000f20: 007c 016b 0572 4e7c 0b64 0064 0285 0219  .|.k.rN|.d.d....
-00000f30: 007c 026b 0172 4e7c 07a0 047c 009b 0064  .|.k.rN|...|...d
-00000f40: 017c 099b 0064 017c 0b9b 009d 05a1 0101  .|...d.|........
-00000f50: 007c 08a0 047c 0b64 0064 0285 0219 00a1  .|...|.d.d......
-00000f60: 0101 0071 4e71 2c74 0564 0374 067c 0883  ...qNq,t.d.t.|..
-00000f70: 019b 009d 0283 0101 0064 0464 0564 0464  .........d.d.d.d
-00000f80: 0664 079c 047d 0c74 077c 0774 087c 0ca0  .d...}.t.|.t.|..
-00000f90: 09a1 0083 017c 0c7c 0364 088d 047d 0d7c  .....|.|.d...}.|
-00000fa0: 0d6a 0a64 0964 0a67 0264 0b64 0c8d 026a  .j.d.d.g.d.d...j
-00000fb0: 0b64 0d64 0e8d 017d 0d67 0064 0fa2 0167  .d.d...}.g.d...g
-00000fc0: 0064 10a2 0167 0064 11a2 0167 0064 12a2  .d...g.d...g.d..
-00000fd0: 0167 0064 13a2 0167 0064 14a2 0167 0064  .g.d...g.d...g.d
-00000fe0: 15a2 0167 0064 16a2 0167 0064 17a2 0167  ...g.d...g.d...g
-00000ff0: 0064 18a2 0167 0064 19a2 0167 0064 1aa2  .d...g.d...g.d..
-00001000: 0167 0064 1ba2 0167 0064 1ca2 0164 1d67  .g.d...g.d...d.g
-00001010: 0167 0064 1ea2 0167 0064 1fa2 0167 0064  .g.d...g.d...g.d
-00001020: 20a2 0167 0064 21a2 0167 0064 22a2 0167   ..g.d!..g.d"..g
-00001030: 0064 23a2 0164 2467 0167 0064 25a2 0164  .d#..d$g.g.d%..d
-00001040: 269c 177d 0e64 2764 2884 007c 0ea0 0ca1  &..}.d'd(..|....
-00001050: 0044 0083 017d 0f7c 0d64 2919 00a0 0d7c  .D...}.|.d)....|
-00001060: 0fa1 017c 0d64 293c 0074 087c 0d64 0a19  ...|.d)<.t.|.d..
-00001070: 00a0 0aa1 0083 0189 0174 0ea0 0f88 01a1  .........t......
-00001080: 0189 0087 0087 0166 0264 2a64 2b84 087c  .......f.d*d+..|
-00001090: 0444 0083 017d 1074 107c 0d7c 1083 027d  .D...}.t.|.|...}
-000010a0: 0d7c 0564 2c6b 0390 0272 1a7c 0d6a 1144  .|.d,k...r.|.j.D
-000010b0: 005d 2c7d 117c 1164 2d76 0090 0172 fe90  .],}.|.d-v...r..
-000010c0: 0171 ec7c 0da0 1264 09a1 017c 1119 00a0  .q.|...d...|....
-000010d0: 137c 05a1 017c 0d7c 113c 0090 0171 ec7c  .|...|.|.<...q.|
-000010e0: 0d53 0029 2e4e fa01 2fe9 fcff ffff 7a1b  .S.).N../.....z.
-000010f0: 5b2b 5d20 6c6f 6164 5f69 6e64 7573 7472  [+] load_industr
-00001100: 792c 206e 6461 7973 203d 20da 066f 626a  y, ndays = ..obj
-00001110: 6563 745a 0569 6e74 3332 724b 0000 0029  ectZ.int32rK...)
-00001120: 04da 0774 735f 636f 6465 da0a 7472 6164  ...ts_code..trad
-00001130: 655f 6461 7465 da08 696e 6475 7374 7279  e_date..industry
-00001140: 7236 0000 0029 035a 0775 7365 636f 6c73  r6...).Z.usecols
-00001150: 7234 0000 0072 2700 0000 725b 0000 0072  r4...r'...r[...r
-00001160: 5c00 0000 da04 6c61 7374 2901 5a04 6b65  \.....last).Z.ke
-00001170: 6570 54a9 0172 3200 0000 2905 7508 0000  epT..r2...).u...
-00001180: 0049 54e8 aebe e5a4 8775 0900 0000 e585  .IT......u......
-00001190: 83e5 99a8 e4bb b675 0900 0000 e58d 8ae5  .......u........
-000011a0: afbc e4bd 9375 0c00 0000 e794 b5e5 99a8  .....u..........
-000011b0: e4bb aae8 a1a8 750c 0000 00e9 809a e4bf  ......u.........
-000011c0: a1e8 aebe e5a4 8729 0975 0c00 0000 e4b8  .......).u......
-000011d0: 93e7 94a8 e69c bae6 a2b0 750c 0000 00e5  ..........u.....
-000011e0: 869c e794 a8e6 9cba e6a2 b075 0c00 0000  ...........u....
-000011f0: e58c 96e5 b7a5 e69c bae6 a2b0 750c 0000  ............u...
-00001200: 00e5 b7a5 e7a8 8be6 9cba e6a2 b075 0c00  .............u..
-00001210: 0000 e69c bae5 ba8a e588 b6e9 80a0 750c  ..............u.
-00001220: 0000 00e6 9cba e6a2 b0e5 9fba e4bb b675  ...............u
-00001230: 0c00 0000 e794 b5e6 b094 e8ae bee5 a487  ................
-00001240: 750c 0000 00e7 baba e7bb 87e6 9cba e6a2  u...............
-00001250: b075 0c00 0000 e8bd bbe5 b7a5 e69c bae6  .u..............
-00001260: a2b0 2905 7509 0000 00e4 b8ad e688 90e8  ..).u...........
-00001270: 8daf 750c 0000 00e5 8c96 e5ad a6e5 88b6  ..u.............
-00001280: e88d af75 0c00 0000 e58c bbe7 9697 e4bf  ...u............
-00001290: 9de5 81a5 750c 0000 00e5 8cbb e88d afe5  ....u...........
-000012a0: 9586 e4b8 9a75 0c00 0000 e794 9fe7 89a9  .....u..........
-000012b0: e588 b6e8 8daf 2906 7509 0000 00e4 b9b3  ......).u.......
-000012c0: e588 b6e5 9381 7506 0000 00e5 95a4 e985  ......u.........
-000012d0: 9275 0600 0000 e799 bde9 8592 7509 0000  .u..........u...
-000012e0: 00e7 baa2 e9bb 84e9 8592 7509 0000 00e8  ..........u.....
-000012f0: bdaf e9a5 aee6 9699 7506 0000 00e9 a39f  ........u.......
-00001300: e593 8129 0375 0900 0000 e4ba 92e8 8194  ...).u..........
-00001310: e7bd 9175 0c00 0000 e794 b5e4 bfa1 e8bf  ...u............
-00001320: 90e8 90a5 750c 0000 00e8 bdaf e4bb b6e6  ....u...........
-00001330: 9c8d e58a a129 0b75 0c00 0000 e4bb 93e5  .....).u........
-00001340: 82a8 e789 a9e6 b581 750c 0000 00e5 85ac  ........u.......
-00001350: e585 b1e4 baa4 e980 9a75 0600 0000 e585  .........u......
-00001360: ace8 b7af 7506 0000 00e6 9cba e59c ba75  ....u..........u
-00001370: 0600 0000 e6b0 b4e8 bf90 7506 0000 00e6  ..........u.....
-00001380: b8af e58f a375 0600 0000 e7a9 bae8 bf90  .....u..........
-00001390: 7506 0000 00e8 88aa e7a9 ba75 0600 0000  u..........u....
-000013a0: e888 b9e8 88b6 750c 0000 00e8 bf90 e8be  ......u.........
-000013b0: 93e8 aebe e5a4 8775 0600 0000 e993 81e8  .......u........
-000013c0: b7af 2903 750c 0000 00e4 be9b e6b0 94e4  ..).u...........
-000013d0: be9b e783 ad75 0600 0000 e6b0 b4e5 8aa1  .....u..........
-000013e0: 750c 0000 00e7 8eaf e5a2 83e4 bf9d e68a  u...............
-000013f0: a429 0475 0600 0000 e4bf 9de9 99a9 750c  .).u..........u.
-00001400: 0000 00e5 a49a e585 83e9 8791 e89e 8d75  ...............u
-00001410: 0600 0000 e8af 81e5 88b8 7506 0000 00e9  ..........u.....
-00001420: 93b6 e8a1 8c29 0475 0c00 0000 e585 a8e5  .....).u........
-00001430: 9bbd e59c b0e4 baa7 750c 0000 00e5 8cba  ........u.......
-00001440: e59f 9fe5 9cb0 e4ba a775 0c00 0000 e59b  .........u......
-00001450: ade5 8cba e5bc 80e5 8f91 750c 0000 00e6  ..........u.....
-00001460: 88bf e4ba a7e6 9c8d e58a a129 0875 0c00  ...........).u..
-00001470: 0000 e585 b6e4 bb96 e595 86e4 b89a 7509  ..............u.
-00001480: 0000 00e5 9586 e593 81e5 9f8e 750c 0000  ............u...
-00001490: 00e5 9586 e8b4 b8e4 bba3 e790 8675 0c00  .............u..
-000014a0: 0000 e794 b5e5 99a8 e8bf 9ee9 9481 7509  ..............u.
-000014b0: 0000 00e6 89b9 e58f 91e4 b89a 750c 0000  ............u...
-000014c0: 00e8 b685 e5b8 82e8 bf9e e994 8175 0600  .............u..
-000014d0: 0000 e799 bee8 b4a7 750c 0000 00e5 b9bf  ........u.......
-000014e0: e591 8ae5 8c85 e8a3 8529 0575 0c00 0000  .........).u....
-000014f0: e585 b6e4 bb96 e5bb bae6 9d90 7506 0000  ............u...
-00001500: 00e5 bbba e69d 9075 0600 0000 e6b0 b4e6  .......u........
-00001510: b3a5 7506 0000 00e7 8ebb e792 8375 0600  ..u..........u..
-00001520: 0000 e999 b6e7 93b7 2905 750c 0000 00e5  ........).u.....
-00001530: 869c e4b8 9ae7 bbbc e590 8875 0600 0000  ...........u....
-00001540: e69e 97e4 b89a 7506 0000 00e6 b894 e4b8  ......u.........
-00001550: 9a75 0900 0000 e7a7 8de6 a48d e4b8 9a75  .u.............u
-00001560: 0600 0000 e9a5 b2e6 9699 2907 750c 0000  ..........).u...
-00001570: 00e5 869c e88d afe5 8c96 e882 a575 0c00  .............u..
-00001580: 0000 e58c 96e5 b7a5 e58e 9fe6 9699 7506  ..............u.
-00001590: 0000 00e5 8c96 e7ba a475 0c00 0000 e697  .........u......
-000015a0: a5e7 94a8 e58c 96e5 b7a5 750c 0000 00e6  ..........u.....
-000015b0: 9f93 e696 99e6 b682 e696 9975 0600 0000  ...........u....
-000015c0: e5a1 91e6 9699 7506 0000 00e6 a9a1 e883  ......u.........
-000015d0: b629 0375 0900 0000 e587 bae7 8988 e4b8  .).u............
-000015e0: 9a75 0c00 0000 e5bd b1e8 a786 e99f b3e5  .u..............
-000015f0: 838f 750c 0000 00e6 9687 e695 99e4 bc91  ..u.............
-00001600: e997 b275 0c00 0000 e5ae b6e7 94a8 e794  ...u............
-00001610: b5e5 99a8 2908 7509 0000 00e5 b08f e987  ....).u.........
-00001620: 91e5 b19e 7506 0000 00e6 99ae e992 a275  ....u..........u
-00001630: 0900 0000 e789 b9e7 a78d e992 a275 0900  .............u..
-00001640: 0000 e992 a2e5 8aa0 e5b7 a575 0600 0000  ...........u....
-00001650: e993 85e9 948c 7503 0000 00e9 939c 7503  ......u.......u.
-00001660: 0000 00e9 939d 7506 0000 00e9 bb84 e987  ......u.........
-00001670: 9129 0375 0c00 0000 e5bb bae7 ad91 e5b7  .).u............
-00001680: a5e7 a88b 750c 0000 00e8 a385 e4bf aee8  ....u...........
-00001690: a385 e9a5 b075 0600 0000 e8b7 afe6 a1a5  .....u..........
-000016a0: 2904 750c 0000 00e5 aeb6 e5b1 85e7 94a8  ).u.............
-000016b0: e593 8175 0600 0000 e69c 8de9 a5b0 7506  ...u..........u.
-000016c0: 0000 00e9 80a0 e7ba b875 0600 0000 e7ba  .........u......
-000016d0: bae7 bb87 2904 7509 0000 00e6 91a9 e689  ....).u.........
-000016e0: 98e8 bda6 750c 0000 00e6 b1bd e8bd a6e6  ....u...........
-000016f0: 95b4 e8bd a675 0c00 0000 e6b1 bde8 bda6  .....u..........
-00001700: e69c 8de5 8aa1 750c 0000 00e6 b1bd e8bd  ......u.........
-00001710: a6e9 858d e4bb b629 0675 0c00 0000 e696  .......).u......
-00001720: b0e5 9e8b e794 b5e5 8a9b 750c 0000 00e6  ..........u.....
-00001730: b0b4 e58a 9be5 8f91 e794 b575 0c00 0000  ...........u....
-00001740: e781 abe5 8a9b e58f 91e7 94b5 750c 0000  ............u...
-00001750: 00e7 84a6 e782 ade5 8aa0 e5b7 a575 0c00  .............u..
-00001760: 0000 e79f b3e6 b2b9 e58a a0e5 b7a5 750c  ..............u.
-00001770: 0000 00e7 9fb3 e6b2 b9e8 b4b8 e698 9329  ...............)
-00001780: 0375 0c00 0000 e785 a4e7 82ad e5bc 80e9  .u..............
-00001790: 8787 750c 0000 00e7 9fb3 e6b2 b9e5 bc80  ..u.............
-000017a0: e987 8775 0c00 0000 e79f bfe7 89a9 e588  ...u............
-000017b0: b6e5 9381 7509 0000 00e7 bbbc e590 88e7  ....u...........
-000017c0: b1bb 2903 750c 0000 00e6 9785 e6b8 b8e6  ..).u...........
-000017d0: 99af e782 b975 0c00 0000 e697 85e6 b8b8  .....u..........
-000017e0: e69c 8de5 8aa1 750c 0000 00e9 8592 e5ba  ......u.........
-000017f0: 97e9 a490 e9a5 ae29 1775 0c00 0000 e7a7  .......).u......
-00001800: 91e6 8a80 e794 b5e5 ad90 750c 0000 00e6  ..........u.....
-00001810: 9cba e6a2 b0e8 aebe e5a4 8775 0c00 0000  ...........u....
-00001820: e58c bbe8 8daf e794 9fe7 89a9 750c 0000  ............u...
-00001830: 00e9 a39f e593 81e9 a5ae e696 9975 0c00  .............u..
-00001840: 0000 e4bf a1e6 81af e68a 80e6 9caf 750c  ..............u.
-00001850: 0000 00e4 baa4 e980 9ae7 89a9 e6b5 8175  ...............u
-00001860: 0c00 0000 e585 ace7 94a8 e4ba 8be4 b89a  ................
-00001870: 750c 0000 00e9 8791 e89e 8de6 9c8d e58a  u...............
-00001880: a175 0900 0000 e688 bfe5 9cb0 e4ba a775  .u.............u
-00001890: 0c00 0000 e595 86e4 b89a e69c 8de5 8aa1  ................
-000018a0: 750c 0000 00e5 bbba e7ad 91e6 9d90 e696  u...............
-000018b0: 9975 0c00 0000 e586 9ce6 9e97 e789 a7e6  .u..............
-000018c0: b894 7506 0000 00e5 8c96 e5b7 a575 0c00  ..u..........u..
-000018d0: 0000 e696 87e5 8c96 e4bc a0e5 aa92 750c  ..............u.
-000018e0: 0000 00e6 b688 e8b4 b9e7 94b5 e5ad 9075  ...............u
-000018f0: 0c00 0000 e987 91e5 b19e e79f bfe4 baa7  ................
-00001900: 750c 0000 00e5 bbba e7ad 91e8 a385 e6bd  u...............
-00001910: a275 0c00 0000 e8bd bbe5 b7a5 e588 b6e9  .u..............
-00001920: 80a0 750c 0000 00e6 b1bd e8bd a6e5 88b6  ..u.............
-00001930: e980 a075 0600 0000 e883 bde6 ba90 750c  ...u..........u.
-00001940: 0000 00e7 9fbf e4ba a7e8 b584 e6ba 9075  ...............u
-00001950: 0600 0000 e7bb bce5 9088 750c 0000 00e4  ..........u.....
-00001960: bc91 e997 b2e6 9c8d e58a a163 0100 0000  ...........c....
-00001970: 0000 0000 0000 0000 0400 0000 0500 0000  ................
-00001980: 5300 0000 7320 0000 0069 007c 005d 185c  S...s ...i.|.].\
-00001990: 027d 017d 027c 0244 005d 0a7d 037c 037c  .}.}.|.D.].}.|.|
-000019a0: 0193 0371 1071 0453 0072 1200 0000 7212  ...q.q.S.r....r.
-000019b0: 0000 0029 0472 1000 0000 da01 6bda 0276  ...).r......k..v
-000019c0: 73da 0176 7212 0000 0072 1200 0000 7213  s..vr....r....r.
-000019d0: 0000 00da 0a3c 6469 6374 636f 6d70 3e82  .....<dictcomp>.
-000019e0: 0000 0072 1500 0000 7a25 6c6f 6164 5f64  ...r....z%load_d
-000019f0: 665f 6261 6b5f 6261 7369 632e 3c6c 6f63  f_bak_basic.<loc
-00001a00: 616c 733e 2e3c 6469 6374 636f 6d70 3e72  als>.<dictcomp>r
-00001a10: 5d00 0000 6301 0000 0000 0000 0000 0000  ]...c...........
-00001a20: 0002 0000 0004 0000 0013 0000 0073 2800  .............s(.
-00001a30: 0000 6700 7c00 5d20 7d01 7c01 8801 7601  ..g.|.] }.|...v.
-00001a40: 7204 7c01 6400 6b05 7204 7c01 8800 6b05  r.|.d.k.r.|...k.
-00001a50: 7204 7c01 9102 7104 5300 2901 69f3 a133  r.|...q.S.).i..3
-00001a60: 0172 1200 0000 720f 0000 00a9 025a 0864  .r....r......Z.d
-00001a70: 6174 655f 6d61 785a 0b64 6174 6573 5f65  ate_maxZ.dates_e
-00001a80: 7869 7374 7212 0000 0072 1300 0000 723d  xistr....r....r=
-00001a90: 0000 0087 0000 0072 1500 0000 7a25 6c6f  .......r....z%lo
-00001aa0: 6164 5f64 665f 6261 6b5f 6261 7369 632e  ad_df_bak_basic.
-00001ab0: 3c6c 6f63 616c 733e 2e3c 6c69 7374 636f  <locals>.<listco
-00001ac0: 6d70 3e72 0100 0000 2902 725b 0000 0072  mp>r....).r[...r
-00001ad0: 5c00 0000 2914 720e 0000 00da 0673 6f72  \...).r......sor
-00001ae0: 7465 64da 026f 73da 076c 6973 7464 6972  ted..os..listdir
-00001af0: da06 6170 7065 6e64 7250 0000 0072 3e00  ..appendrP...r>.
-00001b00: 0000 721f 0000 00da 046c 6973 7472 4000  ..r......listr@.
-00001b10: 0000 5a0f 6472 6f70 5f64 7570 6c69 6361  ..Z.drop_duplica
-00001b20: 7465 7372 4a00 0000 da05 6974 656d 73da  tesrJ.....items.
-00001b30: 036d 6170 7237 0000 00da 036d 6178 da09  .mapr7.....max..
-00001b40: 6466 5f65 7870 616e 6472 4f00 0000 da07  df_expandrO.....
-00001b50: 6772 6f75 7062 79da 0573 6869 6674 2912  groupby..shift).
-00001b60: 7224 0000 0072 2500 0000 7226 0000 0072  r$...r%...r&...r
-00001b70: 2700 0000 da05 6461 7465 7372 2800 0000  '.....datesr(...
-00001b80: 5a09 7965 6172 5f6c 6973 74da 0970 6174  Z.year_list..pat
-00001b90: 685f 6c69 7374 5a09 6461 7465 5f6c 6973  h_listZ.date_lis
-00001ba0: 74da 0479 6561 725a 0966 696c 655f 6c69  t..yearZ.file_li
-00001bb0: 7374 720b 0000 0072 3400 0000 7251 0000  str....r4...rQ..
-00001bc0: 005a 0a69 6e64 5f72 6564 7563 655a 0669  .Z.ind_reduceZ.i
-00001bd0: 6e64 5f6b 76da 0964 6174 6573 5f61 6464  nd_kv..dates_add
-00001be0: 723b 0000 0072 1200 0000 7264 0000 0072  r;...r....rd...r
-00001bf0: 1300 0000 da11 6c6f 6164 5f64 665f 6261  ......load_df_ba
-00001c00: 6b5f 6261 7369 6354 0000 0073 6a00 0000  k_basicT...sj...
-00001c10: 0001 1201 0e01 0401 0401 0801 1a01 0801  ................
-00001c20: 2001 1a01 1602 1202 0201 0201 0201 02fc   ...............
-00001c30: 0606 1801 1a02 0601 0601 0601 0601 0601  ................
-00001c40: 0601 0601 0601 0601 0601 0601 0601 0601  ................
-00001c50: 0601 0401 0601 0601 0601 0601 0601 0601  ................
-00001c60: 0401 06e9 0619 1201 1202 1001 0a01 1401  ................
-00001c70: 0a03 0a01 0a01 0e01 1c01 7274 0000 0072  ..........rt...r
-00001c80: 5c00 0000 6303 0000 0000 0000 0000 0000  \...c...........
-00001c90: 0009 0000 0005 0000 0043 0000 0073 c400  .........C...s..
-00001ca0: 0000 7400 7c01 8301 6401 6b02 7210 7c00  ..t.|...d.k.r.|.
-00001cb0: 5300 7401 6402 7c01 9b00 9d02 8301 0100  S.t.d.|.........
-00001cc0: 6700 7d03 7c00 7c00 7c02 1900 7c00 7c02  g.}.|.|.|...|.|.
-00001cd0: 1900 a002 a100 6b02 1900 7d04 7c01 4400  ......k...}.|.D.
-00001ce0: 5d4e 7d05 7c04 a003 a100 7d06 7c05 7c06  ]N}.|.....}.|.|.
-00001cf0: 6403 3c00 7404 7c06 6a05 6404 6400 8502  d.<.t.|.j.d.d...
-00001d00: 1900 8301 7d07 7c07 4400 5d18 7d08 7c08  ....}.|.D.].}.|.
-00001d10: 6405 6b02 7276 7168 7406 6a07 7c06 7c08  d.k.rvqht.j.|.|.
-00001d20: 3c00 7168 7c03 a008 7c06 a101 0100 713e  <.qh|...|.....q>
-00001d30: 7409 6a0a 7c03 6401 6406 8d02 6a0b 6407  t.j.|.d.d...j.d.
-00001d40: 6408 8d01 7d06 7409 6a0a 7c00 7c06 6702  d...}.t.j.|.|.g.
-00001d50: 6401 6409 640a 8d03 6a0b 6407 6408 8d01  d.d.d...j.d.d...
-00001d60: 7d00 7c00 5300 290b 4e72 0100 0000 7a0d  }.|.S.).Nr....z.
-00001d70: 5b2b 5d20 6578 7061 6e64 203d 2072 5c00  [+] expand = r\.
-00001d80: 0000 e902 0000 00da 046f 7065 6e29 01da  .........open)..
-00001d90: 0461 7869 7354 725f 0000 0046 2902 7277  .axisTr_...F).rw
-00001da0: 0000 0072 3800 0000 290c 723e 0000 0072  ...r8...).r>...r
-00001db0: 5000 0000 726c 0000 00da 0463 6f70 7972  P...rl.....copyr
-00001dc0: 6900 0000 724f 0000 0072 3700 0000 da03  i...rO...r7.....
-00001dd0: 6e61 6e72 6800 0000 da02 7064 da06 636f  nanrh.....pd..co
-00001de0: 6e63 6174 724a 0000 0029 0972 5100 0000  ncatrJ...).rQ...
-00001df0: 7273 0000 0072 4600 0000 5a0c 6466 5f6e  rs...rF...Z.df_n
-00001e00: 6578 745f 6c69 7374 5a07 6466 5f63 6f70  ext_listZ.df_cop
-00001e10: 79da 0464 6174 655a 0764 665f 6e65 7874  y..dateZ.df_next
-00001e20: da04 636f 6c73 723b 0000 0072 1200 0000  ..colsr;...r....
-00001e30: 7212 0000 0072 1300 0000 726d 0000 0091  r....r....rm....
-00001e40: 0000 0073 1e00 0000 0001 1001 0e02 0401  ...s............
-00001e50: 1801 0801 0801 0801 1201 0801 0a01 0c01  ................
-00001e60: 0c01 1601 1c01 726d 0000 0063 0000 0000  ......rm...c....
-00001e70: 0000 0000 0000 0000 0000 0000 0300 0000  ................
-00001e80: 4000 0000 731a 0000 0065 005a 0164 005a  @...s....e.Z.d.Z
-00001e90: 0267 0064 0166 0264 0264 0384 015a 0364  .g.d.f.d.d...Z.d
-00001ea0: 0453 0029 05da 0c42 616b 4261 7369 6344  .S.)...BakBasicD
-00001eb0: 6174 6172 2100 0000 6307 0000 0000 0000  atar!...c.......
-00001ec0: 0000 0000 0007 0000 0007 0000 0043 0000  .............C..
-00001ed0: 0073 1200 0000 7400 7c01 7c02 7c03 7c04  .s....t.|.|.|.|.
-00001ee0: 7c05 7c06 8306 5300 720d 0000 0029 0172  |.|...S.r....).r
-00001ef0: 7400 0000 2907 7223 0000 0072 2400 0000  t...).r#...r$...
-00001f00: 7225 0000 0072 2600 0000 7227 0000 0072  r%...r&...r'...r
-00001f10: 7000 0000 7228 0000 0072 1200 0000 7212  p...r(...r....r.
-00001f20: 0000 0072 1300 0000 7229 0000 00a4 0000  ...r....r)......
-00001f30: 0073 0200 0000 0001 7a13 4261 6b42 6173  .s......z.BakBas
-00001f40: 6963 4461 7461 2e67 6574 5f64 664e 2904  icData.get_dfN).
-00001f50: 7255 0000 0072 5600 0000 7257 0000 0072  rU...rV...rW...r
-00001f60: 2900 0000 7212 0000 0072 1200 0000 7212  )...r....r....r.
-00001f70: 0000 0072 1300 0000 727e 0000 00a3 0000  ...r....r~......
-00001f80: 0073 0200 0000 0801 727e 0000 0029 0172  .s......r~...).r
-00001f90: 5c00 0000 2921 7266 0000 00da 056e 756d  \...)!rf.....num
-00001fa0: 7079 7237 0000 00da 0670 616e 6461 7372  pyr7.....pandasr
-00001fb0: 7a00 0000 da06 706f 6c61 7273 da02 706c  z.....polars..pl
-00001fc0: da08 7275 6e6e 696e 677a 724c 0000 005a  ..runningzrL...Z
-00001fd0: 0f63 6f72 652e 4461 7461 4d61 7374 6572  .core.DataMaster
-00001fe0: 7203 0000 005a 0975 7469 6c2e 7574 696c  r....Z.util.util
-00001ff0: 7204 0000 0072 0500 0000 7206 0000 005a  r....r....r....Z
-00002000: 0875 7469 6c2e 6e70 7972 0700 0000 5a0e  .util.npyr....Z.
-00002010: 7574 696c 2e6e 7079 5f6e 756d 6261 7208  util.npy_numbar.
-00002020: 0000 0072 0900 0000 5a07 7574 696c 2e64  ...r....Z.util.d
-00002030: 6272 0a00 0000 7250 0000 0072 1700 0000  br....rP...r....
-00002040: 5a0a 7574 696c 2e63 6f6e 7374 721d 0000  Z.util.constr...
-00002050: 0072 1e00 0000 5a08 7574 696c 2e63 7376  .r....Z.util.csv
-00002060: 721f 0000 0072 2000 0000 7274 0000 0072  r....r ...rt...r
-00002070: 6d00 0000 727e 0000 0072 1200 0000 7212  m...r~...r....r.
-00002080: 0000 0072 1200 0000 7213 0000 00da 083c  ...r....r......<
-00002090: 6d6f 6475 6c65 3e01 0000 0073 2400 0000  module>....s$...
-000020a0: 0801 0801 0801 0801 0801 0c01 1401 0c01  ................
-000020b0: 1001 0c01 0401 0802 0c01 0c01 0c03 0e41  ...............A
-000020c0: 103d 0a12                                .=..
+000000e0: 640f 6410 6604 6411 6412 8401 5a1e 6418  d.d.f.d.d...Z.d.
+000000f0: 6414 6415 8401 5a1f 4700 6416 6417 8400  d.d...Z.G.d.d...
+00000100: 6417 651d 8303 5a20 6401 5300 2919 e900  d.e...Z d.S.)...
+00000110: 0000 004e e903 0000 0029 01da 0a44 6174  ...N.....)...Dat
+00000120: 614d 6173 7465 7229 03da 066c 6f67 6765  aMaster)...logge
+00000130: 72da 056d 6572 6765 da0d 636f 6465 5f32  r..merge..code_2
+00000140: 5f6d 6172 6b65 7429 01da 0d67 6574 5f64  _market)...get_d
+00000150: 665f 6964 5f61 6c6c 2902 da0c 6e70 5f73  f_id_all)...np_s
+00000160: 6869 6674 5f72 6177 da08 6e70 5f73 6869  hift_raw..np_shi
+00000170: 6674 2901 da08 4442 4d61 7374 6572 6300  ft)...DBMasterc.
+00000180: 0000 0000 0000 0000 0000 0002 0000 0006  ................
+00000190: 0000 004f 0000 0073 2e00 0000 7c01 a000  ...O...s....|...
+000001a0: 6401 6402 a102 6402 6b03 7214 7401 5300  d.d...d.k.r.t.S.
+000001b0: 7402 a003 6403 a004 6404 6405 8400 7c00  t...d...d.d...|.
+000001c0: 4400 8301 a101 a101 5300 2906 4eda 0466  D.......S.).N..f
+000001d0: 696c 657a 0a73 7973 2e73 7464 6f75 74fa  ilez.sys.stdout.
+000001e0: 0120 6301 0000 0000 0000 0000 0000 0002  . c.............
+000001f0: 0000 0003 0000 0073 0000 0073 1600 0000  .......s...s....
+00000200: 7c00 5d0e 7d01 7400 7c01 8301 5600 0100  |.].}.t.|...V...
+00000210: 7102 6400 5300 a901 4e29 01da 0373 7472  q.d.S...N)...str
+00000220: a902 da02 2e30 da01 78a9 0072 1200 0000  .....0..x..r....
+00000230: fa4a 6275 696c 642f 6264 6973 742e 6d61  .Jbuild/bdist.ma
+00000240: 636f 7378 2d31 302e 392d 7838 365f 3634  cosx-10.9-x86_64
+00000250: 2f65 6767 2f72 756e 6e69 6e67 7a2f 6665  /egg/runningz/fe
+00000260: 2f70 7265 7061 7265 5f64 6174 612f 6661  /prepare_data/fa
+00000270: 6374 6f72 5f64 6174 612e 7079 da09 3c67  ctor_data.py..<g
+00000280: 656e 6578 7072 3e0d 0000 00f3 0000 0000  enexpr>.........
+00000290: 7a1b 3c6c 616d 6264 613e 2e3c 6c6f 6361  z.<lambda>.<loca
+000002a0: 6c73 3e2e 3c67 656e 6578 7072 3e29 05da  ls>.<genexpr>)..
+000002b0: 0367 6574 da06 5f70 7269 6e74 7204 0000  .get.._printr...
+000002c0: 00da 0469 6e66 6fda 046a 6f69 6e29 02da  ...info..join)..
+000002d0: 0461 7267 73da 066b 7761 7267 7372 1200  .args..kwargsr..
+000002e0: 0000 7212 0000 0072 1300 0000 da08 3c6c  ..r....r......<l
+000002f0: 616d 6264 613e 0c00 0000 7302 0000 0014  ambda>....s.....
+00000300: 0172 1c00 0000 2901 da05 434f 4e53 5429  .r....)...CONST)
+00000310: 01da 086d 795f 7072 696e 7429 01da 1372  ...my_print)...r
+00000320: 6561 645f 6373 765f 6c69 7374 5f6e 6a6f  ead_csv_list_njo
+00000330: 6273 6300 0000 0000 0000 0000 0000 0000  bsc.............
+00000340: 0000 0003 0000 0040 0000 0073 2000 0000  .......@...s ...
+00000350: 6500 5a01 6400 5a02 6408 6402 6403 8401  e.Z.d.Z.d.d.d...
+00000360: 5a03 6409 6406 6407 8401 5a04 6404 5300  Z.d.d.d...Z.d.S.
+00000370: 290a da0a 4661 6374 6f72 4461 7461 e901  )...FactorData..
+00000380: 0000 0063 0600 0000 0000 0000 0000 0000  ...c............
+00000390: 0600 0000 0200 0000 4300 0000 730c 0000  ........C...s...
+000003a0: 0074 0064 0183 0182 0164 0053 0029 024e  .t.d.....d.S.).N
+000003b0: 7a1e 796f 7520 6e65 6564 2074 6f20 696d  z.you need to im
+000003c0: 706c 656d 656e 7420 6765 745f 6466 2829  plement get_df()
+000003d0: 2901 da13 4e6f 7449 6d70 6c65 6d65 6e74  )...NotImplement
+000003e0: 6564 4572 726f 7229 06da 0473 656c 66da  edError)...self.
+000003f0: 0a70 6174 685f 696e 7075 74da 0a64 6174  .path_input..dat
+00000400: 655f 6265 6769 6eda 0864 6174 655f 656e  e_begin..date_en
+00000410: 64da 066e 5f6a 6f62 73da 0773 6869 6674  d..n_jobs..shift
+00000420: 5f69 7212 0000 0072 1200 0000 7213 0000  _ir....r....r...
+00000430: 00da 0667 6574 5f64 6614 0000 0073 0200  ...get_df....s..
+00000440: 0000 0001 7a11 4661 6374 6f72 4461 7461  ....z.FactorData
+00000450: 2e67 6574 5f64 664e 5463 0400 0000 0000  .get_dfNTc......
+00000460: 0000 0000 0000 1900 0000 0700 0000 0300  ................
+00000470: 0000 73e4 0200 0074 006a 017d 047c 0164  ..s....t.j.}.|.d
+00000480: 0119 007d 057c 0164 0219 007d 067c 0164  ...}.|.d...}.|.d
+00000490: 0319 007d 077c 0164 0419 007d 087c 0764  ...}.|.d...}.|.d
+000004a0: 0519 0089 007c 0764 0619 007d 097c 0764  .....|.d...}.|.d
+000004b0: 0719 007d 0a7c 0764 0819 0089 0188 0188  ...}.|.d........
+000004c0: 0067 027d 0b7c 0264 0075 0072 707c 006a  .g.}.|.d.u.rp|.j
+000004d0: 027c 0467 017c 0564 0919 00a2 017c 0691  .|.g.|.d.....|..
+000004e0: 0152 008e 007d 0264 0a74 0374 047c 0283  .R...}.d.t.t.|..
+000004f0: 0183 0176 0072 867c 027d 0c6e 1c7c 026a  ...v.r.|.}.n.|.j
+00000500: 0564 0b64 0b64 0c8d 0201 0074 067c 0264  .d.d.d.....t.|.d
+00000510: 0d64 0b64 0e8d 037d 0c7c 0c6a 0788 0167  .d.d...}.|.j...g
+00000520: 0164 0d64 0f8d 0201 007c 0ca0 0864 1074  .d.d.....|...d.t
+00000530: 096a 0a74 0b7c 0c83 0174 096a 0c64 118d  .j.t.|...t.j.d..
+00000540: 02a1 0201 0064 1264 1367 027d 0d7c 0ca0  .....d.d.g.}.|..
+00000550: 0d7c 0ba1 0189 0387 0366 0164 1464 1584  .|.......f.d.d..
+00000560: 087c 0b44 0083 017d 0e64 1664 1584 007c  .|.D...}.d.d...|
+00000570: 0e44 0083 017d 0f74 0e7c 0e7c 0b64 178d  .D...}.t.|.|.d..
+00000580: 02a0 0f88 037c 0b19 006a 10a0 11a1 00a1  .....|...j......
+00000590: 017d 1074 126a 137c 107c 0ca0 0d7c 0b7c  .}.t.j.|.|...|.|
+000005a0: 0d17 00a1 017c 0b64 188d 03a0 14a1 007d  .....|.d.......}
+000005b0: 117c 1164 1219 007c 1164 1319 0014 0064  .|.d...|.d.....d
+000005c0: 1914 007c 1164 1a3c 0074 09a0 1574 09a0  ...|.d.<.t...t..
+000005d0: 167c 1164 1a19 0064 1b17 00a1 0164 1c64  .|.d...d.....d.d
+000005e0: 1da1 037c 1164 1e3c 0074 12a0 067c 11a1  ...|.d.<.t...|..
+000005f0: 017d 127c 126a 0764 1f88 019b 0064 209d  .}.|.j.d.....d .
+00000600: 0367 0164 0d64 0f8d 0201 007c 126a 0764  .g.d.d.....|.j.d
+00000610: 2188 019b 0064 229d 0367 0164 0d64 0f8d  !....d"..g.d.d..
+00000620: 0201 007c 12a0 1764 1ea1 017c 1164 233c  ...|...d...|.d#<
+00000630: 0064 2367 017d 1374 126a 1388 037c 117c  .d#g.}.t.j...|.|
+00000640: 0b7c 1317 0019 007c 0b64 188d 03a0 14a1  .|.....|.d......
+00000650: 007d 147c 1344 005d 167d 157c 0ca0 087c  .}.|.D.].}.|...|
+00000660: 157c 147c 1519 00a1 0201 0090 0171 e064  .|.|.........q.d
+00000670: 2464 1584 007c 0ca0 18a1 006a 1944 0083  $d...|.....j.D..
+00000680: 017d 1664 2564 1584 007c 0ca0 18a1 006a  .}.d%d...|.....j
+00000690: 1944 0083 017d 177c 0390 0272 2e74 1a64  .D...}.|...r.t.d
+000006a0: 2683 0101 007c 08a0 1b64 2764 1ba1 0289  &....|...d'd....
+000006b0: 047c 0390 0272 4e74 1a64 2888 049b 009d  .|...rNt.d(.....
+000006c0: 0283 0101 0088 0088 017c 0967 037c 0a17  .........|.g.|..
+000006d0: 007c 1617 007c 1717 007c 08a0 1b64 2964  .|...|...|...d)d
+000006e0: 00a1 0267 0117 0089 0288 027c 08a0 1b64  ...g.......|...d
+000006f0: 2a67 00a1 0237 0089 0288 027c 0864 2a3c  *g...7.....|.d*<
+00000700: 007c 0390 0272 9e74 1a64 2b88 029b 009d  .|...r.t.d+.....
+00000710: 0283 0101 0087 0266 0164 2c64 1584 087c  .......f.d,d...|
+00000720: 0ca0 18a1 006a 1944 0083 017d 1888 0464  .....j.D...}...d
+00000730: 2d6b 0390 0272 e07c 0c6a 0787 0087 0187  -k...r.|.j......
+00000740: 0466 0364 2e64 1584 087c 1844 0083 017c  .f.d.d...|.D...|
+00000750: 0364 0f8d 0201 007c 0c53 0029 2f4e da09  .d.....|.S.)/N..
+00000760: 6461 7465 5f64 6963 7472 2700 0000 da09  date_dictr'.....
+00000770: 636f 6c73 5f64 6963 74da 0a6f 7468 6572  cols_dict..other
+00000780: 5f69 6e66 6fda 0663 6f6c 5f69 64da 0963  _info..col_id..c
+00000790: 6f6c 5f6c 6162 656c da08 636f 6c73 5f74  ol_label..cols_t
+000007a0: 6964 da07 636f 6c5f 7469 64da 0361 6c6c  id..col_tid..all
+000007b0: 7203 0000 0054 2902 da04 6472 6f70 5a07  r....T)...dropZ.
+000007c0: 696e 706c 6163 6546 2902 da07 7665 7262  inplaceF)...verb
+000007d0: 6f73 655a 0a6b 6565 705f 7370 6163 65a9  oseZ.keep_space.
+000007e0: 0172 3300 0000 5a03 4f4e 4529 01da 0564  .r3...Z.ONE)...d
+000007f0: 7479 7065 da05 636c 6f73 65da 0b74 6f74  type..close..tot
+00000800: 616c 5f73 6861 7265 6301 0000 0000 0000  al_sharec.......
+00000810: 0000 0000 0002 0000 0006 0000 0013 0000  ................
+00000820: 0073 1e00 0000 6700 7c00 5d16 7d01 7400  .s....g.|.].}.t.
+00000830: a001 8800 7c01 1900 a002 a100 a101 9102  ....|...........
+00000840: 7104 5300 7212 0000 0029 03da 026e 70da  q.S.r....)...np.
+00000850: 0473 6f72 74da 0675 6e69 7175 65a9 0272  .sort..unique..r
+00000860: 1000 0000 da03 636f 6c29 01da 0564 665f  ......col)...df_
+00000870: 6964 7212 0000 0072 1300 0000 da0a 3c6c  idr....r......<l
+00000880: 6973 7463 6f6d 703e 3300 0000 7215 0000  istcomp>3...r...
+00000890: 007a 2346 6163 746f 7244 6174 612e 6c6f  .z#FactorData.lo
+000008a0: 6164 2e3c 6c6f 6361 6c73 3e2e 3c6c 6973  ad.<locals>.<lis
+000008b0: 7463 6f6d 703e 6301 0000 0000 0000 0000  tcomp>c.........
+000008c0: 0000 0002 0000 0004 0000 0053 0000 0073  ...........S...s
+000008d0: 1400 0000 6700 7c00 5d0c 7d01 7400 7c01  ....g.|.].}.t.|.
+000008e0: 8301 9102 7104 5300 7212 0000 0029 01da  ....q.S.r....)..
+000008f0: 036c 656e 720f 0000 0072 1200 0000 7212  .lenr....r....r.
+00000900: 0000 0072 1300 0000 723e 0000 0034 0000  ...r....r>...4..
+00000910: 0072 1500 0000 2901 da07 636f 6c73 5f69  .r....)...cols_i
+00000920: 6429 01da 046b 6579 7367 0000 0000 84d7  d)...keysg......
+00000930: 9741 5a04 5349 5a45 7221 0000 00e9 0800  .AZ.SIZEr!......
+00000940: 0000 e90b 0000 005a 0853 495a 455f 6c6f  .......Z.SIZE_lo
+00000950: 677a 1753 495a 455f 6c6f 6720 3d20 6167  gz.SIZE_log = ag
+00000960: 6728 7a73 636f 7265 2c20 7a0b 2c20 5349  g(zscore, z., SI
+00000970: 5a45 5f6c 6f67 297a 2653 495a 455f 6c6f  ZE_log)z&SIZE_lo
+00000980: 6720 3d20 6164 6428 6469 6628 5349 5a45  g = add(dif(SIZE
+00000990: 5f6c 6f67 2c20 6167 6728 6d61 782c 207a  _log, agg(max, z
+000009a0: 102c 2053 495a 455f 6c6f 6729 292c 2031  ., SIZE_log)), 1
+000009b0: 29da 0473 697a 6563 0100 0000 0000 0000  )..sizec........
+000009c0: 0000 0000 0200 0000 0400 0000 5300 0000  ............S...
+000009d0: 7320 0000 0067 007c 005d 187d 0164 007c  s ...g.|.].}.d.|
+000009e0: 0176 0073 1864 017c 0176 0072 047c 0191  .v.s.d.|.v.r.|..
+000009f0: 0271 0453 0029 025a 054c 4142 454c da05  .q.S.).Z.LABEL..
+00000a00: 6c61 6265 6c72 1200 0000 723b 0000 0072  labelr....r;...r
+00000a10: 1200 0000 7212 0000 0072 1300 0000 723e  ....r....r....r>
+00000a20: 0000 0044 0000 0072 1500 0000 6301 0000  ...D...r....c...
+00000a30: 0000 0000 0000 0000 0002 0000 0004 0000  ................
+00000a40: 0053 0000 0073 1800 0000 6700 7c00 5d10  .S...s....g.|.].
+00000a50: 7d01 6400 7c01 7600 7204 7c01 9102 7104  }.d.|.v.r.|...q.
+00000a60: 5300 2901 da04 4d41 534b 7212 0000 0072  S.)...MASKr....r
+00000a70: 3b00 0000 7212 0000 0072 1200 0000 7213  ;...r....r....r.
+00000a80: 0000 0072 3e00 0000 4500 0000 7215 0000  ...r>...E...r...
+00000a90: 007a 275b 696e 6974 5d20 3c2d 2d2d 2d2d  .z'[init] <-----
+00000aa0: 2d2d 2d2d 2d20 7368 6966 745f 6920 2d2d  ----- shift_i --
+00000ab0: 2d2d 2d2d 2d2d 2d2d 3e20 7228 0000 007a  --------> r(...z
+00000ac0: 0e5b 2b5d 2073 6869 6674 5f69 203d 20da  .[+] shift_i = .
+00000ad0: 0863 6f6c 5f64 6174 65da 1063 6f6c 735f  .col_date..cols_
+00000ae0: 7368 6966 745f 315f 6e6f 747a 175b 2b5d  shift_1_notz.[+]
+00000af0: 2063 6f6c 735f 7368 6966 745f 315f 6e6f   cols_shift_1_no
+00000b00: 7420 3d20 6301 0000 0000 0000 0000 0000  t = c...........
+00000b10: 0002 0000 0004 0000 0013 0000 0073 1800  .............s..
+00000b20: 0000 6700 7c00 5d10 7d01 7c01 8800 7601  ..g.|.].}.|...v.
+00000b30: 7204 7c01 9102 7104 5300 7212 0000 0072  r.|...q.S.r....r
+00000b40: 1200 0000 723b 0000 0029 0172 4800 0000  ....r;...).rH...
+00000b50: 7212 0000 0072 1300 0000 723e 0000 004e  r....r....r>...N
+00000b60: 0000 0072 1500 0000 7201 0000 0063 0100  ...r....r....c..
+00000b70: 0000 0000 0000 0000 0000 0200 0000 0c00  ................
+00000b80: 0000 1300 0000 732e 0000 0067 007c 005d  ......s....g.|.]
+00000b90: 267d 017c 019b 0064 0088 009b 0064 017c  &}.|...d.....d.|
+00000ba0: 019b 0064 0188 019b 0064 0188 029b 0064  ...d.....d.....d
+00000bb0: 029d 0a91 0271 0453 0029 037a 0f20 3d20  .....q.S.).z. = 
+00000bc0: 726f 6c6c 2873 6869 6674 2c20 7a02 2c20  roll(shift, z., 
+00000bd0: fa01 2972 1200 0000 723b 0000 0029 0372  ..)r....r;...).r
+00000be0: 2d00 0000 7230 0000 0072 2800 0000 7212  -...r0...r(...r.
+00000bf0: 0000 0072 1300 0000 723e 0000 004f 0000  ...r....r>...O..
+00000c00: 0072 1500 0000 291c 721d 0000 005a 0950  .r....).r....Z.P
+00000c10: 4154 485f 4441 5441 7229 0000 0072 0e00  ATH_DATAr)...r..
+00000c20: 0000 da04 7479 7065 da0b 7265 7365 745f  ....type..reset_
+00000c30: 696e 6465 7872 0300 0000 5a05 6665 5f67  indexr....Z.fe_g
+00000c40: 6f5a 0a73 6574 5f62 795f 636f 6c72 3800  oZ.set_by_colr8.
+00000c50: 0000 5a04 6f6e 6573 723f 0000 00da 0766  ..Z.onesr?.....f
+00000c60: 6c6f 6174 3332 5a0f 6765 745f 636f 6c73  loat32Z.get_cols
+00000c70: 5f70 616e 6461 7372 0700 0000 5a06 6173  _pandasr....Z.as
+00000c80: 7479 7065 5a06 6474 7970 6573 5a07 746f  typeZ.dtypesZ.to
+00000c90: 5f64 6963 74da 0272 7a72 0500 0000 5a09  _dict..rzr....Z.
+00000ca0: 746f 5f70 616e 6461 735a 0463 6c69 70da  to_pandasZ.clip.
+00000cb0: 056c 6f67 3130 5a0d 6765 745f 636f 6c5f  .log10Z.get_col_
+00000cc0: 6e75 6d70 79da 0468 6561 64da 0763 6f6c  numpy..head..col
+00000cd0: 756d 6e73 da05 7072 696e 7472 1600 0000  umns..printr....
+00000ce0: 2919 7223 0000 005a 0b64 6174 615f 636f  ).r#...Z.data_co
+00000cf0: 6e66 6967 da02 6466 7233 0000 0072 2400  nfig..dfr3...r$.
+00000d00: 0000 722a 0000 0072 2700 0000 722b 0000  ..r*...r'...r+..
+00000d10: 0072 2c00 0000 722e 0000 0072 2f00 0000  .r,...r....r/...
+00000d20: 7240 0000 00da 0264 6d5a 0863 6f6c 735f  r@.....dmZ.cols_
+00000d30: 7365 6c5a 0769 645f 6c69 7374 da05 7368  selZ.id_list..sh
+00000d40: 6170 655a 0864 665f 6964 5f32 645a 0c64  apeZ.df_id_2dZ.d
+00000d50: 665f 6661 6374 6f72 5f32 645a 0464 6d5f  f_factor_2dZ.dm_
+00000d60: 695a 0b63 6f6c 735f 6661 6374 6f72 5a09  iZ.cols_factorZ.
+00000d70: 6466 5f66 6163 746f 7272 3c00 0000 5a0a  df_factorr<...Z.
+00000d80: 636f 6c73 5f6c 6162 656c 5a09 636f 6c73  cols_labelZ.cols
+00000d90: 5f6d 6173 6b5a 0c63 6f6c 735f 7368 6966  _maskZ.cols_shif
+00000da0: 745f 3172 1200 0000 2905 722d 0000 0072  t_1r....).r-...r
+00000db0: 3000 0000 7248 0000 0072 3d00 0000 7228  0...rH...r=...r(
+00000dc0: 0000 0072 1300 0000 da04 6c6f 6164 1700  ...r......load..
+00000dd0: 0000 7356 0000 0000 0206 0108 0108 0208  ..sV............
+00000de0: 0108 0208 0108 0108 0108 0108 0322 0116  ............."..
+00000df0: 020e 010e 0110 011c 0408 010a 0112 010e  ................
+00000e00: 011c 011e 0218 0120 010a 0118 0118 010e  ....... ........
+00000e10: 0306 011c 011c 0214 0114 020e 010c 0114  ................
+00000e20: 0124 0110 0108 0114 0118 012a 017a 0f46  .$.........*.z.F
+00000e30: 6163 746f 7244 6174 612e 6c6f 6164 2901  actorData.load).
+00000e40: 7221 0000 0029 024e 5429 05da 085f 5f6e  r!...).NT)...__n
+00000e50: 616d 655f 5fda 0a5f 5f6d 6f64 756c 655f  ame__..__module_
+00000e60: 5fda 0c5f 5f71 7561 6c6e 616d 655f 5f72  _..__qualname__r
+00000e70: 2900 0000 7255 0000 0072 1200 0000 7212  )...rU...r....r.
+00000e80: 0000 0072 1200 0000 7213 0000 0072 2000  ...r....r....r .
+00000e90: 0000 1300 0000 7304 0000 0008 010a 0372  ......s........r
+00000ea0: 2000 0000 7221 0000 0054 6307 0000 0000   ...r!...Tc.....
+00000eb0: 0000 0000 0000 0013 0000 0018 0000 0003  ................
+00000ec0: 0000 0073 2802 0000 7400 7c01 8301 7400  ...s(...t.|...t.
+00000ed0: 7c02 8301 0200 7d01 7d02 7401 7402 a003  |.....}.}.t.t...
+00000ee0: 7c00 a101 8301 7d07 6700 7d08 6700 7d09  |.....}.g.}.g.}.
+00000ef0: 7c07 4400 5d74 7d0a 7401 7402 a003 7c00  |.D.]t}.t.t...|.
+00000f00: 9b00 6401 7c0a 9b00 6401 9d04 a101 8301  ..d.|...d.......
+00000f10: 7d0b 7c0b 4400 5d50 7d0c 7c0c 6400 6402  }.|.D.]P}.|.d.d.
+00000f20: 8502 1900 7c01 6b05 724e 7c0c 6400 6402  ....|.k.rN|.d.d.
+00000f30: 8502 1900 7c02 6b01 724e 7c08 a004 7c00  ....|.k.rN|...|.
+00000f40: 9b00 6401 7c0a 9b00 6401 7c0c 9b00 9d05  ..d.|...d.|.....
+00000f50: a101 0100 7c09 a004 7c0c 6400 6402 8502  ....|...|.d.d...
+00000f60: 1900 a101 0100 714e 712c 7c06 72b8 7405  ......qNq,|.r.t.
+00000f70: 6403 7406 7c09 8301 9b00 9d02 8301 0100  d.t.|...........
+00000f80: 6404 6405 6404 6406 6407 9c04 7d0d 7407  d.d.d.d.d...}.t.
+00000f90: 7c08 7408 7c0d a009 a100 8301 7c0d 7c03  |.t.|.......|.|.
+00000fa0: 7c06 6408 8d05 7d0e 7c0e 6a0a 6409 640a  |.d...}.|.j.d.d.
+00000fb0: 6702 640b 640c 8d02 6a0b 640d 640e 8d01  g.d.d...j.d.d...
+00000fc0: 7d0e 6700 640f a201 6700 6410 a201 6700  }.g.d...g.d...g.
+00000fd0: 6411 a201 6700 6412 a201 6700 6413 a201  d...g.d...g.d...
+00000fe0: 6700 6414 a201 6700 6415 a201 6700 6416  g.d...g.d...g.d.
+00000ff0: a201 6700 6417 a201 6700 6418 a201 6700  ..g.d...g.d...g.
+00001000: 6419 a201 6700 641a a201 6700 641b a201  d...g.d...g.d...
+00001010: 6700 641c a201 641d 6701 6700 641e a201  g.d...d.g.g.d...
+00001020: 6700 641f a201 6700 6420 a201 6700 6421  g.d...g.d ..g.d!
+00001030: a201 6700 6422 a201 6700 6423 a201 6424  ..g.d"..g.d#..d$
+00001040: 6701 6700 6425 a201 6426 9c17 7d0f 6427  g.g.d%..d&..}.d'
+00001050: 6428 8400 7c0f a00c a100 4400 8301 7d10  d(..|.....D...}.
+00001060: 7c0e 6429 1900 a00d 7c10 a101 7c0e 6429  |.d)....|...|.d)
+00001070: 3c00 7408 7c0e 640a 1900 a00a a100 8301  <.t.|.d.........
+00001080: 8901 740e a00f 8801 a101 8900 8700 8701  ..t.............
+00001090: 6602 642a 642b 8408 7c04 4400 8301 7d11  f.d*d+..|.D...}.
+000010a0: 7410 7c0e 7c11 7c06 642c 8d03 7d0e 7c05  t.|.|.|.d,..}.|.
+000010b0: 642d 6b03 9002 7224 7c0e 6a11 4400 5d2c  d-k...r$|.j.D.],
+000010c0: 7d12 7c12 642e 7600 9002 7208 9001 71f6  }.|.d.v...r...q.
+000010d0: 7c0e a012 6409 a101 7c12 1900 a013 7c05  |...d...|.....|.
+000010e0: a101 7c0e 7c12 3c00 9001 71f6 7c0e 5300  ..|.|.<...q.|.S.
+000010f0: 292f 4efa 012f e9fc ffff ff7a 1b5b 2b5d  )/N../.....z.[+]
+00001100: 206c 6f61 645f 696e 6475 7374 7279 2c20   load_industry, 
+00001110: 6e64 6179 7320 3d20 da06 6f62 6a65 6374  ndays = ..object
+00001120: 5a05 696e 7433 3272 4c00 0000 2904 da07  Z.int32rL...)...
+00001130: 7473 5f63 6f64 65da 0a74 7261 6465 5f64  ts_code..trade_d
+00001140: 6174 65da 0869 6e64 7573 7472 7972 3700  ate..industryr7.
+00001150: 0000 2904 5a07 7573 6563 6f6c 7372 3500  ..).Z.usecolsr5.
+00001160: 0000 7227 0000 0072 3300 0000 725c 0000  ..r'...r3...r\..
+00001170: 0072 5d00 0000 da04 6c61 7374 2901 5a04  .r].....last).Z.
+00001180: 6b65 6570 54a9 0172 3200 0000 2905 7508  keepT..r2...).u.
+00001190: 0000 0049 54e8 aebe e5a4 8775 0900 0000  ...IT......u....
+000011a0: e585 83e5 99a8 e4bb b675 0900 0000 e58d  .........u......
+000011b0: 8ae5 afbc e4bd 9375 0c00 0000 e794 b5e5  .......u........
+000011c0: 99a8 e4bb aae8 a1a8 750c 0000 00e9 809a  ........u.......
+000011d0: e4bf a1e8 aebe e5a4 8729 0975 0c00 0000  .........).u....
+000011e0: e4b8 93e7 94a8 e69c bae6 a2b0 750c 0000  ............u...
+000011f0: 00e5 869c e794 a8e6 9cba e6a2 b075 0c00  .............u..
+00001200: 0000 e58c 96e5 b7a5 e69c bae6 a2b0 750c  ..............u.
+00001210: 0000 00e5 b7a5 e7a8 8be6 9cba e6a2 b075  ...............u
+00001220: 0c00 0000 e69c bae5 ba8a e588 b6e9 80a0  ................
+00001230: 750c 0000 00e6 9cba e6a2 b0e5 9fba e4bb  u...............
+00001240: b675 0c00 0000 e794 b5e6 b094 e8ae bee5  .u..............
+00001250: a487 750c 0000 00e7 baba e7bb 87e6 9cba  ..u.............
+00001260: e6a2 b075 0c00 0000 e8bd bbe5 b7a5 e69c  ...u............
+00001270: bae6 a2b0 2905 7509 0000 00e4 b8ad e688  ....).u.........
+00001280: 90e8 8daf 750c 0000 00e5 8c96 e5ad a6e5  ....u...........
+00001290: 88b6 e88d af75 0c00 0000 e58c bbe7 9697  .....u..........
+000012a0: e4bf 9de5 81a5 750c 0000 00e5 8cbb e88d  ......u.........
+000012b0: afe5 9586 e4b8 9a75 0c00 0000 e794 9fe7  .......u........
+000012c0: 89a9 e588 b6e8 8daf 2906 7509 0000 00e4  ........).u.....
+000012d0: b9b3 e588 b6e5 9381 7506 0000 00e5 95a4  ........u.......
+000012e0: e985 9275 0600 0000 e799 bde9 8592 7509  ...u..........u.
+000012f0: 0000 00e7 baa2 e9bb 84e9 8592 7509 0000  ............u...
+00001300: 00e8 bdaf e9a5 aee6 9699 7506 0000 00e9  ..........u.....
+00001310: a39f e593 8129 0375 0900 0000 e4ba 92e8  .....).u........
+00001320: 8194 e7bd 9175 0c00 0000 e794 b5e4 bfa1  .....u..........
+00001330: e8bf 90e8 90a5 750c 0000 00e8 bdaf e4bb  ......u.........
+00001340: b6e6 9c8d e58a a129 0b75 0c00 0000 e4bb  .......).u......
+00001350: 93e5 82a8 e789 a9e6 b581 750c 0000 00e5  ..........u.....
+00001360: 85ac e585 b1e4 baa4 e980 9a75 0600 0000  ...........u....
+00001370: e585 ace8 b7af 7506 0000 00e6 9cba e59c  ......u.........
+00001380: ba75 0600 0000 e6b0 b4e8 bf90 7506 0000  .u..........u...
+00001390: 00e6 b8af e58f a375 0600 0000 e7a9 bae8  .......u........
+000013a0: bf90 7506 0000 00e8 88aa e7a9 ba75 0600  ..u..........u..
+000013b0: 0000 e888 b9e8 88b6 750c 0000 00e8 bf90  ........u.......
+000013c0: e8be 93e8 aebe e5a4 8775 0600 0000 e993  .........u......
+000013d0: 81e8 b7af 2903 750c 0000 00e4 be9b e6b0  ....).u.........
+000013e0: 94e4 be9b e783 ad75 0600 0000 e6b0 b4e5  .......u........
+000013f0: 8aa1 750c 0000 00e7 8eaf e5a2 83e4 bf9d  ..u.............
+00001400: e68a a429 0475 0600 0000 e4bf 9de9 99a9  ...).u..........
+00001410: 750c 0000 00e5 a49a e585 83e9 8791 e89e  u...............
+00001420: 8d75 0600 0000 e8af 81e5 88b8 7506 0000  .u..........u...
+00001430: 00e9 93b6 e8a1 8c29 0475 0c00 0000 e585  .......).u......
+00001440: a8e5 9bbd e59c b0e4 baa7 750c 0000 00e5  ..........u.....
+00001450: 8cba e59f 9fe5 9cb0 e4ba a775 0c00 0000  ...........u....
+00001460: e59b ade5 8cba e5bc 80e5 8f91 750c 0000  ............u...
+00001470: 00e6 88bf e4ba a7e6 9c8d e58a a129 0875  .............).u
+00001480: 0c00 0000 e585 b6e4 bb96 e595 86e4 b89a  ................
+00001490: 7509 0000 00e5 9586 e593 81e5 9f8e 750c  u.............u.
+000014a0: 0000 00e5 9586 e8b4 b8e4 bba3 e790 8675  ...............u
+000014b0: 0c00 0000 e794 b5e5 99a8 e8bf 9ee9 9481  ................
+000014c0: 7509 0000 00e6 89b9 e58f 91e4 b89a 750c  u.............u.
+000014d0: 0000 00e8 b685 e5b8 82e8 bf9e e994 8175  ...............u
+000014e0: 0600 0000 e799 bee8 b4a7 750c 0000 00e5  ..........u.....
+000014f0: b9bf e591 8ae5 8c85 e8a3 8529 0575 0c00  ...........).u..
+00001500: 0000 e585 b6e4 bb96 e5bb bae6 9d90 7506  ..............u.
+00001510: 0000 00e5 bbba e69d 9075 0600 0000 e6b0  .........u......
+00001520: b4e6 b3a5 7506 0000 00e7 8ebb e792 8375  ....u..........u
+00001530: 0600 0000 e999 b6e7 93b7 2905 750c 0000  ..........).u...
+00001540: 00e5 869c e4b8 9ae7 bbbc e590 8875 0600  .............u..
+00001550: 0000 e69e 97e4 b89a 7506 0000 00e6 b894  ........u.......
+00001560: e4b8 9a75 0900 0000 e7a7 8de6 a48d e4b8  ...u............
+00001570: 9a75 0600 0000 e9a5 b2e6 9699 2907 750c  .u..........).u.
+00001580: 0000 00e5 869c e88d afe5 8c96 e882 a575  ...............u
+00001590: 0c00 0000 e58c 96e5 b7a5 e58e 9fe6 9699  ................
+000015a0: 7506 0000 00e5 8c96 e7ba a475 0c00 0000  u..........u....
+000015b0: e697 a5e7 94a8 e58c 96e5 b7a5 750c 0000  ............u...
+000015c0: 00e6 9f93 e696 99e6 b682 e696 9975 0600  .............u..
+000015d0: 0000 e5a1 91e6 9699 7506 0000 00e6 a9a1  ........u.......
+000015e0: e883 b629 0375 0900 0000 e587 bae7 8988  ...).u..........
+000015f0: e4b8 9a75 0c00 0000 e5bd b1e8 a786 e99f  ...u............
+00001600: b3e5 838f 750c 0000 00e6 9687 e695 99e4  ....u...........
+00001610: bc91 e997 b275 0c00 0000 e5ae b6e7 94a8  .....u..........
+00001620: e794 b5e5 99a8 2908 7509 0000 00e5 b08f  ......).u.......
+00001630: e987 91e5 b19e 7506 0000 00e6 99ae e992  ......u.........
+00001640: a275 0900 0000 e789 b9e7 a78d e992 a275  .u.............u
+00001650: 0900 0000 e992 a2e5 8aa0 e5b7 a575 0600  .............u..
+00001660: 0000 e993 85e9 948c 7503 0000 00e9 939c  ........u.......
+00001670: 7503 0000 00e9 939d 7506 0000 00e9 bb84  u.......u.......
+00001680: e987 9129 0375 0c00 0000 e5bb bae7 ad91  ...).u..........
+00001690: e5b7 a5e7 a88b 750c 0000 00e8 a385 e4bf  ......u.........
+000016a0: aee8 a385 e9a5 b075 0600 0000 e8b7 afe6  .......u........
+000016b0: a1a5 2904 750c 0000 00e5 aeb6 e5b1 85e7  ..).u...........
+000016c0: 94a8 e593 8175 0600 0000 e69c 8de9 a5b0  .....u..........
+000016d0: 7506 0000 00e9 80a0 e7ba b875 0600 0000  u..........u....
+000016e0: e7ba bae7 bb87 2904 7509 0000 00e6 91a9  ......).u.......
+000016f0: e689 98e8 bda6 750c 0000 00e6 b1bd e8bd  ......u.........
+00001700: a6e6 95b4 e8bd a675 0c00 0000 e6b1 bde8  .......u........
+00001710: bda6 e69c 8de5 8aa1 750c 0000 00e6 b1bd  ........u.......
+00001720: e8bd a6e9 858d e4bb b629 0675 0c00 0000  .........).u....
+00001730: e696 b0e5 9e8b e794 b5e5 8a9b 750c 0000  ............u...
+00001740: 00e6 b0b4 e58a 9be5 8f91 e794 b575 0c00  .............u..
+00001750: 0000 e781 abe5 8a9b e58f 91e7 94b5 750c  ..............u.
+00001760: 0000 00e7 84a6 e782 ade5 8aa0 e5b7 a575  ...............u
+00001770: 0c00 0000 e79f b3e6 b2b9 e58a a0e5 b7a5  ................
+00001780: 750c 0000 00e7 9fb3 e6b2 b9e8 b4b8 e698  u...............
+00001790: 9329 0375 0c00 0000 e785 a4e7 82ad e5bc  .).u............
+000017a0: 80e9 8787 750c 0000 00e7 9fb3 e6b2 b9e5  ....u...........
+000017b0: bc80 e987 8775 0c00 0000 e79f bfe7 89a9  .....u..........
+000017c0: e588 b6e5 9381 7509 0000 00e7 bbbc e590  ......u.........
+000017d0: 88e7 b1bb 2903 750c 0000 00e6 9785 e6b8  ....).u.........
+000017e0: b8e6 99af e782 b975 0c00 0000 e697 85e6  .......u........
+000017f0: b8b8 e69c 8de5 8aa1 750c 0000 00e9 8592  ........u.......
+00001800: e5ba 97e9 a490 e9a5 ae29 1775 0c00 0000  .........).u....
+00001810: e7a7 91e6 8a80 e794 b5e5 ad90 750c 0000  ............u...
+00001820: 00e6 9cba e6a2 b0e8 aebe e5a4 8775 0c00  .............u..
+00001830: 0000 e58c bbe8 8daf e794 9fe7 89a9 750c  ..............u.
+00001840: 0000 00e9 a39f e593 81e9 a5ae e696 9975  ...............u
+00001850: 0c00 0000 e4bf a1e6 81af e68a 80e6 9caf  ................
+00001860: 750c 0000 00e4 baa4 e980 9ae7 89a9 e6b5  u...............
+00001870: 8175 0c00 0000 e585 ace7 94a8 e4ba 8be4  .u..............
+00001880: b89a 750c 0000 00e9 8791 e89e 8de6 9c8d  ..u.............
+00001890: e58a a175 0900 0000 e688 bfe5 9cb0 e4ba  ...u............
+000018a0: a775 0c00 0000 e595 86e4 b89a e69c 8de5  .u..............
+000018b0: 8aa1 750c 0000 00e5 bbba e7ad 91e6 9d90  ..u.............
+000018c0: e696 9975 0c00 0000 e586 9ce6 9e97 e789  ...u............
+000018d0: a7e6 b894 7506 0000 00e5 8c96 e5b7 a575  ....u..........u
+000018e0: 0c00 0000 e696 87e5 8c96 e4bc a0e5 aa92  ................
+000018f0: 750c 0000 00e6 b688 e8b4 b9e7 94b5 e5ad  u...............
+00001900: 9075 0c00 0000 e987 91e5 b19e e79f bfe4  .u..............
+00001910: baa7 750c 0000 00e5 bbba e7ad 91e8 a385  ..u.............
+00001920: e6bd a275 0c00 0000 e8bd bbe5 b7a5 e588  ...u............
+00001930: b6e9 80a0 750c 0000 00e6 b1bd e8bd a6e5  ....u...........
+00001940: 88b6 e980 a075 0600 0000 e883 bde6 ba90  .....u..........
+00001950: 750c 0000 00e7 9fbf e4ba a7e8 b584 e6ba  u...............
+00001960: 9075 0600 0000 e7bb bce5 9088 750c 0000  .u..........u...
+00001970: 00e4 bc91 e997 b2e6 9c8d e58a a163 0100  .............c..
+00001980: 0000 0000 0000 0000 0000 0400 0000 0500  ................
+00001990: 0000 5300 0000 7320 0000 0069 007c 005d  ..S...s ...i.|.]
+000019a0: 185c 027d 017d 027c 0244 005d 0a7d 037c  .\.}.}.|.D.].}.|
+000019b0: 037c 0193 0371 1071 0453 0072 1200 0000  .|...q.q.S.r....
+000019c0: 7212 0000 0029 0472 1000 0000 da01 6bda  r....).r......k.
+000019d0: 0276 73da 0176 7212 0000 0072 1200 0000  .vs..vr....r....
+000019e0: 7213 0000 00da 0a3c 6469 6374 636f 6d70  r......<dictcomp
+000019f0: 3e82 0000 0072 1500 0000 7a25 6c6f 6164  >....r....z%load
+00001a00: 5f64 665f 6261 6b5f 6261 7369 632e 3c6c  _df_bak_basic.<l
+00001a10: 6f63 616c 733e 2e3c 6469 6374 636f 6d70  ocals>.<dictcomp
+00001a20: 3e72 5e00 0000 6301 0000 0000 0000 0000  >r^...c.........
+00001a30: 0000 0002 0000 0004 0000 0013 0000 0073  ...............s
+00001a40: 2800 0000 6700 7c00 5d20 7d01 7c01 8801  (...g.|.] }.|...
+00001a50: 7601 7204 7c01 6400 6b05 7204 7c01 8800  v.r.|.d.k.r.|...
+00001a60: 6b05 7204 7c01 9102 7104 5300 2901 69f3  k.r.|...q.S.).i.
+00001a70: a133 0172 1200 0000 720f 0000 00a9 025a  .3.r....r......Z
+00001a80: 0864 6174 655f 6d61 785a 0b64 6174 6573  .date_maxZ.dates
+00001a90: 5f65 7869 7374 7212 0000 0072 1300 0000  _existr....r....
+00001aa0: 723e 0000 0087 0000 0072 1500 0000 7a25  r>.......r....z%
+00001ab0: 6c6f 6164 5f64 665f 6261 6b5f 6261 7369  load_df_bak_basi
+00001ac0: 632e 3c6c 6f63 616c 733e 2e3c 6c69 7374  c.<locals>.<list
+00001ad0: 636f 6d70 3e72 3400 0000 7201 0000 0029  comp>r4...r....)
+00001ae0: 0272 5c00 0000 725d 0000 0029 1472 0e00  .r\...r]...).r..
+00001af0: 0000 da06 736f 7274 6564 da02 6f73 da07  ....sorted..os..
+00001b00: 6c69 7374 6469 72da 0661 7070 656e 6472  listdir..appendr
+00001b10: 5100 0000 723f 0000 0072 1f00 0000 da04  Q...r?...r......
+00001b20: 6c69 7374 7241 0000 005a 0f64 726f 705f  listrA...Z.drop_
+00001b30: 6475 706c 6963 6174 6573 724b 0000 00da  duplicatesrK....
+00001b40: 0569 7465 6d73 da03 6d61 7072 3800 0000  .items..mapr8...
+00001b50: da03 6d61 78da 0964 665f 6578 7061 6e64  ..max..df_expand
+00001b60: 7250 0000 00da 0767 726f 7570 6279 da05  rP.....groupby..
+00001b70: 7368 6966 7429 1372 2400 0000 7225 0000  shift).r$...r%..
+00001b80: 0072 2600 0000 7227 0000 00da 0564 6174  .r&...r'.....dat
+00001b90: 6573 7228 0000 0072 3300 0000 5a09 7965  esr(...r3...Z.ye
+00001ba0: 6172 5f6c 6973 74da 0970 6174 685f 6c69  ar_list..path_li
+00001bb0: 7374 5a09 6461 7465 5f6c 6973 74da 0479  stZ.date_list..y
+00001bc0: 6561 725a 0966 696c 655f 6c69 7374 720b  earZ.file_listr.
+00001bd0: 0000 0072 3500 0000 7252 0000 005a 0a69  ...r5...rR...Z.i
+00001be0: 6e64 5f72 6564 7563 655a 0669 6e64 5f6b  nd_reduceZ.ind_k
+00001bf0: 76da 0964 6174 6573 5f61 6464 723c 0000  v..dates_addr<..
+00001c00: 0072 1200 0000 7265 0000 0072 1300 0000  .r....re...r....
+00001c10: da11 6c6f 6164 5f64 665f 6261 6b5f 6261  ..load_df_bak_ba
+00001c20: 7369 6354 0000 0073 6a00 0000 0001 1201  sicT...sj.......
+00001c30: 0e01 0401 0401 0801 1a01 0801 2001 1a01  ............ ...
+00001c40: 1602 1602 0201 0201 0201 02fc 0606 1a01  ................
+00001c50: 1a02 0601 0601 0601 0601 0601 0601 0601  ................
+00001c60: 0601 0601 0601 0601 0601 0601 0601 0401  ................
+00001c70: 0601 0601 0601 0601 0601 0601 0401 06e9  ................
+00001c80: 0619 1201 1202 1001 0a01 1401 0e03 0a01  ................
+00001c90: 0a01 0e01 1c01 7275 0000 0072 5d00 0000  ......ru...r]...
+00001ca0: 6304 0000 0000 0000 0000 0000 000a 0000  c...............
+00001cb0: 0005 0000 0043 0000 0073 c800 0000 7400  .....C...s....t.
+00001cc0: 7c01 8301 6401 6b02 7210 7c00 5300 7c03  |...d.k.r.|.S.|.
+00001cd0: 7222 7401 6402 7c01 9b00 9d02 8301 0100  r"t.d.|.........
+00001ce0: 6700 7d04 7c00 7c00 7c02 1900 7c00 7c02  g.}.|.|.|...|.|.
+00001cf0: 1900 a002 a100 6b02 1900 7d05 7c01 4400  ......k...}.|.D.
+00001d00: 5d4e 7d06 7c05 a003 a100 7d07 7c06 7c07  ]N}.|.....}.|.|.
+00001d10: 6403 3c00 7404 7c07 6a05 6404 6400 8502  d.<.t.|.j.d.d...
+00001d20: 1900 8301 7d08 7c08 4400 5d18 7d09 7c09  ....}.|.D.].}.|.
+00001d30: 6405 6b02 727a 716c 7406 6a07 7c07 7c09  d.k.rzqlt.j.|.|.
+00001d40: 3c00 716c 7c04 a008 7c07 a101 0100 7142  <.ql|...|.....qB
+00001d50: 7409 6a0a 7c04 6401 6406 8d02 6a0b 6407  t.j.|.d.d...j.d.
+00001d60: 6408 8d01 7d07 7409 6a0a 7c00 7c07 6702  d...}.t.j.|.|.g.
+00001d70: 6401 6409 640a 8d03 6a0b 6407 6408 8d01  d.d.d...j.d.d...
+00001d80: 7d00 7c00 5300 290b 4e72 0100 0000 7a0d  }.|.S.).Nr....z.
+00001d90: 5b2b 5d20 6578 7061 6e64 203d 2072 5d00  [+] expand = r].
+00001da0: 0000 e902 0000 00da 046f 7065 6e29 01da  .........open)..
+00001db0: 0461 7869 7354 7260 0000 0046 2902 7278  .axisTr`...F).rx
+00001dc0: 0000 0072 3900 0000 290c 723f 0000 0072  ...r9...).r?...r
+00001dd0: 5100 0000 726d 0000 00da 0463 6f70 7972  Q...rm.....copyr
+00001de0: 6a00 0000 7250 0000 0072 3800 0000 da03  j...rP...r8.....
+00001df0: 6e61 6e72 6900 0000 da02 7064 da06 636f  nanri.....pd..co
+00001e00: 6e63 6174 724b 0000 0029 0a72 5200 0000  ncatrK...).rR...
+00001e10: 7274 0000 0072 4700 0000 7233 0000 005a  rt...rG...r3...Z
+00001e20: 0c64 665f 6e65 7874 5f6c 6973 745a 0764  .df_next_listZ.d
+00001e30: 665f 636f 7079 da04 6461 7465 5a07 6466  f_copy..dateZ.df
+00001e40: 5f6e 6578 74da 0463 6f6c 7372 3c00 0000  _next..colsr<...
+00001e50: 7212 0000 0072 1200 0000 7213 0000 0072  r....r....r....r
+00001e60: 6e00 0000 9100 0000 731e 0000 0000 0110  n.......s.......
+00001e70: 0112 0204 0118 0108 0108 0108 0112 0108  ................
+00001e80: 010a 010c 010c 0116 011c 0172 6e00 0000  ...........rn...
+00001e90: 6300 0000 0000 0000 0000 0000 0000 0000  c...............
+00001ea0: 0003 0000 0040 0000 0073 1a00 0000 6500  .....@...s....e.
+00001eb0: 5a01 6400 5a02 6700 6401 6602 6402 6403  Z.d.Z.g.d.f.d.d.
+00001ec0: 8401 5a03 6404 5300 2905 da0c 4261 6b42  ..Z.d.S.)...BakB
+00001ed0: 6173 6963 4461 7461 7221 0000 0063 0700  asicDatar!...c..
+00001ee0: 0000 0000 0000 0000 0000 0700 0000 0700  ................
+00001ef0: 0000 4300 0000 7312 0000 0074 007c 017c  ..C...s....t.|.|
+00001f00: 027c 037c 047c 057c 0683 0653 0072 0d00  .|.|.|.|...S.r..
+00001f10: 0000 2901 7275 0000 0029 0772 2300 0000  ..).ru...).r#...
+00001f20: 7224 0000 0072 2500 0000 7226 0000 0072  r$...r%...r&...r
+00001f30: 2700 0000 7271 0000 0072 2800 0000 7212  '...rq...r(...r.
+00001f40: 0000 0072 1200 0000 7213 0000 0072 2900  ...r....r....r).
+00001f50: 0000 a400 0000 7302 0000 0000 017a 1342  ......s......z.B
+00001f60: 616b 4261 7369 6344 6174 612e 6765 745f  akBasicData.get_
+00001f70: 6466 4e29 0472 5600 0000 7257 0000 0072  dfN).rV...rW...r
+00001f80: 5800 0000 7229 0000 0072 1200 0000 7212  X...r)...r....r.
+00001f90: 0000 0072 1200 0000 7213 0000 0072 7f00  ...r....r....r..
+00001fa0: 0000 a300 0000 7302 0000 0008 0172 7f00  ......s......r..
+00001fb0: 0000 2902 725d 0000 0054 2921 7267 0000  ..).r]...T)!rg..
+00001fc0: 00da 056e 756d 7079 7238 0000 00da 0670  ...numpyr8.....p
+00001fd0: 616e 6461 7372 7b00 0000 da06 706f 6c61  andasr{.....pola
+00001fe0: 7273 da02 706c da08 7275 6e6e 696e 677a  rs..pl..runningz
+00001ff0: 724d 0000 005a 0f63 6f72 652e 4461 7461  rM...Z.core.Data
+00002000: 4d61 7374 6572 7203 0000 005a 0975 7469  Masterr....Z.uti
+00002010: 6c2e 7574 696c 7204 0000 0072 0500 0000  l.utilr....r....
+00002020: 7206 0000 005a 0875 7469 6c2e 6e70 7972  r....Z.util.npyr
+00002030: 0700 0000 5a0e 7574 696c 2e6e 7079 5f6e  ....Z.util.npy_n
+00002040: 756d 6261 7208 0000 0072 0900 0000 5a07  umbar....r....Z.
+00002050: 7574 696c 2e64 6272 0a00 0000 7251 0000  util.dbr....rQ..
+00002060: 0072 1700 0000 5a0a 7574 696c 2e63 6f6e  .r....Z.util.con
+00002070: 7374 721d 0000 0072 1e00 0000 5a08 7574  str....r....Z.ut
+00002080: 696c 2e63 7376 721f 0000 0072 2000 0000  il.csvr....r ...
+00002090: 7275 0000 0072 6e00 0000 727f 0000 0072  ru...rn...r....r
+000020a0: 1200 0000 7212 0000 0072 1200 0000 7213  ....r....r....r.
+000020b0: 0000 00da 083c 6d6f 6475 6c65 3e01 0000  .....<module>...
+000020c0: 0073 2400 0000 0801 0801 0801 0801 0801  .s$.............
+000020d0: 0c01 1401 0c01 1001 0c01 0401 0802 0c01  ................
+000020e0: 0c01 0c03 0e41 123d 0a12                 .....A.=..
```

## runningz/fe/status/status_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Thu May  9 16:27:50 2024 UTC, .py size: 16389 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 86f9 3c66 0540 0000  a.........<f.@..
+00000000: 610d 0d0a 0000 0000 8512 4e66 0540 0000  a.........Nf.@..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
```

## runningz/fe/util/util_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Thu May  9 16:27:50 2024 UTC, .py size: 14520 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 86f9 3c66 b838 0000  a.........<f.8..
+00000000: 610d 0d0a 0000 0000 8512 4e66 b838 0000  a.........Nf.8..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
```

## runningz/model/nn/model_mlp_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Thu May  9 16:27:50 2024 UTC, .py size: 11484 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 86f9 3c66 dc2c 0000  a.........<f.,..
+00000000: 610d 0d0a 0000 0000 8512 4e66 dc2c 0000  a.........Nf.,..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
```

## runningz/model/nn/nn_util_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Thu May  9 16:27:50 2024 UTC, .py size: 16653 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 86f9 3c66 0d41 0000  a.........<f.A..
+00000000: 610d 0d0a 0000 0000 8512 4e66 0d41 0000  a.........Nf.A..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
```

## runningz/model/tree/model_cat_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Thu May  9 16:27:50 2024 UTC, .py size: 7955 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 86f9 3c66 131f 0000  a.........<f....
+00000000: 610d 0d0a 0000 0000 8512 4e66 131f 0000  a.........Nf....
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
```

## runningz/model/tree/model_lgb_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Thu May  9 16:27:50 2024 UTC, .py size: 11922 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 86f9 3c66 922e 0000  a.........<f....
+00000000: 610d 0d0a 0000 0000 8512 4e66 922e 0000  a.........Nf....
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
```

## runningz/opt/opt_random_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Thu May  9 16:27:50 2024 UTC, .py size: 9412 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 86f9 3c66 c424 0000  a.........<f.$..
+00000000: 610d 0d0a 0000 0000 8512 4e66 c424 0000  a.........Nf.$..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
```

## runningz/res/res_dates_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Thu May  9 16:27:50 2024 UTC, .py size: 1250 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 86f9 3c66 e204 0000  a.........<f....
+00000000: 610d 0d0a 0000 0000 8512 4e66 e204 0000  a.........Nf....
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
```

## runningz/res/res_labels.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Thu May  9 16:23:58 2024 UTC, .py size: 2316 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 9ef8 3c66 0c09 0000  a.........<f....
+00000000: 610d 0d0a 0000 0000 4210 4e66 0c09 0000  a.......B.Nf....
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 000d 0000 0040 0000 0073 5602 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6700  d.l.Z.d.d.l.Z.g.
 00000040: 5a02 6402 5a03 6700 6403 a201 5a04 6400  Z.d.Z.g.d...Z.d.
 00000050: 5a05 6506 6404 6507 6504 8301 8302 4400  Z.e.d.e.e.....D.
 00000060: 5d28 5a08 6502 a009 6405 6503 9b00 6406  ](Z.e...d.e...d.
 00000070: 6504 6505 1900 9b00 6406 6504 6508 1900  e.e.....d.e.e...
```

## runningz/res/res_labels_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Thu May  9 16:27:50 2024 UTC, .py size: 2737 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 86f9 3c66 b10a 0000  a.........<f....
+00000000: 610d 0d0a 0000 0000 8512 4e66 b10a 0000  a.........Nf....
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
```

## runningz/res/res_main.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Fri Apr 26 12:05:02 2024 UTC, .py size: 20560 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 6e98 2b66 5050 0000  a.......n.+fPP..
+00000000: 610d 0d0a 0000 0000 1ffa 3c66 8050 0000  a.........<f.P..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 000f 0000 0040 0000 0073 5014 0000 6400  .....@...sP...d.
 00000030: 6401 6c00 5a00 6402 6500 6a01 6403 3c00  d.l.Z.d.e.j.d.<.
 00000040: 6500 a002 6404 a101 0100 6503 6405 6500  e...d.....e.d.e.
 00000050: a004 a100 9b00 6406 6407 6505 8300 7600  ......d.d.e...v.
 00000060: 7238 6506 6e02 6401 9b00 9d04 8301 0100  r8e.n.d.........
 00000070: 6400 6401 6c07 5a07 6507 6a08 a009 6400  d.d.l.Z.e.j...d.
```

## runningz/res/res_main_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Thu May  9 16:27:50 2024 UTC, .py size: 20981 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 86f9 3c66 f551 0000  a.........<f.Q..
+00000000: 610d 0d0a 0000 0000 8512 4e66 2552 0000  a.........Nf%R..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
@@ -10,15 +10,15 @@
 00000090: 0000 0000 0000 0000 0004 0000 0008 0000  ................
 000000a0: 0043 0000 0073 5c00 0000 7400 6a01 a002  .C...s\...t.j...
 000000b0: 7403 a101 6401 1700 7c00 1700 7d01 6402  t...d...|...}.d.
 000000c0: 7d02 7c02 a004 6403 6404 a102 7d02 7405  }.|...d.d...}.t.
 000000d0: 7c01 6405 8302 8f1a 7d03 7c03 a006 7c02  |.d.....}.|...|.
 000000e0: a101 0100 5700 6400 0400 0400 8303 0100  ....W.d.........
 000000f0: 6e10 3100 734e 3000 0100 0100 0100 5900  n.1.sN0.......Y.
-00000100: 0100 6400 5300 2906 4efa 012f 6150 5000  ..d.S.).N../aPP.
+00000100: 0100 6400 5300 2906 4efa 012f 6180 5000  ..d.S.).N../a.P.
 00000110: 0069 6d70 6f72 7420 6f73 0a6f 732e 656e  .import os.os.en
 00000120: 7669 726f 6e5b 2772 7a5f 746f 6b65 6e27  viron['rz_token'
 00000130: 5d20 3d20 2735 6263 3235 3032 6132 3032  ] = '5bc2502a202
 00000140: 3431 3233 3127 0a6f 732e 6368 6469 7228  41231'.os.chdir(
 00000150: 272e 2e2f 2e2e 2f27 290a 7072 696e 7428  '../../').print(
 00000160: 6627 5b2b 5d20 6377 6420 3d20 7b6f 732e  f'[+] cwd = {os.
 00000170: 6765 7463 7764 2829 7d2c 205f 5f66 696c  getcwd()}, __fil
@@ -1296,33 +1296,36 @@
 000050f0: 2e73 7464 6f75 742e 666c 7573 6828 290a  .stdout.flush().
 00005100: 727a 2e54 494d 4552 2873 203d 2027 5255  rz.TIMER(s = 'RU
 00005110: 4e20 5355 4343 2729 0a23 2070 7974 686f  N SUCC').# pytho
 00005120: 6e20 2d75 2072 6573 5f6d 6169 6e2e 7079  n -u res_main.py
 00005130: 0a0a 2320 6e6f 6875 7020 7079 7468 6f6e  ..# nohup python
 00005140: 202d 7520 7265 735f 6d61 696e 2e70 7920   -u res_main.py 
 00005150: 3e20 6c6f 672e 7478 7420 323e 2631 2026  > log.txt 2>&1 &
-00005160: 0a7a 065c 275c 275c 277a 0327 2727 da01  .z.\'\'\'z.'''..
-00005170: 7729 07da 026f 73da 0470 6174 68da 0764  w)...os..path..d
-00005180: 6972 6e61 6d65 da08 5f5f 6669 6c65 5f5f  irname..__file__
-00005190: da07 7265 706c 6163 65da 046f 7065 6eda  ..replace..open.
-000051a0: 0577 7269 7465 2904 da06 6f75 7470 7574  .write)...output
-000051b0: 5a0b 7061 7468 5f6f 7574 7075 74da 0173  Z.path_output..s
-000051c0: da01 66a9 0072 0e00 0000 fa3e 6275 696c  ..f..r.....>buil
-000051d0: 642f 6264 6973 742e 6d61 636f 7378 2d31  d/bdist.macosx-1
-000051e0: 302e 392d 7838 365f 3634 2f65 6767 2f72  0.9-x86_64/egg/r
-000051f0: 756e 6e69 6e67 7a2f 7265 732f 7265 735f  unningz/res/res_
-00005200: 6d61 696e 5f70 792e 7079 da03 7275 6e04  main_py.py..run.
-00005210: 0000 0073 1000 0000 0001 1401 047f 007f  ...s............
-00005220: 007f 0037 0c01 0c01 7210 0000 00da 085f  ...7....r......_
-00005230: 5f6d 6169 6e5f 5f7a 082d 2d6f 7574 7075  _main__z.--outpu
-00005240: 7454 2902 da04 7479 7065 da08 7265 7175  tT)...type..requ
-00005250: 6972 6564 290c 7204 0000 00da 0373 7973  ired).r......sys
-00005260: 7210 0000 00da 085f 5f6e 616d 655f 5fda  r......__name__.
-00005270: 0861 7267 7061 7273 65da 0e41 7267 756d  .argparse..Argum
-00005280: 656e 7450 6172 7365 72da 0670 6172 7365  entParser..parse
-00005290: 72da 0c61 6464 5f61 7267 756d 656e 74da  r..add_argument.
-000052a0: 0373 7472 da0a 7061 7273 655f 6172 6773  .str..parse_args
-000052b0: da04 6172 6773 720b 0000 0072 0e00 0000  ..argsr....r....
-000052c0: 720e 0000 0072 0e00 0000 720f 0000 00da  r....r....r.....
-000052d0: 083c 6d6f 6475 6c65 3e02 0000 0073 1600  .<module>....s..
-000052e0: 0000 0801 0801 087f 007f 007f 003d 0801  .............=..
-000052f0: 0801 0801 1001 0801                      ........
+00005160: 0a23 2070 7974 686f 6e20 2d75 2072 6573  .# python -u res
+00005170: 5f6d 6169 6e2e 7079 202d 2d64 756d 7020  _main.py --dump 
+00005180: 7878 7878 2f78 7878 782e 6a73 6f6e 0a0a  xxxx/xxxx.json..
+00005190: 0a7a 065c 275c 275c 277a 0327 2727 da01  .z.\'\'\'z.'''..
+000051a0: 7729 07da 026f 73da 0470 6174 68da 0764  w)...os..path..d
+000051b0: 6972 6e61 6d65 da08 5f5f 6669 6c65 5f5f  irname..__file__
+000051c0: da07 7265 706c 6163 65da 046f 7065 6eda  ..replace..open.
+000051d0: 0577 7269 7465 2904 da06 6f75 7470 7574  .write)...output
+000051e0: 5a0b 7061 7468 5f6f 7574 7075 74da 0173  Z.path_output..s
+000051f0: da01 66a9 0072 0e00 0000 fa3e 6275 696c  ..f..r.....>buil
+00005200: 642f 6264 6973 742e 6d61 636f 7378 2d31  d/bdist.macosx-1
+00005210: 302e 392d 7838 365f 3634 2f65 6767 2f72  0.9-x86_64/egg/r
+00005220: 756e 6e69 6e67 7a2f 7265 732f 7265 735f  unningz/res/res_
+00005230: 6d61 696e 5f70 792e 7079 da03 7275 6e04  main_py.py..run.
+00005240: 0000 0073 1000 0000 0001 1401 047f 007f  ...s............
+00005250: 007f 003a 0c01 0c01 7210 0000 00da 085f  ...:....r......_
+00005260: 5f6d 6169 6e5f 5f7a 082d 2d6f 7574 7075  _main__z.--outpu
+00005270: 7454 2902 da04 7479 7065 da08 7265 7175  tT)...type..requ
+00005280: 6972 6564 290c 7204 0000 00da 0373 7973  ired).r......sys
+00005290: 7210 0000 00da 085f 5f6e 616d 655f 5fda  r......__name__.
+000052a0: 0861 7267 7061 7273 65da 0e41 7267 756d  .argparse..Argum
+000052b0: 656e 7450 6172 7365 72da 0670 6172 7365  entParser..parse
+000052c0: 72da 0c61 6464 5f61 7267 756d 656e 74da  r..add_argument.
+000052d0: 0373 7472 da0a 7061 7273 655f 6172 6773  .str..parse_args
+000052e0: da04 6172 6773 720b 0000 0072 0e00 0000  ..argsr....r....
+000052f0: 720e 0000 0072 0e00 0000 720f 0000 00da  r....r....r.....
+00005300: 083c 6d6f 6475 6c65 3e02 0000 0073 1600  .<module>....s..
+00005310: 0000 0801 0801 087f 007f 007f 0040 0801  .............@..
+00005320: 0801 0801 1001 0801                      ........
```

## runningz/res/res_run.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Wed Mar 20 14:48:46 2024 UTC, .py size: 370 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 4ef7 fa65 7201 0000  a.......N..er...
+00000000: 610d 0d0a 0000 0000 d911 4e66 2805 0000  a.........Nf(...
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0008 0000 0040 0000 0073 3600 0000 6400  .....@...s6...d.
 00000030: 6401 6c00 5a00 6402 5a01 6502 6501 8301  d.l.Z.d.Z.e.e...
 00000040: 4400 5d1c 5a03 6500 a004 6403 6501 9b00  D.].Z.e...d.e...
 00000050: 6404 6503 9b00 6405 9d05 a101 0100 7114  d.e...d.......q.
 00000060: 6401 5300 2906 e900 0000 004e e904 0000  d.S.)......N....
 00000070: 007a 1d6e 6f68 7570 2070 7974 686f 6e20  .z.nohup python 
@@ -12,8 +12,8 @@
 000000b0: 2629 05da 026f 73da 016e da05 7261 6e67  &)...os..n..rang
 000000c0: 65da 0169 da06 7379 7374 656d a900 7209  e..i..system..r.
 000000d0: 0000 0072 0900 0000 fa3a 6275 696c 642f  ...r.....:build/
 000000e0: 6264 6973 742e 6d61 636f 7378 2d31 302e  bdist.macosx-10.
 000000f0: 392d 7838 365f 3634 2f65 6767 2f72 756e  9-x86_64/egg/run
 00000100: 6e69 6e67 7a2f 7265 732f 7265 735f 7275  ningz/res/res_ru
 00000110: 6e2e 7079 da08 3c6d 6f64 756c 653e 0100  n.py..<module>..
-00000120: 0000 7304 0000 0008 0704 01              ..s........
+00000120: 0000 7306 0000 0008 0704 0126 05         ..s........&.
```

## runningz/res/res_run_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Thu May  9 16:27:50 2024 UTC, .py size: 791 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 86f9 3c66 1703 0000  a.........<f....
+00000000: 610d 0d0a 0000 0000 8512 4e66 d306 0000  a.........Nf....
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
@@ -10,15 +10,15 @@
 00000090: 0000 0000 0000 0000 0004 0000 0008 0000  ................
 000000a0: 0043 0000 0073 5c00 0000 7400 6a01 a002  .C...s\...t.j...
 000000b0: 7403 a101 6401 1700 7c00 1700 7d01 6402  t...d...|...}.d.
 000000c0: 7d02 7c02 a004 6403 6404 a102 7d02 7405  }.|...d.d...}.t.
 000000d0: 7c01 6405 8302 8f1a 7d03 7c03 a006 7c02  |.d.....}.|...|.
 000000e0: a101 0100 5700 6400 0400 0400 8303 0100  ....W.d.........
 000000f0: 6e10 3100 734e 3000 0100 0100 0100 5900  n.1.sN0.......Y.
-00000100: 0100 6400 5300 2906 4efa 012f 6172 0100  ..d.S.).N../ar..
+00000100: 0100 6400 5300 2906 4efa 012f 612e 0500  ..d.S.).N../a...
 00000110: 0069 6d70 6f72 7420 6f73 0a23 2069 6d70  .import os.# imp
 00000120: 6f72 7420 7265 735f 7365 6564 732c 2072  ort res_seeds, r
 00000130: 6573 5f6c 6162 656c 732c 2072 6573 5f64  es_labels, res_d
 00000140: 6174 6573 0a0a 2320 7072 696e 7428 6c65  ates..# print(le
 00000150: 6e28 7265 735f 7365 6564 732e 636d 645f  n(res_seeds.cmd_
 00000160: 6c69 7374 2929 0a23 2070 7269 6e74 286c  list)).# print(l
 00000170: 656e 2872 6573 5f6c 6162 656c 732e 636d  en(res_labels.cm
@@ -34,32 +34,92 @@
 00000210: 2729 0a0a 2320 6e20 3d20 340a 2320 666f  ')..# n = 4.# fo
 00000220: 7220 6920 696e 2072 616e 6765 286e 293a  r i in range(n):
 00000230: 206f 732e 7379 7374 656d 2866 276e 6f68   os.system(f'noh
 00000240: 7570 2070 7974 686f 6e20 2d75 2072 6573  up python -u res
 00000250: 5f6c 6162 656c 732e 7079 207b 6e7d 207b  _labels.py {n} {
 00000260: 697d 203e 3e20 6c6f 675f 7265 735f 6c61  i} >> log_res_la
 00000270: 6265 6c73 2e74 7874 2032 3e26 3120 2627  bels.txt 2>&1 &'
-00000280: 290a 0a7a 065c 275c 275c 277a 0327 2727  )..z.\'\'\'z.'''
-00000290: da01 7729 07da 026f 73da 0470 6174 68da  ..w)...os..path.
-000002a0: 0764 6972 6e61 6d65 da08 5f5f 6669 6c65  .dirname..__file
-000002b0: 5f5f da07 7265 706c 6163 65da 046f 7065  __..replace..ope
-000002c0: 6eda 0577 7269 7465 2904 da06 6f75 7470  n..write)...outp
-000002d0: 7574 5a0b 7061 7468 5f6f 7574 7075 74da  utZ.path_output.
-000002e0: 0173 da01 66a9 0072 0e00 0000 fa3d 6275  .s..f..r.....=bu
-000002f0: 696c 642f 6264 6973 742e 6d61 636f 7378  ild/bdist.macosx
-00000300: 2d31 302e 392d 7838 365f 3634 2f65 6767  -10.9-x86_64/egg
-00000310: 2f72 756e 6e69 6e67 7a2f 7265 732f 7265  /runningz/res/re
-00000320: 735f 7275 6e5f 7079 2e70 79da 0372 756e  s_run_py.py..run
-00000330: 0400 0000 730a 0000 0000 0114 0104 0e0c  ....s...........
-00000340: 010c 0172 1000 0000 da08 5f5f 6d61 696e  ...r......__main
-00000350: 5f5f 7a08 2d2d 6f75 7470 7574 5429 02da  __z.--outputT)..
-00000360: 0474 7970 65da 0872 6571 7569 7265 6429  .type..required)
-00000370: 0c72 0400 0000 da03 7379 7372 1000 0000  .r......sysr....
-00000380: da08 5f5f 6e61 6d65 5f5f da08 6172 6770  ..__name__..argp
-00000390: 6172 7365 da0e 4172 6775 6d65 6e74 5061  arse..ArgumentPa
-000003a0: 7273 6572 da06 7061 7273 6572 da0c 6164  rser..parser..ad
-000003b0: 645f 6172 6775 6d65 6e74 da03 7374 72da  d_argument..str.
-000003c0: 0a70 6172 7365 5f61 7267 73da 0461 7267  .parse_args..arg
-000003d0: 7372 0b00 0000 720e 0000 0072 0e00 0000  sr....r....r....
-000003e0: 720e 0000 0072 0f00 0000 da08 3c6d 6f64  r....r......<mod
-000003f0: 756c 653e 0200 0000 7310 0000 0008 0108  ule>....s.......
-00000400: 0108 1408 0108 0108 0110 0108 01         .............
+00000280: 290a 0a5c 275c 275c 270a 696d 706f 7274  )..\'\'\'.import
+00000290: 206f 730a 696d 706f 7274 2073 7973 0a69   os.import sys.i
+000002a0: 6d70 6f72 7420 6e75 6d70 7920 6173 206e  mport numpy as n
+000002b0: 700a 696d 706f 7274 2070 616e 6461 7320  p.import pandas 
+000002c0: 6173 2070 640a 0a70 6174 6820 3d20 2778  as pd..path = 'x
+000002d0: 7878 270a 666e 616d 6573 203d 2073 6f72  xx'.fnames = sor
+000002e0: 7465 6428 5b78 2066 6f72 2078 2069 6e20  ted([x for x in 
+000002f0: 6f73 2e6c 6973 7464 6972 2870 6174 6829  os.listdir(path)
+00000300: 2069 6620 782e 656e 6473 7769 7468 2827   if x.endswith('
+00000310: 2e63 7376 2729 5d29 0a0a 6466 5f61 7267  .csv')])..df_arg
+00000320: 6d61 7820 3d20 5b5d 0a66 6f72 2066 6e61  max = [].for fna
+00000330: 6d65 2069 6e20 666e 616d 6573 3a0a 2020  me in fnames:.  
+00000340: 2020 6466 203d 2070 642e 7265 6164 5f63    df = pd.read_c
+00000350: 7376 2866 277b 7061 7468 7d2f 7b66 6e61  sv(f'{path}/{fna
+00000360: 6d65 7d27 290a 2020 2020 0a20 2020 2061  me}').    .    a
+00000370: 7267 6d61 7820 3d20 6466 5b27 6963 5f65  rgmax = df['ic_e
+00000380: 7661 6c27 5d2e 6172 676d 6178 2829 0a20  val'].argmax(). 
+00000390: 2020 206e 203d 206c 656e 2864 6629 0a20     n = len(df). 
+000003a0: 2020 2023 2061 7267 6d61 7820 3d20 6e20     # argmax = n 
+000003b0: 2d20 310a 2020 2020 0a20 2020 2069 6320  - 1.    .    ic 
+000003c0: 3d20 6466 5b27 6963 5f63 7572 275d 2e69  = df['ic_cur'].i
+000003d0: 6c6f 635b 6172 676d 6178 5d0a 2020 2020  loc[argmax].    
+000003e0: 6963 5f65 7661 6c20 3d20 6466 5b27 6963  ic_eval = df['ic
+000003f0: 5f65 7661 6c27 5d2e 696c 6f63 5b61 7267  _eval'].iloc[arg
+00000400: 6d61 785d 0a20 2020 2064 6620 3d20 6466  max].    df = df
+00000410: 5b3a 6172 676d 6178 202b 2031 5d0a 2020  [:argmax + 1].  
+00000420: 2020 6466 203d 2064 665b 6466 5b27 6669    df = df[df['fi
+00000430: 6e64 275d 5d0a 2020 2020 636f 6c73 203d  nd']].    cols =
+00000440: 206c 6973 7428 6466 5b27 6e61 6d65 275d   list(df['name']
+00000450: 290a 2020 2020 6466 5f61 7267 6d61 782e  ).    df_argmax.
+00000460: 6170 7065 6e64 285b 666e 616d 655b 3235  append([fname[25
+00000470: 3a5d 2c20 6e2c 2061 7267 6d61 782c 2069  :], n, argmax, i
+00000480: 632c 2069 635f 6576 616c 2c20 636f 6c73  c, ic_eval, cols
+00000490: 5d29 0a64 665f 6172 676d 6178 203d 2070  ]).df_argmax = p
+000004a0: 642e 4461 7461 4672 616d 6528 6466 5f61  d.DataFrame(df_a
+000004b0: 7267 6d61 782c 2063 6f6c 756d 6e73 203d  rgmax, columns =
+000004c0: 205b 2766 6e61 6d65 272c 2027 6e27 2c20   ['fname', 'n', 
+000004d0: 2761 7267 6d61 7827 2c20 2769 6327 2c20  'argmax', 'ic', 
+000004e0: 2769 635f 6576 616c 272c 2027 636f 6c73  'ic_eval', 'cols
+000004f0: 275d 290a 6466 5f61 7267 6d61 7820 3d20  ']).df_argmax = 
+00000500: 6466 5f61 7267 6d61 782e 736f 7274 5f76  df_argmax.sort_v
+00000510: 616c 7565 7328 2769 635f 6576 616c 272c  alues('ic_eval',
+00000520: 2061 7363 656e 6469 6e67 3d46 616c 7365   ascending=False
+00000530: 292e 7265 7365 745f 696e 6465 7828 6472  ).reset_index(dr
+00000540: 6f70 203d 2054 7275 6529 0a64 665f 6172  op = True).df_ar
+00000550: 676d 6178 0a0a 636f 6c73 5f66 6561 203d  gmax..cols_fea =
+00000560: 206c 6973 7428 7064 2e53 6572 6965 7328   list(pd.Series(
+00000570: 5b78 696a 2066 6f72 2078 6920 696e 2064  [xij for xi in d
+00000580: 665f 6172 676d 6178 5b27 636f 6c73 275d  f_argmax['cols']
+00000590: 2066 6f72 2078 696a 2069 6e20 7869 5d29   for xij in xi])
+000005a0: 2e64 726f 705f 6475 706c 6963 6174 6573  .drop_duplicates
+000005b0: 2829 290a 7072 696e 7428 6c65 6e28 636f  ()).print(len(co
+000005c0: 6c73 5f66 6561 2929 0a64 665f 6665 5f72  ls_fea)).df_fe_r
+000005d0: 6570 6f72 7420 3d20 727a 2e44 6174 614d  eport = rz.DataM
+000005e0: 6173 7465 7228 292e 6e61 6d65 722e 6765  aster().namer.ge
+000005f0: 745f 6466 5f66 655f 7265 706f 7274 2863  t_df_fe_report(c
+00000600: 6f6c 735f 6665 6129 0a0a 2320 727a 2e64  ols_fea)..# rz.d
+00000610: 756d 705f 6a73 6f6e 2863 6f6c 735f 6665  ump_json(cols_fe
+00000620: 612c 2027 7878 782f 6475 6d70 2f78 7878  a, 'xxx/dump/xxx
+00000630: 782e 6a73 6f6e 2729 0a5c 275c 275c 277a  x.json').\'\'\'z
+00000640: 065c 275c 275c 277a 0327 2727 da01 7729  .\'\'\'z.'''..w)
+00000650: 07da 026f 73da 0470 6174 68da 0764 6972  ...os..path..dir
+00000660: 6e61 6d65 da08 5f5f 6669 6c65 5f5f da07  name..__file__..
+00000670: 7265 706c 6163 65da 046f 7065 6eda 0577  replace..open..w
+00000680: 7269 7465 2904 da06 6f75 7470 7574 5a0b  rite)...outputZ.
+00000690: 7061 7468 5f6f 7574 7075 74da 0173 da01  path_output..s..
+000006a0: 66a9 0072 0e00 0000 fa3d 6275 696c 642f  f..r.....=build/
+000006b0: 6264 6973 742e 6d61 636f 7378 2d31 302e  bdist.macosx-10.
+000006c0: 392d 7838 365f 3634 2f65 6767 2f72 756e  9-x86_64/egg/run
+000006d0: 6e69 6e67 7a2f 7265 732f 7265 735f 7275  ningz/res/res_ru
+000006e0: 6e5f 7079 2e70 79da 0372 756e 0400 0000  n_py.py..run....
+000006f0: 730a 0000 0000 0114 0104 2e0c 010c 0172  s..............r
+00000700: 1000 0000 da08 5f5f 6d61 696e 5f5f 7a08  ......__main__z.
+00000710: 2d2d 6f75 7470 7574 5429 02da 0474 7970  --outputT)...typ
+00000720: 65da 0872 6571 7569 7265 6429 0c72 0400  e..required).r..
+00000730: 0000 da03 7379 7372 1000 0000 da08 5f5f  ....sysr......__
+00000740: 6e61 6d65 5f5f da08 6172 6770 6172 7365  name__..argparse
+00000750: da0e 4172 6775 6d65 6e74 5061 7273 6572  ..ArgumentParser
+00000760: da06 7061 7273 6572 da0c 6164 645f 6172  ..parser..add_ar
+00000770: 6775 6d65 6e74 da03 7374 72da 0a70 6172  gument..str..par
+00000780: 7365 5f61 7267 73da 0461 7267 7372 0b00  se_args..argsr..
+00000790: 0000 720e 0000 0072 0e00 0000 720e 0000  ..r....r....r...
+000007a0: 0072 0f00 0000 da08 3c6d 6f64 756c 653e  .r......<module>
+000007b0: 0200 0000 7310 0000 0008 0108 0108 3408  ....s.........4.
+000007c0: 0108 0108 0110 0108 01                   .........
```

## runningz/res/res_seeds_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Thu May  9 16:27:50 2024 UTC, .py size: 935 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 86f9 3c66 a703 0000  a.........<f....
+00000000: 610d 0d0a 0000 0000 8512 4e66 a703 0000  a.........Nf....
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
```

## runningz/res/config/res_config_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Thu May  9 16:27:50 2024 UTC, .py size: 3616 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 86f9 3c66 200e 0000  a.........<f ...
+00000000: 610d 0d0a 0000 0000 8512 4e66 200e 0000  a.........Nf ...
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
```

## runningz/res/er/pooler_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Thu May  9 16:27:50 2024 UTC, .py size: 23071 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 86f9 3c66 1f5a 0000  a.........<f.Z..
+00000000: 610d 0d0a 0000 0000 8512 4e66 1f5a 0000  a.........Nf.Z..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
```

## runningz/res/util/util_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Thu May  9 16:27:50 2024 UTC, .py size: 2316 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 86f9 3c66 0c09 0000  a.........<f....
+00000000: 610d 0d0a 0000 0000 8512 4e66 0c09 0000  a.........Nf....
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
```

## runningz/util/const.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Thu May  9 14:37:19 2024 UTC, .py size: 3674 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 9fdf 3c66 5a0e 0000  a.........<fZ...
+00000000: 610d 0d0a 0000 0000 8010 4e66 5a0e 0000  a.........NfZ...
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0003 0000 0040 0000 0073 4600 0000 6400  .....@...sF...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6400  d.l.Z.d.d.l.Z.d.
 00000040: 6401 6c02 5a02 6400 6401 6c03 5a03 4700  d.l.Z.d.d.l.Z.G.
 00000050: 6402 6403 8400 6403 8302 5a04 4700 6404  d.d...d...Z.G.d.
 00000060: 6405 8400 6405 8302 5a05 6505 8300 5a06  d...d...Z.e...Z.
 00000070: 6401 5300 2906 e900 0000 004e 6300 0000  d.S.)......Nc...
```

## runningz/util/const_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Thu May  9 16:27:50 2024 UTC, .py size: 4095 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 86f9 3c66 ff0f 0000  a.........<f....
+00000000: 610d 0d0a 0000 0000 8512 4e66 ff0f 0000  a.........Nf....
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
```

## runningz/util/csv.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Sun Nov  5 12:16:41 2023 UTC, .py size: 1238 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,15 +1,15 @@
-00000000: 610d 0d0a 0000 0000 a987 4765 d604 0000  a.........Ge....
+00000000: 610d 0d0a 0000 0000 ce39 4066 f904 0000  a........9@f....
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
-00000020: 0005 0000 0040 0000 0073 5000 0000 6400  .....@...sP...d.
+00000020: 0006 0000 0040 0000 0073 5000 0000 6400  .....@...sP...d.
 00000030: 6401 6c00 5a01 6400 6401 6c02 5a03 6400  d.l.Z.d.d.l.Z.d.
 00000040: 6402 6c04 6d05 5a05 6d06 5a06 0100 6403  d.l.m.Z.m.Z...d.
 00000050: 6404 6c07 6d08 5a08 0100 6403 6405 6c09  d.l.m.Z...d.d.l.
-00000060: 6d0a 5a0a 0100 640a 6406 6407 8401 5a0b  m.Z...d.d.d...Z.
-00000070: 640b 6408 6409 8401 5a0c 6401 5300 290c  d.d.d...Z.d.S.).
+00000060: 6d0a 5a0a 0100 640b 6406 6407 8401 5a0b  m.Z...d.d.d...Z.
+00000070: 640c 6409 640a 8401 5a0c 6401 5300 290d  d.d.d...Z.d.S.).
 00000080: e900 0000 004e 2902 da08 5061 7261 6c6c  .....N)...Parall
 00000090: 656c da07 6465 6c61 7965 64e9 0100 0000  el..delayed.....
 000000a0: 2901 da08 7275 6e5f 6675 6e63 2901 da0d  )...run_func)...
 000000b0: 6765 745f 7031 7032 5f6c 6973 7463 0500  get_p1p2_listc..
 000000c0: 0000 0000 0000 0000 0000 0800 0000 0600  ................
 000000d0: 0000 0300 0000 7364 0000 0087 0087 0187  ......sd........
 000000e0: 0266 0364 0164 0284 087c 0044 0083 017d  .f.d.d...|.D...}
@@ -41,57 +41,58 @@
 00000280: 6e63 6174 2908 da09 7061 7468 5f6c 6973  ncat)...path_lis
 00000290: 7472 0700 0000 7208 0000 0072 0900 0000  tr....r....r....
 000002a0: da09 4e41 4d45 5f4c 4953 54da 0764 665f  ..NAME_LIST..df_
 000002b0: 6c69 7374 da04 4e41 4d45 da02 6466 720e  list..NAME..dfr.
 000002c0: 0000 0072 0d00 0000 720f 0000 00da 0d72  ...r....r......r
 000002d0: 6561 645f 6373 765f 6c69 7374 0700 0000  ead_csv_list....
 000002e0: 7312 0000 0000 010e 0102 ff06 0208 0112  s...............
-000002f0: 0110 0110 0110 0172 1c00 0000 6306 0000  .......r....c...
-00000300: 0000 0000 0000 0000 000a 0000 0006 0000  ................
-00000310: 0003 0000 0073 5600 0000 7400 7401 8803  .....sV...t.t...
-00000320: 8301 7c05 8302 7d06 8700 8701 8702 8703  ..|...}.........
-00000330: 8704 6605 6401 6402 8408 7c06 4400 8301  ..f.d.d...|.D...
-00000340: 7d07 7402 7403 7c07 7c05 6403 6404 8d04  }.t.t.|.|.d.d...
-00000350: 7d08 7404 6a05 6405 6402 8400 7c08 4400  }.t.j.d.d...|.D.
-00000360: 8301 6406 6407 6408 8d03 7d09 7c09 5300  ..d.d.d...}.|.S.
-00000370: 2909 4e63 0100 0000 0000 0000 0000 0000  ).Nc............
-00000380: 0300 0000 0900 0000 1300 0000 733e 0000  ............s>..
-00000390: 0067 007c 005d 365c 027d 017d 0288 037c  .g.|.]6\.}.}...|
-000003a0: 017c 0285 0219 0088 0488 0288 0188 0064  .|.............d
-000003b0: 0075 0072 2864 006e 0a88 007c 017c 0285  .u.r(d.n...|.|..
-000003c0: 0219 0066 0569 0067 0291 0271 0453 00a9  ...f.i.g...q.S..
-000003d0: 014e 720e 0000 0029 0372 0b00 0000 da02  .Nr....).r......
-000003e0: 7031 da02 7032 a905 7218 0000 0072 0900  p1..p2..r....r..
-000003f0: 0000 7208 0000 0072 1700 0000 7207 0000  ..r....r....r...
-00000400: 0072 0e00 0000 720f 0000 0072 1000 0000  .r....r....r....
-00000410: 1400 0000 730c 0000 0006 0206 fe10 0116  ....s...........
-00000420: ff02 0202 fe7a 2772 6561 645f 6373 765f  .....z'read_csv_
-00000430: 6c69 7374 5f6e 6a6f 6273 2e3c 6c6f 6361  list_njobs.<loca
-00000440: 6c73 3e2e 3c6c 6973 7463 6f6d 703e 5a02  ls>.<listcomp>Z.
-00000450: 6c6b 2901 da04 6d6f 6465 6301 0000 0000  lk)...modec.....
-00000460: 0000 0000 0000 0002 0000 0004 0000 0053  ...............S
-00000470: 0000 0073 1800 0000 6700 7c00 5d10 7d01  ...s....g.|.].}.
-00000480: 7c01 6400 7501 7204 7c01 9102 7104 5300  |.d.u.r.|...q.S.
-00000490: 721d 0000 0072 0e00 0000 2902 720b 0000  r....r....).r...
-000004a0: 005a 0464 665f 6972 0e00 0000 720e 0000  .Z.df_ir....r...
-000004b0: 0072 0f00 0000 7210 0000 0018 0000 00f3  .r....r.........
-000004c0: 0000 0000 7201 0000 0046 7211 0000 0029  ....r....Fr....)
-000004d0: 0672 0600 0000 7215 0000 0072 0500 0000  .r....r....r....
-000004e0: 721c 0000 0072 0a00 0000 7216 0000 0029  r....r....r....)
-000004f0: 0a72 1700 0000 7207 0000 0072 0800 0000  .r....r....r....
-00000500: 7209 0000 0072 1800 0000 5a06 6e5f 6a6f  r....r....Z.n_jo
-00000510: 6273 5a09 7031 7032 5f6c 6973 745a 1061  bsZ.p1p2_listZ.a
-00000520: 7267 735f 6b77 6172 6773 5f6c 6973 7472  rgs_kwargs_listr
-00000530: 1900 0000 721b 0000 0072 0e00 0000 7220  ....r....r....r 
-00000540: 0000 0072 0f00 0000 da13 7265 6164 5f63  ...r......read_c
-00000550: 7376 5f6c 6973 745f 6e6a 6f62 7311 0000  sv_list_njobs...
-00000560: 0073 0e00 0000 0002 0e01 1202 02fe 0603  .s..............
-00000570: 1001 1a01 7223 0000 0029 044e 4e4e 4e29  ....r#...).NNNN)
-00000580: 054e 4e4e 4e72 0400 0000 290d da05 6e75  .NNNNr....)...nu
-00000590: 6d70 79da 026e 70da 0670 616e 6461 7372  mpy..np..pandasr
-000005a0: 0a00 0000 5a06 6a6f 626c 6962 7202 0000  ....Z.joblibr...
-000005b0: 0072 0300 0000 da03 7275 6e72 0500 0000  .r......runr....
-000005c0: da04 7574 696c 7206 0000 0072 1c00 0000  ..utilr....r....
-000005d0: 7223 0000 0072 0e00 0000 720e 0000 0072  r#...r....r....r
-000005e0: 0e00 0000 720f 0000 00da 083c 6d6f 6475  ....r......<modu
-000005f0: 6c65 3e01 0000 0073 1000 0000 0801 0801  le>....s........
-00000600: 1001 0c01 0c02 0a0a 0001 00ff            ............
+000002f0: 0110 0110 0110 0172 1c00 0000 5463 0700  .......r....Tc..
+00000300: 0000 0000 0000 0000 0000 0b00 0000 0700  ................
+00000310: 0000 0300 0000 7358 0000 0074 0074 0188  ......sX...t.t..
+00000320: 0383 017c 0583 027d 0787 0087 0187 0287  ...|...}........
+00000330: 0387 0466 0564 0164 0284 087c 0744 0083  ...f.d.d...|.D..
+00000340: 017d 0874 0274 037c 087c 0564 037c 0664  .}.t.t.|.|.d.|.d
+00000350: 048d 057d 0974 046a 0564 0564 0284 007c  ...}.t.j.d.d...|
+00000360: 0944 0083 0164 0664 0764 088d 037d 0a7c  .D...d.d.d...}.|
+00000370: 0a53 0029 094e 6301 0000 0000 0000 0000  .S.).Nc.........
+00000380: 0000 0003 0000 0009 0000 0013 0000 0073  ...............s
+00000390: 3e00 0000 6700 7c00 5d36 5c02 7d01 7d02  >...g.|.]6\.}.}.
+000003a0: 8803 7c01 7c02 8502 1900 8804 8802 8801  ..|.|...........
+000003b0: 8800 6400 7500 7228 6400 6e0a 8800 7c01  ..d.u.r(d.n...|.
+000003c0: 7c02 8502 1900 6605 6900 6702 9102 7104  |.....f.i.g...q.
+000003d0: 5300 a901 4e72 0e00 0000 2903 720b 0000  S...Nr....).r...
+000003e0: 00da 0270 31da 0270 32a9 0572 1800 0000  ...p1..p2..r....
+000003f0: 7209 0000 0072 0800 0000 7217 0000 0072  r....r....r....r
+00000400: 0700 0000 720e 0000 0072 0f00 0000 7210  ....r....r....r.
+00000410: 0000 0014 0000 0073 0c00 0000 0602 06fe  .......s........
+00000420: 1001 16ff 0202 02fe 7a27 7265 6164 5f63  ........z'read_c
+00000430: 7376 5f6c 6973 745f 6e6a 6f62 732e 3c6c  sv_list_njobs.<l
+00000440: 6f63 616c 733e 2e3c 6c69 7374 636f 6d70  ocals>.<listcomp
+00000450: 3e5a 026c 6b29 02da 046d 6f64 65da 0776  >Z.lk)...mode..v
+00000460: 6572 626f 7365 6301 0000 0000 0000 0000  erbosec.........
+00000470: 0000 0002 0000 0004 0000 0053 0000 0073  ...........S...s
+00000480: 1800 0000 6700 7c00 5d10 7d01 7c01 6400  ....g.|.].}.|.d.
+00000490: 7501 7204 7c01 9102 7104 5300 721d 0000  u.r.|...q.S.r...
+000004a0: 0072 0e00 0000 2902 720b 0000 005a 0464  .r....).r....Z.d
+000004b0: 665f 6972 0e00 0000 720e 0000 0072 0f00  f_ir....r....r..
+000004c0: 0000 7210 0000 0018 0000 00f3 0000 0000  ..r.............
+000004d0: 7201 0000 0046 7211 0000 0029 0672 0600  r....Fr....).r..
+000004e0: 0000 7215 0000 0072 0500 0000 721c 0000  ..r....r....r...
+000004f0: 0072 0a00 0000 7216 0000 0029 0b72 1700  .r....r....).r..
+00000500: 0000 7207 0000 0072 0800 0000 7209 0000  ..r....r....r...
+00000510: 0072 1800 0000 5a06 6e5f 6a6f 6273 7222  .r....Z.n_jobsr"
+00000520: 0000 005a 0970 3170 325f 6c69 7374 5a10  ...Z.p1p2_listZ.
+00000530: 6172 6773 5f6b 7761 7267 735f 6c69 7374  args_kwargs_list
+00000540: 7219 0000 0072 1b00 0000 720e 0000 0072  r....r....r....r
+00000550: 2000 0000 720f 0000 00da 1372 6561 645f   ...r......read_
+00000560: 6373 765f 6c69 7374 5f6e 6a6f 6273 1100  csv_list_njobs..
+00000570: 0000 730e 0000 0000 020e 0112 0202 fe06  ..s.............
+00000580: 0312 011a 0172 2400 0000 2904 4e4e 4e4e  .....r$...).NNNN
+00000590: 2906 4e4e 4e4e 7204 0000 0054 290d da05  ).NNNNr....T)...
+000005a0: 6e75 6d70 79da 026e 70da 0670 616e 6461  numpy..np..panda
+000005b0: 7372 0a00 0000 5a06 6a6f 626c 6962 7202  sr....Z.joblibr.
+000005c0: 0000 0072 0300 0000 da03 7275 6e72 0500  ...r......runr..
+000005d0: 0000 da04 7574 696c 7206 0000 0072 1c00  ....utilr....r..
+000005e0: 0000 7224 0000 0072 0e00 0000 720e 0000  ..r$...r....r...
+000005f0: 0072 0e00 0000 720f 0000 00da 083c 6d6f  .r....r......<mo
+00000600: 6475 6c65 3e01 0000 0073 1000 0000 0801  dule>....s......
+00000610: 0801 1001 0c01 0c02 0a0a 0001 00ff       ..............
```

## runningz/util/npy_numba.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Thu May  9 16:08:25 2024 UTC, .py size: 87558 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 f9f4 3c66 0656 0100  a.........<f.V..
+00000000: 610d 0d0a 0000 0000 797c 4b66 0656 0100  a.......y|Kf.V..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 c415 0000 6400  .....@...s....d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6400  d.l.Z.d.d.l.Z.d.
 00000040: 6401 6c02 5a02 6400 6401 6c03 5a04 6400  d.l.Z.d.d.l.Z.d.
 00000050: 6401 6c05 5a06 6400 6401 6c07 5a08 6402  d.l.Z.d.d.l.Z.d.
 00000060: 6403 8400 5a09 6502 6a0a 6404 6405 8d01  d...Z.e.j.d.d...
 00000070: 6406 6407 8400 8301 5a0b 6502 6a0a 6404  d.d.....Z.e.j.d.
```

## runningz/util/npy_numba_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Thu May  9 16:27:50 2024 UTC, .py size: 88003 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 86f9 3c66 c357 0100  a.........<f.W..
+00000000: 610d 0d0a 0000 0000 8512 4e66 c357 0100  a.........Nf.W..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
```

## runningz/util/test_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Thu May  9 16:27:50 2024 UTC, .py size: 7255 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 86f9 3c66 571c 0000  a.........<fW...
+00000000: 610d 0d0a 0000 0000 8512 4e66 571c 0000  a.........NfW...
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
```

## Comparing `runningz-0.16.1.dist-info/RECORD` & `runningz-0.16.2.dist-info/RECORD`

 * *Files 10% similar despite different names*

```diff
@@ -1,23 +1,23 @@
 runningz/.gitignore,sha256=2PnT92rNjvJIdZJRlw65BllfDzmxlteLcGOxAPCDFpY,196
-runningz/__init__.pyc,sha256=QQJ8WHwHUa6j8UbHCbrDJ8LZd4Q0y7P5gbFWKex_wyw,1299
+runningz/__init__.pyc,sha256=nN3JBA8mlpQgpaBusE-gjVMTFMm1sD6CQEt6_BTB7_g,1299
 runningz/api.pyc,sha256=RKrNXhZAbCuq7RJX1EcSVYzjVgAew4Eo3JhdLCYloyU,186
 runningz/core/DataMaster.pyc,sha256=S8UbdIPVfUiTRpVkfUX75a7g7WpwvWiRc8544L0R0-8,18311
 runningz/core/__init__.pyc,sha256=QCBebMNvhe3fWRkv8vWOA0yerZUrPPO6jwXFDmU3dKg,151
 runningz/core/api.pyc,sha256=aNJrgOHktign7G1_Hkdcgc8MwbY7F0Bn7ZijeXzwGmo,3856
 runningz/core/er/__init__.pyc,sha256=X_qSA5MvcnWpGi_boqjQZ6kSfAmGgjUXpvkqa-6kwuQ,154
 runningz/core/er/hasher.pyc,sha256=m5R_HNzBmjnhAZAAUXu8sYYhkMYiEPOBngv-rcZ_SX8,572
 runningz/core/er/idxer.pyc,sha256=UtRjQIG1gYD1zGwS4BeTAUUKumeztGIVex0ZPrspQYc,651
 runningz/core/er/masker.pyc,sha256=JkbKeuW68AtDP-4jW8CAx-NQUa2yvrPv2uDDf3b2Jyg,573
 runningz/core/er/namer.pyc,sha256=jbsrt_681kgVn83k7wyJjgaAkG_--KkEDKAZCsvys8E,9357
 runningz/core/er/scaler.pyc,sha256=z-77F9YAX5zJXYGJFkFsfTxVS0br2uAojZfTMmBs414,550
 runningz/core/op/OPMaster.pyc,sha256=5m6qOe0L3gsEi6l3T8H9LHVsF1iGqMc8sXxrvH-Uu4c,7484
-runningz/core/op/OPMaster_py.pyc,sha256=pcCrpCNv44gBNCVGrd2p_uMyW2PuaMKKIkdCtlqH1QA,15662
+runningz/core/op/OPMaster_py.pyc,sha256=7v9UyHRdL4ryo1QDroR3uyfBbOBFOU6ZThwx284QPwY,15662
 runningz/core/op/__init__.pyc,sha256=HTwyx7showFNZVKRzFD4ZWDoa-Bf4ZG9OJY8mAu647w,6671
-runningz/core/op/__init___py.pyc,sha256=ZzZhKxKFeymZVymPjpN-dSsY6919Kx0FsGEGBp2fKaA,7346
+runningz/core/op/__init___py.pyc,sha256=52KsyyBaarEi976My9NsT0phTQZYRpWKwzvRld1tsPE,7346
 runningz/core/op/_numba.pyc,sha256=RyrgcV17NuzdULgofkDrYy3G-RT3EAt_V0aAeBWVcDw,11402
 runningz/core/op/_numba_1.pyc,sha256=P31JQAfKGeQ8-7PSrjClvmITpCR2eqgEArpaEqCXjRw,24115
 runningz/core/op/_numba_2.pyc,sha256=nugIiRQeD64yvCr8J6qP1Ojbz6mx_4fxlbTflcRBXVo,27784
 runningz/core/op/_numba_2_2.pyc,sha256=jtBN10GA0bj7ci32xbqbJ46A8ETnGHi-j-5QN8COwv0,17533
 runningz/core/op/_numba_merge_roll.pyc,sha256=vlpr49CiPNy8aDrA0sG_hYWHT-S68OxEFI7eVYJT_AU,6742
 runningz/core/op/op_1.pyc,sha256=J9SjPBX7U_FRNBsQC2ZkXJF2saL2F7ARjykGObWxzw0,9392
 runningz/core/op/op_1_numba.pyc,sha256=OxKBVswDsHXHMnIYrLSyECWoF9DMWJ42TzPLlyU15Qo,13877
@@ -28,51 +28,51 @@
 runningz/core/op/op_3_numba.pyc,sha256=J-1zgpPKzo8omFBzeNs47oQSOwd5OJ6CMEdpvPwKBPg,7119
 runningz/core/op/op_groupby.pyc,sha256=JWVvhHh3NuEWPeEmWWijFcellUNT0keGURNQs66cLJY,3788
 runningz/core/op/op_m.pyc,sha256=uE3QFbpcnbDnMWizWaaKZjp23ewo4VhsC81MBWyLW5M,3575
 runningz/core/op/op_m_numba.pyc,sha256=860BOhBUsXIGm6E5wXu1zX4nw3FZ-0XRu1VtN2dpewg,5128
 runningz/core/op/op_other.pyc,sha256=XrxOFIGu1nELWw1A8W2Foa8g6LPzGfNw0uX6F3thPVI,8705
 runningz/fe/.gitignore,sha256=hHBi8ZlV4ltnxGsnVdQuzcBcUempQhukAdFcnnBqy2Q,15
 runningz/fe/FEMaster.pyc,sha256=5IVfLLMBmpd59_IQE9skO7wrw1MzA0THZ89KqobeVVI,14548
-runningz/fe/FEMaster_py.pyc,sha256=VAPQp8YEgxRl3Qgt6rd8HxOy66bZqs1YO3V6X0blHIc,23960
+runningz/fe/FEMaster_py.pyc,sha256=elctN2jBFqf0bEu7jzJhotC8RfPb8MBAC8pWwDTJyfs,23960
 runningz/fe/__init__.pyc,sha256=2_vUy08HEb1-PVEqHBG8_uAZIYrYdR_7J9wRhzJqwh8,178
 runningz/fe/fe_dump.pyc,sha256=NWwdT8-6xcrW3I0r2hY9Nd5mI5bnrG0ExRYXaO7XJ_w,2487
-runningz/fe/fe_dump_py.pyc,sha256=oZOjCQ49F_lLmNHbI6kWr1SnZsJvHPWAK84jHNeNbek,3708
+runningz/fe/fe_dump_py.pyc,sha256=PYSyYjhlyK0MPmnT2OalfXUWi1_0k79dUs_BP-eouPg,3708
 runningz/fe/fe_eval.pyc,sha256=9C82kbEuobgos86DLkvi024K5n54KrVEVAxGqAWQfBk,4370
-runningz/fe/fe_eval_py.pyc,sha256=MeYKA9oic0JklQJwMr1_iJhSmz3Qev6oYACbL2V8f90,7171
+runningz/fe/fe_eval_py.pyc,sha256=tMKnyY2kM09nSpk8ZF-GM022E3yY73LOeASIbL900fQ,7171
 runningz/fe/fe_main.pyc,sha256=oCwvlN_E4ot8KWEgeJueh23ne2y2N7zr9E4ZbefbZiM,4850
-runningz/fe/fe_main_py.pyc,sha256=gtP9M2kLLFTAfZGNvfWznDxN0_EUCWt1Tqfvas603Mo,8473
+runningz/fe/fe_main_py.pyc,sha256=US4Ad7w4oDgsx__f4gjpXDtPXL823O0y5jlqYMJ58Sk,8473
 runningz/fe/config/__init__.pyc,sha256=q7MDowHyfmiAZaxv-qXSh7ezQovtmTx3yW8VUeGC4vE,156
 runningz/fe/config/cols_dict.pyc,sha256=w1kpbbHYak-W5fLkA5SZbc5bnBmc3LTui_FBTclFwyk,11438
 runningz/fe/config/cols_fea.pyc,sha256=tQhxeuKgeJX_eH0xiT-mgP8Oz7OCS1RjuZRFYN5PFEM,74158
 runningz/fe/config/fm_config.pyc,sha256=2-er7s4G7PG6CZ7WfbXNYbA_GoPeXh6fwI3yEGZyAjc,1274
 runningz/fe/config/fm_config_opt.pyc,sha256=nFJGM0D5E7nocTABVPSyIRI8ikH5gFNlGV3-mmhNYPk,1919
-runningz/fe/config/fm_config_opt_py.pyc,sha256=ejF-aPQj-Yhs-NZn_zH5eFZt5GCgaMLbmudePgJvEAk,5184
-runningz/fe/config/fm_config_py.pyc,sha256=hzH30JS3rpSZfdMI2APeP11yXRgnmx8jczA8aO1ESRk,5988
+runningz/fe/config/fm_config_opt_py.pyc,sha256=192qkzKFz_2raGlj-R8cAJ0pf_NmUY3LFaHM9vqWZBY,5184
+runningz/fe/config/fm_config_py.pyc,sha256=ORTOUQSBrotgvfWc75k6rExukCGNSZ-8vCzxf8vd3I8,5988
 runningz/fe/config/fm_config_top.pyc,sha256=CXDLrgGmWq2FKu7V4-FESNXH9qoA5l_LML51QrOwv5g,5793
-runningz/fe/config/fm_config_top_py.pyc,sha256=uMJ8Ce4EnmIzehA85-TNv2RskpQpLqK471TqWtnkAHw,19957
+runningz/fe/config/fm_config_top_py.pyc,sha256=EV2IyiXar3COsrt-cjJmbhAWhVjOCeUFHVCml1Ml1Fg,19957
 runningz/fe/er/__init__.pyc,sha256=uurZqbqGE1GDBJQJw1vkaJrLmnEqJiMMVqKV5WWDveQ,298
 runningz/fe/er/pather.pyc,sha256=6Y70GcIF7TerQ5G0Goa-t0cNaleD_WCiatN19HwdvRE,3039
 runningz/fe/er/pooler.pyc,sha256=xI_RhNirpSYgph7dGUPZkMC-4IDkEfKcLygw6IfESh0,17161
 runningz/fe/er/pooler_old.pyc,sha256=-6p1cSxjEtna3PjQQfaugtgqJ7pa-yyX860wvxubCVQ,17241
-runningz/fe/er/pooler_py.pyc,sha256=YnCYbe7v5AJ_WufiCWJlvZHyUy8FkU0ZFf5-kHYTW1g,38247
+runningz/fe/er/pooler_py.pyc,sha256=v9pDcNhFPldtgGiS6WjH2RpKTNKfxpe0e57ZS5vrXfw,38247
 runningz/fe/er/ranker.pyc,sha256=cj_A2vTxDUiV4jQIEoGenSNhR1cx59Rj1tgvxRuq56Q,8018
-runningz/fe/er/ranker_py.pyc,sha256=Gw2aX2T3pIKWh_YsNEbxluxl-Kgia5ZT-FZ0CKXfOc0,12370
+runningz/fe/er/ranker_py.pyc,sha256=EHrmxTasRBT6o45MC0NAuKQ6dGg88J34gJwDSw9in6Q,12370
 runningz/fe/er/typer.pyc,sha256=hzB_PbW39UFWD5kIPKrImD8hrWmlw6NsUvnN7fc-SB0,5561
 runningz/fe/prepare_data/__init__.pyc,sha256=blGZQ6BoJMvuFphXVYdT21vyAjv4X1PhZ7QhJduDYjE,162
-runningz/fe/prepare_data/base_data.pyc,sha256=S2B1CKVJTAIuEhBtNQ_42HYzdh3XLANJwqOYTUjGfkY,13097
-runningz/fe/prepare_data/base_data_py.pyc,sha256=texM_SCldYMPGun_aSCNEun_EiK-NpSbwCBH0RJL7zw,19981
-runningz/fe/prepare_data/basic_data.pyc,sha256=7rAPzGTJ3TmKr5O0tSKizkHZL1DFfx8M0otveltu8TA,1499
-runningz/fe/prepare_data/basic_data_py.pyc,sha256=Nb1f7LjjnFYYpDPIcRnfRM9Pn4NehCqYt44tE2XwXWI,2663
-runningz/fe/prepare_data/factor_data.pyc,sha256=uGg1OyT3F7a7S9zrh_vi8u6RndQTs1lmozNOFJArr24,8388
+runningz/fe/prepare_data/base_data.pyc,sha256=bQzqibsZO-WoHeYcqbRbREhQ0u9_lGcNkUVr9mDPWNo,13167
+runningz/fe/prepare_data/base_data_py.pyc,sha256=04zki1MqxIDHw25QxM0HbpyIBMJS4vQrB5DxPcM1SxI,20141
+runningz/fe/prepare_data/basic_data.pyc,sha256=oarelB9MmBiiOSC8nLcSMdlF-WV6ssRzEUJxxZyW5j8,1543
+runningz/fe/prepare_data/basic_data_py.pyc,sha256=Uv4Pb9wIvpx_tv2XXwSRZn1fxwM5kCKyleLjF-EqL_0,2745
+runningz/fe/prepare_data/factor_data.pyc,sha256=J25b72tBdWuVb71JIPaGG33RtKy_EIxun8Lcb0eww8M,8426
 runningz/fe/status/__init__.pyc,sha256=c6UCJqWddjdl6cy1fyu0WOBrYWirQejtL8OkuFxNgjQ,193
 runningz/fe/status/status.pyc,sha256=Osvp0TRjijnxTmxoLzIVl4ntUS7ZmkvjiuXg5ece6ew,10623
-runningz/fe/status/status_py.pyc,sha256=H9hu2WxPw92u4KsMdUPR3om3-bvbO_i5D7tzC_iCJuQ,16648
+runningz/fe/status/status_py.pyc,sha256=D5NpsIGJy6Ns9GIAjwwxaDLoYV7iOfsLWlXgYiav-V8,16648
 runningz/fe/util/__init__.pyc,sha256=glKAXhLTfBtMxBnasGohn-b5wfUZhr2Myy11I6jNW78,154
 runningz/fe/util/util.pyc,sha256=koBO_xKIkuIKZ58aFlYBcA0gySyM78H7PsCPgk8Rjls,11846
-runningz/fe/util/util_py.pyc,sha256=mU18yW4bWnFjtCg10pECoyycba84EkrsahT4piA_qyo,14775
+runningz/fe/util/util_py.pyc,sha256=TxeqcPQ2yf9cfQte8ou6c4p_TPxCDFz9JwQH8Ih66zs,14775
 runningz/metric/__init__.pyc,sha256=L2jH9L5nE6mhbRjHzSVbfIBBjnSyCLJCO0IATv7s_q4,294
 runningz/metric/get_score_metric.pyc,sha256=XJHVw77RTq-G-6E0MHvfe2oAiLA5C959TrSrhvcweTU,1818
 runningz/metric/ic.pyc,sha256=1iMvEajaLLuddxQggmZRV14mHtQZkwv3rzL7CXKVq7U,883
 runningz/metric/metrics.pyc,sha256=0cxQSgRQSkt26XEgylraMWeVbDiG66HefSXXCJAvcIo,3441
 runningz/metric/metrics_numba.pyc,sha256=bfWMGXMIGlkvzbSTx4bNr_d3HzVaRowvPaoBa0Dq6aY,3252
 runningz/model/__init__.pyc,sha256=WgDsn0BpUsR09JJ2DFupw7CbkjTvMIzdUCUwwoP-nik,277
 runningz/model/api.pyc,sha256=_HODf5U3wa-sZ2yIL9NQ-jvrPIkL_Kxx9rmhRh1pQ_A,147
@@ -92,79 +92,79 @@
 runningz/model/linear/model_lr.pyc,sha256=7fbROA0cQV5asWMOMwFUSw5w0TfD_MGjqXm_oaIbDiU,3931
 runningz/model/linear/model_sgd.pyc,sha256=nSChiqRTH3KY9DAu3QvAEB4Ej9NzOHS4NqLFPSjcOWg,3245
 runningz/model/nn/__init__.pyc,sha256=7NuqrrBMzqRrkM8QnoCvvOQRBheJKF4_1YmTa-IHJbc,197
 runningz/model/nn/model_cnn.pyc,sha256=HDTFBn6aUuDQy6ejt6VhJ9H_WVWrIxd9fpFdD4mbhj0,156
 runningz/model/nn/model_deep_wide.pyc,sha256=1aNS5uIw9dO9Zfhvo0g9E_WlCkAzKN-13c6-jT7XmZg,162
 runningz/model/nn/model_lstm.pyc,sha256=ijY-gN7DGnu_En9bc3ckRlfZAOqPD3EQtJPqkmzMiEI,157
 runningz/model/nn/model_mlp.pyc,sha256=UpO77RX1DNaDymEtNrfV9XjfAPyhCnYPZ79zVJ52yMg,6022
-runningz/model/nn/model_mlp_py.pyc,sha256=YaviT1SB3FBZdQ9axPwohlxSMWLl-1G5C4F1EXOWajM,11745
+runningz/model/nn/model_mlp_py.pyc,sha256=pj50o_wyLGjK9CHwtkMVTuauS3rlZYvbvF9C43htreE,11745
 runningz/model/nn/model_moe.pyc,sha256=EtyRdfnefqcA-e1SqWtC5CN_ADjanrd4rp75UziBg7o,156
 runningz/model/nn/model_rxnet.pyc,sha256=pHFIxF_eZJ9hIdGGqIpsEZPAxJhc-pKioa_euTXVBG4,4888
 runningz/model/nn/model_tabnet.pyc,sha256=ZM9IBlnHETCEEErcxK6Y84NmoqzQO-cFuwv2gVyuW5I,159
 runningz/model/nn/nn_util.pyc,sha256=_10R8jL62E_LTd9RLcCBSpWTcVL5HzzVMaz4_MkBPDo,14568
-runningz/model/nn/nn_util_py.pyc,sha256=usyzrWmuBdqDZhkIxNR1xOxu9rjzTauAhiVJlW7LdWo,16916
+runningz/model/nn/nn_util_py.pyc,sha256=ERHYXf3HWBwPYvkoofev3Ox0oefDy2JL2rSzTNPGdVM,16916
 runningz/model/tree/__init__.pyc,sha256=xkzPRkgdncRr8BI0U0x8RYAj6h_iHwSjB7zS04-5sgM,365
 runningz/model/tree/model_cat.pyc,sha256=yOPRT2wRcM-5A5aASGynwdCg4GeCvk_lA_ExabHvVl4,4689
-runningz/model/tree/model_cat_py.pyc,sha256=X5nft67-cvNDgdZtEx6WyY_Bb3gvbPWfKrpTPdwEzRg,8214
+runningz/model/tree/model_cat_py.pyc,sha256=MJMNd1ANtXdTof73tJXsmjbVVq9s0eWvqbKzYZcDCiQ,8214
 runningz/model/tree/model_erf.pyc,sha256=oKjlNUDUxrhvkkxHBBVn-KKz04ZhWUgu4MDTKlJNOO0,2815
 runningz/model/tree/model_lgb.pyc,sha256=O-ECs_IIPW7jwfoDkoLqS1NdtW5brAorSHQjLSBnfrU,8323
-runningz/model/tree/model_lgb_py.pyc,sha256=S3lO5jc0_R9OKffE_lkkxhEsQ8ehNfrzNa1RdVu9KsY,12185
+runningz/model/tree/model_lgb_py.pyc,sha256=_8wBVwE3wTPfrU5vd5Q3dHrkzvgKoOTwnx3mtdFUU10,12185
 runningz/model/tree/model_rf.pyc,sha256=AKvS311eWYtadhbElEw7gzsBMBywnTGKvaREwoShLCc,2829
 runningz/model/tree/model_xgb.pyc,sha256=WvC85WVDAIG43fY7E3PQ6-iWRKARVXvfskQCSch4vhM,3677
 runningz/opt/__init__.pyc,sha256=u2wdHAljgvyfwoazHDwCf0_34cQUCU4qQ4kqbJiWbrE,349
 runningz/opt/opt_convex.pyc,sha256=Tpt_lMeAMTfURZQ99nP_psn2LwAPueSgXI8AXtOIb78,152
 runningz/opt/opt_elo.pyc,sha256=h1b3-iYFWZvSrj3JuJn_z0vm9d4q5p2WNQRraFa4OHo,12130
 runningz/opt/opt_optuna.pyc,sha256=Qp_US7ez4-WbbPiofF9qaIY_TumZU979IiH6tv9fyLE,2320
 runningz/opt/opt_random.pyc,sha256=_C32uz2gxLVWLvwiPIDdb78Z8hQUBQQ5G1R96IUNB2A,6914
-runningz/opt/opt_random_py.pyc,sha256=x3hw7vy6HBgLUXpf40PR6gUZRnI9DcQLKOypuBH4OwE,9665
+runningz/opt/opt_random_py.pyc,sha256=PnI9lJI-vXVQT0GW_cq4BbxAXAhUNAsvxG2LOZBWmis,9665
 runningz/opt/opt_scipy.pyc,sha256=_A-_nULPtl4IGaGHnGJlVRd0Ma4gzAwxCU93KO3NLMI,927
 runningz/opt/opt_sgd.pyc,sha256=vYxDt7l80n9yWELHN1_mLQqvfuvWLrzAIhe__v3auXc,3556
 runningz/res/__init__.pyc,sha256=q6ZWBqFGo4VmQ6wcPcELc7leWktE8aTCwAx5XWxnxLU,150
 runningz/res/res_dates.pyc,sha256=ziX-58AjirUURtm1p6XO8Xeb7-UAugKngoRZT-8CPRg,1180
-runningz/res/res_dates_py.pyc,sha256=2ZeX_PFGQryU15nf17xbvefVdPE4R34t5QOFVkXRkI0,1498
-runningz/res/res_labels.pyc,sha256=fmKmry7bj0edhgl6MpWSJkWlQdlYtvVWx4CvZP2hcPU,1715
-runningz/res/res_labels_py.pyc,sha256=lkNChbhkY8bItpIvVItQx8Rt6fvVsD7bDihvBjfuyVM,2986
-runningz/res/res_main.pyc,sha256=pWYx_x0mhLBkMuPkzRjUieuo_jWmxnJwCKt9gjJ8Qd0,11812
-runningz/res/res_main_py.pyc,sha256=tTl52fUQ-GDEKP5vHO7GQNi9NWv7PiudJVjQ6GZA6Ac,21240
-runningz/res/res_run.pyc,sha256=zbxmRxwrUuG_JXQIQD3jOh74opLJ41aiWqlHS8hrJ_g,299
-runningz/res/res_run_py.pyc,sha256=qraImHUKlx0Xt_SN52zhEETCbaH1lTy1LSPTwTP6m84,1037
+runningz/res/res_dates_py.pyc,sha256=yOooVXgW6SXvaG4kqOEspEtFIVtbagGfRaUvhTLGCUo,1498
+runningz/res/res_labels.pyc,sha256=yldZVR-v290zYqUcENMy79tQW_oDgiP4YfIIsKg8kUs,1715
+runningz/res/res_labels_py.pyc,sha256=mlKt58ApcMU2_NQpjmZwvqu_eLzNF7m8a1z8crnx5Os,2986
+runningz/res/res_main.pyc,sha256=RJOraTcteyWQBcYjUwkNkWPzCUO_LoRPn0O98uD7bRM,11812
+runningz/res/res_main_py.pyc,sha256=rnyQD4uce01vR1IUzBWldqmCDWyCnn2lp3dHS1sfEE8,21288
+runningz/res/res_run.pyc,sha256=_aAueXnNT2YDZCa_gCOSqxRDrupyJsiLLNcP_oWteFs,301
+runningz/res/res_run_py.pyc,sha256=Ef4W8EzwydXiQ7aAzGjuq1Y7xZQfCUxrWGQvuwUzisw,1993
 runningz/res/res_seeds.pyc,sha256=LjWKMqCvMMg_fFxcaywNMtBgcnE9VssDx4d_Aqg7Q-o,971
-runningz/res/res_seeds_py.pyc,sha256=MQ48hhvzAbSahvsGU3WeoEGSTFhhZ41fbesTaaQs_Rw,1183
+runningz/res/res_seeds_py.pyc,sha256=IFVx2ZtFiHq_8rXfxlbmJ2pzAfQqXbzEXwTk951nW0w,1183
 runningz/res/config/__init__.pyc,sha256=JjG__a_vG2aVh24l9QvKtngGokxviRjfN0RTUMjemnU,157
 runningz/res/config/res_config.pyc,sha256=tLr2R0Gp19LMM7RTG_m7adYbWs5Oj2CcZmYGROz1KpM,1706
-runningz/res/config/res_config_py.pyc,sha256=x0ZZbvYN-9yU_OCed1oaLcDChdRyacodJvRQuJejhUw,3872
+runningz/res/config/res_config_py.pyc,sha256=iYyd8gYECt_WRptGPVAuZK7XaRVejcK02TTnYnjilgU,3872
 runningz/res/er/__init__.pyc,sha256=wK42RDd5Xe_W8dPlU-afOKqHqAgvK41i5sJtddX_tfE,153
 runningz/res/er/pooler.pyc,sha256=s3oC25EJZ9GEVsWbCXyRO3V02RMmPCyqeXLAdMpS69w,9935
-runningz/res/er/pooler_py.pyc,sha256=nMENIJWgwEzA-Z0EwkTLfucR9Or58s9Lb7I5Z4Ni4fI,23331
+runningz/res/er/pooler_py.pyc,sha256=acksRLHkOLKiFKvQheDFk1vnYWcYepbFq8AyRvWfKNw,23331
 runningz/res/util/__init__.pyc,sha256=Q_WC18b3dbhBj1QVFk8wi4FJ1N7wtA-dvzcgXIj8s4k,155
 runningz/res/util/util.pyc,sha256=YBLsb2b7Vz2_OU-272kmHIbEkqPulLTMKoeaRQ3caQY,2094
-runningz/res/util/util_py.pyc,sha256=X5vlxMyiZhSZZAkmuXPQI6t64WYLhDuT0BBK3CHlVXM,2564
+runningz/res/util/util_py.pyc,sha256=2fTsosf9nGIcE2Cx9cP-egsQ_46CKEinkOBEWRtG-Zc,2564
 runningz/util/__init__.pyc,sha256=YtFcSjnc7TDswwLg7pUyD1Uw_9iOydpx3difGt79a0g,172
 runningz/util/api.pyc,sha256=fSTyQdCndjcXTwcp5FB9SHjvR5KDM6Vhaa-EK9KPDfM,1813
 runningz/util/clss.pyc,sha256=jsj_HHemzsF4PEM7HaUiiPmqA7mms7Tpf01t-5uDFAc,2062
 runningz/util/code.pyc,sha256=zFbPplaiZ53nYR3yTR7scMX0tn1PBMbkkMSw7t0bo0w,46539
-runningz/util/const.pyc,sha256=wmMgjYj7P1MUSLaSNJhj3ZCdrGrDIajYgpXCVh5h7Gw,3426
-runningz/util/const_py.pyc,sha256=S-cYvwT9c5gH4iezCLAD5mG2NKjVBpQsf1ZvvDsx6i0,4340
-runningz/util/csv.pyc,sha256=poZc9O8vsPTTw1qQqU2ANJHCAwsM3w7wLAj4bgr_Dw4,1548
+runningz/util/const.pyc,sha256=SbIMC7nLjCFq9Dev5xCcMxfdoyC6zGPu0TMdaXu-dpA,3426
+runningz/util/const_py.pyc,sha256=tAzq5qLMa9nbCe7201LA5AfaZunulQI_6Wuv0QpmpAM,4340
+runningz/util/csv.pyc,sha256=lbnxhsyUjhK5hTo7qYLpFaOaGks99dp4xXq5XJFz8s4,1566
 runningz/util/db.pyc,sha256=nLjt-XbeyY94daxB0KEHRVTB4qANqaMe999B0qwcGYg,12208
 runningz/util/debug.pyc,sha256=VLnGcYxVQjXiFRmwAj6QMirUK1XjzSOU-Kg-Mb-kXLA,469
 runningz/util/dec.pyc,sha256=V-QlU_oQwqHpYYnrtEmKFWdZsBdG8JXiHB_3Dh3mGp4,2191
 runningz/util/dist.pyc,sha256=_GzIWmIEj5Ul586FmJdCVZXfI1nrKy68PNGtzHavvgM,9190
 runningz/util/env.pyc,sha256=wN6ExFgNPya7u1J_G2Wc7fRfzfOXLRhLKuV9quMgLzU,3599
 runningz/util/login.pyc,sha256=fRrfRaNynqmzcpvI_7QelPGan275aXhtVi0DqaIUKXM,2172
 runningz/util/mem.pyc,sha256=xPRK-N8YCaEmlLvbUhhTP00KPiAzwi-N4w89hydzrXg,4867
 runningz/util/npy.pyc,sha256=Klww-DBgxoPImdnWnU2314b25plqtDAqW2oAlz53lN0,19993
-runningz/util/npy_numba.pyc,sha256=gMMZDX2LmjhbPiOG9v4b9kf5EjVcCHGugl2vc0yz9yM,68010
-runningz/util/npy_numba_py.pyc,sha256=gc1AFkCGk5HbToPwrAxkRKLQv7wH8E64RwKndfuh2gs,88324
+runningz/util/npy_numba.pyc,sha256=3w6UzOmODOWAspxNvS_Y3xfe2bGQCzsnBOv-ltNQj3I,68010
+runningz/util/npy_numba_py.pyc,sha256=LQTyRvDuhkkT_bVCRQ6OrOGHg-QvrzOJupXf-GKzDqs,88324
 runningz/util/pool.pyc,sha256=GWzXucYKxIcUxvL35x4whdJYWa-D8X_MK13f9xol7-w,702066
 runningz/util/run.pyc,sha256=9JVK1WIjpmaYmx1BO6n9mpmfDInrA_J0AOGg7D686lY,9282
 runningz/util/split.pyc,sha256=eSRY1XmEoPyaguip2MBcp9TIm4bzfhhGE2MKEn9GlMA,3974
 runningz/util/test.pyc,sha256=4uw3IrAqzVoOC-RsoiLGtnXCat0XtujnASPX5tbWYv0,5670
-runningz/util/test_py.pyc,sha256=mszm0ULewlcmqxWqHDCa7dV0hX6pm2tXBVkeaDugtRg,7503
+runningz/util/test_py.pyc,sha256=VseHGSmlWhXXkMPR5CUAYzXbhrKfTj_8SNd2uWEcP_g,7503
 runningz/util/util.pyc,sha256=7tMZrilL_XjYjAPU0jLHMXAcr1Xe6RiZoI1tCTj-Xpk,18691
 runningz/util/temp/__init__.pyc,sha256=riZY9noDfq5zOxfSHKR_W2QIOhEaLafBvvessFfJ074,156
 runningz/util/temp/main.pyc,sha256=A5M2waDjLYpsf0KhEzOH5VcL2Hhl4JxfwbRYJfYTssY,1211
-runningz-0.16.1.dist-info/METADATA,sha256=HRTDMZONF8vm8quiorBSYhk-BOEZvQid3_yG_6syFEI,510
-runningz-0.16.1.dist-info/WHEEL,sha256=mzt24jmB6onkp8K8M-0bHGtbssTH2r_o1Dey-oJvff8,82
-runningz-0.16.1.dist-info/entry_points.txt,sha256=xRyDezAQfzQeE97t4wke38tl4qHJ613W1xSFGgezkzY,52
-runningz-0.16.1.dist-info/top_level.txt,sha256=qEVJqYeVqhub8a5GjohmAzV8iHDFesibNKxTpCqsOBQ,9
-runningz-0.16.1.dist-info/RECORD,,
+runningz-0.16.2.dist-info/METADATA,sha256=gcOLabYR7rCEuFawdWg_0hFPPUgGDzmO2jXM3sRtwFM,510
+runningz-0.16.2.dist-info/WHEEL,sha256=mzt24jmB6onkp8K8M-0bHGtbssTH2r_o1Dey-oJvff8,82
+runningz-0.16.2.dist-info/entry_points.txt,sha256=xRyDezAQfzQeE97t4wke38tl4qHJ613W1xSFGgezkzY,52
+runningz-0.16.2.dist-info/top_level.txt,sha256=qEVJqYeVqhub8a5GjohmAzV8iHDFesibNKxTpCqsOBQ,9
+runningz-0.16.2.dist-info/RECORD,,
```

