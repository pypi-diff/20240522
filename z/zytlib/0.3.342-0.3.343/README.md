# Comparing `tmp/zytlib-0.3.342-py3-none-any.whl.zip` & `tmp/zytlib-0.3.343-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,37 +1,37 @@
-Zip file size: 75001 bytes, number of entries: 35
--rw-r--r--  2.0 unx      750 b- defN 23-May-12 10:21 zytlib/__init__.py
--rw-r--r--  2.0 unx       35 b- defN 23-May-12 10:21 zytlib/table.py
--rw-r--r--  2.0 unx       37 b- defN 23-May-12 10:21 zytlib/vector.py
--rw-r--r--  2.0 unx      145 b- defN 23-May-12 10:21 zytlib/container/__init__.py
--rw-r--r--  2.0 unx     3240 b- defN 23-May-12 10:21 zytlib/container/sequence.py
--rw-r--r--  2.0 unx     9598 b- defN 23-May-12 10:21 zytlib/container/table.py
--rw-r--r--  2.0 unx    11061 b- defN 23-May-12 10:21 zytlib/container/torch_table.py
--rw-r--r--  2.0 unx   179917 b- defN 23-May-12 10:21 zytlib/container/vector.py
--rw-r--r--  2.0 unx        0 b- defN 23-May-12 10:21 zytlib/deprecated/__init__.py
--rw-r--r--  2.0 unx     1000 b- defN 23-May-12 10:21 zytlib/deprecated/_test_curses.py
--rw-r--r--  2.0 unx    11461 b- defN 23-May-12 10:21 zytlib/deprecated/terminal.py
--rw-r--r--  2.0 unx        0 b- defN 23-May-12 10:21 zytlib/inout/__init__.py
--rw-r--r--  2.0 unx    32428 b- defN 23-May-12 10:21 zytlib/inout/filemanager.py
--rw-r--r--  2.0 unx    30748 b- defN 23-May-12 10:21 zytlib/inout/logging.py
--rw-r--r--  2.0 unx        0 b- defN 23-May-12 10:21 zytlib/nstools/__init__.py
--rw-r--r--  2.0 unx    10673 b- defN 23-May-12 10:21 zytlib/nstools/torch_utils.py
--rw-r--r--  2.0 unx      327 b- defN 23-May-12 10:21 zytlib/nstools/vector_utils.py
--rw-r--r--  2.0 unx        0 b- defN 23-May-12 10:21 zytlib/utils/__init__.py
--rw-r--r--  2.0 unx      643 b- defN 23-May-12 10:21 zytlib/utils/classfunc.py
--rw-r--r--  2.0 unx      161 b- defN 23-May-12 10:21 zytlib/utils/strtools.py
--rw-r--r--  2.0 unx     3569 b- defN 23-May-12 10:21 zytlib/utils/timing.py
--rw-r--r--  2.0 unx     6413 b- defN 23-May-12 10:21 zytlib/utils/touch.py
--rw-r--r--  2.0 unx     2031 b- defN 23-May-12 10:21 zytlib/utils/utils.py
--rw-r--r--  2.0 unx    13839 b- defN 23-May-12 10:21 zytlib/utils/wrapper.py
--rw-r--r--  2.0 unx      489 b- defN 23-May-12 10:21 zytlib/utils/wrapper_plus.py
--rw-r--r--  2.0 unx      575 b- defN 23-May-12 10:21 zytlib/visual/__init__.py
--rw-r--r--  2.0 unx     4887 b- defN 23-May-12 10:21 zytlib/visual/animation.py
--rw-r--r--  2.0 unx     2904 b- defN 23-May-12 10:21 zytlib/visual/debugger.py
--rw-r--r--  2.0 unx     2119 b- defN 23-May-12 10:21 zytlib/visual/display.py
--rw-r--r--  2.0 unx     2572 b- defN 23-May-12 10:21 zytlib/visual/plot.py
--rw-r--r--  2.0 unx      355 b- defN 23-May-12 10:21 zytlib/visual/progress.py
--rw-r--r--  2.0 unx     3317 b- defN 23-May-12 10:21 zytlib-0.3.342.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-May-12 10:21 zytlib-0.3.342.dist-info/WHEEL
--rw-r--r--  2.0 unx        7 b- defN 23-May-12 10:21 zytlib-0.3.342.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     2823 b- defN 23-May-12 10:21 zytlib-0.3.342.dist-info/RECORD
-35 files, 338216 bytes uncompressed, 70513 bytes compressed:  79.2%
+Zip file size: 75256 bytes, number of entries: 35
+-rw-r--r--  2.0 unx      750 b- defN 24-May-22 09:32 zytlib/__init__.py
+-rw-r--r--  2.0 unx       35 b- defN 24-May-22 09:32 zytlib/table.py
+-rw-r--r--  2.0 unx       37 b- defN 24-May-22 09:32 zytlib/vector.py
+-rw-r--r--  2.0 unx      145 b- defN 24-May-22 09:32 zytlib/container/__init__.py
+-rw-r--r--  2.0 unx     3240 b- defN 24-May-22 09:32 zytlib/container/sequence.py
+-rw-r--r--  2.0 unx     9598 b- defN 24-May-22 09:32 zytlib/container/table.py
+-rw-r--r--  2.0 unx    11061 b- defN 24-May-22 09:32 zytlib/container/torch_table.py
+-rw-r--r--  2.0 unx   179917 b- defN 24-May-22 09:32 zytlib/container/vector.py
+-rw-r--r--  2.0 unx        0 b- defN 24-May-22 09:32 zytlib/deprecated/__init__.py
+-rw-r--r--  2.0 unx     1000 b- defN 24-May-22 09:32 zytlib/deprecated/_test_curses.py
+-rw-r--r--  2.0 unx    11461 b- defN 24-May-22 09:32 zytlib/deprecated/terminal.py
+-rw-r--r--  2.0 unx        0 b- defN 24-May-22 09:32 zytlib/inout/__init__.py
+-rw-r--r--  2.0 unx    32428 b- defN 24-May-22 09:32 zytlib/inout/filemanager.py
+-rw-r--r--  2.0 unx    30748 b- defN 24-May-22 09:32 zytlib/inout/logging.py
+-rw-r--r--  2.0 unx        0 b- defN 24-May-22 09:32 zytlib/nstools/__init__.py
+-rw-r--r--  2.0 unx    14960 b- defN 24-May-22 09:32 zytlib/nstools/torch_utils.py
+-rw-r--r--  2.0 unx      327 b- defN 24-May-22 09:32 zytlib/nstools/vector_utils.py
+-rw-r--r--  2.0 unx        0 b- defN 24-May-22 09:32 zytlib/utils/__init__.py
+-rw-r--r--  2.0 unx      643 b- defN 24-May-22 09:32 zytlib/utils/classfunc.py
+-rw-r--r--  2.0 unx      161 b- defN 24-May-22 09:32 zytlib/utils/strtools.py
+-rw-r--r--  2.0 unx     3569 b- defN 24-May-22 09:32 zytlib/utils/timing.py
+-rw-r--r--  2.0 unx     6413 b- defN 24-May-22 09:32 zytlib/utils/touch.py
+-rw-r--r--  2.0 unx     2031 b- defN 24-May-22 09:32 zytlib/utils/utils.py
+-rw-r--r--  2.0 unx    13839 b- defN 24-May-22 09:32 zytlib/utils/wrapper.py
+-rw-r--r--  2.0 unx      489 b- defN 24-May-22 09:32 zytlib/utils/wrapper_plus.py
+-rw-r--r--  2.0 unx      575 b- defN 24-May-22 09:32 zytlib/visual/__init__.py
+-rw-r--r--  2.0 unx     4887 b- defN 24-May-22 09:32 zytlib/visual/animation.py
+-rw-r--r--  2.0 unx     2904 b- defN 24-May-22 09:32 zytlib/visual/debugger.py
+-rw-r--r--  2.0 unx     2119 b- defN 24-May-22 09:32 zytlib/visual/display.py
+-rw-r--r--  2.0 unx     2572 b- defN 24-May-22 09:32 zytlib/visual/plot.py
+-rw-r--r--  2.0 unx      355 b- defN 24-May-22 09:32 zytlib/visual/progress.py
+-rw-r--r--  2.0 unx     3317 b- defN 24-May-22 09:32 zytlib-0.3.343.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 24-May-22 09:32 zytlib-0.3.343.dist-info/WHEEL
+-rw-r--r--  2.0 unx        7 b- defN 24-May-22 09:32 zytlib-0.3.343.dist-info/top_level.txt
+?rw-rw-r--  2.0 unx     2823 b- defN 24-May-22 09:32 zytlib-0.3.343.dist-info/RECORD
+35 files, 342503 bytes uncompressed, 70768 bytes compressed:  79.3%
```

## zipnote {}

```diff
@@ -87,20 +87,20 @@
 
 Filename: zytlib/visual/plot.py
 Comment: 
 
 Filename: zytlib/visual/progress.py
 Comment: 
 
-Filename: zytlib-0.3.342.dist-info/METADATA
+Filename: zytlib-0.3.343.dist-info/METADATA
 Comment: 
 
-Filename: zytlib-0.3.342.dist-info/WHEEL
+Filename: zytlib-0.3.343.dist-info/WHEEL
 Comment: 
 
-Filename: zytlib-0.3.342.dist-info/top_level.txt
+Filename: zytlib-0.3.343.dist-info/top_level.txt
 Comment: 
 
-Filename: zytlib-0.3.342.dist-info/RECORD
+Filename: zytlib-0.3.343.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## zytlib/nstools/torch_utils.py

```diff
@@ -210,14 +210,88 @@
             new_condition += condition[:, i] * basis
             basis *= condition_num[i]
         ret_shape = tuple(list(x.shape[:dim]) + list(condition_num) + list(x.shape[dim + 1:]))
         temp_ret = condition_average(x, basis, new_condition, dim=dim)
         ret = ConditionAverage(temp_ret.avg_tensor.reshape(ret_shape), temp_ret.count.reshape(condition_num))
         return ret
 
+# Define the named tuple for the result
+class ConditionStd(NamedTuple):
+    std_tensor: torch.Tensor
+    count: torch.Tensor
+
+def condition_std(x: torch.Tensor, condition_num: Union[int, Tuple[int]], condition: torch.Tensor, *, dim: int=-1, keep_shape: bool=False) -> ConditionStd:
+    """
+    Computes the standard deviation of the input tensor `x` over different conditions specified by the `condition` tensor.
+    If `condition_num` is an integer, the function computes the standard deviation of `x` over `condition_num` conditions,
+    where the condition of each element of `x` is specified by the corresponding element of `condition`.
+    If `condition_num` is a tuple, the function computes the standard deviation of `x` over the conditions specified by
+    the multi-dimensional `condition` tensor. Each dimension of `condition` specifies a different level of condition.
+
+    Args:
+        x (torch.Tensor): The input tensor to be averaged.
+        condition_num (Union[int, Tuple[int]]): An integer or tuple specifying the number of conditions.
+        condition (torch.Tensor): A tensor specifying the condition of each element of `x`.
+                                  The shape of `condition` should match the shape of `x` except in the dimension `dim`.
+                                  If `condition_num` is an integer, `condition` should have shape `(x.shape[dim],)`.
+                                  If `condition_num` is a tuple, `condition` should have shape
+                                  `(x.shape[0], x.shape[1], ..., x.shape[dim-1], condition_num[0], condition_num[1], ..., condition_num[-1], x.shape[dim+1], ..., x.shape[-1])`.
+        dim (int): The dimension along which to compute the standard deviation of the input tensor `x`. Default is `-1` (the last dimension).
+
+    Returns:
+        ConditionStd: A named tuple containing two elements: `std_tensor` and `count`.
+                      `std_tensor` is a tensor containing the standard deviation of `x` over different conditions.
+                      `count` is a tensor containing the number of elements in each condition.
+
+    Raises:
+        AssertionError: If the input arguments do not meet the requirements.
+    """
+    dim = dim % x.dim()
+    if keep_shape:
+        std_x = condition_std(x, condition_num, condition, dim=dim, keep_shape=False).std_tensor
+        ret = torch.zeros_like(x)
+        for i in range(x.shape[dim]):
+            x_idx = [slice(None)] * dim + [i] + [slice(None)] * (x.dim() - dim - 1)
+            if condition.dim() == 1:
+                std_idx = [slice(None)] * dim + [condition[i].item()] + [slice(None)] * (x.dim() - dim - 1)
+            else:
+                std_idx = [slice(None)] * dim + list(condition[i, :].detach().cpu().numpy()) + [slice(None)] * (x.dim() - dim - 1)
+            ret[tuple(x_idx)] = std_x[tuple(std_idx)]
+        return ret
+
+    if isinstance(condition_num, int):
+        assert condition_num > 0
+        assert condition.dim() == 1
+        ret_shape = list(x.shape)
+        ret_shape[dim] = condition_num
+        ret = ConditionStd(torch.zeros(ret_shape).to(x.device), torch.zeros(condition_num).to(x.device).long())
+        condition = condition.long()
+        for c in range(condition_num):
+            ci = condition == c
+            if ci.sum() == 0:
+                continue
+            x_index: List[Any] = [slice(None)] * dim + [ci] + [slice(None)] * (x.dim() - 1 - dim)
+            ret_index: List[Any] = [slice(None)] * dim + [c] + [slice(None)] * (x.dim() - 1 - dim)
+            ret.std_tensor[ret_index] = x[x_index].std(dim)
+            ret.count[c] = ci.sum()
+        return ret
+    elif isinstance(condition_num, tuple):
+        assert condition.dim() == 2
+        assert len(condition_num) == condition.shape[-1]
+        new_condition = torch.zeros_like(condition[:, -1])
+        basis = 1
+        for i in range(condition.shape[1] - 1, -1, -1):
+            new_condition += condition[:, i] * basis
+            basis *= condition_num[i]
+        ret_shape = tuple(list(x.shape[:dim]) + list(condition_num) + list(x.shape[dim + 1:]))
+        temp_ret = condition_std(x, basis, new_condition, dim=dim)
+        ret = ConditionStd(temp_ret.std_tensor.reshape(ret_shape), temp_ret.count.reshape(condition_num))
+        return ret
+
+
 def condition_residual(x: torch.Tensor, condition_num: Union[int, Tuple[int]], condition: torch.Tensor, *, dim: int=-1) -> torch.Tensor:
     dim = dim % x.dim()
     avg_x = condition_average(x, condition_num, condition, dim=dim).avg_tensor
 
     ret = torch.zeros_like(x)
 
     for i in range(x.shape[dim]):
```

## Comparing `zytlib-0.3.342.dist-info/METADATA` & `zytlib-0.3.343.dist-info/METADATA`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: zytlib
-Version: 0.3.342
+Version: 0.3.343
 Summary: This is A foundamental package containing some basic self-designed functions and types for Project PyCTLib. 
 Home-page: https://github.com/Bertie97/pyctlib/tree/main/pyctlib
 Author: All contributors of PyCTLib
 Author-email: zytfdu@icloud.com
 License: MIT Licence
 Keywords: pip,zytlib
 Platform: any
```

## Comparing `zytlib-0.3.342.dist-info/RECORD` & `zytlib-0.3.343.dist-info/RECORD`

 * *Files 8% similar despite different names*

```diff
@@ -9,15 +9,15 @@
 zytlib/deprecated/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 zytlib/deprecated/_test_curses.py,sha256=p6ARxr7wwy9Afuj0EvnC93Ot9fSYi30T9nad4jVmsgk,1000
 zytlib/deprecated/terminal.py,sha256=YVQcA3jKpHGex-cGEf5EQZf9e-iacszPajfzEgixzQA,11461
 zytlib/inout/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 zytlib/inout/filemanager.py,sha256=K26LAZeUImQdFrkuQ0KrYQy2Eu39b5RARI2sHt1XLhA,32428
 zytlib/inout/logging.py,sha256=kPd7wg7y7ckMkTpkAJW51VWWG2pdcskGBxKu6HGODY4,30748
 zytlib/nstools/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-zytlib/nstools/torch_utils.py,sha256=L3dFeWgUk9K-SCn9ew2BEkZkSUa20G7JqdC-OZrrhfs,10673
+zytlib/nstools/torch_utils.py,sha256=ZEZ5fC0IRKRUbO2qj1gAENOkynGxpmib3L2NrNIH13o,14960
 zytlib/nstools/vector_utils.py,sha256=9ouC7OTrKYa1BSCKpUK-7FyamF7mDVcJIioSJSzfVSo,327
 zytlib/utils/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 zytlib/utils/classfunc.py,sha256=HfIu6dq7CSMBG8y-No_4OMnLHgxCLT2Z_wIo6X_ahVk,643
 zytlib/utils/strtools.py,sha256=ytgrgk3mWAqqOuaMC_ckmHOe8zzLRXDtBq6j0ZuZVAE,161
 zytlib/utils/timing.py,sha256=OGlr0Q6Uxr05pwtzHtlxJHHK3mXeZd-5YdEIc4qKF8M,3569
 zytlib/utils/touch.py,sha256=InpCJtZbRre5hVDzVl--yA3QEPiUIIRvSI4_Y5hX5V4,6413
 zytlib/utils/utils.py,sha256=ZWwwP2jhFMMr8vLKqE1T99jXwRpsZdayLM1Y9dzy0rM,2031
@@ -25,11 +25,11 @@
 zytlib/utils/wrapper_plus.py,sha256=gzxKcbsZ2xEqQluzTwp06Hqf4Ttm2iMjjhyLNfay-mE,489
 zytlib/visual/__init__.py,sha256=faaJ-ys17tnVAC0w5ZHU66_VKcrcbiTZFQ6_PcNGtaQ,575
 zytlib/visual/animation.py,sha256=UvJwiQzgbSiXbjmuR0Ib8_ZlbfA8l81WG3Y3nd9HRdc,4887
 zytlib/visual/debugger.py,sha256=GUz2U4RFosQlZMxbR3HYSvng3-G-UzBCI-HGkUYkKKE,2904
 zytlib/visual/display.py,sha256=lzXFfno0wlUB1RVfWWFLTppSNezzjL68fBPm-JwHVCY,2119
 zytlib/visual/plot.py,sha256=fB-a1mhEVOnqLN7LGAIflZIkRsrrc2RX-UH50SU0Cmk,2572
 zytlib/visual/progress.py,sha256=GgZX7LbjQUDf3V2-HcrA3nNkw52PRxbZV9buMgK519o,355
-zytlib-0.3.342.dist-info/METADATA,sha256=cQiN7z7CnqB56FTChRA8pqfzoGISVenS9PIUZjNjAAg,3317
-zytlib-0.3.342.dist-info/WHEEL,sha256=G16H4A3IeoQmnOrYV4ueZGKSjhipXx8zc8nu9FGlvMA,92
-zytlib-0.3.342.dist-info/top_level.txt,sha256=MM5VcTDuVj-BaEIbC62T3PaPy4XmSD3InWJei3Fi0UY,7
-zytlib-0.3.342.dist-info/RECORD,,
+zytlib-0.3.343.dist-info/METADATA,sha256=VZiMNtm-yGQL85Tp4BUFETzT-u3hS1leoFsdPwS8NNg,3317
+zytlib-0.3.343.dist-info/WHEEL,sha256=G16H4A3IeoQmnOrYV4ueZGKSjhipXx8zc8nu9FGlvMA,92
+zytlib-0.3.343.dist-info/top_level.txt,sha256=MM5VcTDuVj-BaEIbC62T3PaPy4XmSD3InWJei3Fi0UY,7
+zytlib-0.3.343.dist-info/RECORD,,
```

